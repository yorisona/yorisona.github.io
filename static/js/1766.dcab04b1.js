"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[1766],{81766:function(e,t,a){a.d(t,{Z:function(){return T}});var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-changci-center-collect flex-auto tg-card"},[a("div",{staticClass:"collect-select",staticStyle:{"margin-top":"0px"}},[a("div",{staticStyle:{display:"flex"}},[a("select-date",{staticStyle:{width:"302px"},attrs:{isMonthQuarter:!0},on:{selectDate:e.selectDate}}),e.is_one_peoject?e._e():a("div",{staticStyle:{width:"180px","margin-left":"10px"}},[a("el-popover",{attrs:{placement:"bottom-start",trigger:"click",width:"370","popper-class":"cb-department-tree-popper-class"}},[a("div",{staticClass:"repain-select",staticStyle:{display:"block"},attrs:{slot:"reference"},slot:"reference"},[e.feishu_department_name?a("div",{staticClass:"depart-select-box"},[a("span",[e._v(e._s(e.feishu_department_name))]),a("i",{staticClass:"el-icon-circle-close",staticStyle:{"margin-top":"8px",color:"white"},on:{click:function(t){return t.stopPropagation(),function(){e.feishu_department_name="",e.feishu_department_id=void 0,e.cb_department_tree.setCheckedKeys([])}.apply(null,arguments)}}})]):a("div",{staticClass:"depart-select-box",staticStyle:{color:"rgba(164, 178, 194, 1)"}},[a("span",[e._v("请选择项目所属部门")]),a("i",{staticClass:"el-icon-arrow-down",staticStyle:{"margin-top":"8px",color:"#c0c4cc"}})])]),a("div",{staticClass:"department-tree"},[a("el-tree",{ref:"cb_department_tree",attrs:{props:e.treeProps,"check-strictly":!0,"node-key":"id",data:e.feishuDepartmentList,"show-checkbox":"","check-on-click-node":"","default-checked-keys":e.default_checked_department_ids,"default-expanded-keys":e.default_checked_department_ids},on:{check:e.handleCheckChange}})],1)])],1),e.is_one_peoject?e._e():a("el-select",{staticStyle:{"margin-left":"12px",width:"180px"},attrs:{size:"small"},model:{value:e.select_project_id,callback:function(t){e.select_project_id=t},expression:"select_project_id"}},e._l(e.project_list,(function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.title}})})),1)],1),e.update_time?a("div",{staticStyle:{"font-size":"14px",color:"#a4b2c2","line-height":"32px",height:"32px","margin-left":"18px"}},[e._v(" 最后更新时间： "+e._s(e.update_time)+" ")]):e._e()]),a("data-center-list",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"center-list-min-height",attrs:{list:e.tableData,"current-date-type":e.selectedDateType}})],1)},i=[],s=a(97434),o=a(99824),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"data-center-list"},[a("el-table",{attrs:{data:e.list,border:"","cell-style":{height:"32px !important",padding:0,fontSize:"12px"},"header-cell-style":{background:"#ffffff",height:"36px !important",color:"#19232D",fontSize:"12px",padding:0,fontWeight:500,borderBottom:"1px solid #ebeef5"}},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无数据"}})]},proxy:!0}])},[a("el-table-column",{attrs:{label:"指标",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",{staticClass:"slash",staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.weeK_str||t.row.month_str))]),a("span",{staticStyle:{color:"#6a7b92"}},[e._v(e._s(t.row.day_str))])])]}}])},[a("template",{slot:"header"},[a("div",{staticClass:"header-price list-title-box"},[a("p",{staticClass:"date"},[e._v("指标")]),a("p",{staticClass:"title"},[e._v("日期")])])])],2),e._l(e.columns,(function(t,r){return a("el-table-column",e._b({key:r},"el-table-column",t,!1))}))],2)],1)},l=[],_=a(24643),c=a(17099),d=a(61282),u=a(85937),p=a.n(u);const m=e=>{const t=e?new(p())(e).mul(new(p())(100)).toFixed(2):"0";return`${t}%`},v=e=>{const t=e?(0,d.dN)(e/100,"None"):"0";return t},h=e=>{const t=e?(0,d.dN)(e,"None",!0):"0";return t};var f=(0,s.defineComponent)({name:"dataCenterList",props:{loading:{type:Boolean,default:!1},list:{type:Array,default:()=>[]},restDates:{type:Array},currentDateType:{type:Number,default:0}},setup(e,t){const a=(0,s.computed)((()=>{const t=JSON.parse(JSON.stringify(e.list));return t})),r=[{label:"有效直播场次",minWidth:150,formatter:e=>"环比"===e.weeK_str?e.valid_live_room_count||0===e.valid_live_room_count?m(e.valid_live_room_count):(0,c.l)():e.valid_live_room_count||0===e.valid_live_room_count?h(e.valid_live_room_count):(0,c.l)()},{label:"总直播时长 (h)",minWidth:150,formatter:e=>{if("环比"===e.weeK_str)return e.live_duration||0===e.live_duration?m(e.live_duration):(0,c.l)();if(e.live_duration||0===e.live_duration){const t=e.live_duration/60;return(0,d.nA)(String(t))}return(0,c.l)()}},{label:"直播间曝光人数",minWidth:150,formatter:e=>"环比"===e.weeK_str?e.room_watch_person||0===e.room_watch_person?m(e.room_watch_person):(0,c.l)():e.room_watch_person||0===e.room_watch_person?h(e.room_watch_person):(0,c.l)()},{label:"直播间曝光次数",minWidth:130,formatter:e=>"环比"===e.weeK_str?e.room_watch_times||0===e.room_watch_times?m(e.room_watch_times):(0,c.l)():e.room_watch_times||0===e.room_watch_times?h(e.room_watch_times):(0,c.l)()},{label:"曝光点击率",minWidth:130,formatter:e=>e.watch_cnt_show_ratio||0===e.watch_cnt_show_ratio?m(e.watch_cnt_show_ratio):(0,c.l)()},{label:"直播间浏览量 (人次)",minWidth:160,formatter:e=>"环比"===e.weeK_str?e.room_user_views||0===e.room_user_views?m(e.room_user_views):(0,c.l)():e.room_user_views||0===e.room_user_views?h(e.room_user_views):(0,c.l)()},{label:"累计观看人数",minWidth:130,formatter:e=>"环比"===e.weeK_str?e.cumulative_watch_person||0===e.cumulative_watch_person?m(e.cumulative_watch_person):(0,c.l)():e.cumulative_watch_person||0===e.cumulative_watch_person?h(e.cumulative_watch_person):(0,c.l)()},{label:"商品曝光人数",minWidth:130,formatter:e=>"环比"===e.weeK_str?e.product_watch_person||0===e.product_watch_person?m(e.product_watch_person):(0,c.l)():e.product_watch_person||0===e.product_watch_person?h(e.product_watch_person):(0,c.l)()},{label:"商品点击人数",minWidth:130,formatter:e=>"环比"===e.weeK_str?e.product_click_person||0===e.product_click_person?m(e.product_click_person):(0,c.l)():e.product_click_person||0===e.product_click_person?h(e.product_click_person):(0,c.l)()},{label:"商品点击率 (人数)",minWidth:150,formatter:e=>e.product_click_person_rate||0===e.product_click_person_rate?m(e.product_click_person_rate):(0,c.l)()},{label:"直播间成交人数",minWidth:150,formatter:e=>"环比"===e.weeK_str?e.pay_ucnt||0===e.pay_ucnt?m(e.pay_ucnt):(0,c.l)():e.pay_ucnt||0===e.pay_ucnt?h(e.pay_ucnt):(0,c.l)()},{label:"点击成交转化率（人数）",minWidth:160,formatter:e=>e.click_to_trade_person_rate||0===e.click_to_trade_person_rate?m(e.click_to_trade_person_rate):(0,c.l)()},{label:"看播成交转化率（人数）",minWidth:160,formatter:e=>e.watch_convert_to_trade_rate||0===e.watch_convert_to_trade_rate?m(e.watch_convert_to_trade_rate):(0,c.l)()},{label:"客单价",minWidth:120,formatter:e=>"环比"===e.weeK_str?e.per_customer_price||0===e.per_customer_price?m(e.per_customer_price):(0,c.l)():e.per_customer_price||0===e.per_customer_price?v(e.per_customer_price):(0,c.l)()},{label:"直播间成交金额 (元)",minWidth:150,formatter:e=>"环比"===e.weeK_str?e.gmv||0===e.gmv?m(e.gmv):(0,c.l)():e.gmv||0===e.gmv?v(e.gmv):(0,c.l)()},{label:"预估佣金 (元)",minWidth:150,formatter:e=>"环比"===e.weeK_str?e.estimated_institution_commission||0===e.estimated_institution_commission?m(e.estimated_institution_commission):(0,c.l)():e.estimated_institution_commission||0===e.estimated_institution_commission?v(e.estimated_institution_commission):(0,c.l)()},{label:"结算率",minWidth:150,formatter:e=>e.settled_rate||0===e.settled_rate?m(e.settled_rate):(0,c.l)()},{label:"新增粉丝数",minWidth:120,formatter:e=>"环比"===e.weeK_str?e.incr_new_fans_num||0===e.incr_new_fans_num?m(e.incr_new_fans_num):(0,c.l)():e.incr_new_fans_num||0===e.incr_new_fans_num?h(e.incr_new_fans_num):(0,c.l)()},{label:"转粉率",minWidth:120,formatter:e=>e.new_fans_rate||0===e.new_fans_rate?m(e.new_fans_rate):(0,c.l)()},{label:"新加团人数",minWidth:120,formatter:e=>"环比"===e.weeK_str?e.incr_new_add_group_person||0===e.incr_new_add_group_person?m(e.incr_new_add_group_person):(0,c.l)():e.incr_new_add_group_person||0===e.incr_new_add_group_person?h(e.incr_new_add_group_person):(0,c.l)()},{label:"加团率",minWidth:120,formatter:e=>e.add_group_rate||0===e.add_group_rate?m(e.add_group_rate):(0,c.l)()}],i=(0,s.computed)((()=>e.restDates??[])),o=e=>{if(0===i.value.length)return!1;const t=i.value.find((t=>{const a=t.split("-"),r=`${Number(a[a.length-1])}`;if(r===`${e}`)return t}));return!!t};return{is_rest:o,dateList:a,columns:r,numberFormat:_.Y4}}}),w=f,g=a(1001),y=(0,g.Z)(w,n,l,!1,null,"b84a86f0",null),b=y.exports,k=a(99575),x=a(83626),j=a(87939),C=a(6933),D=a.n(C),S=a(3293),K=a(26895);const W=e=>{const t=(0,s.ref)(!0),a=(0,s.ref)([]),r=(0,s.ref)(void 0),i=(0,s.ref)([]),o=(0,s.ref)({}),n=(0,s.ref)({dates:[],lists:[]}),l=(0,s.ref)([]),_=(0,s.ref)({dates:[],lists:[]}),c=(0,s.ref)({dates:[],lists:[]}),d=(0,s.ref)({dates:[],lists:[]}),u="yyyy-MM-DD",p=(0,s.ref)(""),m=async(r,i)=>{t.value=!0;let s=D()(r.the_date);if(2===r.dateType){let e=r.the_date.split("-");(!e||e.length<2)&&(e=[D()().year(),D()().quarter()]);const t=1===Number(e[1])?"01":2===Number(e[1])?"04":3===Number(e[1])?"07":4===Number(e[1])?"10":"01";s=D()(e[0]+"-"+t+"-01")}const o=2===r.dateType?"quarter":"M",n=String(s.startOf(o).format(u)),l=String(s.endOf(o).format(u)),_={begin_time:n,end_time:l,project_id:r.project_id,group:2===r.dateType?"quarter":"month",department_id:i||void 0},c=await(0,x.Lt)(_);if(c.data.success){if(c.data.data.update_time){const e=D()(1e3*c.data.data.update_time);p.value=e.format("yyyy.MM.DD")}else p.value=void 0;const e=c.data.data.date_list?c.data.data.date_list.map((e=>{if(2!==r.dateType){const t=e.weeK_str||"",a=t.split("月")||[],r=a.length>1?a[1].split("周"):a.length>0?a[0].split("周"):[];e.weeK_str=a.length>0?r[0]+"周":"周",e.day_str=a.length>1?r[1]:""}return e})):[];if(c.data.data.last){const t=2===r.dateType?"上季度数据":"上月数据";e.push({...c.data.data.last,weeK_str:t})}if(c.data.data.current){const t=2===r.dateType?"本季度合计":"本月合计";e.push({...c.data.data.current,weeK_str:t})}c.data.data.link_ratio&&e.push({...c.data.data.link_ratio,weeK_str:"环比"}),a.value=e||c.data.data.date_list}else e.root.$message.error(c.data.message);t.value=!1};r.value=0;const v=[{id:0,title:"所有项目",project_name:"所有项目"}];i.value=v;const h=async(t,a,s)=>{const o=2===a?"quarter":"M";let n=D()(t);if(2===a){let e=t.split("-");(!e||e.length<2)&&(e=[D()().year(),D()().quarter()]);const a=1===Number(e[1])?"01":2===Number(e[1])?"04":3===Number(e[1])?"07":4===Number(e[1])?"10":"01";n=D()(e[0]+"-"+a+"-01")}const l=n.clone().startOf(o).format(u),_=n.clone().endOf(o).format(u),c={begin_time:l,end_time:_,department_id:s||void 0},{data:d}=await(0,k.Ze)(c);if(d.success){const e=[{id:0,title:"所有项目",project_name:"所有项目"}];e.push(...d.data.data),i.value=e;let o=!1;i.value.forEach((e=>{e.title=e.project_name,r.value===e.id&&(o=!0)})),!1===o&&(r.value=0),m({business_type:j._.Mcn,project_id:r.value||void 0,the_date:t,dateType:a},s)}else e.root.$message.error(d.message)};return{update_time:p,select_project_id:r,getData:m,tableLoading:t,tableData:a,operatingData:_,sessionData:c,liverNumData:d,summaryData:o,gmvData:n,project_list:i,gmvRateData:l,getMcnProjectList:h}};var N=(0,s.defineComponent)({components:{DataCenterList:b,SelectDate:o.Z},props:{project_id:{type:String,default:""},is_one_peoject:{type:Boolean,default:!1}},setup(e,t){const a=W(t),r=(0,s.ref)(void 0),i=(0,s.ref)(),o=(0,s.ref)("");e.is_one_peoject&&(a.select_project_id.value=e.project_id);const n=(0,s.ref)(0);let l="";const _=(0,s.ref)(0),c=e=>{n.value=e},d=(0,s.ref)([]),u=async(e=!1)=>{const t=await(0,S.o1)({root_department_name:"s2b2c"}),a=t.data.data.data;(0,K.$S)(a,!1,3),d.value=a,e&&a.length>0&&(o.value=a[0].name,r.value?.setCheckedKeys([a[0].id]))},p=(t,r)=>{_.value=t,l=r,e.is_one_peoject?a.getData({business_type:j._.Mcn,project_id:a.select_project_id.value||void 0,the_date:l,dateType:_.value},d.value.length>0&&d.value[0].id===i.value?"":i.value):a.getMcnProjectList(String(l),t,d.value.length>0&&d.value[0].id===i.value?"":i.value)};(0,s.watch)((()=>a.select_project_id.value),(()=>{a.getData({business_type:j._.Mcn,project_id:a.select_project_id.value||void 0,the_date:l,dateType:_.value},d.value.length>0&&d.value[0].id===i.value?"":i.value)})),e.is_one_peoject||u(!0);const m={label:"name",children:"sons"},v=e=>{r.value?.setCheckedKeys([]),e.id===i.value?(i.value=void 0,o.value=void 0):(i.value=e.id,o.value=e.name,r.value?.setCheckedKeys([e.id])),a.getMcnProjectList(String(l),_.value,d.value[0].id===i.value?"":i.value)},h=(0,s.computed)((()=>i.value?[i.value]:[]));return(0,s.watch)((()=>o.value),(()=>{o.value||(i.value="",o.value="",a.getMcnProjectList(String(l),_.value,i.value))})),{cb_department_tree:r,handleCheckChange:v,feishu_department_id:i,feishu_department_name:o,treeProps:m,default_checked_department_ids:h,getFeishuDepartmentList:u,feishuDepartmentList:d,activeIndex:n,handleCheckTab:c,selectDate:p,selectedDateType:_,...a}}}),L=N,M=(0,g.Z)(L,r,i,!1,null,"70d0adec",null),T=M.exports}}]);