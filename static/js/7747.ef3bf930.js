"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[7747],{59563:function(e,t,a){a.d(t,{Q:function(){return l},h:function(){return r}});a(21703);var s=a(97434),o=a(48606);const l=(e,{manual:t,onError:a,onSuccess:l,defaultParams:r,transform:n}={})=>{const i=(0,s.ref)(),c=(0,s.ref)(),u=(0,s.ref)(!1),d=(0,s.ref)([]),p=()=>{m(...d.value)},m=(...t)=>Promise.resolve(t||r).then((()=>{u.value=!0})).then((()=>0===t.length&&r&&r.length>0?r:t)).then((e=>(d.value=e,e))).then((t=>e(...t))).then((e=>{if(!e.data.success)throw new Error(e.data.message);return i.value=n?n(e.data.data):e.data.data,l&&l(i.value,e.data),e})).then((()=>{u.value=!1})).catch((e=>{throw u.value=!1,c.value=e.message,a&&a(e),o.Message.error(e.message),e})),v=m;return t||m(...r||[]),(0,s.reactive)({data:i,error:c,loading:u,reload:p,run:m,runAsync:v,params:d})},r=(e,t={})=>{const{defaultPageSize:a=20,defaultParams:o=[],transform:r,...n}=t,i=(0,s.ref)(),c=(0,s.reactive)({total:0,page_num:1,page_size:a,onCurrentChange:e=>{const t=[...p.params];t[0]?t[0].page_num=e:t[0]={num:a,page_num:e},p.runAsync(...t).then((()=>{c.page_num=e}))},refresh:()=>c.onCurrentChange(1),reQuery(...e){const t=[];return p.params[0]?(t[0]=p.params[0],t[0].page_num=1,c.page_num=1):(t[0]={num:a,page_num:1},c.page_num=1),t.push(...e),p.runAsync(...t)}}),[u={num:a,page_num:1},...d]=o,p=l(e,{defaultParams:[u,...d],...n,onSuccess(e,a){i.value=r?r(e):e.data,c.total=e.total,t.onSuccess&&t.onSuccess(i.value,a)}}),{data:m,...v}=(0,s.toRefs)(p);return(0,s.reactive)({...v,data:i,pagination:c})}},70437:function(e,t,a){var s=a(36568),o=a.n(s);const l={functional:!0,render:(e,t)=>{const{props:a}=t,{showAll:s=!1,showAllText:l="全部",clearable:r=!0}=a,n={props:{...t.value,clearable:r},on:t.listeners,attrs:t.data.attrs};return e("el-select",o()([{},n]),[s&&e("el-option",{attrs:{label:l,value:void 0}}),a.options?.map(((t,a)=>e("el-option",{attrs:{disabled:t.disabled,label:t.label,value:t.value},key:a})))])}};t["Z"]=l},21495:function(e,t,a){a.d(t,{L:function(){return l}});var s=a(97434),o={template:"template-fe9519",searchBar:"searchBar-c522bd",formItemContainer:"formItemContainer-d53e08",formItem:"formItem-c6ff4c",bodyContainer:"bodyContainer-b06936",btnLine:"btnLine-d428fc",tableContainer:"tableContainer-dd87f4"},l=(0,s.defineComponent)({props:{columns:{type:Array,default:()=>[]},value:{type:Object},routes:{},service:{required:!0,type:Function},config:{type:Object,default:()=>{}}},setup(e,t){const a=(0,s.ref)(),{reset:o}=e.config||{},l=e.service,r=()=>{const t=l.params;return t[0]&&(t[0].page_num=1),l.runAsync(t[0],e.value)},n=()=>{o&&o(),(0,s.nextTick)(r)};return{formRef:a,onReset:n,reqData:l,search:r}},render(){const e=arguments[0];return e("div",{class:["tg-page-container",o.template]},[this.routes&&e("tg-breadcrumbs",{attrs:{routes:this.routes}}),this.$slots.default&&e("div",{class:["tg-card",o.searchBar]},[e("el-form",{attrs:{size:"small","show-message":!1,"hide-required-asterisk":!0,"label-width":"70px"},ref:"formRef"},[e("div",{class:o.formItemContainer},[this.$slots.default?.map((t=>e("div",{class:o.formItem},[t]))),this.$slots.searchBtn?this.$slots.searchBtn:e("div",[e("tg-button",{attrs:{type:"primary"},on:{click:this.search}},["查询"]),e("tg-button",{class:"mgl-12",on:{click:this.onReset}},["重置"])])])])]),this.$slots.middle,e("div",{class:o.bodyContainer},[this.$slots.btnLine&&e("div",{class:o.btnLine},[this.$slots.btnLine]),e("div",{class:o.tableContainer},[e("tg-table",{attrs:{stripe:!0,columns:this.columns,height:"100%",data:this.reqData.data,pagination:this.reqData.pagination},directives:[{name:"loading",value:this.reqData.loading}],on:{"selection-change":this.config?.table?.selectionChange}},[e("div",{class:"tg-page-empty",slot:"empty"},[e("empty-common")])])])])])}})},17747:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var s,o,l=a(97434),r=a(21495),n=a(59563),i=a(70437),c=a(15681),u=a(1763),d=a(23624),p=a(82741),m=a(44928),v=a(99205),f=a(36568),g=a.n(f),b=(0,l.defineComponent)({setup(e,t){const a=e=>{e?(r.value.cycle_type=e.cycle_type,r.value.id=e.id,o.value=[{label:e.name,value:e.id,obj:e}]):i("")},s=(0,l.ref)(),o=(0,l.ref)([]),r=(0,l.ref)({id:void 0,cycle_type:c.Sr.MONTHLY}),n=async()=>{s.value?.validate((e=>{if(e){const e=o.value.find((e=>e.value===r.value.id));e&&(t.emit("submit",{group:e.obj,template:r.value.template,process:r.value.process}),t.emit("close"))}}))},i=e=>{(0,d.UX)({num:20,page_num:1},{name:e,cycle_type:r.value.cycle_type}).then((e=>{e.data.success?o.value=e.data.data.data.map((e=>({label:e.name,value:e.id,obj:e}))):o.value=[]}))};return{onSaveBtnClick:n,show:a,formData:r,formRef:s,options:o,Query:i}},render(){const e=arguments[0],{formData:t}=this;return e("div",{class:"dialog-container"},[e("el-form",g()([{attrs:{size:"small","hide-required-asterisk":!0},ref:"formRef"},{attrs:{model:t}}]),[e("el-form-item",{attrs:{label:"考核周期：","label-width":"70px",prop:"cycle_type",rules:{required:!0,message:"请选择考核周期",trigger:"change"}}},[e(i.Z,{attrs:{options:c.OF},on:{change:()=>{t.id=void 0,this.Query("")}},model:{value:t.cycle_type,callback:e=>{this.$set(t,"cycle_type",e)}}})]),e("el-form-item",{attrs:{label:"考核组：","label-width":"70px",prop:"id",rules:{required:!0,message:"请选择考核组",trigger:"change"}}},[e(i.Z,{style:"width:100%",attrs:{filterable:!0,remote:!0,"remote-method":this.Query,options:this.options},model:{value:t.id,callback:e=>{this.$set(t,"id",e)}}})]),e("el-form-item",{attrs:{label:"复制内容：","label-width":"70px",prop:"id",rules:{validator:(e,a,s)=>{t.template||t.process?s():s("复制内容必须选一个")}}}},[e("div",{class:"checkbox-group"},[e("el-checkbox",{model:{value:t.template,callback:e=>{this.$set(t,"template",e)}}},["模板指标"]),e("el-checkbox",{model:{value:t.process,callback:e=>{this.$set(t,"process",e)}}},["考评流程"])])])])])}}),y=b,k=a(1001),_=(0,k.Z)(y,s,o,!1,null,"23789231",null),w=_.exports,C=a(43773),$=a(21757),S=(0,l.defineComponent)({setup:()=>{const e=(0,m.t)(),t=(0,$.gI)(),a=[{label:"考评组名称",prop:"name"},{label:"参与人数",formatter:e=>`${e.by_evaluation_person.length}人`},{label:"周期类型",formatter:e=>c.fB.get(e.cycle_type)},{label:"发起考核次数",prop:"assessment_count"},{label:"操作",minWidth:60,formatter:a=>h("div",[t.evaluation_group_edit&&h("tg-button",{attrs:{type:"link"},on:{click:()=>{(0,v.lL)(a),e.push({name:u.Gr.assessment.create.base})}}},["编辑"]),t.evaluation_group_edit&&h("tg-button",{attrs:{type:"link"},class:"mgl-12",on:{click:()=>{f.show(a)}}},["复制"]),t.evaluation_group_delete&&h("tg-button",{attrs:{type:"link"},class:"mgl-12",on:{click:async()=>{await(0,p.u)("确认删除考评组吗?"),o.runAsync(a.id).then(s.reload)}}},["删除"])])}],s=(0,n.h)(d.UX),o=(0,n.Q)(d.lI,{manual:!0}),r=(0,l.ref)({}),i={reset:()=>{r.value={}}},f=(0,C.R)({component:w,title:"复制考评组",width:"380px",on:{submit({group:t,template:a,process:s}){let o;s?(o={...(0,v.cb)(),...t},a||(o.assessment_dimension_list=[])):a&&(o=(0,v.cb)(),o.assessment_dimension_list=t.assessment_dimension_list,o.cycle_type=t.cycle_type),o.id=void 0,o.name=void 0,o.by_evaluation_person=[],(0,v.lL)(o),e.push({name:u.Gr.assessment.create.base})}}});return{columns:a,reqList:s,formData:r,config:i,dialogCopyEvalGroup:f,permission:t}},render(){const e=arguments[0],{formData:t,permission:a}=this;return e(r.L,{attrs:{columns:this.columns,service:this.reqList,config:this.config},model:{value:this.formData,callback:e=>{this.formData=e}}},[e("el-form-item",{attrs:{label:"考评组："}},[e("el-input",{attrs:{placeholder:"请填写"},model:{value:t.name,callback:e=>{this.$set(t,"name",e)}}})]),e("el-form-item",{attrs:{label:"周期类型："}},[e(i.Z,{attrs:{options:c.OF},model:{value:t.cycle_type,callback:e=>{this.$set(t,"cycle_type",e)}}})]),e("div",{slot:"btnLine",class:"btns-line"},[a.evaluation_group_edit&&e("tg-button",{attrs:{type:"primary",size:"small"},on:{click:()=>{(0,v.Ti)(),this.$router.push({name:u.Gr.assessment.create.base})}}},["新增考评组"]),a.evaluation_group_edit&&e("tg-button",{style:"margin-left: 12px;",attrs:{size:"small"},on:{click:()=>this.dialogCopyEvalGroup.show()}},["复制考评组"])])])}})},43773:function(e,t,a){a.d(t,{R:function(){return p},y:function(){return m}});var s=a(36568),o=a.n(s),l=a(97434),r=a(64923),n=a(77944);let i=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+i++,document.body.appendChild(e),e},u=new Function,d=(e,t)=>{let a=e;return void 0===a&&(a={}),Object.keys(t).forEach((e=>{const s=a[e]||u,o=t[e];a[e]=(...e)=>{if(!1!==o(...e))return s(...e)}})),a},p=(e={})=>{const t=(0,l.ref)(),a=(0,l.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,l.ref)(!0),i=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};i(e);const u=(0,l.ref)(d(e.on,{close(){a.visible=!1},updateDialog(e={}){i(e)}})),p=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new r["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,l.provide)(t,e.provide[t])}))},render(t){if(s.value&&a.visible)return t("el-dialog",o()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value}),a.footer&&t("fragments",{slot:"footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const m=(...e)=>{a.visible||(a.visible=!0,(0,l.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},v=e=>(i(e),h),f=()=>{a.visible=!1},g=(e,t,a=!1)=>(!0===a?u.value[e]=t:d(u.value,{[e]:t}),h);(0,l.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const h=(0,l.reactive)({show:m,update:v,on:g,close:f,config:e,data:e.data});return h},m=(e={})=>{const t=(0,l.ref)(),a=(0,l.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,l.ref)(!0),i=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};i(e);const u=(0,l.ref)(d(e.on,{close(){a.visible=!1},updateDialog(e={}){i(e)}})),p=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new r["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,l.provide)(t,e.provide[t])}))},render(t){if(!s.value)return;if(!a.visible)return;const{width:l,...r}=a;return t("el-drawer",o()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...r,size:l}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[t("div",{class:"tg-drawer-content"},[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value})]),a.footer&&t("div",{class:"tg-drawer-footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const m=(...e)=>{a.visible||(a.visible=!0,(0,l.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},v=e=>(i(e),h),f=()=>{a.visible=!1},g=(e,t,a=!1)=>(!0===a?u.value[e]=t:d(u.value,{[e]:t}),h);(0,l.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const h=(0,l.reactive)({show:m,update:v,on:g,close:f,config:e});return h}}}]);