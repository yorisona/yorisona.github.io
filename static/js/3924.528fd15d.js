"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[3924],{3283:function(t,e,a){a.d(e,{Z:function(){return d}});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"oa-flows"},[a("div",{staticClass:"oa-flows-hd"},[t._v("审批进度")]),a("div",{staticClass:"oa-flows-bd"},[a("el-steps",{attrs:{direction:"vertical",active:t.length}},[""!==t.receivedPersons&&t.isProcessing?a("el-step",{scopedSlots:t._u([{key:"icon",fn:function(){return[a("tg-icon",{staticStyle:{"font-size":"14px"},attrs:{name:"ico-waiting"}})]},proxy:!0},{key:"description",fn:function(){return[a("div",{staticClass:"oa-flow-content",staticStyle:{color:"#a4b2c2"}},[t._v(t._s(t.receivedPersons))]),a("div",{staticClass:"oa-flow-content",staticStyle:{color:"#a4b2c2"}},[t._v("待处理")])]},proxy:!0}],null,!1,2618238872)}):t._e(),t._l(t.flows,(function(e,o){return a("el-step",{key:o,scopedSlots:t._u([{key:"icon",fn:function(){return[e.isFailureNode?a("tg-icon",{staticStyle:{"font-size":"16px"},attrs:{name:"ico-cross-red"}}):a("tg-icon",{staticStyle:{"font-size":"16px"},attrs:{name:"ico-tick"}})]},proxy:!0},{key:"description",fn:function(){return[a("div",{staticClass:"oa-flow-content"},[t._v(t._s(e.nodeName))]),a("div",{staticClass:"oa-flow-content"},[a("span",[t._v("审批人："+t._s(e.operatorName))]),e.isFailureNode&&t.get_node_result(e)?a("span",{staticClass:"fg-failure"},[t._v("("+t._s(t.get_node_result(e))+")")]):t._e()]),a("div",{staticClass:"oa-flow-footer"},[t._v(t._s(e.operateDate)+" "+t._s(e.operateTime))])]},proxy:!0}],null,!0)})}))],2)],1)])},s=[],n=a(97434),i=a(17890),r=(0,n.defineComponent)({props:{removeOaNodeNameIndex:{type:Boolean,default:!1},status:{type:Number}},setup(t){const e=(0,n.inject)("flows")??(0,n.ref)([]),a=e.value[e.value.length-1]?.receivedPersons,o=(0,n.computed)((()=>t.status===i.Kb.Failure)),s=(0,n.computed)((()=>t.status===i.Kb.Processing)),r=e.value.length+(""===a||o.value?0:1),l=t=>t.oa_review_result??t.remark;return{flows:(0,n.computed)((()=>e.value.map((e=>t.removeOaNodeNameIndex?{...e,nodeName:e.nodeName.replace(/^\d+\./u,"")}:e)).map(((t,a)=>{const s=a<e.value.length-1,n=!s&&o.value;return{...t,isFinishNode:s,isFailureNode:n}})).reverse())),receivedPersons:a,length:r,get_node_result:l,isProcessing:s}}}),l=r,c=a(1001),u=(0,c.Z)(l,o,s,!1,null,null,null),d=u.exports},3924:function(t,e,a){a.r(e),a.d(e,{default:function(){return N}});a(26699);var o=a(97434),s=a(44928),n=(a(21703),a(83005)),i=a(84731),r=a(17890),l=a(97484),c=a(82741),u=a(1763),d=a(25711),p=a(64236),m=a(48606),v=a(11676),_=a(86863),f=a(43847);const g=t=>{const e=(0,o.ref)(),a=(0,s.t)(),g=(0,i.f)(),h=(0,f.Pc)();let b=1;const y=(0,o.computed)((()=>(e.value?.contract_info.contract_status===r.Kb.Processing||e.value?.contract_info.contract_status===r.Kb.Failure)&&(null!==e.value?.contract_info.feishu_request_id||null!==e.value?.contract_info.oa_request_id))),{getCache:w,setCache:C}=(0,d.Y)(),k=async t=>{x.flowsLoading=!0;const[{data:e},a]=await Promise.all([await(0,n.eu)(t),await(0,p._v)(200)]);return x.flowsLoading=!1,e.success?(C(t,e.data),x.flowsError="",e.data):(x.flowsError=e.message,!1)},x=(0,o.reactive)({flowsLoading:!0,isFlowFromOA:y,flows:[],status:1,flowsError:"",onFlowsShow:async()=>{const t=e.value?.contract_info.id;if(void 0===t)return;const a=w(t)??await k(t);!1!==a&&(x.flows=a,x.status=e.value?.contract_info.contract_status)}});(0,o.provide)("flows",(0,o.toRef)(x,"flows"));const S=async a=>{b=a;let o=7;g.isLegalSupplierContractDetail||g.isLegalCustomerContractDetail?o=2:g.isLiveCustomerContractDetail||g.isLiveSupplierContractDetail?o=3:g.isCoopSupplierContractDetail||g.isCoopCustomerContractDetail?o=4:g.isCommonBusinessCustomerContractDetail||g.isCommonBusinessSupplierContractDetail||g.isisCommonBusinessCustomerContractDetailTemplate?o=5:g.isLegalStatisticsSupplierContractDetail||g.isLegalStatisticsCustomerContractDetail?o=6:g.isSupplierDetail&&(o=7);const s=await(0,n.Ue)(a,o);s.success&&s.data?e.value=D(s.data):t.root.$message.warning(s.message??"合同详情获取失败，稍后重试")},D=t=>{if(!t.template_info)return t;const e=t.template_info;t?.contract_detail?.contract_scan_urls&&(t.contract_detail.contract_scan_urls=t?.contract_detail?.contract_scan_urls.map((t=>(t.file_name=decodeURIComponent(t.file_name),t)))),t?.contract_detail?.attachment_url_list&&(t.contract_detail.attachment_url_list=t?.contract_detail?.attachment_url_list.map((t=>(t.file_name=decodeURIComponent(t.file_name),t))));const a={key:"创建人",value:t.contract_info.add_by_name},o={key:"供应商名称",value:t?.contract_info?.company_name};t.template_info.extend_contract_info=[o,a];const s=["others","margin","cooperation_content","cooperation_duration"];if(s.forEach((t=>{const a={};e[t]&&e[t].forEach((t=>{a[t.key]=t.value})),e[`${t}Map`]=a})),e.hasMargin=1===e.marginMap["是否有保证金"],e.cooperation_content){const t=[];let a;e.cooperation_content=t;const o=[{value:1,label:"小时服务费"},{value:9,label:"保底服务费"},{value:4,label:"小时服务费或提点"},{value:2,label:"保底服务费或提点"},{value:5,label:"小时服务费或阶梯式提点"},{value:6,label:"保底服务费或阶梯式提点"},{value:7,label:"保底服务费A或保底服务费B+提点"},{value:8,label:"小时服务费或保底服务费+提点"}],s=e.cooperation_contentMap["计算方式"];let n="";if(o.map((t=>{String(t.value)===String(s)&&(n=t.label)})),a={key:"计算方式",value:n},t.push(a),1!==s&&4!==s&&5!==s&&8!==s||(a={key:"小时服务费",value:e.cooperation_contentMap["小时服务费"]},t.push(a)),9!==s&&2!==s&&6!==s&&8!==s||(a={key:"保底服务费",value:e.cooperation_contentMap["保底服务费"]},t.push(a)),7===s&&(a={key:"保底服务费A",value:e.cooperation_contentMap["保底服务费A"]},t.push(a),a={key:"保底服务费B",value:e.cooperation_contentMap["保底服务费B"]},t.push(a)),4!==s&&2!==s&&7!==s&&8!==s||(a={key:"提成比例",value:e.cooperation_contentMap["提成比例"]+"%"},t.push(a)),5===s||6===s){const o=e.cooperation_contentMap["阶梯提点"];o.map(((e,s)=>{a={key:"阶梯"+(s+1)+"：月净销额（万）",value:0===s?"0 - "+o[0].settlement_month_sales_point:o[s-1].settlement_month_sales_point+(e.settlement_month_sales_point?" - "+e.settlement_month_sales_point:"万以上")},t.push(a),a={key:"提成比例"+(s+1),value:e.settlement_month_sales_rate+"%"},t.push(a)}))}a={key:"票款类型",value:e.cooperation_contentMap["票款类型"]},t.push(a),a={key:"发票类型",value:e.cooperation_contentMap["发票类型"]},t.push(a),a={key:"税率",value:e.cooperation_contentMap["税率"]},t.push(a)}return t},j=async()=>{S(b)},T=(0,o.computed)((()=>{const t=r.yR.get(e.value?.contract_info.contract_status??2)??"";let a="status-approval";switch(e.value?.contract_info.contract_status){case r.Kb.Failure:a="status-error";break;case r.Kb.Normal:a="status-success";break;case r.Kb.Invalid:a="status-fail";break;default:break}return{text:t,style:a}})),F=async t=>{try{if(!(0,v.K)({excel:!0,pdf:!0,doc:!0,fileSize:50})(t.file))return;const e=new FormData;e.append("file",t.file),e.append("type","contract/scan");const{data:a}=await(0,l.cT)(e);if(!a.success)throw new Error(a.message||"上传失败");return a}catch(e){throw m.Message.error(e.message),e}},R=async t=>{const a={contract_id:e.value?.contract_info.id,contract_scan_urls:[t],save_for_update:1};try{const{data:t}=await(0,n.ab)(a);if(!t.success)throw new Error(t.message);await j()}catch(o){m.Message.error(o.message)}},B=async a=>{const o=await(0,c.I)(t,"扫描件删除后无法恢复，是否继续操作？");if(!o)return;if(void 0===e.value)return;const{data:s}=await(0,n.dJ)({contract_id:e.value.contract_info.id,contract_scan_urls:[a]});s.success?await j():t.root.$message.error(s.message??"删除失败")},$=async()=>{if(!e.value)return;const a=e.value?.contract_info.id,o=await(0,c.I)(t,{title:"此操作将作废合同, 是否继续",confirmText:"作废合同"});if(!o)return;const{data:s}=await(0,_.it)({contract_id:a,invalid_code:5});s.success?(t.root.$message.success(s.message),await j()):t.root.$message.error(s.message)},M=(0,o.computed)((()=>e.value?.contract_info.contract_status===r.Kb.Normal&&(h.value?.id===e.value?.contract_info.manager_id||h.value?.id===e.value?.contract_info.add_by))),P=(0,o.computed)((()=>{const t=[r.Kb.Invalid,r.Kb.Failure].includes(e.value?.contract_info.contract_status??-1)&&(h.value?.id===e.value?.contract_info.manager_id||h.value?.id===e.value?.contract_detail.add_by);if(t)return g.isLiveCustomerContractDetail||g.isCommonBusinessCustomerContractDetail,!0})),N=async()=>{if(!e.value)return;const o=await(0,c.I)(t,{title:"此操作将删除合同， 确认删除？",confirmText:"删除合同"});if(!o)return;const{data:s}=await(0,_.qJ)({contract_id:[e.value.contract_info.id]});s.success?(m.Message.success("删除成功"),setTimeout((()=>{g.isSupplierDetail?t.root.$router.replace({name:u.bv.player_detail,params:{id:a.currentRoute.query.anchorId,tab:a.currentRoute.query.parent_tab}}):a.back()}),500)):t.root.$message.error(s.message??"合同删除失败")};return(0,o.reactive)({onDelete:N,hasDelete:P,hasVoidRight:M,toVoid:$,queryContractDetail:S,remove:B,uploadScans:R,uploadScanFiles:F,detail:e,contract_status:T,reload:j,flow:x,isFlowFromOA:y})},h=()=>{const t=(0,s.t)();let e=[{title:"法务管理",name:u.l6.contact},{title:"合同管理",name:u.l6.contact},{title:"合同详情"}];const a=(0,i.f)();return a.isLiveCustomerContractDetail||a.isLiveSupplierContractDetail?e=[{title:"品牌中心",name:u.FB.project.list},{title:"项目管理",name:u.FB.project.list},{title:"项目详情",name:u.FB.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab,liveType:"calendar"}},{title:"合同详情"}]:a.isCommonBusinessCustomerContractDetail||a.isCommonBusinessSupplierContractDetail?e=[{title:"S2B2C",name:u.u3.project.list},{title:"项目管理",name:u.u3.project.list},{title:"项目详情",name:u.u3.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]:a.isCoopCustomerContractDetail||a.isCoopSupplierContractDetail?e=[{title:"整合营销",name:u.Z8.project.list},{title:"项目管理",name:u.Z8.project.list},{title:"项目详情",name:u.Z8.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]:a.isLegalCustomerContractDetail||a.isLegalSupplierContractDetail?e=[{title:"法务管理",name:u.l6.contact},{title:"合同管理",name:u.l6.contact},{title:"合同详情"}]:a.isLegalStatisticsCustomerContractDetail||a.isLegalStatisticsSupplierContractDetail?e=[{title:"法务管理",name:u.l6.contact},{title:"合同统计",name:u.l6.constatistics},{title:"合同详情"}]:a.isSupplierDetail&&(e=[{title:"主播管理",name:u.bv.player},{title:"主播详情",name:u.bv.player_detail,params:{id:t.currentRoute.query.anchorId,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]),(0,o.reactive)({routes:e})};var b=a(21042),y=a(3283),w=a(318),C=a(31973),k=a(43773),x=a(72253),S=a(21757);const D=(0,S.gI)(),j={functional:!0,render:(t,e)=>t("div",{class:`contract-grid column-${e.props.column} ${e.data.class}`},[e.children])},T={functional:!0,render:(t,e)=>{let a=e.children;return a&&0!==a.length||(a="--"),t("div",{class:`contract-grid-item contract-grid-columnSpan-${e.props.columnSpan}`},[t("div",{class:"label",style:"min-width:"+(e.props.label.length>9?165:18*e.props.label.length)+"px;"},[e.props.label,"："]),t("div",{class:"item"},[a])])}};var F,R,B=(0,o.defineComponent)({components:{anchorAgreementDialog:b.Z,OaFlows:y.Z,toExamineDialog:x.Z},setup(t,e){const a=(0,o.ref)(!1),c=(0,s.t)(),u=g(e),d=h(),m=(0,f.Pc)();(0,o.provide)("project",{}),(0,o.provide)("project_add_id",{});const v=(0,o.ref)(null);u.queryContractDetail({id:parseInt(c.currentRoute.params.id,10)});const _=t=>{v.value?.show({},t)},b=(0,o.computed)((()=>[r.Kb.Failure].includes(u.detail?.contract_info.contract_status??-1)&&(C.YH.supplier_kol_sign_contract||m.value.id===u.detail?.contract_info.manager_id||m.value.id===u.detail?.contract_detail.add_by))),y=(0,o.computed)((()=>C.YH.supplier_kol_sign_contract||m.value.id===u.detail?.contract_info.manager_id||m.value.id===u.detail?.contract_detail.add_by)),S=D.law_verify_contract_scan,j=(0,o.computed)((()=>(u.detail?.contract_info.add_by===m.value.id||u.detail?.allow_update_contract_scan_user_ids?.includes(m.value.id))&&u.detail?.contract_info.contract_status===r.Kb.Normal)),T=t=>t.length>10?t.substring(0,6)+"*****"+t.substring(14):"******",F=t=>t.length>10?t.substring(0,3)+"****"+t.substring(7):"******",R=t=>t.length>0?t.substring(0,1)+"****":"******",B=(0,o.ref)(!1),$=async()=>{if(N.value){const[{data:t}]=await(0,p.Dc)(500,w.ZP.SaveAnchorProjectContract({contract_id:u.detail?.contract_info.id,project_id:N.value}));t.success?(e.root.$message.success(t.message||"修改关联项目成功！"),B.value=!1,u.reload()):e.root.$message.warning(t.message||"修改关联项目失败！")}else e.root.$message.warning("请先选择要关联的项目！")},M=(0,o.ref)([]),P=t=>{(0,l.Iz)({project_name:t,cooperation_type:1,business_type:"3,7",is_end:0}).then((({data:t})=>{const e=[],a=t.data;e.push(...a),M.value=e}))};u.detail?.contract_info?.project_name&&"无"!==u.detail?.contract_info?.project_name&&"暂无"!==u.detail?.contract_info?.project_name||!y.value||P("");const N=(0,o.ref)(""),L=(0,o.ref)(""),I=(0,i.f)(),Z=async t=>{t.status=3,a.value=!0;const o=await(0,n.f6)(t);a.value=!1,o.data.success?(e.root.$message.success(o.data.message??"驳回成功"),u.queryContractDetail({id:parseInt(c.currentRoute.params.id,10)})):e.root.$message.error(o.data.message??"请求失败，请重试")},K=(0,k.R)({component:x.Z,title:"扫描件审核",okText:"驳回",width:"400px",on:{submit:t=>{Z(t)}}}),O=()=>{K.show(u.detail?.contract_info?.id)};return{approvalLoading:a,onApprovalHandler:O,breadcrumb:I,project_relevancy_id:N,project_relevancy_name:L,project_ids:M,getProjectIds:P,submitProject:$,projectVisible:B,anchorIdent:T,anchorTel:F,anchorWeixin:R,canUpload:j,hasPermission:S,addAnchorTemplateContractRef:v,opendialogClick:_,contract:u,breadRouter:d,oprateBtnVisiable:b,caneditproject:y}},render(){const t=arguments[0],{contract:e,breadRouter:a}=this,{detail:o,flow:s}=e,n=o?.template_info;return t("div",{class:"contract-detail"},[t("tg-breadcrumbs",{attrs:{routes:a.routes}}),t("div",{class:"contract-detail-container"},[t("div",{class:"contract-title-box"},[t("div",{class:"contract-title"},["合同编号：",o?.contract_info?.contract_uid]),e.isFlowFromOA?t("el-popover",{attrs:{placement:"right-start",trigger:"hover","popper-class":"approve-progress-popper"},on:{show:e.flow.onFlowsShow},style:"margin-right:20px"},[t("span",{slot:"reference",class:`status  ${e.contract_status.style}`,style:"cursor:default"},[e.contract_status.text]),s.flowsLoading&&t("div",{style:"padding: 10px 20px"},["正在查询进度..."]),!s.flowsLoading&&s.flows.length>0?t("oa-flows",{attrs:{status:s.status}}):t("div",[s.flowsError])]):t("span",{class:`status  ${e.contract_status.style}`},[e.contract_status.text]),this.oprateBtnVisiable&&t("span",{class:"edit",on:{click:()=>{this.opendialogClick(o)}}},[t("tg-icon",{attrs:{name:"ico-edit"}})]),t("div",{class:"fill"}),t("div",{class:"operator"},[e.hasVoidRight&&t("tg-button",{attrs:{size:"small",className:"disabled",type:"negative",icon:"ico-invalid-lite"},on:{click:e.toVoid}},[t("span",["作废"])]),e.hasDelete&&t("tg-button",{attrs:{type:"negative",icon:"ico-btn-delete"},on:{click:e.onDelete}},["删除"])])]),t(j,{attrs:{column:4}},[" ",n?.cooperation_duration?.map((e=>{if("签约类型"===e.key&&e.value)return t(T,{attrs:{label:e.key}},[e.value])})),t(T,{attrs:{label:"创建人"}},[o?.contract_info.add_by_name])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"主播信息"}}),t(j,{attrs:{column:4}},[n?.anchor_info?.map((e=>"身份证号"===e.key?t(T,{attrs:{label:e.key}},[" ",this.anchorIdent(e.value)||"--"]):"电话"===e.key?t(T,{attrs:{label:e.key}},[" ",this.anchorTel(e.value)||"--"]):"微信号"===e.key?t(T,{attrs:{label:e.key}},[" ",this.anchorWeixin(e.value)||"--"]):t(T,{attrs:{label:e.key}},[e.value])))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"关联机构信息"}}),t(j,{attrs:{column:4}},[n?.company_info?.map((e=>{if("机构ID"!==e.key)return t(T,{attrs:{label:e.key}},[e.value])}))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"项目信息"}}),t(j,{attrs:{column:4}},[t(T,{attrs:{label:"关联项目"}},[o?.contract_info?.project_name||"无"," ",this.breadcrumb.isSupplierDetail&&(!o?.contract_info?.project_name||"无"===o?.contract_info?.project_name||"暂无"===o?.contract_info?.project_name)&&this.caneditproject&&t("tg-button",{attrs:{className:"edit-button",type:"link"},style:"color:#3c5269;margin-left:5px",on:{click:()=>{this.projectVisible=!0}}},[t("tg-icon",{attrs:{name:"ico-edit"}})])]),t(T,{attrs:{label:"运营审批人"}},[o?.contract_info?.approver_name])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"我方信息"}}),t(j,{attrs:{column:4}},[n?.our_info?.map((e=>"经办人Name"===e.key?t(T,{attrs:{label:"经办人"}},[e.value]):"电话"===e.key?t(T,{attrs:{label:e.key}},[e.value]):void 0))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同期限"}}),t(j,{attrs:{column:4}},[n?.cooperation_duration?.map((e=>{if("签约类型"!==e.key&&"试合作期"!==e.key&&"起止时间"!==e.key)return"关联主合同"===e.key?e.value?t(T,{attrs:{label:e.key}},[e.value]):void 0:"合同有效期"===e.key?t(T,{attrs:{label:e.key}},[e.value,"年"]):"合作期限"===e.key?t(T,{attrs:{label:e.key}},[e.value.replace(/-/g,".").replace("/","-")]):t(T,{attrs:{label:e.key}},[e.value])}))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"结算信息"}}),t(j,{attrs:{column:4}},[n?.cooperation_content?.map((e=>"税率"===e.key?t(T,{attrs:{label:"税率"}},[e.value,"%"]):t(T,{attrs:{label:e.key}},[e.value])))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"其它信息"}}),t(j,{attrs:{column:4}},[t(T,{attrs:{label:"盖章份数"}},[n?.othersMap["盖章份数"]]),t(T,{attrs:{label:"印章名称"}},[n?.othersMap["印章名称"]]),t(T,{attrs:{label:"用印时间"}},[n?.othersMap["用印时间"]]),0===n?.othersMap["是否邮寄"]&&t(T,{attrs:{label:"是否邮寄"}},["否"]),n?.othersMap["邮寄信息"]&&t(T,{attrs:{label:"邮寄信息",columnSpan:4}},[n?.othersMap["邮寄信息"]]),t(T,{attrs:{label:"备注",columnSpan:5}},[n?.frontend_data?.other_remark])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同附件"}}),t("div",{class:"grid-annex "},[0===o?.contract_detail?.attachment_url_list.length&&t("div",["未上传合同附件"]),t("tg-file-card-group",{attrs:{filelist:o?.contract_detail?.attachment_url_list?.map((t=>({filename:t.file_name,url:t.url})))}})]),t("div",{class:"line"}),t("div",{style:"display: flex;"},[t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同扫描件"}}),this.canUpload&&this.hasPermission&&1===o?.contract_info.contract_scan_status&&(o?.contract_detail?.contract_scan_urls.length??0)>0&&t("tg-button",{attrs:{type:"link"},on:{click:this.onApprovalHandler}},["审核"])]),t("div",{class:"grid-annex"},[t("tg-file-card-group",{attrs:{filelist:o?.contract_detail?.contract_scan_urls?.map((t=>({filename:t.file_name,url:t.url}))),editable:!0},on:{remove:e.remove}},[(2===o?.contract_info.contract_scan_status||3===o?.contract_info.contract_scan_status)&&t("div",{style:{position:"absolute",bottom:"-10px",left:"0","font-size":"12px",width:"178px","text-align":"center",color:3===o?.contract_info.contract_scan_status?"red":"#02ba3c"}},[2===o?.contract_info.contract_scan_status?"审批通过":"已驳回"]),!this.canUpload&&0===o?.contract_detail?.contract_scan_urls.length&&t("div",["未上传合同扫描件"]),this.canUpload&&(0===o?.contract_info.contract_scan_status||3===o?.contract_info.contract_scan_status)&&t("div",{class:"annex"},[t("tg-upload",{attrs:{action:"/api/resources/upload_file","http-request":e.uploadScanFiles,"show-file-list":!1,success:t=>{t.success&&e.uploadScans(t.data.source)}}},[t("div",{class:"annex-upload"},[t("tg-icon",{attrs:{name:"ico-add-thin"}}),t("span",{class:"text"},["支持：docx、excel、pdf 单个文件不超过50M"])])])])])])]),t("el-dialog",{attrs:{className:"el-dialog__wrapper customer-dialog",width:"460px","close-on-click-modal":!1,visible:this.projectVisible,title:"选择关联项目"},on:{close:()=>{this.projectVisible=!1}}},[t("div",{style:"margin:0px 8px 8px 8px"},[t("span",{style:"color:#6a7b92"},["关联项目： "]),t("el-select",{attrs:{placeholder:"请输入选择关联项目","reserve-keyword":!0,clearable:!0,filterable:!0},on:{change:t=>{this.project_relevancy_id=t,this.project_ids.map((e=>{e.id===t&&(this.project_relevancy_name=e.project_name)}))}},style:"width: 252px; font-size: 12px",model:{value:this.project_relevancy_id,callback:t=>{this.project_relevancy_id=t}}},[this.project_ids.map(((e,a)=>t("el-option",{style:"width: 194px",attrs:{label:e.project_name,value:e.id},key:a})))])]),t("template",{slot:"footer"},[t("tg-button",{on:{click:()=>{this.projectVisible=!1}}},["取消"]),t("tg-button",{attrs:{type:"primary"},style:"margin-left:20px",on:{click:this.submitProject}},["提交"])])]),t(b.Z,{attrs:{type:"edit"},ref:"addAnchorTemplateContractRef",on:{added:e.reload}}),t("tg-mask-loading",{attrs:{visible:this.approvalLoading,content:"正在保存，请稍候..."}})])}}),$=B,M=a(1001),P=(0,M.Z)($,F,R,!1,null,"3f5b6915",null),N=P.exports},84731:function(t,e,a){a.d(e,{f:function(){return n}});var o=a(44928),s=a(1763);const n=(t=!1)=>{const e=(0,o.t)(),a=e.currentRoute.name,n=s.u3.project.detail===a||t,i=s.u3.contract.supplier.detail===a||s.u3.contract.supplier.detailTemplate===a||s.u3.contract.anchor.detailTemplate===a,r=s.u3.contract.customer.detail===a||s.u3.contract.customer.detailTemplate===a,l=s.FB.contract.supplier.detail===a||s.FB.contract.supplier.detailTemplate===a||s.FB.contract.anchor.detailTemplate===a,c=s.FB.contract.customer.detail===a||s.FB.contract.customer.detailTemplate===a,u=s.u3.contract.customer.detailTemplate===a,d=s.Z8.contract.supplier.detail===a||s.Z8.contract.supplier.detailTemplate===a||s.Z8.contract.anchor.detailTemplate===a,p=s.Z8.contract.customer.detail===a||s.Z8.contract.customer.detailTemplate===a,m=s.l6.contracts.supplier.detail===a||s.l6.contracts.supplier.detailTemplate===a||s.l6.contracts.anchor.detailTemplate===a,v=s.l6.contracts.customer.detail===a||s.l6.contracts.customer.detailTemplate===a,_=s.l6.statistics.supplier.detail===a||s.l6.statistics.supplier.detailTemplate===a||s.l6.statistics.anchor.detailTemplate===a,f=s.l6.statistics.customer.detail===a||s.l6.statistics.customer.detailTemplate===a,g=s.Z8.project.detail===a,h=s.FB.project.detail===a,b=s.u3.contract.customer.detailTemplate===a||s.l6.contracts.customer.detailTemplate===a||s.Z8.contract.customer.detailTemplate===a||s.FB.contract.customer.detailTemplate===a,y=s.bv.player_contract===a;return{isCustomerDetail:b,isCommonBusinessDetail:n,isCommonBusinessSupplierContractDetail:i,isCommonBusinessCustomerContractDetail:r,isLiveSupplierContractDetail:l,isLiveCustomerContractDetail:c,isLegalCustomerContractDetail:v,isLegalSupplierContractDetail:m,isLegalStatisticsSupplierContractDetail:_,isLegalStatisticsCustomerContractDetail:f,isCoopSupplierContractDetail:d,isCoopCustomerContractDetail:p,isCoopDetail:g,isLiveDetail:h,isisCommonBusinessCustomerContractDetailTemplate:u,isSupplierDetail:y}}},11676:function(t,e,a){a.d(e,{K:function(){return d}});a(26699);var o=a(48606);const s=[".pdf",".doc",".docx",".ppt",".pptx"],n=[".mp4"],i=[".png",".jpg",".jpeg"],r=[".xls",".xlsx",".csv"],l=[".doc",".docx"],c=[".pdf"],u=[".csv"],d=t=>e=>{const a=/(\.[^.]+)$/.exec(e.name);let d="";a&&(d=a[1]);const p=[];if(t.image&&p.push(...i),t.file&&p.push(...s),t.video&&p.push(...n),t.excel&&p.push(...r),t.pdf&&p.push(...c),t.doc&&p.push(...l),t.csv&&p.push(...u),t.extensions&&p.push(...t.extensions),p.length>0&&!p.includes(d))return o.Message.warning(`文件格式不正确，请使用 ${p.join(";")}`),!1;if(void 0!==t.fileSize){const a=e.size/1024/1024<t.fileSize;if(!a)return o.Message.warning(`文件不能超过${t.fileSize}MB!`),!1}return!0};e["Z"]={ValidationFileUpload:d}},17890:function(t,e,a){var o,s;a.d(e,{Kb:function(){return o},OX:function(){return l},l7:function(){return r},yR:function(){return n}}),function(t){t[t["Pending"]=1]="Pending",t[t["Normal"]=2]="Normal",t[t["Failure"]=3]="Failure",t[t["Processing"]=4]="Processing",t[t["Invalid"]=5]="Invalid"}(o||(o={})),function(t){t[t["Yes"]=0]="Yes",t[t["No"]=1]="No",t[t["Reject"]=2]="Reject"}(s||(s={}));const n=new Map([[o.Pending,"待审批"],[o.Normal,"审批成功"],[o.Failure,"审批失败"],[o.Processing,"审批中"],[o.Invalid,"已作废"]]),i=new Map([[s.Yes,"未上传"],[s.No,"已上传"],[s.Reject,"已驳回"]]),r=[o.Normal,o.Failure,o.Processing,o.Invalid].map((t=>({value:t,label:n.get(t)??""}))),l=[s.Yes,s.No,s.Reject].map((t=>({value:t,label:i.get(t)??""})))},82741:function(t,e,a){a.d(e,{I:function(){return s},u:function(){return n}});var o=a(71340);const s=(t,e)=>{const a="string"===typeof e?{title:e}:e;return new Promise((e=>{t.root.$TDialog({...a,onConfirm:()=>e(!0),onCancel:()=>e(!1)})}))},n=t=>{const e="string"===typeof t?{title:t}:t;return new Promise(((t,a)=>{(0,o.t)({...e,onConfirm:()=>t(!0),onCancel:()=>a()})}))}},25711:function(t,e,a){a.d(e,{Y:function(){return i}});var o=a(97434);const s=!0,n=s?3e5:3e4,i=(t=n)=>{const e=(0,o.ref)(new Map([])),a=a=>{const o=e.value.get(a);return void 0===o?void 0:o.timestamp+t>Date.now()?o.record:void 0},s=(t,a)=>{const o={key:t,record:a,timestamp:Date.now()};e.value.set(t,o)},i=t=>e.value.delete(t),r=()=>{e.value.clear()};return{getCache:a,setCache:s,removeCache:i,clearCache:r}}},72253:function(t,e,a){var o=a(36568),s=a.n(o),n=a(97434);e["Z"]=(0,n.defineComponent)({name:"",setup(t,e){const a=(0,n.ref)(),o=(0,n.ref)(),s=t=>{o.value=t},i=()=>{const t={contract_id:o.value,message:a.value};e.emit("close"),e.emit("submit",t)};return{reason:a,show:s,dialogSubmit:i}},render(){const t=arguments[0];return t("div",[t("el-form",s()([{class:" pd-18"},{props:{model:this.reason}},{ref:"elFormRef",attrs:{size:"small","label-width":"0"}}]),[t("el-form-item",{attrs:{label:"",prop:"reason"}},[t("el-input",{attrs:{type:"textarea",rows:5,maxlength:50,placeholder:"请填写意见，限50字"},style:"height: 100px;",model:{value:this.reason,callback:t=>{this.reason=t}}})])])])}})},43773:function(t,e,a){a.d(e,{R:function(){return p},y:function(){return m}});var o=a(36568),s=a.n(o),n=a(97434),i=a(64923),r=a(77944);let l=1;const c=()=>{const t=document.createElement("div");return t.id="dialog_"+l++,document.body.appendChild(t),t},u=new Function,d=(t,e)=>{let a=t;return void 0===a&&(a={}),Object.keys(e).forEach((t=>{const o=a[t]||u,s=e[t];a[t]=(...t)=>{if(!1!==s(...t))return o(...t)}})),a},p=(t={})=>{const e=(0,n.ref)(),a=(0,n.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),o=(0,n.ref)(!0),l=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};l(t);const u=(0,n.ref)(d(t.on,{close(){a.visible=!1},updateDialog(t={}){l(t)}})),p=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new i["default"]({el:c(),store:r.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,n.provide)(e,t.provide[e])}))},render(e){if(o.value&&a.visible)return e("el-dialog",s()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${t.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value}),a.footer&&e("fragments",{slot:"footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,n.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},v=t=>(l(t),g),_=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?u.value[t]=e:d(u.value,{[t]:e}),g);(0,n.onUnmounted)((()=>{o.value=!1,a.visible=!1}));const g=(0,n.reactive)({show:m,update:v,on:f,close:_,config:t,data:t.data});return g},m=(t={})=>{const e=(0,n.ref)(),a=(0,n.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),o=(0,n.ref)(!0),l=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};l(t);const u=(0,n.ref)(d(t.on,{close(){a.visible=!1},updateDialog(t={}){l(t)}})),p=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new i["default"]({el:c(),store:r.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,n.provide)(e,t.provide[e])}))},render(e){if(!o.value)return;if(!a.visible)return;const{width:n,...i}=a;return e("el-drawer",s()([{class:`tg-drawer-rewrite ${t.class}`},{props:{...i,size:n}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[e("div",{class:"tg-drawer-content"},[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value})]),a.footer&&e("div",{class:"tg-drawer-footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,n.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},v=t=>(l(t),g),_=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?u.value[t]=e:d(u.value,{[t]:e}),g);(0,n.onUnmounted)((()=>{o.value=!1,a.visible=!1}));const g=(0,n.reactive)({show:m,update:v,on:f,close:_,config:t});return g}}}]);