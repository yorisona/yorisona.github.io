"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[8867],{19958:function(e,s,a){a.d(s,{Z:function(){return p}});var r,t,n=a(97434),l=a(1763),i=a(64236),o=(0,n.defineComponent)({setup(e,s){const a=(0,n.ref)(),r=(0,n.ref)(!1),t=(0,n.ref)(),l=e=>{e&&(a.value=e,r.value=!0)},o=(0,n.ref)(""),u=(0,n.computed)((()=>{const e=o.value,s=a.value?.by_evaluation_person||[];return(0,i.xb)(e)?s:s.filter((s=>-1!==s.username.indexOf(e)))}));return{show:l,formData:a,visible:r,selected:t,filterValue:o,filterList:u}},render(){const e=arguments[0];return e("el-drawer",{attrs:{title:"选择模拟被考核人员",size:"378px",visible:this.visible},on:{close:()=>{this.visible=!1}}},[e("div",{class:"assessor-container"},[e("div",{class:"search"},[e("el-input",{attrs:{size:"small",placeholder:"输入姓名查找 "},model:{value:this.filterValue,callback:e=>{this.filterValue=e}}},[e("i",{slot:"prefix",class:"el-input__icon el-icon-search"})])]),e("div",{class:"body"},[e("el-radio-group",{model:{value:this.selected,callback:e=>{this.selected=e}}},[this.filterList.map((s=>e("div",{class:"assessor-item"},[e("el-radio",{attrs:{name:"assessor",label:s.user_id}},[s.username," (",s.real_name,")"])])))])]),e("div",{class:"footer"},[e("tg-button",{attrs:{size:"small"},on:{click:()=>this.visible=!1}},["取消"]),e("tg-button",{attrs:{size:"small",type:"primary"},class:"mgl-18",on:{click:()=>{this.selected&&(this.$router.push({name:l.Gr.assessment.preview,query:{user_id:this.selected+""}}),this.visible=!1)}}},["确定"])])])])}}),u=o,c=a(1001),m=(0,c.Z)(u,r,t,!1,null,"b3c041e4",null),p=m.exports},18867:function(e,s,a){a.r(s),a.d(s,{default:function(){return g}});var r=a(97434),t=a(99205),n=a(1763),l=a(44928),i=a(73497),o=a(19958),u=a(23624),c=a(15681),m=a(64236);const p=[{title:"考评组",name:n.Gr.assessment.list},{title:"新增考评组",name:n.Gr.assessment.create.base},{title:"预览"}];var _,d,f=(0,r.defineComponent)({components:{Steps:i.Z,selectAssessor:o.Z},setup:()=>{const e=(0,l.t)(),s=(0,r.ref)((0,t.Sr)());(0,t.h4)(s.value);const a=(0,r.ref)((0,t.XH)(s.value)),n=[{align:"center",label:"维度",minWidth:150,formatter:e=>e.assessment_dimension.name},{label:"指标名称",minWidth:150,prop:"name"},{label:"目标值",minWidth:150,prop:"is_target"},{label:"指标定义",minWidth:150,prop:"remark"},{label:"考核标准",minWidth:150,prop:"check_standard",formatter(e){return e.check_standard?(0,t.Io)(e.check_standard):"--"}},{label:"权重",minWidth:70,align:"right",prop:"weight",formatter:e=>{switch(e.indicator_type){case c.F2.DEDUCT:case c.F2.BONUS:return"--";case c.F2.QUALITATIVE:case c.F2.RATION:return(0,m.xb)(e.weight)?"":`${e.weight}%`}}}],i=(0,r.ref)({self:{},leader:{},job_title:""}),o=(0,r.ref)(),p=(0,r.ref)(),_=e=>{const a=s.value.by_evaluation_person.find((s=>Number(s.user_id)===e));a&&(i.value.self=a),(0,u.ao)(e).then((e=>{if(e.data.success){const s=e.data.data;i.value.leader=s.leader?.username?s.leader:{username:"--",real_name:"--"},i.value.job_title=s.job_title??"--"}})).then((()=>{const e={...s.value},a=i.value.leader.username,r=i.value.leader.real_name,t=i.value.self.username,n=i.value.self.real_name;e.username=t,e.real_name=n,e.operator_person={username:2===e.operator?a:t,real_name:2===e.operator?r:n},e.confirmer_person={username:2===e.confirmer?a:t,real_name:2===e.confirmer?r:n},e.superior_assessment_person=[{username:a,real_name:r}],o.value?.updateData(e)}))};return _(Number(e.currentRoute.query.user_id)),{formData:s,data:a,columns:n,currentSelectInfo:i,stepsRef:o,selectAssessorRef:p,init:_}},beforeRouteUpdate(e,s,a){a(),this.init(Number(e.query.user_id))},render(){const e=arguments[0],{selectAssessorRef:s,formData:a,currentSelectInfo:r}=this;return e("div",{class:"tg-page-container page-content-container"},[e("tg-breadcrumbs",{attrs:{routes:p}}),e("div",{class:"container"},[e("div",{class:"userinfo-box"},[e("tg-icon",{class:"avatar",attrs:{name:"ico-default-avatar"}}),e("div",{class:"userinfo"},[e("span",{class:"name"},[r.self?.username,"（",r.self?.real_name,"）"]),e("span",{class:"job"},[r.job_title])]),e("tg-button",{class:"mgl-18",on:{click:()=>{s?.show(a)}}},["更换"])]),e("steps",{ref:"stepsRef"}),e("div",{class:"table-box"},[e("tg-table",{attrs:{border:!0,columns:this.columns,data:this.data,"span-method":({row:e,columnIndex:s})=>0===s&&e.span?e.span:[1,1]}})])]),e("select-assessor",{ref:"selectAssessorRef"})])}}),v=f,b=a(1001),h=(0,b.Z)(v,_,d,!1,null,"65739237",null),g=h.exports},73497:function(e,s,a){a.d(s,{Z:function(){return m}});var r,t,n=a(97434),l=a(15681),i=(0,n.defineComponent)({props:{showRealName:{type:Boolean,default:()=>!0}},setup:()=>{const e=(0,n.ref)({}),s=(0,n.ref)(l.Tp.map((e=>({...e})))),a=s=>{e.value=s,!0!==s.is_target_confirmed&&r(l.__.TARGET_CONFIRM),!0!==s.is_superior_rating&&r(l.__.SUPERIOR),!0!==s.is_self_evaluation&&r(l.__.SELF)},r=e=>{s.value=s.value.filter((s=>s.value!==e))};return{steps:s,data:e,updateData:a,disabledStep:r}},render(){const e=arguments[0],{data:s}=this;return e("div",{class:"steps-box"},[this.steps.map((a=>{let r="step";s.present_stage>a.value&&(r=`${r} success`),s.present_stage===a.value&&(r=`${r} active`);let t="";switch(a.value){case l.__.TARGET_SETTING:t=`${s.operator_person?.username??"--"}（${s.operator_person?.real_name??"--"}）`;break;case l.__.SELF:case l.__.SIGNATURE:case l.__.IN_PROGRESS:t=`${s.username??"--"} ${s.real_name?` (${s.real_name})`:""}`;break;case l.__.TARGET_CONFIRM:t=`${s.confirmer_person?.username??"--"} ${s.confirmer_person?.real_name?`(${s.confirmer_person?.real_name})`:""}\n              `;break;case l.__.SUPERIOR:s.superior_assessment_person&&s.superior_assessment_person.length>0&&(t=s.superior_assessment_person.map((a=>{let r="";return s.present_stage===l.__.SUPERIOR&&s.present_person&&s.present_person.username===a.username&&(r="present"),e("span",{class:r},[`${a.username??"--"} ${a.real_name?` (${a.real_name})`:""}`])})));break}return e("div",{class:r},[e("div",{class:"step-target"},[e("span",[a.label])]),e("div",{class:"step-names"},[t])])}))])}}),o=i,u=a(1001),c=(0,u.Z)(o,r,t,!1,null,"625c60b5",null),m=c.exports}}]);