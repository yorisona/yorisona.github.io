"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[6911],{66950:function(e,t,a){a.r(t),a.d(t,{default:function(){return ii}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-page-container tg-common-business-project-detail"},[a("TgBreadcrumbs",{attrs:{routes:e.routes}}),a("tg-card",{staticClass:"project-detail",attrs:{padding:[6,0,0,0],overflowInBody:""}},[e.inProject||e.permission.common_business_view_all_project?a("tg-tabs",{staticClass:"flex-none",attrs:{tabs:e.tabs,bottom:""},on:{change:e.onTabChange},model:{value:e.checkedTab,callback:function(t){e.checkedTab=t},expression:"checkedTab"}}):e._e(),e.inProject||e.permission.common_business_view_all_project?a(e.checkedTab,{tag:"component",staticClass:"component-container",on:{editProjectReload:e.editProjectReload}}):e._e(),e.inProject||e.permission.common_business_view_all_project?e._e():a("div",{staticClass:"abnormal-empty"},[a("div",{staticClass:"abnormal-empty-content"},[a("empty-common",{attrs:{"detial-text":void 0===e.inProject?"获取项目详情失败，请稍后重试":"暂无查看当前项目的权限"}})],1)])],1)],1)},r=[],n=a(97434),o=a(23812),s=a(85457),l=a(52140),c=a(1763),u=a(21757),d=a(78902),m=a(83626),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-common-business-project-detail-info"},[a("div",{staticClass:"project-info-scroll"},[a("div",{staticClass:"project-info-left"},[a("div",{staticClass:"project-name-info filter-form-item-btn"},[a("span",{staticClass:"project-name"},[e._v(e._s(e.ProjectDetail.project_name))]),e.Permission.canSaveProject?a("tg-button",{staticClass:"project-edit",on:{click:function(t){return e.toggleProjectModalVisible(!0)}}},[e._v("编辑项目 ")]):e._e()],1),a("div",{staticClass:"project-uid"},[e._v(e._s(e.ProjectDetail.project_uid))]),e.ProjectDetail.project_status===e.ProjectStatusEnum.execution?a("div",{staticClass:"project-status"},[a("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","-ms-flex-align":"start"}},[a("div",{staticStyle:{color:"#6a7b92"}},[e._v("状态：")]),a("div",{staticStyle:{width:"200px"}},[a("div",{staticClass:"status",staticStyle:{"font-size":"14px",color:"#ffac15"}},[e._v(" 执行中"),e.Permission.canEditProject?a("tg-button",{staticClass:"edit-button",attrs:{type:"link"},on:{click:e.openFinishDialog}},[a("tg-icon",{attrs:{name:"ico-edit"}})],1):e._e()],1)])])]):e.ProjectDetail.project_status===e.ProjectStatusEnum.executionEnd?a("div",{staticClass:"project-status"},[a("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","-ms-flex-align":"start"}},[a("div",{staticStyle:{color:"#6a7b92"}},[e._v("状态：")]),a("div",{staticStyle:{width:"200px"}},[a("div",{staticClass:"status",staticStyle:{"font-size":"14px",color:"#ffac15"}},[e._v(" 执行结束"),e.Permission.canEditProject?a("tg-button",{staticClass:"edit-button",attrs:{type:"link"},on:{click:e.openFinishDialog}},[a("tg-icon",{attrs:{name:"ico-edit"}})],1):e._e()],1)])])]):a("div",{staticClass:"project-status"},[a("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","-ms-flex-align":"start"}},[a("div",{staticStyle:{color:"#6a7b92"}},[e._v("状态：")]),a("div",{staticStyle:{width:"200px"}},[a("div",{staticClass:"project-status-desc"},[a("div",{staticClass:"status",staticStyle:{"font-size":"14px",color:"#00a935"},style:{color:1===e.ProjectDetail.end_type?"#00A935":"#ED3434"}},[e._v(" "+e._s(e.project_status_str)+" "),e.Permission.canEndEditProject?a("tg-button",{staticClass:"edit-button",attrs:{type:"link"},on:{click:e.onRollBackProject}},[a("tg-icon",{attrs:{name:"ico-edit"}})],1):e._e()],1)]),a("div",{staticStyle:{"margin-top":"2px",color:"#999999","font-size":"12px"}},[e._v(" "+e._s(e.ProjectDetail.end_date?e.ProjectDetail.end_date.replace(/-/g,"."):"")+" ")])])]),2===e.ProjectDetail.end_type?a("div",{staticStyle:{width:"100%",display:"flex","flex-direction":"row","-ms-flex-align":"start","margin-top":"8px"}},[a("div",{staticStyle:{color:"#6a7b92"}},[e._v("处理方案：")]),a("div",{staticStyle:{width:"180px","white-space":"normal","word-wrap":"break-word",overflow:"hidden"}},[e._v(" "+e._s(e.project_reason_status_str)+" ")])]):e._e()]),e._m(0),a("div",{staticClass:"project-base"},[a("span",{staticClass:"label"},[e._v("业务平台：")]),1===e.ProjectDetail.platform_type?a("span",[e._v("抖音")]):2===e.ProjectDetail.platform_type?a("span",[e._v("淘宝")]):a("span",[e._v("--")])]),a("div",{staticClass:"project-circle",staticStyle:{"margin-top":"24px"}},[a("span",{staticClass:"label"},[e._v("项目周期：")]),a("span",[e._v(e._s(e.project_cycle))])]),1===e.ProjectDetail.platform_type?a("div",{staticClass:"project-base"},[a("span",{staticClass:"label"},[e._v("项目达人：")]),a("span",[e._v(e._s(e.ProjectDetail.kol_name?e.ProjectDetail.kol_name:"--"))])]):e._e(),a("div",{staticClass:"project-base"},[a("span",{staticClass:"label"},[e._v("项目类型：")]),a("span",[e._v(e._s(e.projectTypeStr))])]),a("div",{staticClass:"project-base"},[a("span",{staticClass:"label"},[e._v("所属部门：")]),a("span",[e._v(e._s(e.ProjectDetail.feishu_department_name?e.ProjectDetail.feishu_department_name:"--"))])]),e.teamMemberEditEnabled?a("div",{staticClass:"project-team"},[a("span",{staticClass:"label",staticStyle:{"font-weight":"600","font-size":"14px",color:"#3c5269"}},[e._v("项目团队")]),a("tg-button",{staticClass:"edit-people-button",attrs:{type:"link"},on:{click:e.onProjectTeamEdit}},[a("tg-icon",{attrs:{name:"ico-edit"}})],1)],1):e._e(),a("div",{class:["project-manager",e.teamMemberEditEnabled?"":"mgt-24"]},[a("span",{staticClass:"label"},[e._v("项目经理：")]),a("span",[e._v(e._s(e.ProjectDetail.project_manager?e.ProjectDetail.project_manager:"--"))])]),a("div",{staticClass:"project-base"},[a("span",{staticClass:"label"},[e._v("其他成员：")]),a("span",[e._v(e._s(e.otherMembersStr))])])]),a("div",{class:["project-info-right",{"row-two":2===e.ProjectDetail.platform_type}]},[a("div",{staticClass:"project-info-income-contract"},[a("div",{staticClass:"income"},[a("div",{staticClass:"title"},[e._v("项目盈收")]),a("div",{staticClass:"income-row"},[a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.income_settlement_amount)))]),a("div",[e._v("收入结算金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.real_income_amount)))]),a("div",[e._v("实收金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.unreceived_amount)))]),a("div",[e._v("未收金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.paid_invoice_amount)))]),a("div",[e._v("已开发票")])])]),a("div",{staticClass:"income-row"},[a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.cost_settlement_amount)))]),a("div",[e._v("成本结算金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.real_paid_amount)))]),a("div",[e._v("实付金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.unpaid_amount)))]),a("div",[e._v("未付金额")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(e._s(e.formatAmount(e.profitData.received_invoice_amount)))]),a("div",[e._v("已收发票")])])])]),a("div",{staticClass:"contract"},[a("div",{staticClass:"title"},[e._v("合同")]),a("div",{staticClass:"contract-row"},[a("div",{staticClass:"income-contract-item"},[a("div",{class:0===(e.ProjectDetail.contract_stat?e.ProjectDetail.contract_stat.customer:0)?"contract-no-customer":""},[e._v(" "+e._s(e.ProjectDetail.contract_stat?e.ProjectDetail.contract_stat.customer:0)+" ")]),a("div",[e._v("客户合同")])]),a("div",{staticClass:"income-contract-item"},[a("div",[e._v(" "+e._s(e.ProjectDetail.contract_stat?e.ProjectDetail.contract_stat.supplier:0)+" ")]),a("div",[e._v("供应商合同")])])]),0===(e.ProjectDetail.contract_stat?e.ProjectDetail.contract_stat.customer:0)?a("div",{staticClass:"contract-tip"},[a("tg-icon",{attrs:{name:"ico-icon_jinggao"}}),a("div",[e._v("当前还没签署合同，请尽快签署合同并录入系统")])],1):e._e()])]),1===e.ProjectDetail.platform_type?a("month-live",{attrs:{platform:e.ProjectDetail.platform_type}}):a("div",{staticClass:"taobao-empty"},[a("empty-common",{attrs:{"detial-text":"敬请期待新功能"}})],1)],1)]),a("CommonBusinessProjectDialog",{attrs:{title:"编辑项目",isEditForm:"",project:e.currentProject,visible:e.ProjectFormVisible},on:{"dialog:close":e.onProjectFormModalClose}}),a("team-member",{attrs:{projectId:""+e.ProjectDetail.id,member:e.memberForEdit,creator:e.ProjectDetail.add_by_username,visible:e.teamMemberVisible},on:{"update:visible":function(t){e.teamMemberVisible=t},save:e.onTeamMemberSave}}),a("projectFinal",{ref:"projectFinal",attrs:{IsMcn:!0,visible:e.ProjectStepFinalFormVisible,status:e.ProjectDetail.project_status},on:{"ProjectFinalStep:close":e.onProjectFinalStepDialogModalClose,getDetail:e.getDetail}}),a("roll-back-project",{attrs:{visible:e.rollBackProjectVisible,projectInfo:e.rollBackProjectInfo},on:{"update:visible":function(t){e.rollBackProjectVisible=t},save:e.onProjectRollBackSave}})],1)},_=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-business-type"},[a("span",{staticClass:"label"},[e._v("业务类型：")]),a("span",[e._v("S2B2C")])])}],v=a(4665),f=a(90553),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"month-live-wrapper"},[a("div",{staticClass:"project-live"},[a("div",{staticClass:"table-box"},[e._m(0),a("el-table",{staticClass:"month-live-table",attrs:{data:e.liveDatas,stripe:"",height:e.liveParams.total>20?230:275},on:{"row-click":e.onLiveRowClick},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":e.withoutLiveDisplayPermission?"权限不足，需要查看权限":"暂无场次"}})]},proxy:!0}])},e._l(e.liveColumns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),1),e.liveParams.total>20?a("el-pagination",{staticClass:"live-pagination",attrs:{"current-page":e.liveParams.page_num,"page-sizes":[20,5,10,50],"page-size":e.liveParams.num,layout:"total, prev, pager, next, sizes, jumper",total:e.liveParams.total},on:{"update:currentPage":function(t){return e.$set(e.liveParams,"page_num",t)},"update:current-page":function(t){return e.$set(e.liveParams,"page_num",t)},"current-change":e.liveCurrentChange,"size-change":e.livePageSizeChange}}):e._e()],1)]),a("div",{staticClass:"project-live"},[a("div",{staticClass:"table-box"},[a("div",{staticClass:"live-header"},[a("div",{staticClass:"title"},[e._v("招商商品")]),e.shop_live_name?a("div",{staticClass:"tag-box"},[a("div",{staticClass:"tag-box-line"},[e._v(" "+e._s(e.shop_live_name)+" "),a("tg-icon",{staticClass:"close-icon",attrs:{name:"ico-a-quseguanbiicon2x"},on:{click:e.closeShopName}})],1)]):e._e()]),a("el-table",{attrs:{data:e.goodsDatas,stripe:"",height:e.merchantGoodsParams.total>20?460:490},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":e.withoutLiveDisplayPermission?"权限不足，需要查看权限":"暂无商品"}})]},proxy:!0}])},e._l(e.goodsColumns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),1),e.merchantGoodsParams.total>20?a("el-pagination",{staticClass:"live-pagination",attrs:{"current-page":e.merchantGoodsParams.page_num,"page-sizes":[20,5,10,50],"page-size":e.merchantGoodsParams.num,layout:"total, prev, pager, next, sizes, jumper",total:e.merchantGoodsParams.total},on:{"update:currentPage":function(t){return e.$set(e.merchantGoodsParams,"page_num",t)},"update:current-page":function(t){return e.$set(e.merchantGoodsParams,"page_num",t)},"current-change":e.merchantCurrentChange,"size-change":e.merchantPageSizeChange}}):e._e()],1)])])},h=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"live-header"},[a("div",{staticClass:"title"},[e._v("本月场次")])])}],y=a(6933),b=a.n(y),w=a(44928),C=a(3293),x=a(67910),j=a(61282),D=(0,n.defineComponent)({props:{platform:{type:Number,default:1}},setup(e,t){const a=(0,w.t)(),i=a.currentRoute.params.id,r=b()(),o=(0,n.ref)([]),s=e=>{const t=b()(e);return t.isBefore(r,"d")},l=(0,n.computed)((()=>[{label:"场次类型",minWidth:70,formatter:e=>{let t="--";return 60===e.live_type?t="直播":61===e.live_type?t="短视频":62===e.live_type&&(t="图文"),(0,n.h)("div",[t])}},{label:"场次名称",minWidth:200,formatter:e=>(0,n.h)("div",{class:"line-clamp-1"},[e.live_title?e.live_title:"--"])},{label:"场次时间",minWidth:156,align:"center",formatter:e=>{if(e.live_start_time&&e.live_end_time){const t=b()(e.live_start_time),a=b()(e.live_end_time),i=t.isSame(a,"d");let r=`${t.format("MM.DD HH:mm")} ~ ${a.format("HH:mm")}`;if(!i){const e=t.date(),i=a.date(),n=t.clone().date(e+1),o=n.isSame(a,"d");r=o?`${r}(次日)`:`${r}(${i}日)`}return r}return"--"}},{label:"招商商品数",minWidth:150,align:"right",property:"merchant_goods_count"},{label:"执行结果",minWidth:135,align:"center",formatter:e=>{const t=4===e.live_status,a=s(e.live_start_time)&&!t?"warning":"";return(0,n.h)("div",{class:"live-status"},[(0,n.h)("span",{class:a}),(0,n.h)("span",[t?"已归档":"未完成"])])}}])),c=(0,n.ref)(!1),u=(0,n.ref)({project_id:i,num:20,page_num:1,total:0}),d=async()=>{const e=r,t="yyyy-MM-DD",a=e.clone().startOf("month"),i=e.clone().endOf("month"),n={live_start_date:a.format(t),live_end_date:i.format(t),...u.value},s=await(0,m.AT)(n);s.data.success?(c.value=!1,o.value=s.data.data.data,u.value.total=s.data.data.total):200===s.data.error_code?c.value=!0:c.value=!1},p=e=>{u.value.page_num=e,d()},_=e=>{u.value.num=e,d()},v=(0,n.ref)(null),f=(0,n.ref)(""),g=e=>{v.value=e.id,f.value=e.live_title,L()},h=(0,n.ref)([]),y=(e,t,a,i)=>{const r=e[t]||"--",{is_folded:o,folded_text:s}=(0,j.zb)(r,a);return i||!o?s:(0,n.h)("el-popover",{props:{placement:"right",trigger:"hover",content:r}},[(0,n.h)("span",{slot:"reference"},[s]),(0,n.h)("DefText",{props:{content:e[t]}})])},D=(e,t)=>y(e,"product_code",8,t),S=(0,x.zY)(h,"商品ID",D),k=(e,t)=>y(e,"product_name",8,t),A=(0,x.zY)(h,"商品名称",k),P=(e,t)=>y(e,"company_name",8,t),M=(0,x.zY)(h,"所属公司",P),R=(e,t)=>y(e,"shop_name",8,t),T=(0,x.zY)(h,"所属店铺",R),N=(e,t)=>y(e,"brand_name",5,t),F=(0,x.zY)(h,"品牌",N),V=(e,t)=>y(e,"live_title",10,t),$=(0,x.zY)(h,"场次名称",V),I=(0,n.computed)((()=>[{label:"商品ID",headerAlign:"left",minWidth:S.value,formatter:e=>D(e,!1)},{label:"商品名称",minWidth:A.value,formatter:e=>k(e,!1)},{label:"所属公司",minWidth:M.value,formatter:e=>P(e,!1)},{label:"所属店铺",minWidth:T.value,formatter:e=>R(e,!1)},{label:"品牌",minWidth:F.value,formatter:e=>N(e,!1)},{label:"日期",minWidth:100,align:"center",formatter:e=>(0,n.h)("div",{class:"line-clamp-1"},[e.live_start_time?e.live_start_time.replace(/-/g,"."):"--"])},{label:"场次名称",minWidth:$.value,formatter:e=>V(e,!1)},{label:"场次类型",minWidth:80,align:"center",formatter:e=>{let t="--";return 60===e.live_type?t="直播":61===e.live_type?t="短视频":62===e.live_type&&(t="图文"),(0,n.h)("span",[t])}},{label:"招商人员",minWidth:70,align:"center",formatter:e=>(0,n.h)("div",[e.add_by_name?e.add_by_name:"--"])}])),E=(0,n.ref)({num:20,page_num:1,total:0}),L=async()=>{const e=r,a="yyyy-MM-DD",n=e.clone().startOf("month"),o=e.clone().endOf("month"),s={live_start_time:n.format(a),live_end_time:o.format(a),live_id:v.value,project_id:i,...E.value},l=await(0,C.BR)(s);l.data.success?(h.value=l.data.data.data,E.value.total=l.data.data.total):t.root.$message.error(l.data.message)},W=()=>{v.value=null,f.value="",L()},Z=e=>{E.value.page_num=e,L()},G=e=>{E.value.num=e,L()};return(0,n.onBeforeMount)((()=>{1===e.platform&&(d(),L())})),{liveDatas:o,liveColumns:l,withoutLiveDisplayPermission:c,liveParams:u,liveCurrentChange:p,livePageSizeChange:_,onLiveRowClick:g,shop_live_name:f,goodsDatas:h,goodsColumns:I,merchantGoodsParams:E,closeShopName:W,merchantCurrentChange:Z,merchantPageSizeChange:G}}}),S=D,k=a(1001),A=(0,k.Z)(S,g,h,!1,null,"6dff7b70",null),P=A.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-mcn-project-team-member"},[a("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new",attrs:{visible:e.visible,width:"478px",title:"团队成员","close-on-click-modal":!1},on:{close:e.onClose},scopedSlots:e._u([{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.onClose}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"team-member-content"},[a("el-form",{attrs:{model:e.form,"label-width":"60px",size:"small","label-position":"top"}},[a("el-form-item",{attrs:{label:"项目经理："}},[a("el-select",{attrs:{filterable:"",placeholder:"请输入并选择项目经理"},model:{value:e.form.project_manager_id,callback:function(t){e.$set(e.form,"project_manager_id",t)},expression:"form.project_manager_id"}},e._l(e.projectManagers,(function(e,t){return a("el-option",{key:t,attrs:{label:e.username,value:e.id}})})),1)],1),a("el-form-item",{staticClass:"mgt-18",attrs:{label:"其他成员："}},[a("el-select",{attrs:{clearable:"",multiple:"",remote:"",filterable:"",value:e.selectNames,"remote-method":e.getAllOtherMembersRequest,loading:e.otherMemberLoading,placeholder:"请输入并选择其他成员"},on:{change:e.onOtherMembersChanged}},e._l(e.otherMembers,(function(e){return a("el-option",{key:e.id,attrs:{label:e.username,value:e.username}})})),1)],1),a("div",{staticClass:"creator mgt-24"},[a("span",[e._v("创建人：")]),a("span",[e._v(e._s(e.computedCreator))])])],1)],1)]),a("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"  正在保存，请稍候..."}})],1)},R=[],T=a(14782),N=a(57046);const F=()=>({project_manager_id:void 0,team_members:[]});var V=(0,n.defineComponent)({props:{visible:{type:Boolean,default:!1},projectId:{type:String},member:{type:Object},creator:{type:String}},setup(e,t){const a=(0,n.ref)(!1),i=(0,n.ref)(!1),r=(0,n.computed)((()=>e.creator?e.creator:"--")),o=(0,n.ref)(F()),s=(0,n.ref)([]),l=(0,n.ref)([]),c=(0,n.ref)([]),u=(0,n.computed)((()=>o.value.team_members.map((e=>{const t=c.value.find((t=>t.id===e));return t?.name??""})))),d={onClose:()=>{t.emit("close"),t.emit("update:visible",!1)},onSave:async()=>{const a={project_manager_id:o.value.project_manager_id,team_members:o.value.team_members??[]};i.value=!0;const r=await(0,m.YP)(e.projectId??"",a);i.value=!1,r.data.success?t.emit("save"):t.root.$message.error(r.data.message??"保存失败，请稍候重试")},getAllProjectManagerRequest:async()=>{const e=await(0,T.g)();e.data.success&&(s.value=e.data.data)},getAllOtherMembersRequest:async e=>{if(""===e||void 0===e)return void(l.value=[]);a.value=!0;const t=await(0,C.em)(e);a.value=!1,t.data.success?l.value=t.data.data.user_data:l.value=[]},onOtherMembersChanged:e=>{const t=[];l.value.forEach((e=>{const t=c.value.find((t=>e.id===t.id));t||c.value.push({id:e.id,name:e.username})})),e.forEach((e=>{const a=c.value.find((t=>t.name===e));a&&t.push(a.id)})),o.value.team_members=t}};return(0,n.watch)([()=>e.visible,()=>e.member],(([e,t])=>{if(t&&e){const e=t;o.value={project_manager_id:e.project_manager_id,team_members:e.team_members.map((e=>e.id))},c.value=(0,N.I8)(e.team_members)}else l.value=[]})),d.getAllProjectManagerRequest(),{selectNames:u,computedCreator:r,otherMemberLoading:a,form:o,saveLoading:i,projectManagers:s,otherMembers:l,...d}}}),$=V,I=(0,k.Z)($,M,R,!1,null,null,null),E=I.exports,L=a(60097),W=a(77944),Z=a(72713),G=a(29625),O=(0,n.defineComponent)({name:"CommonBusinessProjectDetailInfo",components:{CommonBusinessProjectDialog:f.Z,TeamMember:E,projectFinal:L.Z,MonthLive:P,RollBackProject:Z.Z},setup(e,t){const a=(0,n.computed)((()=>W.Z.getters["user/getUserInfo"])),i=(0,w.t)(),r=i.currentRoute.params.id,o=(0,n.inject)("project")??(0,n.ref)(),s=(0,n.computed)((()=>o.value)),l=(0,n.computed)((()=>({...s.value}))),c=(0,n.ref)(!1),p=async e=>{c.value=e},_=async e=>{c.value=!1,e&&$()},f=(0,n.ref)(!1),g=()=>{f.value=!0},h=(0,n.computed)((()=>{const e=o.value?.team_members.map((e=>e.name))??[];return e.length?e.join(" "):"--"})),y=(0,n.computed)((()=>o.value?.mcn_project_type?v.MU.get(o.value.mcn_project_type)??"--":"--")),b=(0,n.computed)((()=>{const e=1===o.value?.end_type?"正常结束":2===o.value?.end_type?"意外终止":"";return e})),C=(0,n.computed)((()=>{const e=2===o.value?.end_detail.end_handle_type?`${o.value?.end_detail.end_handle_detail}`:"退款";return 2===o.value?.end_type?e:""})),x=(0,n.computed)((()=>{const e=(0,u.kG)(d.HN.common_business_project_save),t=(0,u.kG)(d.HN.common_business_project_end_project),a=(0,u.kG)(d.HN.common_business_project_status_finish_edit);return{canSaveProject:e,canEditProject:t,canEndEditProject:a}})),D=(0,n.computed)((()=>({projectId:o.value?.id,projectType:G.kA.common_business}))),S=(0,n.ref)({income_settlement_amount:"",cost_settlement_amount:"",real_income_amount:"",real_paid_amount:"",unreceived_amount:"",unpaid_amount:"",paid_invoice_amount:"",received_invoice_amount:""}),k=async()=>{const e=await(0,m.x$)(r);e.data.success?S.value=e.data.data:t.root.$message(e.data.message)},A=e=>{const t=e||"0";return(0,j.FU)(t)},P=(0,n.ref)(!1),M=(0,n.computed)((()=>({project_manager_id:o.value?.project_manager_id,team_members:o.value?.team_members}))),R=()=>{P.value=!0},T=()=>{P.value=!1,$()},N=(0,n.ref)(!1),F=()=>{N.value=!1},V=()=>{N.value=!0},$=()=>{t.emit("editProjectReload")},I=(0,n.computed)((()=>!(!a.value?.id||!o.value)&&(a.value.id===o.value.project_manager_id||a.value.id===o.value.add_by))),E=()=>{f.value=!1,$()};(0,n.onBeforeMount)((()=>{k()}));const L=(0,n.computed)((()=>{if(l.value?.start_date&&l.value?.end_date){const e=l.value?.start_date.replace(/-/g,"."),t=l.value?.end_date.replace(/-/g,".");return`${e} - ${t}`}return"--"}));return{ProjectStatusEnum:G.C_,project_cycle:L,Permission:x,ProjectDetail:l,projectTypeStr:y,project_status_str:b,project_reason_status_str:C,currentProject:s,otherMembersStr:h,ProjectFormVisible:c,toggleProjectModalVisible:p,onProjectFormModalClose:_,formatAmount:A,profitData:S,teamMemberVisible:P,teamMemberEditEnabled:I,memberForEdit:M,onProjectTeamEdit:R,onTeamMemberSave:T,ProjectStepFinalFormVisible:N,rollBackProjectVisible:f,onRollBackProject:g,onProjectFinalStepDialogModalClose:F,openFinishDialog:V,getDetail:$,rollBackProjectInfo:D,onProjectRollBackSave:E}}}),B=O,Y=(0,k.Z)(B,p,_,!1,null,null,null),z=Y.exports,q=a(91354),X=(a(21703),a(36568)),H=a.n(X),U=a(68762),J=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-common-business-base-form-dialog tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{width:"440px",visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1},on:{close:e.onCloseBtnClick},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{attrs:{size:"small"},on:{click:e.onCloseBtnClick}},[e._v("取消")]),a("tg-button",{attrs:{size:"small",type:"primary"},on:{click:e.onSaveBtnClick}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"dialog-content"},[a("el-form",{ref:"formRef",attrs:{"label-position":"top",size:"small","label-width":"106px"}},[a("div",{staticClass:"tg-dialog-section-title"},[a("span"),e._v("直播数据")]),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"直播时长"}},[a("el-input",{attrs:{maxlength:"8",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("live_duration",t)}},model:{value:e.baseForm.live_duration,callback:function(t){e.$set(e.baseForm,"live_duration","string"===typeof t?t.trim():t)},expression:"baseForm.live_duration"}},[a("template",{slot:"append"},[e._v("小时")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"直播增粉数"}},[a("el-input",{attrs:{maxlength:"12",placeholder:"0"},on:{input:function(t){return e.inputInteger("new_fans_count",t)}},model:{value:e.baseForm.new_fans_count,callback:function(t){e.$set(e.baseForm,"new_fans_count","string"===typeof t?t.trim():t)},expression:"baseForm.new_fans_count"}},[a("template",{slot:"append"},[e._v("人")])],2)],1)],1),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"同时最高在线人数"}},[a("el-input",{attrs:{maxlength:"12",placeholder:"0"},on:{input:function(t){return e.inputInteger("max_uv",t)}},model:{value:e.baseForm.max_uv,callback:function(t){e.$set(e.baseForm,"max_uv","string"===typeof t?t.trim():t)},expression:"baseForm.max_uv"}},[a("template",{slot:"append"},[e._v("人")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"用户停留时长"}},[a("el-input",{attrs:{maxlength:"8",placeholder:"0"},on:{input:function(t){return e.inputInteger("avg_stay",t)}},model:{value:e.baseForm.avg_stay,callback:function(t){e.$set(e.baseForm,"avg_stay","string"===typeof t?t.trim():t)},expression:"baseForm.avg_stay"}},[a("template",{slot:"append"},[e._v("秒")])],2)],1)],1),a("div",{staticClass:"tg-dialog-section-title"},[a("span"),e._v("销售数据")]),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"GMV"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("gmv",t)}},model:{value:e.baseForm.gmv,callback:function(t){e.$set(e.baseForm,"gmv","string"===typeof t?t.trim():t)},expression:"baseForm.gmv"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"净销比例"}},[a("el-input",{attrs:{maxlength:"10",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("net_sales_rate",t)}},model:{value:e.baseForm.net_sales_rate,callback:function(t){e.$set(e.baseForm,"net_sales_rate","string"===typeof t?t.trim():t)},expression:"baseForm.net_sales_rate"}},[a("template",{slot:"append"},[e._v("%")])],2)],1)],1),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"预估当日净销额"}},[a("el-input",{attrs:{maxlength:"18",disabled:"",value:e.net_sales_amount,placeholder:"- -"}},[a("template",{slot:"append"},[e._v("元")])],2)],1)],1),a("div",{staticClass:"tg-dialog-section-title"},[a("span"),e._v("投放数据")]),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"投放金额"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("promote_amount",t)}},model:{value:e.baseForm.promote_amount,callback:function(t){e.$set(e.baseForm,"promote_amount","string"===typeof t?t.trim():t)},expression:"baseForm.promote_amount"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"定向投放ROI（倍数）"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("roi",t)}},model:{value:e.baseForm.roi,callback:function(t){e.$set(e.baseForm,"roi","string"===typeof t?t.trim():t)},expression:"baseForm.roi"}},[a("template",{slot:"append"},[e._v("倍")])],2)],1)],1),a("div",{staticClass:"tg-dialog-section-title"},[a("span"),e._v("收入数据")]),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"佣金比例"}},[a("el-input",{attrs:{maxlength:"10",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("commission_rate",t)}},model:{value:e.baseForm.commission_rate,callback:function(t){e.$set(e.baseForm,"commission_rate","string"===typeof t?t.trim():t)},expression:"baseForm.commission_rate"}},[a("template",{slot:"append"},[e._v("%")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"预估当日佣金"}},[a("el-input",{attrs:{maxlength:"18",disabled:"",value:e.commission_amount,placeholder:"- -"}},[a("template",{slot:"append"},[e._v("元")])],2)],1)],1),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"每日到账金额"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("income_amount",t)}},model:{value:e.baseForm.income_amount,callback:function(t){e.$set(e.baseForm,"income_amount","string"===typeof t?t.trim():t)},expression:"baseForm.income_amount"}},[a("template",{slot:"append"},[e._v("元")])],2)],1)],1)])],1)])],1)},Q=[],K=a(53451),ee=a.n(K);const{debounce:te}=ee();var ae=(0,n.defineComponent)({props:{visible:{type:Boolean,default:!1},title:{type:String,default:"日报详情"},data:{type:Object}},setup:function(e,t){const a=(0,n.ref)(null),i=(0,n.ref)({live_duration:"",new_fans_count:"",max_uv:"",avg_stay:"",gmv:"",net_sales_rate:"",net_sales_amount:"",promote_amount:"",roi:"",commission_rate:"",commission_amount:"",income_amount:"",...e.data}),r=(0,n.computed)((()=>{const e=i.value.gmv,t=i.value.net_sales_rate,a=e*(t/100);if(Number.isNaN(a))return"--";const r=a.toFixed(2).replace(/\.0+$/g,"").replace(/(\.[^0]+)(0+)$/g,"$1");return r})),o=(0,n.computed)((()=>{const e=i.value.gmv,t=i.value.net_sales_rate,a=e*(t/100);if(Number.isNaN(a))return"--";const r=i.value.commission_rate,n=a*(r/100);if(Number.isNaN(n))return"--";const o=n.toFixed(2).replace(/\.0+$/g,"").replace(/(\.[^0]+)(0+)$/g,"$1");return o})),s=()=>{t.emit("dialog:close"),t.root.$nextTick(l)},l=()=>{i.value.live_duration="",i.value.new_fans_count="",i.value.max_uv="",i.value.avg_stay="",i.value.gmv="",i.value.net_sales_rate="",i.value.net_sales_amount="",i.value.promote_amount="",i.value.roi="",i.value.commission_rate="",i.value.commission_amount="",i.value.income_amount=""},c=()=>{const e={...i.value};t.emit("saveSubmit",e)},u=te(c,200),d=(e,t)=>{i.value[e]=(0,j.nA)(t)},m=(e,t)=>{i.value[e]=t.replace(/[^\d]/g,"")};return{commission_amount:o,net_sales_amount:r,onCloseBtnClick:s,onSaveBtnClick:u,baseForm:i,formRef:a,inputAmount:d,inputInteger:m}}}),ie=ae,re=(0,k.Z)(ie,J,Q,!1,null,null,null),ne=re.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-common-business-mcn-form-dialog tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{width:"440px",visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1},on:{close:e.onCloseBtnClick},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{attrs:{size:"small"},on:{click:e.onCloseBtnClick}},[e._v("取消")]),a("tg-button",{attrs:{size:"small",type:"primary"},on:{click:e.onSaveBtnClick}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"dialog-content"},[a("el-form",{ref:"formRef",attrs:{"label-position":"top",size:"small","label-width":"106px"}},[a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"GMV"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("gmv",t)}},model:{value:e.mcnForm.gmv,callback:function(t){e.$set(e.mcnForm,"gmv","string"===typeof t?t.trim():t)},expression:"mcnForm.gmv"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"运营费用"}},[a("el-input",{attrs:{maxlength:"18",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("operating_amount",t)}},model:{value:e.mcnForm.operating_amount,callback:function(t){e.$set(e.mcnForm,"operating_amount","string"===typeof t?t.trim():t)},expression:"mcnForm.operating_amount"}},[a("template",{slot:"append"},[e._v("元")])],2)],1)],1),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"直播场次"}},[a("el-input",{attrs:{maxlength:"8",placeholder:"0"},on:{input:function(t){return e.inputInteger("live_count",t)}},model:{value:e.mcnForm.live_count,callback:function(t){e.$set(e.mcnForm,"live_count","string"===typeof t?t.trim():t)},expression:"mcnForm.live_count"}},[a("template",{slot:"append"},[e._v("场")])],2)],1),a("el-form-item",{staticClass:"mgb-18",attrs:{label:"开播时长"}},[a("el-input",{attrs:{maxlength:"8",placeholder:"0.00"},on:{input:function(t){return e.inputAmount("live_duration",t)}},model:{value:e.mcnForm.live_duration,callback:function(t){e.$set(e.mcnForm,"live_duration","string"===typeof t?t.trim():t)},expression:"mcnForm.live_duration"}},[a("template",{slot:"append"},[e._v("小时")])],2)],1)],1),a("div",{staticClass:"line-box"},[a("el-form-item",{staticClass:"mgb-18",attrs:{label:"开播主播数"}},[a("el-input",{attrs:{maxlength:"8",placeholder:"0"},on:{input:function(t){return e.inputInteger("anchor_count",t)}},model:{value:e.mcnForm.anchor_count,callback:function(t){e.$set(e.mcnForm,"anchor_count","string"===typeof t?t.trim():t)},expression:"mcnForm.anchor_count"}},[a("template",{slot:"append"},[e._v("人次")])],2)],1)],1)])],1)])],1)},se=[];const{debounce:le}=ee();var ce,ue,de,me,pe,_e,ve=(0,n.defineComponent)({props:{visible:{type:Boolean,default:!1},title:{type:String,default:"日报详情"},data:{type:Object}},setup(e,t){const a=(0,n.ref)(null),i=(0,n.ref)({gmv:"",operating_amount:"",live_count:"",live_duration:"",anchor_count:"",...e.data}),r=()=>{t.emit("dialog:close"),t.root.$nextTick(o)},o=()=>{i.value.gmv="",i.value.operating_amount="",i.value.live_count="",i.value.live_duration="",i.value.anchor_count=""},s=()=>{const e={...i.value};t.emit("saveSubmit",e)},l=(e,t)=>{i.value[e]=(0,j.nA)(t)},c=(e,t)=>{i.value[e]=t.replace(/[^\d]/g,"")},u=le(s,200);return{onCloseBtnClick:r,onSaveBtnClick:u,mcnForm:i,formRef:a,inputAmount:l,inputInteger:c}}}),fe=ve,ge=(0,k.Z)(fe,oe,se,!1,null,null,null),he=ge.exports,ye=(0,n.defineComponent)({props:{},components:{CalendarPage:U.Z,BaseDialog:ne,McnDialog:he},setup(e){const t=(0,w.t)(),a=t.currentRoute.params.id,i=(0,n.inject)("project")??(0,n.ref)(),r=(0,n.computed)((()=>i.value?.business_type)),o=(e,t,a)=>{const i=r.value;return(0,m.ME)(e,t,a,i)},s=e=>(0,m.yT)({...e,business_type:r.value,project_id:a}).then((e=>{if(!e.data.success)throw new Error(e.data.message);return e}));return{query:o,save:s,business_type:r}},render(){const e=arguments[0];return void 0!==this.business_type&&e("calendar-page",H()([{},{props:{query:this.query,save:this.save,type:4===this.business_type?"base":"mcn"}}]))||e("div")}}),be=ye,we=(0,k.Z)(be,ce,ue,!1,null,null,null),Ce=we.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("sub-tabs",[e.permission.common_business_project_settlement_view&&e.permission.common_live_project_gathering_view?[e.permission.common_business_project_settlement_view?a("settlementIncome",{attrs:{name:"结算",cooperationType:e.cooperation_type}}):e._e(),a("comp1",{attrs:{name:"应收"}}),a("comp2",{attrs:{name:"实收"}})]:e.permission.common_live_project_gathering_view?[a("comp1",{attrs:{name:"应收"}}),a("comp2",{attrs:{name:"实收"}})]:e.permission.common_business_project_settlement_view?a("settlementIncome",{attrs:{name:"结算",cooperationType:e.cooperation_type}}):e._e()],2)},je=[],De=a(58008),Se=a(85688),ke=(a(26699),a(98560)),Ae=a(91538),Pe=a(82741),Me=a(78066),Re=a(48606),Te=a(64236),Ne={useShopLiveAchievment(){const e=(0,n.ref)(!1),t=(0,n.ref)(!1),a=(0,n.ref)([]),i=(0,n.ref)(0),r=(0,n.ref)(0),o=(0,n.ref)(0);let s;const l=async n=>{if(void 0===n)return;s=n,t.value=!0;const[{data:l}]=await(0,Te.Dc)(500,(0,m.ij)(n)),c=l.data;a.value=c.data,e.value=!0,i.value=c.not_write_off,r.value=c.receivable,o.value=c.write_off,t.value=!1},c=()=>{l(s)},u=e=>(0,Me.oP)(e+"").then((e=>{e.data.success?(Re.Message.success(e.data.message),c()):Re.Message.error(e.data.message)}));return{init:e,loading:t,data:a,not_write_off:i,receivable:r,write_off:o,query:l,reload:c,deleteShopLiveAchievement:u}}},Fe=a(43847),Ve=a(93889),$e=a(39716),Ie=a(31279),Ee=a(2698),Le=a(10114),We=a(58302),Ze=(0,n.defineComponent)({components:{achievement:ke.Z,invoicelist:Ae.Z,InvoiceDetail:$e.Z,FirstStep:Ie.Z,reverseOrderDialog:Le.Z},setup(e,t){const a=(0,n.ref)(null),i=(0,n.ref)(null),r=(0,n.ref)(null),o=(0,n.inject)("project"),s=(0,n.ref)(void 0),l=(0,u.gI)(),c=(0,w.t)(),d=Ne.useShopLiveAchievment();(0,n.watch)((()=>o.value),(()=>{null!==o.value&&d.query({receivable_type:o.value.business_type,project_id:c.currentRoute.params.id})})),void 0!==o.value&&null!==o.value&&d.query({receivable_type:o.value.business_type,project_id:c.currentRoute.params.id});const m=async e=>{const a=await(0,Pe.I)(t,"确认删除该业绩？");a&&d.deleteShopLiveAchievement(e).then((()=>{d.reload()}))},p=(0,Fe.Pc)(),_=(e,t)=>[Ve.RJ.Sales,Ve.RJ.Framework].includes(e)?"/legal/contract/customer/"+t.toString():[Ve.RJ.ServiceContract].includes(e)?"/legal/contract/customerTemplate/"+t.toString():[Ve.RJ.Purchase,Ve.RJ.SupplierFramework].includes(e)?"/legal/contract/supplier/"+t.toString()+"?contract_type="+e.toString():[Ve.RJ.SupplierContract].includes(e)?"/legal/contract/supplierTemplate/"+t.toString()+"?contract_type="+e.toString():[Ve.RJ.AnchorContract].includes(e)?"/legal/contract/anchorTemplate/"+t.toString()+"?contract_type="+e.toString():"",v=32,f=0,g=0,h=0,y=(0,n.ref)(164),C=(0,We.Z)({compensation:(0,n.computed)((()=>v+f+g+h)),fixedBlockHeightRefs:[y],tableMinHeight:100}),D=e=>(0,n.h)("div",{class:"number-div"},[(0,n.h)("span",{class:"number-span table_achievement "+(e.reversed_id||e.refunded_id?"reverse-red":"")},e.receivable_uid)]),S=(e,t)=>{const a=e.reversed_id||e.refunded_id?"reverse-red":"";return t?e.receivable_uid:(0,n.h)("div",{class:a},[(0,j.dN)(e.receivable_amount,"")])},k=e=>(0,n.h)("div",{class:"number-div"},[(0,n.h)("span",{class:"number-span text "+(e.reversed_id||e.refunded_id?"reverse-red":"")},e.settlement_uid)]),A=(0,n.computed)((()=>[{label:"应收编号",minWidth:180,formatter:e=>D(e)},{label:"应收金额 (元)",headerAlign:"right",align:"right",minWidth:(0,x.zY)(d.data,"应收金额 (元)",S).value,formatter:e=>S(e,!1)},{label:"创建日期",minWidth:154,align:"center",formatter:e=>b()(e.create_date).format("YYYY.MM.DD")},{label:"结算单",minWidth:180,formatter:e=>k(e)},{label:"核销状态",minWidth:180,formatter:e=>{const t=(e.write_off_infos||[]).map((e=>[e.receipt_uid,e.write_off_amount,e.write_off_user,e.write_off_time]));(e.refund_write_off_infos||[]).forEach((e=>{t.push([e.cost_id,-1*(e.write_off_amount??0),e.write_off_user,e.write_off_time])}));const a=["单据编号","核销金额 (元)","核销人/日期"];return(0,n.h)(Ee.Z,{attrs:{is_reverse:e.reversed_id,write_off_header:a,write_off_infos:t,write_off_status:e.write_off_status}})}},{label:"操作",align:"center",fixed:"right",formatter:e=>{const t=[],a=l.common_business_write_off;return 2===e.write_off_status||e.reverse_id||e.reversed_id||!a||t.push((0,n.h)("a",{on:{click:()=>{s.value?.show({type:"isReceivable",id:e.id,amount:e.not_write_off_amount,leaf:"common_business",busType:e.receivable_type,receivable_uid:e.receivable_uid||e.achievement_uid})}}},["核销"])),(0,n.h)("div",{class:"operation-column"},t)}}]));return{columns:A,invoiceDialogRef:r,getContractJumpLink:_,deleteCollection:m,...d,achievementRef:a,invoicelistRef:i,permission:l,userinfo:p,firstStepRef:s,...C}},render(){const e=arguments[0];return e("tg-card",H()([{class:"project-collection flex-auto",attrs:{loading:this.loading}},{directives:[{name:"loading",value:this.loading}]}]),[e("div",{class:"header"},[e("span",{class:"label"},["应收金额："]),e("span",{class:"text"},[(0,j.dN)(this.receivable)]),e("span",{class:"label"},["已核销金额："]),e("span",{class:"text"},[(0,j.dN)(this.write_off)]),e("span",{class:"label"},["未核销金额："]),e("span",{class:"text"},[(0,j.dN)(this.not_write_off)])]),e("el-table",{attrs:{stripe:!0,border:!0,height:"calc(100% - 70px - 6px)",loading:this.loading,data:this.data},scopedSlots:{empty:()=>e("div",{style:"position: static;"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})])}},[this.columns.map(((t,a)=>e("el-table-column",H()([{},{props:{...t}},{key:a}]))))]),e(ke.Z,{ref:"achievementRef",on:{ok:()=>{this.reload()}}}),e(Ae.Z,{ref:"invoicelistRef"}),e($e.Z,H()([{},{ref:"invoiceDialogRef"}])),e("first-step",{ref:"firstStepRef",on:{submit:()=>{this.reload()}}})])}}),Ge=Ze,Oe=(0,k.Z)(Ge,de,me,!1,null,"012a0a4e",null),Be=Oe.exports,Ye={useShopLiveAchievment(){const e=(0,n.ref)(!1),t=(0,n.ref)(!1),a=(0,n.ref)([]),i=(0,n.ref)(0),r=(0,n.ref)(0),o=(0,n.ref)(0),s=(0,n.ref)(0),l=(0,n.ref)(0);let c;const u=async n=>{if(void 0===n)return;c=n,t.value=!0;const[u]=await(0,Te.Dc)(500,(0,Me.Wk)(n)),d=u.data.data,m=d.stat_info;a.value=d.data,e.value=!0,i.value=m.confirmed_gather_amount,r.value=m.total_gather_amount,o.value=m.wait_gather_amount,l.value=m.write_off_amount,s.value=m.not_write_off_amount,t.value=!1},d=()=>{u(c)},m=e=>(0,Me.qG)(e+"").then((e=>{e.data.success?(Re.Message.success(e.data.message),d()):Re.Message.error(e.data.message)}));return{init:e,loading:t,data:a,confirmed_gather_amount:i,total_gather_amount:r,wait_gather_amount:o,write_off_amount:l,not_write_off_amount:s,query:u,reload:d,deleteShopLiveAchievement:m}}},ze=a(89935),qe=a(64519),Xe=a(45781),He=a(49187),Ue=a(28348),Je=a(42386),Qe=a(85937),Ke=a.n(Qe),et=a(57325),tt=a(6283),at=a(79546),it=(0,n.defineComponent)({components:{achievement:ke.Z,invoicelist:Ae.Z,InvoiceDetail:$e.Z,FirstStep:Ie.Z,reverseOrderDialog:Le.Z,refundDialog:tt.Z,RefundWriteOff:at.Z},setup(e,t){const a=(0,n.ref)(void 0),i=(0,n.ref)(null),r=(0,n.ref)(null),o=(0,n.ref)(void 0),s=(0,n.ref)(!1),l=(0,n.ref)(""),c=(0,n.ref)(""),d=(0,n.ref)(!1),m=(0,n.ref)(!1),p=(0,n.ref)(void 0),_=(0,n.ref)(void 0),v=(0,n.ref)(void 0),f=(0,u.gI)(),g=(0,w.t)(),h=Ye.useShopLiveAchievment();h.query(g.currentRoute.params.id);const y=async(e,a)=>{const i=await(0,Pe.I)(t,a);i&&h.deleteShopLiveAchievement(e).then((()=>{h.reload()}))},b=(0,n.ref)(!1),C=(0,n.ref)({achievement_id:"",achievement_uid:"",project_name:"",gather_amount:0,project_id:"",business_type:""}),D=e=>{C.value.achievement_id=e.achievement_id,C.value.achievement_uid=e.achievement_uid,C.value.project_name=e.project_name,C.value.gather_amount=e.gather_amount,C.value.project_id=e.project_id,C.value.business_type=e.business_type,b.value=!0},S=()=>{C.value.achievement_id="",C.value.achievement_uid="",C.value.project_name="",C.value.gather_amount=0,C.value.project_id="",C.value.business_type="",b.value=!1},k=(0,Fe.Pc)(),A=(0,n.inject)("project"),P=(e,t)=>[Ve.RJ.Sales,Ve.RJ.Framework].includes(e)?"/legal/contract/customer/"+t.toString():[Ve.RJ.ServiceContract].includes(e)?"/legal/contract/customerTemplate/"+t.toString():[Ve.RJ.Purchase,Ve.RJ.SupplierFramework].includes(e)?"/legal/contract/supplier/"+t.toString()+"?contract_type="+e.toString():[Ve.RJ.SupplierContract].includes(e)?"/legal/contract/supplierTemplate/"+t.toString()+"?contract_type="+e.toString():[Ve.RJ.AnchorContract].includes(e)?"/legal/contract/anchorTemplate/"+t.toString()+"?contract_type="+e.toString():"",M=(0,n.ref)(null),R=async(e,a,i)=>{const r={id:e.achievement_id,reverse_reason:a,reverse_type:Ue.Jd.receive};let n;return s.value=!0,n=i?await(0,Je.Xz)(r):await(0,Je.Tu)(r),s.value=!1,n.data.success?(t.root.$message.success(n.data.message??"冲销成功"),h.reload()):t.root.$message.error(n.data.message??"冲销失败"),n.data.success},T=e=>{l.value=e.reverse_reason,d.value=!0,c.value="冲销原因"},N=e=>{l.value=e.reverse_back_reason,d.value=!0,c.value="冲销退回原因"},F=()=>{l.value="",d.value=!1},V=32,$=0,I=0,E=0,L=(0,n.ref)(164),W=(0,We.Z)({compensation:(0,n.computed)((()=>V+$+I+E)),fixedBlockHeightRefs:[L],tableMinHeight:100}),Z=(e,t)=>{if(t)return(0,j.QN)(e.achievement_uid)>(0,j.QN)(e.achievement_name)?e.achievement_uid:e.achievement_name;{const t=e.reversed_id?"reverse-red":void 0;return(0,n.h)("div",{class:"table_achievement"},[(0,n.h)("div",{class:t},[e.achievement_uid]),(0,n.h)("div",{class:"text"},[e.achievement_name])])}},G=(0,x.zY)(h.data,"收款编号/名称",Z,30),O=e=>{const t=null!==e.reversed_id,a=t?"冲销":ze.qw.find((t=>t.value===e.gather_type))?.label;return(0,n.h)("span",t?{class:"reverse-red"}:void 0,[a])},B=(e,t)=>{const a=`${(0,j.SJ)(new(Ke())(e.gather_amount))}`;return t||null===e.reversed_id?a:(0,n.h)("span",{class:"reverse-red"},[a])},Y=(0,x.zY)(h.data,"收款金额 (元)",B),z=(0,n.computed)((()=>[{label:"收款编号/名称",fixed:"left",minWidth:G.value,formatter:e=>Z(e,!1)},{label:"收款类型",minWidth:80,align:"center",prop:"gather_type",formatter:O},{label:"收款金额 (元)",prop:"gather_amount",align:"right",minWidth:Y.value,formatter:e=>B(e,!1)},{label:"收款账户",minWidth:120,align:"center",formatter:e=>{const t=ze.E1.find((t=>t.value===e.gather_way))?.label;return(0,n.h)("div",{class:"column-cell",style:{paddingLeft:"10px"}},[(0,n.h)("div",{class:"column-cell-line"},[(0,n.h)("span",{class:"label"},["方式："]),(0,n.h)("span",{class:"text"},[t])]),(0,n.h)("div",{class:"column-cell-line"},[(0,n.h)("span",{class:"label"},["详情："]),(0,n.h)("el-popover",{props:{trigger:"hover",placement:"left"}},[(0,n.h)("div",{class:"pop-container pop-finance"},[(0,n.h)("div",{class:"pop-header"},["收款账户"]),(0,n.h)("div",{class:"pop-row"},[(0,n.h)("span",{class:"label"},["收款方式："]),(0,n.h)("span",{class:"text"},[t])]),...1===e.gather_way?[(0,n.h)("div",{class:"pop-row"},[(0,n.h)("span",{class:"label"},["旺旺号"]),(0,n.h)("span",{class:"text"},[e.gather_way_detail.order_wangwang_id])]),(0,n.h)("div",{class:"pop-row"},[(0,n.h)("span",{class:"label"},["V任务ID："]),(0,n.h)("span",{class:"text"},[e.gather_way_detail.task_id])]),(0,n.h)("div",{class:"pop-row"},[(0,n.h)("span",{class:"label"},["接单时间："]),(0,n.h)("span",{class:"text"},[e.gather_way_detail.order_date])])]:[],...2===e.gather_way||3===e.gather_way?[(0,n.h)("div",{class:"pop-row"},[(0,n.h)("span",{class:"label"},["打款公司："]),(0,n.h)("span",{class:"text"},[e.gather_way_detail.pay_company_name])])]:[]]),(0,n.h)("a",{slot:"reference"},["查看"])])])])}},{label:"收款凭证",minWidth:80,align:"center",formatter:e=>e.gather_certificate_pic?(0,n.h)("button",{class:"tg-button",on:{click:()=>{qe.Z.showDetail((0,et.W)(e.gather_certificate_pic,!1))}}},["查看"]):"--"}]));return{columns:z,invoiceDialogRef:r,getContractJumpLink:P,deleteCollection:y,...h,achievementRef:a,invoicelistRef:i,permission:f,userinfo:k,firstStepRef:o,writeOffLoading:s,project:A,reverseOrderDialogRef:M,onWriteOffConfirmResolve:R,onViewReverseReason:T,reasonDialogTitle:c,onViewReverseBackReason:N,onReasonDialogClose:F,reason:l,reasonDialogVisible:d,...W,onRefundViewBtnClick:D,refundRow:C,refundDialogVisible:b,onRefundDialogClose:S,refundWriteOffId:p,refundWriteOffAchievementId:_,refundWriteOffAmount:v,refundWriteOffVisible:m}},render(){const e=arguments[0];return e("tg-card",H()([{class:"project-collection flex-auto tg-mcn-collection",attrs:{loading:this.loading}},{directives:[{name:"loading",value:this.loading}]}]),[e("div",{class:"header"},[e("span",{class:"label"},["登记收款："]),e("span",{class:"text"},[Xe.Z.formatPrice(this.total_gather_amount,He.WL.Yuan,!0)]),e("span",{class:"label"},["确认收款："]),e("span",{class:"text"},[Xe.Z.formatPrice(this.confirmed_gather_amount,He.WL.Yuan,!0)]),e("span",{class:"label"},["等待确认："]),e("span",{class:"text"},[Xe.Z.formatPrice(this.wait_gather_amount,He.WL.Yuan,!0)]),e("span",{class:"label"},["已核销金额："]),e("span",{class:"text"},[Xe.Z.formatPrice(this.write_off_amount,He.WL.Yuan,!0)]),e("span",{class:"label"},["未核销金额："]),e("span",{class:"text"},[Xe.Z.formatPrice(this.not_write_off_amount,He.WL.Yuan,!0)])]),e("el-table",{attrs:{stripe:!0,border:!0,height:"calc(100% - 70px - 6px)",loading:this.loading,data:this.data},scopedSlots:{empty:()=>e("div",{style:"position: static;"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})])}},[this.columns.map(((t,a)=>e("el-table-column",H()([{},{props:{...t}},{key:a}])))),e("el-table-column",{attrs:{label:"是否开票",align:"center",width:104},scopedSlots:{default:({row:t})=>e("div",{class:"column-cell",style:"padding-left:10px"},[e("div",{class:"column-cell-line"},[e("span",{class:"label"},["开票："]),e("span",{class:"text"},[1===t.is_invoice?"是":"否"])]),e("div",{class:"column-cell-line"},[e("span",{class:"label"},["发票："]),1===t.is_invoice&&t.invoice_info.length>0&&e("button",{slot:"reference",class:"tg-button",on:{click:()=>{this.invoicelistRef?.show({title:"发票详情",list:t.invoice_info.map((e=>(e.info=[{label:"发票号码",value:Xe.Z.formatEmpty(e.invoice_num)},{label:"开票时间",value:Xe.Z.formatTime(e.invoice_date)},{label:"开票金额",value:Xe.Z.formatPrice(e.amount,He.WL.Yuan)},{label:"开票公司",value:Xe.Z.formatEmpty(e.institution)}],e))),type:0})}}},["查看"]),(1!==t.is_invoice||0===t.invoice_info.length)&&"--"])])}}),e("el-table-column",{attrs:{label:"关联单据","min-width":238},scopedSlots:{default:({row:t})=>{const a=!!t.contract_id;return e("div",{class:"column-cell column-cell-start"},[e("div",{class:"column-cell-line"},[e("span",{class:"label"},["关联合同："]),a?e("span",{class:"text",style:"color: #2877FF; cursor: pointer",on:{click:()=>{const e=this.getContractJumpLink(t.contract_type,t.contract_id);e&&window.open(e)}}},[Xe.Z.formatEmpty(t.contract_uid)]):e("span",{class:"text"},["--"])]),e("div",{class:"column-cell-line"},[e("span",{class:"label"},["开票审批："]),e("span",H()([{class:t.approval_uid?"hover-link":""},{on:{click:()=>{t.invoice_apply_id&&this.invoiceDialogRef?.open(t.invoice_apply_id)}}}]),[t.approval_uid??"--"])])])}}}),e("el-table-column",{attrs:{label:"财务确认信息","min-width":150},scopedSlots:{default({row:t}){const a=1===t.is_gather,i=1!==t.gather_way;return 1!==t.is_gather?e("span",{style:{color:"#FF7A36"}},["待确认"]):e("div",{class:"column-cell"},[e("div",{class:"column-cell-line"},[e("span",{class:"label"},["状态："]),e("span",{class:"text"},[1===t.is_gather?"已确认":"未确认"])]),e("div",{class:"column-cell-line"},[e("span",{class:"label"},["收款时间："]),e("span",{class:"text"},[Xe.Z.formatEmpty(t.gather_confirm_detail?t.gather_confirm_detail.order_date:"")])]),i&&e("div",{class:"column-cell-line"},[e("span",{class:"label"},["详情："]),e("el-popover",{attrs:{trigger:"hover",placement:"left"}},[e("div",{class:"pop-container pop-finance"},[e("div",{class:"pop-header"},["财务确认信息"]),e("div",{class:"pop-row"},[e("span",{class:"label"},["收款时间："]),e("span",{class:"text"},[Xe.Z.formatEmpty(t.gather_confirm_detail?t.gather_confirm_detail.order_date:"")])]),e("div",{class:"pop-row"},[e("span",{class:"label"},["名称："]),e("span",{class:"text"},[Xe.Z.formatEmpty(t.gather_confirm_detail?t.gather_confirm_detail.pay_company_name:"")])]),e("div",{class:"pop-row"},[e("span",{class:"label"},["账号："]),e("span",{class:"text"},[Xe.Z.formatEmpty(t.gather_confirm_detail?t.gather_confirm_detail.account:"")])]),3===t.gather_way&&e("div",{class:"pop-row"},[e("span",{class:"label"},["开户行："]),e("span",{class:"text"},[Xe.Z.formatEmpty(t.gather_confirm_detail?t.gather_confirm_detail.bank_of_deposit:"")])])]),a?e("button",{slot:"reference",class:"tg-button"},["预览"]):e("span",{slot:"reference"},["--"])])])])}}}),e("el-table-column",{attrs:{label:"核销状态",width:120},scopedSlots:{default({row:t}){let a=[];a=5===t.gather_type?(t.refund_write_off_info_items||[]).map((e=>[e.settlement_uid,e.payable_uid,-1*(e.write_off_amount??0),e.write_off_user,e.write_off_time])):(t.write_off_infos||[]).map((e=>[e.settlement_uid,e.receivable_uid,e.write_off_amount,e.write_off_user,e.write_off_time]));const i=["结算单编号",5===t.gather_type?"应付编号":"应收编号","核销金额 (元)","核销人/日期"];return e(Ee.Z,{attrs:{is_reverse:t.reversed_id,write_off_header:i,write_off_infos:a,write_off_status:5===t.gather_type?t.refund_write_off_status:t.write_off_status}})}}}),e("el-table-column",{attrs:{label:"冲销状态","min-width":80,align:"center"},scopedSlots:{default({row:t}){let a;return 1===t.reverse_status?a=e("div",{style:"color: #ff7a36"},["待确认"]):2===t.reverse_status?a=e("div",{style:"color: #02ba3c"},["已确认"]):3===t.reverse_status&&(a=e("div",{style:"color: #e91313"},["退回"])),a??"--"}}}),e("el-table-column",{attrs:{label:"录入人/日期",width:102},scopedSlots:{default:({row:t})=>e("div",{class:"table_achievement"},[e("div",[t.add_by??"--"]),e("div",{class:"text"},[b()(t.gmt_create).format("YYYY.MM.DD")])])}}),e("el-table-column",{attrs:{label:"操作","min-width":160,fixed:"right"},scopedSlots:{default:({row:t})=>{const a=t.add_by_id===this.userinfo.id,i=0===t.is_gather,r=this.permission.common_business_project_end_project,n=this.permission.common_business_write_off;let o,s;const l=t.not_refund_amount>0&&1===t.is_gather&&!t.reverse_id&&(1===t.gather_type||2===t.gather_type||3===t.gather_type),c=1===t.is_gather&&5===t.gather_type&&!t.reverse_id&&!t.reversed_id&&2!==t.refund_write_off_status,u=e("tg-button",{class:"mgr-12",attrs:{type:"link"},on:{click:()=>{this.refundWriteOffAmount=new(Ke())(t.gather_amount?t.gather_amount:0).sub(new(Ke())(t.refund_write_off_amount?t.refund_write_off_amount:0)).toNumber(),this.refundWriteOffId=t.refund_cost_id,this.refundWriteOffAchievementId=t.achievement_id,this.refundWriteOffVisible=!0}}},["核销"]);return t.reversed_id?s=3!==t.reverse_status?e("a",{on:{click:()=>{this.onViewReverseReason(t)}}},["查看"]):e("div",[e("a",{on:{click:()=>{this.deleteCollection(t.achievement_id,"是否删除该冲销单")}},class:"mgr-12"},["删除"]),e("a",{on:{click:()=>{this.reverseOrderDialogRef?.open((e=>this.onWriteOffConfirmResolve(t,e,!0)),t.reverse_reason)}},class:"mgr-12"},["重新提交"]),e("a",{on:{click:()=>{this.onViewReverseBackReason(t)}}},["退回原因"])]):t.reverse_id||(0!==t.write_off_status&&1!==t.write_off_status||!n||1===t.is_gather&&4!==t.business_type&&5!==t.gather_type&&(o=e("a",{class:"mgr-12",on:{click:()=>{this.firstStepRef?.show({type:"isActualIncome",id:t.achievement_id,amount:t.not_write_off_amount,leaf:"common_business",busType:t.business_type,receivable_uid:t.receivable_uid||t.achievement_uid})}}},["核销"])),1!==t.is_gather||5===t.gather_type||t.has_refund||(s=e("a",{on:{click:()=>{this.reverseOrderDialogRef?.open((e=>this.onWriteOffConfirmResolve(t,e,!1)))}},class:"reverse-red mgr-12"},["冲销"]))),e("div",{class:"operation-column"},[s,o,a&&i&&r&&e("button",{class:"tg-button",on:{click:()=>{const e={achievement_name:t.achievement_name,gather_type:t.gather_type,gather_amount:t.gather_amount,gather_way:t.gather_way,contract_id:t.contract_id,is_invoice:t.is_invoice,invoice_apply_id:t.invoice_apply_id,achievement_id:t.achievement_id,id:t.settlement_id,company_name:t.customer_company_name,revenue_flow_id:t.revenue_flow_id},a=t.gather_way_detail;if(a&&(e.order_date=a.order_date,e.order_wangwang_id=a.order_wangwang_id,e.task_id=a.task_id,e.pay_company_name=a.pay_company_name),t.gather_certificate_pic){const a=new RegExp("\\/([^\\/]+)$"),i=a.exec(t.gather_certificate_pic);let r;i&&(r=i[1]),e.gather_certificate_pic={name:r,value:t.gather_certificate_pic}}t.contract_id&&(e.search_contract_list_value=[{label:t.contract_uid,value:t.contract_id}]),t.invoice_apply_id&&(e.search_invoice_apply_value=[{label:t.approval_uid,value:t.invoice_apply_id}]);const i="CommonBusinessProjectDetail"===this.$route.name,r="SSLiveProjectDetail"===this.$route.name,n="MarketingProjectDetail"===this.$route.name;this.achievementRef?.show(e,{isMcn:i,isBrand:r,isMarketing:n})}}},["编辑"]),a&&i&&r&&e("button",{on:{click:()=>this.deleteCollection(t.achievement_id,"确认删除该业绩？")},class:"tg-button"},["删除"]),l&&e("button",{on:{click:()=>this.onRefundViewBtnClick(t)},class:"tg-button mgr-12"},["退款"]),c&&u])}}})]),e(ke.Z,{attrs:{type:1},ref:"achievementRef",on:{ok:()=>{this.reload()}}}),e(Ae.Z,{ref:"invoicelistRef"}),e($e.Z,H()([{},{ref:"invoiceDialogRef"}])),e("first-step",{ref:"firstStepRef",on:{submit:()=>{this.reload()}}}),e("el-dialog",{class:"tg-dialog-classic tg-dialog-vcenter",attrs:{visible:this.reasonDialogVisible,width:"440px",title:this.reasonDialogTitle},on:{close:()=>{this.onReasonDialogClose()}}},[e("div",{class:"reason-dialog-content"},[this.reason])]),e("refund-write-off",{attrs:{type:"pay",notWriteOffAmount:this.refundWriteOffAmount,refund_cost_id:this.refundWriteOffId,achievement_id:this.refundWriteOffAchievementId,visible:this.refundWriteOffVisible},on:{cancel:()=>this.refundWriteOffVisible=!1,save:()=>{this.refundWriteOffVisible=!1,this.reload()}}}),e(Le.Z,{ref:"reverseOrderDialogRef"}),this.refundDialogVisible?e(tt.Z,H()([{attrs:{visible:this.refundDialogVisible,row:this.refundRow}},{on:{"dialog:close":()=>{this.refundDialogVisible=!1,this.reload()}}}])):"",e("tg-mask-loading",{attrs:{visible:this.writeOffLoading,content:"正在提交冲销，请稍候..."}})])}}),rt=it,nt=(0,k.Z)(rt,pe,_e,!1,null,"7a9f363c",null),ot=nt.exports,st=(0,n.defineComponent)({components:{SubTabs:De.Z,settlementIncome:Se.Z,comp1:Be,comp2:ot},setup(){const e=(0,u.gI)(),t=JSON.stringify((0,n.inject)("project",{cooperation_type:0})),a=JSON.parse(t);let i=(0,n.ref)(0);return a.value&&(i=a.value.cooperation_type||0),{cooperation_type:i,permission:e}}}),lt=st,ct=(0,k.Z)(lt,xe,je,!1,null,null,null),ut=ct.exports,dt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("sub-tabs",[e.permission.common_business_project_settlement_view&&e.permission.common_business_project_view_common_project_paid?[a("settlement-cost",{attrs:{name:"结算"}}),a("comp1",{attrs:{name:"应付"}}),a("comp2",{attrs:{name:"实付"}})]:e.permission.common_business_project_settlement_view?[a("settlement-cost",{attrs:{name:"结算",isareacost:!0,cooperationType:e.cooperation_type}})]:e.permission.common_business_project_view_common_project_paid?[a("comp1",{attrs:{name:"应付"}}),a("comp2",{attrs:{name:"实付"}})]:e._e()],2)},mt=[],pt=a(36165),_t=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tg-card",e._b({staticClass:"tg-common-business-tab-payable-need flex-auto",on:{"rect:update":e.onRectUpdate}},"tg-card",e.cardProps,!1),[a("div",{staticClass:"btns-line mgb-12 mgt-12"},[a("label",[e._v("应付金额：")]),a("span",[e._v(e._s(e.formatAmount(e.info.payable)))]),a("label",[e._v("已核销金额：")]),a("span",[e._v(e._s(e.formatAmount(e.info.write_off)))]),a("label",[e._v("未核销金额：")]),a("span",[e._v(e._s(e.formatAmount(e.info.not_write_off)))])]),a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{stripe:"",border:"",data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无数据"}})]},proxy:!0}])},"el-table",e.tableProps,!1),e._l(e.columns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),1),a("first-step",{ref:"firstStepRef",on:{submit:e.getList}}),e.paymentDialogVisible?a("payment-dialog",{attrs:{visible:e.paymentDialogVisible,data:e.paymentData,projectType:3},on:{"update:visible":function(t){e.paymentDialogVisible=t},"dialog:close":function(t){e.paymentDialogVisible=!1}}}):e._e()],1)},vt=[],ft=a(62068),gt=a(35049),ht=(0,n.defineComponent)({name:"TgMarketingProjectTabNeed",components:{WriteListPop:ft.Z,FirstStep:Ie.Z,PaymentDialog:gt.Z},setup:function(e,t){const a=(0,w.t)(),i=a.currentRoute.params.id,r=(0,n.inject)("project")??(0,n.ref)(),o=(0,n.computed)((()=>r.value)),s=o.value?.business_type,l=(0,n.ref)(!1),c=(0,u.gI)(),d=(0,n.ref)(void 0),p=(0,n.ref)({project_name:o.value?.project_name,project_id:o.value?.id,business_type:o?.value?.business_type});(0,n.watch)((()=>r.value),(()=>{o.value?.business_type&&(g(),p.value={project_name:o.value?.project_name,project_id:o.value?.id,business_type:o?.value?.business_type})}));const _=(0,n.ref)(!1),v=(0,n.ref)({payable:0,write_off:0,not_write_off:0}),f=(0,n.ref)([]),g=async()=>{_.value=!0;const e={project_id:i,payable_type:s},a=await(0,m.LE)(e);if(a.data.success){const e=a.data.data;f.value=e.data,v.value={payable:e.payable,write_off:e.write_off,not_write_off:e.not_write_off},_.value=!1}else t.root.$message.error(a.data.message)},h=e=>{d.value?.show({type:"isPayable",id:e.id,amount:e.not_write_off_amount,leaf:"common_business",busType:e.receivable_type,receivable_uid:e.payable_uid})};(0,n.onMounted)((()=>{i&&s&&g()}));const y=32,b=0,C=0,D=0,S=(0,n.ref)(146),k=(0,We.Z)({compensation:(0,n.computed)((()=>y+b+C+D)),fixedBlockHeightRefs:[S],tableMinHeight:100}),A=e=>(0,n.h)("div",{class:"number-div"},[(0,n.h)("span",{class:"number-span "+(e.reversed_id||e.refunded_id?"reverse-red":"")},e.payable_uid)]),P=(e,t)=>{const a=e.reversed_id||e.refunded_id?"reverse-red":"",i=String((0,j.dN)(e.payable_amount,""));return t?i:(0,n.h)("div",{class:a},[i])},M=e=>(0,n.h)("div",{class:"number-div"},[(0,n.h)("span",{class:"number-span text "+(e.reversed_id||e.refunded_id?"reverse-red":"")},e.settlement_uid)]),R=(0,n.computed)((()=>[{label:"应付编号",minWidth:180,formatter:e=>A(e)},{label:"应付金额 (元)",headerAlign:"right",align:"right",minWidth:(0,x.zY)(f,"应付金额 (元)",P).value,formatter:e=>P(e,!1)},{label:"创建日期",minWidth:154,align:"center",formatter:e=>e.create_date},{label:"结算单",minWidth:180,formatter:e=>M(e)},{label:"核销状态",minWidth:180,align:"center",formatter:e=>{const t=[];let a;if(a=2===e.write_off_status?(0,n.h)("p",{class:"write-on"},["已核销"]):1===e.write_off_status?(0,n.h)("p",{class:"write-off"},["部分核销"]):(0,n.h)("p",{class:"write-off"},["未核销"]),t.push((0,n.h)("div",{class:"line-info",style:{width:"100%",display:"flex",justifyContent:"center"}},[(0,n.h)("p",{class:"label-50"},["状态："]),a])),e.write_off_infos.length>0){const a=[...e.write_off_infos];e.refund_write_off_info_items.forEach((e=>{a.push({cost_id:e.achievement_uid,cost_uid:e.achievement_uid,write_off_amount:-1*(e.write_off_amount??0),write_off_time:e.write_off_time,write_off_user:e.write_off_user})})),t.push((0,n.h)("div",{class:"line-info",style:{width:"100%",display:"flex",justifyContent:"center",paddingLeft:"10px"}},[(0,n.h)("p",{class:"label-50"},["详情："]),(0,n.h)(ft.Z,{class:"label-70",props:{list:a,type:"payable"}})]))}return t}},{label:"操作",align:"center",fixed:"right",formatter:e=>2===e.write_off_status||!c.common_business_write_off||e.reverse_id||e.reversed_id||e.refunded_id?"":(0,n.h)("tg-button",{props:{type:"link"},on:{click:()=>h(e)}},["核销"])}])),T=()=>{l.value=!0};return{columns:R,loading:_,info:v,list:f,formatAmount:j.dN,Permission:c,firstStepRef:d,handleWriteOff:h,getList:g,...k,paymentDialogVisible:l,showPaymentDialog:T,paymentData:p}}}),yt=ht,bt=(0,k.Z)(yt,_t,vt,!1,null,null,null),wt=bt.exports,Ct=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tg-card",e._b({staticClass:"tg-common-business-tab-payable-need flex-auto",on:{"rect:update":e.onRectUpdate}},"tg-card",e.cardProps,!1),[a("div",{staticClass:"btns-line mgb-12 mgt-12"},[a("label",[e._v("登记付款：")]),a("span",[e._v(e._s(e.formatAmount(e.info.total_pay_amount)))]),a("label",[e._v("已付款：")]),a("span",[e._v(e._s(e.formatAmount(e.info.paid_amount)))]),a("label",[e._v("待付款：")]),a("span",[e._v(e._s(e.formatAmount(e.info.wait_pay_amount)))]),a("label",[e._v("已核销金额：")]),a("span",[e._v(e._s(e.formatAmount(e.info.write_off_amount)))]),a("label",[e._v("未核销金额：")]),a("span",[e._v(e._s(e.formatAmount(e.info.not_write_off_amount)))])]),a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{stripe:"",border:"",data:e.list,"cell-style":{cursor:"pointer"}},on:{"row-click":function(t){return t.target!==t.currentTarget?null:e.onRowClick.apply(null,arguments)}},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无数据"}})]},proxy:!0}])},"el-table",e.tableProps,!1),[e._l(e.columns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),e._e()],2),e.shouldVisible?a("payable-actual",{attrs:{visible:e.shouldVisible,title:e.title,data:e.dialogData},on:{closeAction:e.handleCloseAction,saveSubmit:e.handleSucceedAction}}):e._e(),a("invoice-list",{ref:"invoicelistRef"}),a("first-step",{ref:"firstStepRef",on:{submit:e.getList}}),a("finance-invoice-detail-dialog",{attrs:{visible:e.invoiceShow,list:e.invoiceList},on:{closeFinanceInvoiceDetailAction:e.closeInvoice}}),a("reverseOrderDialog",{ref:"reverseOrderDialogRef"}),a("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter",attrs:{visible:e.reasonVisible,width:"440px"},on:{close:e.onReasonDialogClose},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.reasonTitle))]},proxy:!0}])},[a("div",{staticClass:"reason-dialog-content"},[e._v(e._s(e.reason))])]),a("tg-mask-loading",{attrs:{visible:e.writeOffLoading,content:"正在提交冲销，请稍候..."}}),a("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"正在保存，请稍候..."}}),a("pay-refund",{attrs:{rawAmount:e.payRefundAmout,visible:e.payRefundVisible,costId:e.payRefundCostId},on:{"update:visible":function(t){e.payRefundVisible=t},save:e.onPayRefundSave}}),a("refund-write-off",{attrs:{type:"receive",projectType:3,visible:e.refundWriteOffVisible,notWriteOffAmount:e.notRefundWriteOffAmount,invoiceId:e.refundWriteoffId,costId:e.refundWriteoffCostId},on:{"update:visible":function(t){e.refundWriteOffVisible=t},save:e.onRefundWriteOffSave}}),e.loanDetailVisible?a("LoanfinanceDetailModal",{attrs:{visible:e.loanDetailVisible,detailroval:e.detailroval},on:{"dialog:closerow":e.onLoanDetailClose}}):e._e()],1)},xt=[],jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-common-business-payable-actual-dialog tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{visible:e.visible,width:"440px",top:"119px","close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1},on:{close:e.handleCloseAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.handleCloseAction}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.handleSaveAction}},[e._v("保存")])]},proxy:!0}])},[a("el-form",{ref:"formRef",attrs:{model:e.form,"label-position":"top",size:"small","label-width":"106px"}},[a("el-form-item",{attrs:{label:"打款金额：",size:"medium",prop:"pay_amount",rules:{required:!0,validator:function(t,a,i){""===a||void 0===a?i(new e.Error("请输入打款金额")):0===Number(a)?i(new e.Error("费用金额必须大于0")):i()},trigger:["blur"]}}},[a("el-input",{attrs:{maxlength:"18",placeholder:"请输入打款金额"},on:{input:function(t){return e.inputAmount("pay_amount",t)}},model:{value:e.form.pay_amount,callback:function(t){e.$set(e.form,"pay_amount",t)},expression:"form.pay_amount"}})],1),a("el-form-item",{attrs:{label:"用款日期：",size:"medium",rules:{required:!0,message:"请选择用款日期",trigger:"change"},prop:"transfer_date"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请选择用款日期",editable:!1,format:"yyyy.MM.dd","value-format":"yyyy.MM.dd"},model:{value:e.form.transfer_date,callback:function(t){e.$set(e.form,"transfer_date",t)},expression:"form.transfer_date"}})],1),a("el-form-item",{attrs:{label:"收款方：",size:"medium",maxlength:"20",prop:"pay_way_detail.name",rules:{required:!0,message:"请输入收款方",trigger:"blur"}}},[a("el-input",{attrs:{maxlength:"20",placeholder:"请输入收款方"},model:{value:e.form.pay_way_detail.name,callback:function(t){e.$set(e.form.pay_way_detail,"name",t)},expression:"form.pay_way_detail.name"}})],1),a("el-form-item",{attrs:{label:"付款方式：",size:"medium",prop:"pay_way",rules:{required:!0,message:"请选择付款方式",trigger:"blur"}}},[a("el-radio-group",{model:{value:e.form.pay_way,callback:function(t){e.$set(e.form,"pay_way",t)},expression:"form.pay_way"}},[a("el-radio",{attrs:{label:1}},[e._v("对公银行")]),a("el-radio",{attrs:{label:4}},[e._v("支付宝")]),a("el-radio",{attrs:{label:2}},[e._v("V任务")])],1)],1),a("el-form-item",{attrs:{label:"付款事由：",size:"medium",prop:"pay_reason",rules:{required:!0,message:"请输入付款事由",trigger:"blur"}}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入付款事由",maxlength:"100","show-word-limit":""},model:{value:e.form.pay_reason,callback:function(t){e.$set(e.form,"pay_reason",t)},expression:"form.pay_reason"}})],1)],1)],1)],1)},Dt=[];const{debounce:St}=ee();var kt=(0,n.defineComponent)({props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object}},setup(e,t){const a=(0,n.ref)(null),i=(0,n.ref)({pay_amount:"",transfer_date:"",pay_reason:"",pay_way:1,pay_way_detail:{name:""},...e.data}),r=()=>{t.emit("closeAction"),t.root.$nextTick(o)},o=()=>{i.value.pay_amount="",i.value.transfer_date="",i.value.pay_reason="",i.value.pay_way=1,i.value.pay_way_detail.name="",setTimeout((()=>{a.value?.clearValidate()}),100)},s=()=>{t.refs.formRef.validate((e=>{if(e){const e={...i.value,pay_amount:Number(i.value.pay_amount)};t.emit("saveSubmit",e)}}))},l=(e,t)=>{i.value[e]=(0,j.nA)(t)},c=St(s,200);return{handleCloseAction:r,handleSaveAction:c,form:i,formRef:a,inputAmount:l,Error:Error,Number:Number}}}),At=kt,Pt=(0,k.Z)(At,jt,Dt,!1,null,null,null),Mt=Pt.exports,Rt=a(86611),Tt=a(74750),Nt=a(67578),Ft=a(70727),Vt=a(92656),$t=(0,n.defineComponent)({name:"TgMarketingProjectTabActual",components:{WriteListPop:ft.Z,PayableActual:Mt,InvoiceList:Ae.Z,FirstStep:Ie.Z,FinanceInvoiceDetailDialog:Rt.Z,reverseOrderDialog:Le.Z,PayRefund:Ft.Z,RefundWriteOff:at.Z,LoanfinanceDetailModal:Vt.Z},setup:function(e,t){const a=(0,w.t)(),i=a.currentRoute.params.id,r=(0,n.inject)("project")??(0,n.ref)(),o=(0,n.computed)((()=>r.value)),s=o.value?.business_type,l=(0,n.ref)(!1),c=(0,n.ref)(!1),d=(0,n.ref)(void 0),p=(0,n.ref)(void 0),_=(0,n.ref)(void 0),v=(0,n.ref)(void 0),f=(0,n.ref)(!1),g=(0,n.ref)(""),h=(0,n.ref)(""),y=(0,n.ref)(!1),b=(0,n.ref)(!1),C=(0,n.ref)(void 0),D=(0,u.gI)(),S=(0,n.ref)(void 0),k=(0,Fe.Pc)(),A=(0,n.ref)(!1),P=(0,n.ref)([]),M=(0,n.ref)({total_pay_amount:0,paid_amount:0,wait_pay_amount:0,write_off_amount:0,not_write_off_amount:0}),R=(0,n.ref)(void 0),T=(0,n.ref)(!1),N=(0,n.ref)(""),F=(0,n.ref)(void 0),V=(0,n.ref)({pay_amount:"",transfer_date:"",pay_reason:"",pay_way:1,pay_way_detail:{name:""}}),$=e=>{F.value=e.cost_id,V.value={pay_amount:e.pay_amount,transfer_date:e.transfer_date,pay_reason:e.pay_reason,pay_way:e.pay_way,pay_way_detail:e.pay_way_detail},N.value="编辑登记成本",T.value=!T.value},I=(0,n.ref)(null),E=async(e,a,i)=>{const r={id:e.cost_id,reverse_reason:a,reverse_type:Ue.Jd.payment};let n;return l.value=!0,n=i?await(0,Je.Xz)(r):await(0,Je.Tu)(r),l.value=!1,n.data.success?(t.root.$message.success(n.data.message??"冲销成功"),z()):t.root.$message.error(n.data.message??"冲销失败"),n.data.success},L=(e,t)=>{I.value?.open((a=>E(e,a,t)),e.reverse_reason)},W=e=>{f.value=!0,g.value="冲销原因",h.value=e.reverse_reason},Z=e=>{f.value=!0,g.value="冲销退回原因",h.value=e.reverse_back_reason},G=()=>{h.value="",f.value=!1},O=()=>{T.value=!1,F.value=void 0,V.value={pay_amount:"",transfer_date:"",pay_reason:"",pay_way:1,pay_way_detail:{name:""}}},B=async e=>{const a=Number(i),r={project_id:a,...e};F.value&&(r.cost_id=F.value),c.value=!0;const n=await(0,m.eF)(r);c.value=!1,n.data.success?(T.value=!T.value,V.value={pay_amount:"",transfer_date:"",pay_reason:"",pay_way:1,pay_way_detail:{name:""}},t.root.$message.success("保存通用业务成本成功！"),z()):t.root.$message.error(n.data.message)},Y=async(e,a)=>{const i=await(0,Pe.I)(t,a);if(!i)return;const r=await(0,m.Cv)(e);r.data.success?(t.root.$message.success("删除成功！"),z()):(z(),t.root.$message.error(r.data.message))},z=async()=>{A.value=!0;const e=await(0,m.cm)(i);if(e.data.success){const t=e.data.data;P.value=t.list,M.value={total_pay_amount:t.total_pay_amount,paid_amount:t.paid_amount,wait_pay_amount:t.wait_pay_amount,write_off_amount:t.write_off_amount,not_write_off_amount:t.not_write_off_amount},A.value=!1}else t.root.$message.error(e.data.message)},q=(0,n.ref)(!1),X=(0,n.ref)([]),H=e=>{X.value=e,q.value=!0},U=()=>{q.value=!1},J=e=>{const t=e.split(",");1===t.length?qe.Z.showDetail(t[0]+"?Authorization="+(0,Tt.LP)()):R.value?.show({title:"打款凭证",list:t.map((e=>e+"?Authorization="+(0,Tt.LP)())),type:1})},Q=e=>{S.value?.show({type:"isActual",id:e.cost_id,amount:e.not_write_off_amount,leaf:"common_business",busType:e.business_type,receivable_uid:e.cost_id})},K=e=>Nt.rt.get(e)??"--",ee=e=>{switch(e){case 1:return"银行卡";case 2:return"V任务";case 3:return"对公银行";case 4:return"支付宝";default:return"--"}},te=e=>{switch(e){case 0:return"待打款";case 1:return"已打款";case-1:return"待发起打款";default:return"--"}},ae=e=>{switch(e){case 1:return"成本";case 2:return"退款";default:return"--"}};(0,n.onMounted)((()=>{i&&z()}));const ie=32,re=0,ne=0,oe=0,se=(0,n.ref)(146),le=(0,We.Z)({compensation:(0,n.computed)((()=>ie+re+ne+oe)),fixedBlockHeightRefs:[se],tableMinHeight:100}),ce=(e,t)=>{const a=e.reversed_id?"reverse-red":"",i=e.uid;return t?i:(0,n.h)("div",{class:a},[i])},ue=(e,t)=>{const a=e.reversed_id?"reverse-red":"",i=String((0,j.dN)(e.pay_amount,""));return t?i:(0,n.h)("div",{class:a},[i])},de=(e,t)=>{const a=e.pay_reason||"--",{is_folded:i,folded_text:r}=(0,j.zb)(a,12);return t||!i?r:(0,n.h)("el-popover",{props:{placement:"right",trigger:"hover",width:"220",content:a}},[(0,n.h)("div",{slot:"reference"},[r])])},me=(e,t)=>{const a=e.cost_company_name||"--",{is_folded:i,folded_text:r}=(0,j.zb)(a,12);return t||!i?r:(0,n.h)("el-popover",{props:{placement:"right",trigger:"hover",content:a}},[(0,n.h)("span",{slot:"reference"},[r])])},pe=(0,n.computed)((()=>[{label:"付款编号",minWidth:(0,x.zY)(P,"付款编号",ce).value,align:"center",formatter:e=>ce(e,!1)},{label:"付款金额 (元)",align:"right",minWidth:(0,x.zY)(P,"付款金额 (元)",ue).value,formatter:e=>ue(e,!1)},{label:"付款类型",minWidth:80,align:"center",formatter:e=>(0,n.h)("div",ae(e.pay_type))},{label:"付款方式",minWidth:80,align:"center",formatter:e=>(0,n.h)("div",ee(e.pay_way))},{label:"付款事由",minWidth:(0,x.zY)(P,"付款事由",de).value,formatter:e=>de(e,!1)},{label:"供应商",minWidth:(0,x.zY)(P,"供应商",me).value,formatter:e=>me(e,!1)},{label:"是否开票",minWidth:80,align:"center",formatter:e=>0===e.is_invoice?"未开票":(0,n.h)("tg-button",{props:{type:"link"},on:{click:t=>{H(e.invoice_info),t.stopPropagation()}}},["查看"])},{label:"付款时间",minWidth:100,align:"center",formatter:e=>e.pay_date?e.pay_date.replace(/-/g,"."):"--"},{label:"付款凭证",minWidth:80,align:"center",formatter:e=>1===e.is_pay?(0,n.h)("tg-button",{props:{type:"link"},on:{click:t=>{J(e.pay_certificate_pic),t.stopPropagation()}}},["查看"]):"--"},{label:"核销状态",minWidth:130,align:"center",formatter:e=>{const t=[];let a;return a=2===e.write_off_status?(0,n.h)("p",{class:"write-on label-70"},["已核销"]):1===e.write_off_status?(0,n.h)("p",{class:"write-off label-70"},["部分核销"]):(0,n.h)("p",{class:"write-off label-70"},["未核销"]),t.push((0,n.h)("div",{class:"line-info",style:{width:"100%",display:"flex",justifyContent:"center"}},[(0,n.h)("p",{class:"label-50"},["状态："]),a])),(2===e.pay_type?e.refund_write_off_infos.length>0:e.write_off_infos.length>0)&&t.push((0,n.h)("div",{class:"line-info",style:{width:"100%",display:"flex",justifyContent:"center"}},[(0,n.h)("p",{class:"label-50"},["详情："]),(0,n.h)(ft.Z,{class:"label-70",props:{list:2===e.pay_type?e.refund_write_off_infos.map((e=>{const t={...e};return t.write_off_amount=-1*t.write_off_amount,t})):e.write_off_infos,type:2===e.pay_type?"receive":"commonBusinessPayableActual",showSettlementUid:!0}})])),t}},{label:"单据状态",minWidth:80,align:"center",formatter:e=>(0,n.h)("div",{style:{color:0===e.is_pay?"#ff7a36":1===e.is_pay?void 0:"#ffac15"}},[te(e.is_pay)])},{label:"操作",fixed:"right",minWidth:160,formatter:e=>{const t=[];if(e.reversed_id?3===e.reverse_status?(t.push((0,n.h)("tg-button",{props:{type:"link"},class:"mgr-12",on:{click:t=>{Y(e.cost_id,"是否删除该冲销单"),t.stopPropagation()}}},["删除"])),t.push((0,n.h)("tg-button",{props:{type:"link"},class:"mgr-12",on:{click:t=>{L(e,!0),t.stopPropagation()}}},["重新提交"])),t.push((0,n.h)("tg-button",{props:{type:"link"},on:{click:t=>{Z(e),t.stopPropagation()}}},["退回原因"]))):t.push((0,n.h)("tg-button",{props:{type:"link"},on:{click:t=>{W(e),t.stopPropagation()}}},["查看"])):(1!==e.is_pay||e.reverse_id||2===e.pay_type||e.has_refund||t.push((0,n.h)("tg-button",{props:{type:"link"},class:"button-item-reverse",on:{click:t=>{L(e,!1),t.stopPropagation()}}},["冲销"])),2!==e.write_off_status&&1===e.is_pay&&1===e.pay_type&&4!==s&&D.common_business_write_off&&!e.reverse_id&&t.push((0,n.h)("tg-button",{props:{type:"link"},class:"mgl-12",on:{click:t=>{Q(e),t.stopPropagation()}}},["核销"]))),e.is_pay&&2!==e.pay_type&&!e.reverse_id&&null===e.reverse_status){const a=(0,n.h)("tg-button",{props:{type:"link"},class:t.length>0?"mgl-12":"",on:{click:t=>{C.value=new(Ke())(e.pay_amount??0).sub(new(Ke())(e.refunded_amount??0)).toNumber(),y.value=!0,v.value=e.cost_id,t.stopPropagation()}}},["退款"]);t.push(a)}if(e.is_pay&&2===e.pay_type&&!e.reverse_id&&!e.reversed_id&&2!==e.write_off_status){const a=(0,n.h)("tg-button",{props:{type:"link"},class:t.length>0?"mgl-12":"",on:{click:t=>{b.value=!0,d.value=e.not_write_off_amount,p.value=e.achievement_uid,_.value=e.cost_id,t.stopPropagation()}}},["核销"]);t.push(a)}return 0!==e.is_pay||1!==e.pay_type&&2!==e.pay_type||!D.common_business_project_settlement_delete||t.push((0,n.h)("tg-button",{props:{type:"link"},on:{click:t=>{Y(e.cost_id,"确认删除"+(1===e.pay_type?"成本":"退款")),t.stopPropagation()}}},["删除"])),(0,n.h)("div",t)}}])),_e=()=>{y.value=!1,z()},ve=()=>{b.value=!1,z()},fe=(0,n.ref)(!1),ge=(0,n.ref)({name:"123"}),he=e=>{ge.value=e,fe.value=!0},ye=()=>{fe.value=!1};return{columns:pe,saveLoading:c,Permission:D,invoicelistRef:R,loading:A,info:M,list:P,formatAmount:j.dN,fillEmptyStr:j.Vw,showInvoice:H,closeInvoice:U,invoiceList:X,invoiceShow:q,project_id:i,shouldVisible:T,title:N,handleCloseAction:O,handleSucceedAction:B,showCertificatePic:J,dialogData:V,editCost:$,delCost:Y,business_type:s,firstStepRef:S,handleWriteOff:Q,userInfo:k,getList:z,writeOffLoading:l,handleReserve:L,reverseOrderDialogRef:I,onWriteOffConfirmResolve:E,handleViewReserveReason:W,handleViewReserveBackReason:Z,onReasonDialogClose:G,reasonVisible:f,reason:h,reasonTitle:g,costTypeName:K,...le,payRefundVisible:y,refundWriteOffVisible:b,onPayRefundSave:_e,payRefundCostId:v,onRefundWriteOffSave:ve,notRefundWriteOffAmount:d,refundWriteoffId:p,refundWriteoffCostId:_,payRefundAmout:C,loanDetailVisible:fe,detailroval:ge,onRowClick:he,onLoanDetailClose:ye}}}),It=$t,Et=(0,k.Z)(It,Ct,xt,!1,null,null,null),Lt=Et.exports,Wt=(0,n.defineComponent)({components:{SubTabs:De.Z,settlementCost:pt.Z,comp1:wt,comp2:Lt},setup(){const e=(0,u.gI)();e.common_business_project_view_common_project_paid;const t=JSON.stringify((0,n.inject)("project",{cooperation_type:1})),a=JSON.parse(t);let i=(0,n.ref)(1);return a.value&&(i=a.value.cooperation_type||1),{permission:e,cooperation_type:i}}}),Zt=Wt,Gt=(0,k.Z)(Zt,dt,mt,!1,null,"363d03cd",null),Ot=Gt.exports,Bt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-s2b2c-detail-tab-calendar"},[a("div",{staticClass:"setting-form"},[a("el-form",{ref:"settingFormRef",staticStyle:{padding:"33px"},attrs:{size:"small","label-width":"134px","label-position":"right",model:e.settingForm,rules:e.formRules},nativeOn:{submit:function(e){e.preventDefault()}}},[a("head-lines",{staticStyle:{margin:"0px 0px 16px 0px"},attrs:{title:"分成设置"}}),a("el-form-item",{staticClass:"setting-item",attrs:{label:"达人线下分成比例：",prop:"kol_divide"}},[a("el-input",{staticStyle:{width:"248px"},attrs:{placeholder:"请输入比例",maxlength:"6"},on:{input:function(t){e.divideRateInput("kol_divide",t)}},model:{value:e.settingForm.kol_divide,callback:function(t){e.$set(e.settingForm,"kol_divide","string"===typeof t?t.trim():t)},expression:"settingForm.kol_divide"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("%")])])],1),a("head-lines",{staticStyle:{margin:"0px 0px 16px 0px"},attrs:{title:"开票设置"}}),a("el-row",[a("el-form-item",{staticClass:"setting-item inline",attrs:{label:"达人能否开票：",prop:"invoice_enable"}},[a("el-select",{staticStyle:{width:"88px"},attrs:{placeholder:"请选择"},model:{value:e.settingForm.invoice_enable,callback:function(t){e.$set(e.settingForm,"invoice_enable","string"===typeof t?t.trim():t)},expression:"settingForm.invoice_enable"}},[a("el-option",{attrs:{label:"能",value:"1"}}),a("el-option",{attrs:{label:"不能",value:"0"}})],1)],1),"1"===e.settingForm.invoice_enable?a("el-form-item",{staticClass:"setting-item inline",attrs:{label:"","label-width":"10px",prop:"invoice_tax_rate"}},[a("el-input",{staticStyle:{width:"152px","vertical-align":"baseline"},attrs:{placeholder:"请输入比例",maxlength:"6"},on:{input:function(t){e.divideRateInput("invoice_tax_rate",t)}},model:{value:e.settingForm.invoice_tax_rate,callback:function(t){e.$set(e.settingForm,"invoice_tax_rate","string"===typeof t?t.trim():t)},expression:"settingForm.invoice_tax_rate"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("%")])])],1):a("el-form-item",{staticClass:"setting-item inline",attrs:{label:"","label-width":"10px",prop:"invoice_enable"}},[a("el-select",{staticStyle:{width:"152px"},attrs:{placeholder:"请选择"},model:{value:e.settingForm.invoice_platform,callback:function(t){e.$set(e.settingForm,"invoice_platform","string"===typeof t?t.trim():t)},expression:"settingForm.invoice_platform"}},[a("el-option",{attrs:{label:"灵活用工平台",value:"1"}}),a("el-option",{attrs:{label:"公司代扣代缴",value:"2"}})],1)],1)],1),a("head-lines",{staticStyle:{margin:"0px 0px 16px 0px"},attrs:{title:"费用分摊设置"}}),a("div",{staticClass:"setting-table"},[a("el-row",{staticClass:"setting-table-head"},[a("el-col",{staticClass:"td"},[e._v("费用类型")]),a("el-col",{staticClass:"td"},[e._v("达人承担比例")]),a("el-col",{staticClass:"td"},[e._v("操作")])],1),a("el-row",{staticClass:"setting-table-body"},e._l(e.settingForm.cost_share,(function(t,i){return a("el-row",{key:t.expense_type_id,staticClass:"setting-table-tr"},[a("el-col",{staticClass:"td"},[a("el-select",{staticClass:"form-item",attrs:{filterable:"",remote:"","reserve-keyword":"","remote-method":e.remoteMethod,loading:e.typeLoading,placeholder:"请选择费用类型",size:"small"},model:{value:t.expense_type_id,callback:function(a){e.$set(t,"expense_type_id",a)},expression:"item.expense_type_id"}},e._l(e.typeData,(function(t){return a("el-option",{key:t.expense_type+t.id,attrs:{label:t.expense_type,value:t.id,disabled:e.shareIds.includes(t.id)}})})),1)],1),a("el-col",{staticClass:"td"},[a("el-input",{staticClass:"form-item",attrs:{placeholder:"请输入承担比例",size:"small"},on:{input:function(a){e.shareProportionHandler(t,a)}},model:{value:t.share_proportion,callback:function(a){e.$set(t,"share_proportion",a)},expression:"item.share_proportion"}},[a("span",{attrs:{slot:"append"},slot:"append"},[e._v("%")])])],1),a("el-col",{staticClass:"td delete-btn"},[a("tg-icon",{attrs:{name:"ico-btn-delete"},on:{click:function(t){return e.deleteType(i)}}})],1)],1)})),1),a("el-row",{staticClass:"setting-table-foot"},[a("el-col",{staticClass:"btn"},[a("el-button",{attrs:{size:"small",type:"text",icon:"el-icon-plus"},on:{click:e.addType}},[e._v(" 新增费用 ")])],1)],1)],1),a("div",{staticStyle:{"margin-top":"32px"}},[a("el-button",{staticStyle:{padding:"8px 30px"},attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)],1)])},Yt=[],zt=a(41572),qt=(0,n.defineComponent)({name:"TgTabCalendarWeek",components:{},setup(e,t){const a=(0,w.t)(),i=(0,n.computed)((()=>a.currentRoute.params.id)),r=(0,n.ref)({project_id:i.value,kol_divide:"",invoice_enable:"1",invoice_tax_rate:"",invoice_platform:"1",cost_share:[]}),o=(0,n.ref)(void 0),s=(0,n.reactive)({typeLoading:!1,typeData:[]}),l={kol_divide:[{required:!0,message:"请输入比例",trigger:["blur","change"]}],invoice_enable:[{required:!0,message:"请输入比例",trigger:["blur","change"]}],invoice_tax_rate:[{required:!0,message:"请输入税率",trigger:["blur","change"]}]},c=e=>(/100(?:\.0{0,2})?|(?:[1-9]?\d)(?:\.\d{0,2})?/u.exec(e.replace(/[^.\d]+/gu,"").replace(zt.Pj,""))??[""])[0],u=(e,t)=>{const a=c(t);r.value[e]=String(a)},d=[{text:"费用类型",required:!0},{text:"达人承担比例",required:!0},{text:"操作"}],m=()=>{r.value.cost_share.push({expense_type_id:"",share_proportion:"0"})},p=e=>{r.value.cost_share.splice(e,1)},_=(e,t)=>{const a=c(t);e.share_proportion=a},v=async e=>{if(""!==e){s.typeLoading=!0;const{data:{data:t}}=await(0,Me.WH)(e);s.typeData=t}else s.typeData=[];s.typeLoading=!1},f=async()=>{try{await(o.value?.validate()),r.value.cost_share=r.value.cost_share.filter((e=>e.expense_type_id));const{data:e}=await(0,Me.gO)(r.value);e.success&&t.root.$message.success("保存成功")}catch(e){t.root.$message.error("保存失败")}},g=(0,n.computed)((()=>r.value.cost_share.map((e=>e.expense_type_id))));return(0,n.onMounted)((async()=>{const{data:{data:{kol_divide:e,invoice_enable:t,invoice_tax_rate:a,invoice_platform:n,cost_share:o}}}=await(0,Me.S2)(i.value);r.value.kol_divide=e+"",r.value.invoice_enable=t+"",r.value.invoice_tax_rate=a+"",r.value.invoice_platform=n?n+"":"1",r.value.cost_share=o,s.typeData=o.map((e=>({expense_type:e.expense_type,id:e.expense_type_id})))})),{project_id:i,formRules:l,shareIds:g,onSubmit:f,addType:m,deleteType:p,remoteMethod:v,settingForm:r,settingFormRef:o,chargeTableData:d,divideRateInput:u,shareProportionHandler:_,...(0,n.toRefs)(s)}}}),Xt=qt,Ht=(0,k.Z)(Xt,Bt,Yt,!1,null,"4981d615",null),Ut=Ht.exports,Jt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-project-live"},[a("live-calendar")],1)},Qt=[],Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-project-live-schedule"},[a("div",{staticClass:"live-operator-row"},[a("div",{staticClass:"live-operator-row-left"},["calendar"===e.liveDisplayType?a("div",{staticClass:"date-switch"},[a("div",{staticClass:"btn-circle",on:{click:e.onPrevMonth}},[a("tg-icon",{attrs:{name:"ico-arrow-left"}})],1),a("span",{staticClass:"live-date"},[e._v(e._s(e.currentTitle))]),a("div",{staticClass:"btn-circle",on:{click:e.onNextMonth}},[a("tg-icon",{attrs:{name:"ico-arrow-right"}})],1)]):a("div",{staticClass:"date-select"},[a("span",{staticClass:"label"},[e._v("查询日期：")]),a("el-date-picker",{attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy.MM.dd","value-format":"yyyy-MM-dd",size:"small",editable:!1},model:{value:e.selectDates,callback:function(t){e.selectDates=t},expression:"selectDates"}})],1),a("div",{staticClass:"live-operator"},[e.Permission.mcn_save_shop_live?a("tg-button",{staticClass:"mgl-12",attrs:{icon:"ico-btn-add",type:"primary"},on:{click:e.AddLiveDisplayHandler}},[e._v("新增场次")]):e._e()],1)]),a("div",{staticClass:"live-operator-row-right"},[a("el-popover",{attrs:{placement:"bottom-end",trigger:"hover","open-delay":300}},[a("tg-button",{staticClass:"abnormal-tip-btn",attrs:{slot:"reference",type:"link"},slot:"reference"},[a("tg-icon",{attrs:{name:"ico-question"}})],1),a("div",{staticClass:"abnormal-tip"},[a("div",{staticClass:"abnormal-tip-title"},[e._v("以下情况场次将以橙色标注")]),a("div",{staticClass:"mgt-12 abnormal-tip-row"},[e._v("1、已过结束时间未归档的场次")])])],1),a("span",{staticClass:"mgl-6",staticStyle:{color:"#6a7b92"}},[e._v("异常提醒说明")]),a("TgBtnCapsule",{staticClass:"btn-capsule mgl-18",attrs:{value:"calendar"===e.liveDisplayType?"left":"right"},on:{click:e.onCapsuleClick},scopedSlots:e._u([{key:"left",fn:function(){return[e._v("日历")]},proxy:!0},{key:"right",fn:function(){return[e._v("列表")]},proxy:!0}])})],1)]),"calendar"===e.liveDisplayType?a("calendar",{ref:"CalendarRef",attrs:{displayDate:e.displayDate}}):a("live-list",{ref:"LiveListRef",attrs:{start_date:e.start_date,end_date:e.end_date}}),a("CopyScheduleForm",{attrs:{visible:e.CopyScheduleFormVisible},on:{"update:visible":function(t){e.CopyScheduleFormVisible=t},succeed:e.handleCopyScheduleSucceedAction}}),a("liveDisplayAddDialog",{attrs:{visible:e.liveDisplayAddDialogVisible,project_id:e.project_id},on:{succeed:e.handleSaveSucceedAction,closeAction:e.handleCloseAction}})],1)},ea=[],ta=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tg-live-schedule-calendar",staticStyle:{overflow:"overlay"}},[a("div",{staticClass:"calender"},[e._l(e.weeks,(function(t){return a("div",{key:t,staticClass:"grid-item grid-item-header"},[e._v(" "+e._s(t)+" ")])})),e._l(e.calendarData,(function(t,i){return a("div",{key:i+"cur",staticClass:"grid-item grid-item-content",class:e.isToday(t)?"today":""},[a("div",{staticClass:"grid-item-content-header"},[a("div",{staticClass:"day-no"},[e._v(" "+e._s(t.day)+" ")]),a("div",{staticClass:"rest",class:1===t.status?"is-rest":"",attrs:{disabled:e.is_rest_disabled(t)},on:{click:function(a){return e.onRestHandle(t)}}},[e._v(" 休 ")])]),a("div",{staticClass:"grid-item-content-detail"},[2===t.status?a("div",{staticStyle:{display:"flex","flex-direction":"column"}},e._l(e.two_live(t),(function(t,i){return a("el-popover",{key:i+"live",style:i<1?"":"margin-top: 8px;",attrs:{placement:"right-start","open-delay":300,trigger:"hover",disabled:!e.is_live_abnormal(t)}},[a("div",e._l(e.abnormal_live_tips(t),(function(t,i){return a("div",{key:i+"tip",class:i>0?"mgt-12":""},[e._v(" "+e._s(t)+" ")])})),0),a("div",{staticClass:"live",class:e.is_live_abnormal(t)?"abnormal":"",attrs:{slot:"reference"},on:{click:function(a){return e.jumpDetail(t)}},slot:"reference"},[i<2?a("div",{staticClass:"live_item"},[a("span",[e._v(e._s(t.time_str))]),a("span",[e._v(e._s(60===t.live_type?"直播":61===t.live_type?"短视频":"图文"))])]):e._e()])])})),1):e._e(),0===t.status?a("div",{staticStyle:{"text-align":"center","margin-top":"40px",color:"#a4b2c2"}},[e._v(" 暂无排期 ")]):e._e(),1===t.status?a("div",{staticStyle:{"text-align":"center","margin-top":"11px",color:"rgba(60, 82, 105, 0.2)","font-size":"56px","font-weight":"400"}},[e._v(" 休 ")]):e._e()]),2===t.status&&t.shop_live_list.length>2?a("div",{staticClass:"grid-item-content-footer"},[a("el-popover",{attrs:{"popper-class":"more-live",trigger:"hover",placement:"right-start","open-delay":300}},[a("tg-icon",{attrs:{slot:"reference",name:"ico-Icon_24px_gengduo"},slot:"reference"}),a("div",{staticClass:"live-list"},e._l(t.shop_live_list,(function(t,i){return a("div",{key:i+"live",staticClass:"live",class:e.is_live_abnormal(t)?"abnormal":"",on:{click:function(a){return e.jumpDetail(t)}}},[a("div",{staticClass:"live_item"},[a("span",[e._v(e._s(t.time_str))]),a("span",[e._v(e._s(60===t.live_type?"直播":61===t.live_type?"短视频":"图文"))])])])})),0)],1)],1):e._e()])}))],2)])},aa=[];const{debounce:ia}=ee(),ra="yyyy-MM-DD";var na,oa,sa=(0,n.defineComponent)({name:"Calendar",props:{displayDate:{type:Date}},setup(e,t){const a=(0,n.ref)(!1),i=(0,n.computed)((()=>p.value.map((e=>{const t=r.value.find((t=>_.is_same_day(e,t.date))),a=t?.date?b()(t?.date):b()(e),i=t?_.status_of_day(t):0;return{date:e,day:a.date(),new_date:a,status:i,shop_live_list:t?.shop_live_list??[]}})))),r=(0,n.ref)([]),o=(0,w.t)(),s=o.currentRoute.params.id,l=(0,n.computed)((()=>e.displayDate?b()(e.displayDate):b()())),u=(0,n.computed)((()=>l.value.clone().endOf("month").date())),d=(0,n.computed)((()=>{const e=l.value.clone().startOf("month").day();return(0===e?7:e)-1})),m=(0,n.computed)((()=>{const e=l.value.clone().endOf("month").day();return e?7-e:0})),p=(0,n.computed)((()=>{const e=[],t=l.value.clone();for(let a=0;a<_.prefixDays.value.length;a++){const i=_.prefixDays.value[a],r=t.clone().month(t.month()-1).date(i);e.push(r.format(ra))}for(let a=1;a<=u.value;a++){const i=t.clone().date(a);e.push(i.format(ra))}for(let a=0;a<_.surfixDays.value.length;a++){const i=_.surfixDays.value[a],r=t.clone().month(t.month()+1).date(i);e.push(r.format(ra))}return e})),_={onRest:async e=>{if(_.is_rest_disabled(e))return;if(1===e.status){const a=await(0,C.m6)(e.shop_live_list[0].id);return void(a.data.success?(_.queryProjectScheduleCalendar(),t.root.$message.success(a.data.message??"取消休息日成功")):t.root.$message.error(a.data.message??"休息日取消失败，请稍后重试"))}const a=await(0,C.It)(s,e.date);a.data.success?(_.queryProjectScheduleCalendar(),t.root.$message.success(a.data.message??"设置休息日成功")):t.root.$message.error(a.data.message??"休息日设置失败，请稍后重试")},isToday:e=>{const t=b()();return t.format(ra)===e.date},surfixDays:(0,n.computed)((()=>{const e=[];for(let t=1;t<=m.value;t++)e.push(t);return e})),prefixDays:(0,n.computed)((()=>{const e=[],t=l.value.clone().month(l.value.month()-1).endOf("month").date();for(let a=0;a<d.value;a++)e.push(t+a-d.value+1);return e})),queryProjectScheduleCalendar:async()=>{const e={project_id:s,start_date:p.value[0],end_date:p.value[p.value.length-1]};a.value=!0;const[i,n]=await Promise.all([await(0,C.ss)(e),await(0,Te._v)(500)]);a.value=!1;const o=i.data.data??[];i.data.success?r.value=o:(r.value=[],t.root.$message.error(i.data.message??"获取直播场次信息失败，请稍后重试"))},status_of_day:e=>{const t=e.shop_live_list.find((e=>e.is_rest_day));return t?1:e.shop_live_list.length?2:0},is_same_day:(e,t)=>!!(t&&t.length&&b()(t).isSame(b()(e),"day")),is_rest_disabled:e=>2===e.status,two_live:e=>e.shop_live_list.filter(((e,t)=>t<2)),is_live_abnormal:e=>{let t=!1;return 1===e.is_overdue&&1===e.live_status&&(t=!0),t},abnormal_live_tips:e=>{const t=[];return 1===e.is_overdue&&1===e.live_status&&t.push(`${t.length+1}、已过结束时间未归档的场次`),t},jumpDetail:e=>{o.push({name:c.u3.project.detail_display,params:{id:`${s}`,liveId:`${e.id}`,tab:"live",liveType:"list"}})},reloadData:()=>{_.queryProjectScheduleCalendar()}},v=(0,n.ref)(["周一","周二","周三","周四","周五","周六","周日"]);(0,n.watch)([()=>e.displayDate],(([e])=>{_.queryProjectScheduleCalendar()})),_.queryProjectScheduleCalendar();const f=ia(_.onRest,200);return{onRestHandle:f,loading:a,calendarData:i,weeks:v,..._}},activated(){this.queryProjectScheduleCalendar()}}),la=sa,ca=(0,k.Z)(la,ta,aa,!1,null,null,null),ua=ca.exports,da=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-project-livelist-page"},[a("tg-card",{staticStyle:{display:"flex","flex-direction":"column","flex-grow":"1"},attrs:{padding:0}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{height:"100%",stripe:"",data:e.ShopLiveDataList},on:{"row-click":e.onRowClick},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无记录"}})]},proxy:!0}])},e._l(e.ShopLiveColumns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),1),a("el-pagination",{staticStyle:{margin:"8px 0"},attrs:{"current-page":e.QueryForm.page_num,"page-sizes":[10,20,50,100],"page-size":e.QueryForm.num,layout:"total, prev, pager, next, sizes, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.QueryForm,"page_num",t)},"update:current-page":function(t){return e.$set(e.QueryForm,"page_num",t)},"current-change":e.handleCurrentChange,"size-change":e.handlePageSizeChange}})],1)],1)},ma=[],pa=(0,n.defineComponent)({props:{start_date:{type:String},end_date:{type:String}},setup(e,t){const a=b()(),i=(0,w.t)(),r=i.currentRoute.params.id,o=(0,n.ref)(!1),s=(0,n.ref)(0),l=(0,n.ref)({page_num:1,num:20,project_id:r,live_start_date:e.start_date??"",live_end_date:e.end_date??""}),u=(0,n.ref)([]);(0,n.watch)((()=>[e.start_date,e.end_date]),(t=>{t&&(l.value.live_start_date=e.start_date??"",l.value.live_end_date=e.end_date??"",f())}));const d=e=>{f(e)},m=async e=>{o.value=!0;const[{data:a}]=await(0,Te.Dc)(500,(0,C.MX)(e));o.value=!1,a.success?(u.value=a.data.data,s.value=a.data.total):(u.value=[],s.value=0,t.root.$message.warning(a.message??"查询失败，稍后重试"))},p=e=>{i.push({name:c.u3.project.detail_display,params:{id:`${r}`,liveId:`${e.id}`,tab:"live",liveType:"list"}})},_=e=>{l.value.page_num=e,f(!1)},v=e=>{l.value.num=e,f()},f=async(e=!0)=>{e&&(l.value.page_num=1),await m(l.value)};(0,n.onMounted)((()=>{f()}));const g={is_before:e=>{const t=b()(e);return t.isBefore(a,"d")}},h=(0,n.computed)((()=>[{label:"场次类型",minWidth:120,formatter:e=>{let t;switch(e.live_type){case 60:t="直播";break;case 61:t="短视频";break;case 62:t="图文";break;default:t=`未知(${e.live_type})`}return(0,n.h)("div",{class:"line-clamp-1"},[t])}},{label:"场次名称",minWidth:130,formatter:e=>(0,n.h)("div",{class:"line-clamp-1"},[e.live_title?e.live_title:"--"])},{label:"场次时间",minWidth:186,align:"center",formatter:e=>{if(e.live_start_time&&e.live_end_time){const t=b()(e.live_start_time),a=b()(e.live_end_time),i=t.isSame(a,"d");let r=`${t.format("MM.DD HH:mm")} ~ ${a.format("HH:mm")}`;if(!i){const e=t.date(),i=a.date(),n=t.clone().date(e+1),o=n.isSame(a,"d");r=o?`${r}(次日)`:`${r}(${i}日)`}return r}return"--"}},{label:"预估GMV (元)",minWidth:104,align:"right",formatter:e=>x.P6(e.expect_gmv/100,!1)},{label:"实际GMV (元)",minWidth:104,align:"right",formatter:e=>x.P6(e.actual_gmv/100,!1)},{label:"招商商品数",minWidth:74,align:"right",formatter:e=>(0,n.h)("span",e.merchant_goods_count??"--")},{label:"执行结果",minWidth:74,align:"right",formatter:e=>{const t=4===e.live_status,a=g.is_before(e.live_start_time)&&!t?"warning":"";return(0,n.h)("div",{class:"live-status"},[(0,n.h)("span",{class:a}),(0,n.h)("span",[t?"已归档":"未完成"])])}}]));return{reloadData:d,QueryForm:l,onRowClick:p,handleCurrentChange:_,handlePageSizeChange:v,ShopLiveDataList:u,ShopLiveColumns:h,loading:o,total:s}},activated(){this.reloadData(!1)}}),_a=pa,va=(0,k.Z)(_a,da,ma,!1,null,null,null),fa=va.exports,ga=a(40884),ha=a(13413),ya=a(8284),ba=(0,n.defineComponent)({components:{calendar:ua,TgBtnCapsule:ga.Z,LiveList:fa,CopyScheduleForm:ha.Z,liveDisplayAddDialog:ya.Z},setup(e,t){const a=(0,u.gI)(),i=(0,n.ref)(void 0),r=(0,n.ref)(void 0),o=(0,n.ref)(!1),s=(0,w.t)(),l=parseInt(s.currentRoute.params.id,10),d=(0,n.ref)(0),m=(0,n.computed)((()=>{const e=new Date;return e.setMonth(e.getMonth()+d.value,1),e})),p=(0,n.ref)(void 0),_=(0,n.computed)((()=>(p.value??[])[0])),v=(0,n.computed)((()=>(p.value??[])[1])),f=(0,n.ref)("calendar"),g=(0,n.computed)((()=>`${m.value.getFullYear()}年${h.formatMonth(m.value.getMonth()+1)}月`)),h={onCapsuleClick:e=>{f.value="left"===e?"calendar":"list",t.root.$router.replace({name:c.u3.project.detail,params:{id:`${l}`,tab:s.currentRoute.params.tab,liveType:f.value}})},onPrevMonth:()=>{h.getNewDate(-1)},onNextMonth:()=>{h.getNewDate(1)},getNewDate:e=>{d.value+=e},formatMonth:e=>e<10?`0${e}`:e},y=()=>{o.value=!0},b=()=>{i.value?.reloadData(),r.value?.reloadData()},C=(0,n.ref)(!1),x=()=>{C.value=!0},j=()=>{C.value=!1,i.value?.reloadData(),r.value?.reloadData()},D=()=>{C.value=!1};return(0,n.onBeforeMount)((()=>{const e=t.root.$route.params.liveType??"calendar";"calendar"===e?f.value="calendar":"list"===e&&(f.value="list")})),{Permission:a,handleCopyScheduleSucceedAction:b,liveDisplayAddDialogVisible:C,handleSaveSucceedAction:j,CopyScheduleFormVisible:o,CopyLiveScheduleHandler:y,AddLiveDisplayHandler:x,handleCloseAction:D,project_id:l,liveDisplayType:f,currentTitle:g,...h,displayDate:m,selectDates:p,start_date:_,end_date:v,CalendarRef:i,LiveListRef:r}}}),wa=ba,Ca=(0,k.Z)(wa,Kt,ea,!1,null,null,null),xa=Ca.exports,ja=(0,n.defineComponent)({components:{LiveCalendar:xa},setup(){return{}}}),Da=ja,Sa=(0,k.Z)(Da,Jt,Qt,!1,null,null,null),ka=Sa.exports,Aa=a(48331),Pa=(0,n.defineComponent)({name:"DailyData",props:{currentDate:{type:Object,require:!0}},components:{TgDailyDataTable:Aa.Z},setup(e,t){const a=(0,w.t)(),i="yyyy-MM-DD",r=e=>{const t=e?.clone(),a=[],i=t?.endOf("M").date()??0,r=t?.startOf("M");for(let n=1;n<=i;n++){r?.date(n);const e={dateNum:n,weekDate:r?.format("ddd")??"",dateMoment:r?.clone(),date:void 0,gmv:void 0,gmv_rate:void 0,live_duration:void 0,estimated_institution_commission:void 0,live_duration_str:void 0};a.push(e)}return a},o=(0,n.ref)(void 0),s=(0,n.ref)(r(e.currentDate)),l={async queryS2B2CDouyinDailyReport(){const r=e.currentDate??b()(),n=r.clone().startOf("M").format(i),l=r.clone().endOf("M").format(i),c={begin_time:n,end_time:l,project_id:a.currentRoute.params.id},u=await(0,m.Il)(c);u.data.success?(o.value=u.data.data,t.emit("dataUpdate",{date:o.value.update_time}),s.value=s.value.map(((e,t)=>{const a=o.value?.date_list[t];return a?{...e,...a}:{...e}}))):t.root.$message.error(u.data.message??"获取日报数据失败")},async onGmvTargetChanged(i){if(!i||0===parseFloat(i))return t.root.$message.error("GMV目标须大于0"),void l.queryS2B2CDouyinDailyReport();const r=e.currentDate??b()(),n={goal_value:i?new(Ke())(i).mul(new(Ke())(100)).toString():"0",month:r.month()+1,year:r.year(),project_id:a.currentRoute.params.id},o=await(0,m.nY)(n);o.data.success?(l.queryS2B2CDouyinDailyReport(),t.root.$message.success(o.data.message??"保存成功")):t.root.$message.error(o.data.message??"保存失败")}};return(0,n.onMounted)((()=>{l.queryS2B2CDouyinDailyReport()})),(0,n.watch)((()=>e.currentDate),(e=>{e&&(s.value=r(e),o.value=void 0,l.queryS2B2CDouyinDailyReport())})),{reportData:o,tableData:s,...l}},render(){const e=arguments[0],{tableData:t,reportData:a}=this;return e("tg-daily-data-table",{attrs:{showTableData:t,totalData:a?.total,editEnabled:!0},on:{gmvTargetChanged:this.onGmvTargetChanged}})}}),Ma=Pa,Ra=(0,k.Z)(Ma,na,oa,!1,null,null,null),Ta=Ra.exports;const Na=e=>{const t=(0,w.t)(),a="yyyy-MM-DD",i=(0,n.ref)(!1),r=(0,n.ref)(void 0),o="base-info-head",s="data-screen-head",l="flow-target-head",c="interactive-target-head",u="product-target-head",d="trade-target-head",p="viewer-head",_="deal-head",v=e=>{if(void 0===e||null===e)return"";if(e<0)return"--";const t=e?new(Ke())(e).mul(new(Ke())(100)).toFixed(2):"0";return`${t}%`},f=e=>{if(void 0===e||null===e)return"";if(e<0)return"--";const t=e?(0,j.dN)(e,"None",!0):"0";return t},g=e=>{if(void 0===e||null===e)return"";if(e<0)return"--";const t=e?(0,j.dN)(e/100,"None"):"0";return t},h=(0,n.computed)((()=>[{label:"开播时间",width:126,align:"center",className:o,formatter:({row:e})=>e.live_room_start_time?b()(e.live_room_start_time).format("yyyy.MM.DD HH:mm"):""},{label:"结束时间",width:126,align:"center",className:o,formatter:({row:e})=>e.live_room_end_time?b()(e.live_room_end_time).format("yyyy.MM.DD HH:mm"):""},{label:"直播时长",width:102,align:"right",headerAlign:"center",className:o,formatter:({row:e})=>e.live_duration_str?e.live_duration_str:""},{label:"是否有效直播",width:92,align:"center",className:o,formatter:({row:e})=>null===e.is_valid_live_room||void 0===e.is_valid_live_room?"":e.is_valid_live_room?"是":"否"}])),y=(0,n.computed)((()=>[{label:"直播间成交金额 (元)",width:130,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>g(e.gmv)},{label:"曝光-观看率",width:88,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>v(e.watch_cnt_show_ratio)},{label:"人均看播时长 (秒)",width:118,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>f(e.avg_watch_duration)},{label:"分钟评论次数",width:92,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>f(e.comment_num_minute)},{label:"千次观看转化 (元)",width:126,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>g(e.gpm)},{label:"观看-成交转化率",width:112,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>v(e.watch_pay_ucnt_ratio)},{label:"成交老粉占比",width:92,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>v(e.old_fans_pay_ucnt_ratio)},{label:"退款金额占比",width:92,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>v(e.real_refund_amt_ratio)},{label:"成交人数",width:68,align:"right",headerAlign:"center",className:s,formatter:({row:e})=>f(e.pay_ucnt)}])),C=(0,n.computed)((()=>[{label:"平均在线人数",width:92,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.avg_online_person)},{label:"最高在线人数",width:92,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.max_online_person)},{label:"累计观看人数",width:92,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.cumulative_watch_person)},{label:"直播间浏览量",width:92,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.room_user_views)},{label:"直播间爆光人数",width:110,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.room_watch_person)},{label:"直播间爆光次数",width:104,align:"right",headerAlign:"center",className:l,formatter:({row:e})=>f(e.room_watch_times)}])),x=(0,n.computed)((()=>[{label:"新增粉丝数",width:80,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.incr_new_fans_num)},{label:"转粉率",width:72,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>v(e.new_fans_rate)},{label:"人均观看时长 (秒)",width:126,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.avg_watch_duration)},{label:"新加团人数",width:80,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.incr_new_add_group_person)},{label:"加团率",width:72,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>v(e.add_group_rate)},{label:"评论次数",width:70,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.comment_num)},{label:"点赞次数",width:70,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.thumb_num)},{label:"分享次数",width:70,align:"right",headerAlign:"center",className:c,formatter:({row:e})=>f(e.share_num)}])),D=(0,n.computed)((()=>[{label:"带货商品数",width:80,align:"right",headerAlign:"center",className:u,formatter:({row:e})=>f(e.product_nums)},{label:"商品爆光人数",width:92,align:"right",headerAlign:"center",className:u,formatter:({row:e})=>f(e.product_watch_person)},{label:"商品点击人数",width:92,align:"right",headerAlign:"center",className:u,formatter:({row:e})=>f(e.product_click_person)},{label:"商品点击率 (次数)",width:128,align:"right",headerAlign:"center",className:u,formatter:({row:e})=>v(e.product_click_nums_rate)},{label:"商品点击率 (人数)",width:128,align:"right",headerAlign:"center",className:u,formatter:({row:e})=>v(e.product_click_person_rate)}])),S=(0,n.computed)((()=>[{label:"客单价 (元)",width:90,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>g(e.per_customer_price)},{label:"看播成交转化率 (人数)",width:152,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>v(e.watch_pay_ucnt_ratio)},{label:"直播间成交人数",width:104,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>f(e.pay_ucnt)},{label:"点击成交转化率 (人数)",width:152,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>v(e.click_to_trade_person_rate)},{label:"点击成交转化率 (次数)",width:152,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>v(e.click_to_trade_num_rate)},{label:"看播成交转化率 (次数)",width:152,align:"right",headerAlign:"center",className:d,formatter:({row:e})=>v(e.watch_to_trade_num_rate)}])),k=(0,n.computed)((()=>[{label:"粉丝占比",width:72,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.fans_distribution?.fans)},{label:"非粉丝占比",width:80,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.fans_distribution?.un_fans)},{label:"女性占比",width:72,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.gender_distribution?.female)},{label:"年龄层18-23",width:100,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.age_distribution?.["18-23"])},{label:"年龄层24-30",width:100,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.age_distribution?.["24-30"])},{label:"年龄层31-40",width:100,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.age_distribution?.["31-40"])},{label:"年龄层41-50",width:100,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>v(e.watch_user?.age_distribution?.["41-50"])},{label:"TOP1省份",width:84,align:"center",className:p,formatter:({row:e})=>{if(e.watch_user?.fans_distribution?.fans&&e.watch_user?.fans_distribution?.fans<0)return"--";const t=e.watch_user?.province_distribution_sorted?.[0]?.[0];return t||""}},{label:"占比",width:72,align:"right",headerAlign:"center",className:p,formatter:({row:e})=>e.watch_user?.fans_distribution?.fans&&e.watch_user?.fans_distribution?.fans<0?"--":v(e.watch_user?.province_distribution_sorted?.[0]?.[1])}])),A=(0,n.computed)((()=>[{label:"粉丝占比",width:72,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.fans_distribution?.fans)},{label:"非粉丝占比",width:80,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.fans_distribution?.un_fans)},{label:"女性占比",width:72,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.gender_distribution?.female)},{label:"年龄层18-23",width:100,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.age_distribution?.["18-23"])},{label:"年龄层24-30",width:100,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.age_distribution?.["24-30"])},{label:"年龄层31-40",width:100,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.age_distribution?.["31-40"])},{label:"年龄层41-50",width:100,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>v(e.pay_user?.age_distribution["41-50"])},{label:"TOP1省份",width:84,align:"center",className:_,formatter:({row:e})=>{if(e.pay_user?.fans_distribution?.fans&&e.pay_user?.fans_distribution?.fans<0)return"--";const t=e.pay_user?.province_distribution_sorted?.[0]?.[0];return t||""}},{label:"占比",width:72,align:"right",headerAlign:"center",className:_,formatter:({row:e})=>e.pay_user?.fans_distribution?.fans&&e.pay_user?.fans_distribution?.fans<0?"--":v(e.pay_user?.province_distribution_sorted?.[0]?.[1])}])),P=(0,n.computed)((()=>[{label:"带货口碑分",width:84,align:"right",headerAlign:"center",className:o,formatter:({row:e})=>{const t=e.seller_score?.score.value;return null===t||void 0===t?"":t<0?"--":t||0}}])),M={async queryS2B2CDouyinSessionReport(n){const o=n??b()(),s={begin_time:o.clone().startOf("M").format(a),end_time:o.clone().endOf("M").format(a),project_id:t.currentRoute.params.id,group:"live"};i.value=!0;const l=await(0,m.Lt)(s);setTimeout((()=>{i.value=!1}),300),l.data.success?(r.value=l.data.data,e.emit("dataUpdate",{date:r.value.update_time})):e.root.$message.error(l.data.message??"获取场次数据失败")},reload(e){M.queryS2B2CDouyinSessionReport(e)}};return{loading:i,tableData:r,baseInfoClassName:o,dataScreenClassName:s,flowTargetClassName:l,interaactiveTargetClassName:c,productTargetClassName:u,tradeTargetClassName:d,viewerClassName:p,dealClassName:_,baseInfoColumns:h,dataScreenColumns:y,flowTargetColumns:C,interactiveTargetColumns:x,productTargetColumns:D,tradeTargetColumns:S,viewerColumns:k,dealColumns:A,bringGoodsGradeColumns:P,...M}};var Fa,Va,$a,Ia,Ea,La,Wa=(0,n.defineComponent)({name:"displayData",props:{currentDate:{type:Object,require:!0}},setup(e,t){const a=Na(t);(0,n.watch)((()=>e.currentDate),(e=>{a.reload(e)})),(0,n.onMounted)((()=>{a.reload(e.currentDate)}));const i={};return{...a,...i}},render(){const e=arguments[0];return e("div",{class:"s2b2c-display-data-page-container"},[e("vxe-table",{attrs:{border:!0,"highlight-hover-row":!0,"tooltip-config":{theme:"light"},"show-overflow":!0,height:"100%",data:this.tableData?.date_list},directives:[{name:"loading",value:this.loading}]},[e("template",{slot:"empty"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})]),e("vxe-colgroup",{attrs:{title:"基础信息","header-class-name":this.baseInfoClassName,align:"center"}},[this.baseInfoColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,fixed:t.fixed,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"数据大屏","header-class-name":this.dataScreenClassName,align:"center"}},[this.dataScreenColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"流量指标","header-class-name":this.flowTargetClassName,align:"center"}},[this.flowTargetColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"互动指标","header-class-name":this.interaactiveTargetClassName,align:"center"}},[this.interactiveTargetColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"商品指标","header-class-name":this.productTargetClassName,align:"center"}},[this.productTargetColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"交易指标","header-class-name":this.tradeTargetClassName,align:"center"}},[this.tradeTargetColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"用户画像-看播用户","header-class-name":this.viewerClassName,align:"center"}},[this.viewerColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"用户画像-成交用户","header-class-name":this.dealClassName,align:"center"}},[this.dealColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))]),e("vxe-colgroup",{attrs:{title:"带货分","header-class-name":this.baseInfoClassName,align:"center"}},[this.bringGoodsGradeColumns.map((t=>e("vxe-column",{attrs:{"header-class-name":t.className,title:t.label,field:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.width,formatter:t.formatter}})))])])])}}),Za=Wa,Ga=(0,k.Z)(Za,Fa,Va,!1,null,null,null),Oa=Ga.exports,Ba=a(81766),Ya=(0,n.defineComponent)({name:"monthSession",components:{sessionList:Ba.Z},props:{currentDate:{type:Object,require:!0}},setup(e,t){const a=(0,w.t)(),i=a.currentRoute.params.id;return{project_id:i}},render(){const e=arguments[0],{project_id:t}=this,a={name:"sessionList",props:{project_id:t,is_one_peoject:!0}};return e("div",[e(a.name,{props:a.props})])}}),za=Ya,qa=(0,k.Z)(za,$a,Ia,!1,null,"217f1866",null),Xa=qa.exports,Ha=(0,n.defineComponent)({name:"dataCenter",components:{DailyData:Ta,DisplayData:Oa,monthSession:Xa},setup(e,t){const a="yyyy年MM月",i=(0,n.ref)(0),r=(0,n.ref)(b()().startOf("M")),o=(0,n.computed)((()=>r.value.format(a))),s=(0,n.ref)(void 0),l=(0,n.computed)((()=>!r.value.isSameOrBefore(b()("2022-01"),"M"))),c=(0,n.computed)((()=>!r.value.isSameOrAfter(b()(),"M"))),u=[Ta.name,Xa.name,Oa.name],d={onSwitch(e){s.value=void 0,i.value!==e&&(r.value=b()().startOf("M")),i.value=e},onPreMonth(){l.value&&d.resetDate(-1)},onNextMonth(){c.value&&d.resetDate(1)},resetDate(e){s.value=void 0,r.value=r.value.clone().add(e,"M")}};return{selectedDate:r,preMonthEnable:l,nextMonthEnable:c,showDateStr:o,selectIndex:i,switchComponents:u,dataUpdateStr:s,...d}},render(){const e=arguments[0],{selectIndex:t,showDateStr:a,preMonthEnable:i,nextMonthEnable:r,selectedDate:n,switchComponents:o}=this,s={name:o[t],props:{currentDate:n}};return e("div",{class:"data-center-page-container"},[e("div",{class:"data-center-switch"},[e("tg-button",{attrs:{selected:0===t,type:"link"},on:{click:()=>this.onSwitch(0)}},["项目日报"]),e("span",{class:"mgl-18 mgr-18 line-ver"},["|"]),e("tg-button",{attrs:{selected:1===t,type:"link"},on:{click:()=>this.onSwitch(1)}},["项目月报"]),e("span",{class:"mgl-18 mgr-18 line-ver"},["|"]),e("tg-button",{attrs:{selected:2===t,type:"link"},on:{click:()=>this.onSwitch(2)}},["场次明细"])]),1!==t&&e("div",{class:"data-center-operation"},[e("div",{class:"data-center-operation-date"},[e("tg-button",{attrs:{disabled:!i,type:"link"},on:{click:this.onPreMonth}},[e("tg-icon",{attrs:{name:"ico-arrow-left"}})]),e("span",{class:"mgl-12 mgr-12 data-center-date"},[a]),e("tg-button",{attrs:{disabled:!r,type:"link"},on:{click:this.onNextMonth}},[e("tg-icon",{attrs:{name:"ico-arrow-right"}})])]),(this.dataUpdateStr?.length??0)>0&&e("div",{class:"data-center-operation-update-date-desc"},["最后更新时间：",this.dataUpdateStr])]),e("div",{class:"data-center-template"},[e(s.name,{props:s.props,on:{dataUpdate:e=>{if(e.date){const t=b()(1e3*e.date);this.dataUpdateStr=t.format("yyyy.MM.DD")}else this.dataUpdateStr=void 0}}})])])}}),Ua=Ha,Ja=(0,k.Z)(Ua,Ea,La,!1,null,null,null),Qa=Ja.exports;const Ka=[{name:c.u3.project.list,title:"项目管理"},{path:"",title:"项目详情"}];var ei=(0,n.defineComponent)({name:"TgCommonBusinessProjectDetail",props:{id:{type:Number},tab:{type:String}},components:{info:z,contract:q.Z,dailyData:Ce,live:ka,income:ut,cost:Ot,setting:Ut,dataCenter:Qa},setup(e,t){const a=(0,n.ref)(void 0),i=(0,u.gI)(),r=(0,w.t)(),c=r.currentRoute.params.id,p=(0,n.ref)(void 0),_=(0,n.computed)((()=>{const e=(0,u.kG)(d.HN.common_business_project_contract_view),t=(0,u.kG)(d.HN.common_business_project_status_setting),a=(0,u.kG)(d.HN.common_business_project_contract_daily_data),i=(0,u.kG)(d.HN.common_business_project_settlement_view),r=(0,u.kG)(d.HN.common_live_project_gathering_view);return{canViewContractTab:e,canViewDailyDataTab:a,canViewSettlementTab:i,canSettingContractTab:t,canViewLiveProjectGatherTab:r}})),v=(0,o.pK)((0,n.computed)((()=>{let e=!1;a.value&&1===a.value.platform_type&&(e=!0);const t=[{label:"项目信息",value:"info"}];return i.mcn_shop_live_view&&e&&t.push({label:"场次",value:"live"}),(i.common_business_project_settlement_view||i.common_live_project_gathering_view)&&t.push({label:"收入",value:"income"}),(i.common_business_project_settlement_view||i.common_business_project_view_common_project_paid)&&t.push({label:"成本",value:"cost"}),_.value.canViewContractTab&&t.push({label:"合同协议",value:"contract"}),_.value.canViewDailyDataTab&&2===a.value?.platform_type&&t.push({label:"日报数据",value:"dailyData"}),_.value.canViewDailyDataTab&&1===a.value?.platform_type&&t.push({label:"数据中心",value:"dataCenter"}),_.value.canSettingContractTab&&t.push({label:"设置",value:"setting"}),t})),e.tab??"info");(0,n.watch)((()=>v.checkedTab.value),((a,i)=>{i!==a&&t.root.$router.replace({params:(0,s.P)({...e,tab:a})})})),(0,n.onMounted)((()=>{(0,l.S)()}));const f=()=>{},g=async(i=!1)=>{const r=async e=>{const{data:t}=await(0,m.$q)(e);a.value=t.data};e.id?await r(e.id.toString()):i&&await r(t.root.$route.params.id.toString())},h=(0,n.ref)(!1),y=async()=>{h.value=!0;const e=await(0,C.gs)(c,5);h.value=!1,e.data.success?(p.value=!!e.data.data.in_project,p.value&&g()):t.root.$message.error(e.data.message)};(0,n.onBeforeMount)((()=>{y()})),(0,n.provide)("project",a),(0,n.provide)("common_project",a);const b=()=>{g()};return{editProjectReload:b,Permission:_,routes:Ka,CommonBusinessProject:a,inProject:p,permission:i,...v,onTabChange:f}}}),ti=ei,ai=(0,k.Z)(ti,i,r,!1,null,null,null),ii=ai.exports},48331:function(e,t,a){a.d(t,{Z:function(){return h}});var i,r,n=a(36568),o=a.n(n),s=a(97434),l=a(6933),c=a.n(l),u=a(41572),d=a(61282),m=a(85937),p=a.n(m),_=(0,s.defineComponent)({name:"TgDailyDataTable",props:{showTableData:{type:Array},totalData:{type:Object},editEnabled:{type:Boolean,default:!1}},setup(e,t){const a=(0,s.ref)(!1),i=(0,s.ref)(e.totalData?.gmv_goal?new(p())(e.totalData.gmv_goal).div(new(p())(100)).toFixed(0):void 0),r=(0,s.computed)((()=>e.showTableData??[])),n=(0,s.ref)(void 0),o=(0,s.ref)(!1),l=(0,s.computed)((()=>[{prop:"dateNum",align:"center",fixed:"left",resizable:!1,width:156,formatter:e=>(0,s.h)("div",{style:"height: 32px; line-height: 32px; display: flex; align-items: center; justify-content: center;"},[(0,s.h)("span",{class:"date-day"},`${e.dateNum}`),(0,s.h)("span",{class:"date-week"},e.weekDate)])},{label:"GMV (元)",prop:"dateNum",align:"right",headerAlign:"center",resizable:!1,minWidth:120,formatter:e=>{let t,a="table-cell-container";return e.dateMoment?.isAfter(c()(),"day")?a+=" empty":t=e.gmv?(0,d.dN)(e.gmv/100,"None"):"0",(0,s.h)("div",{class:a},t)}},{label:"目标累计完成度",prop:"dateNum",align:"right",headerAlign:"center",resizable:!1,minWidth:120,formatter:e=>{let t,a="table-cell-container";return e.dateMoment?.isAfter(c()(),"day")?a+=" empty":t=void 0===e.gmv_rate||null===e.gmv_rate?"--":`${e.gmv_rate}%`,(0,s.h)("div",{class:a},t)}},{label:"直播时长",prop:"dateNum",align:"right",headerAlign:"center",resizable:!1,minWidth:120,formatter:e=>{let t,a="table-cell-container";return e.dateMoment?.isAfter(c()(),"day")?a+=" empty":t=e.live_duration_str?e.live_duration_str:"--",(0,s.h)("div",{class:a},t)}},{label:"预估佣金收入 (元)",prop:"dateNum",align:"right",headerAlign:"center",resizable:!1,minWidth:120,formatter:e=>{let t,a="table-cell-container";return e.dateMoment?.isAfter(c()(),"day")?a+=" empty":t=e.estimated_institution_commission?(0,d.dN)(e.estimated_institution_commission/100,"None"):"0",(0,s.h)("div",{class:a},t)}}])),m={onDbClick(){e.editEnabled&&(a.value=!0)},onKeydown(e){"Enter"===e.key&&n.value?.blur()},onGMVTargetInput(e){const t=/\d{0,10}/u,a=/[^\d]+/gu;i.value=(t.exec(e.replace(a,"").replace(u.Pj,""))??[""])[0]},async onGMVTargetBlur(){a.value=!1,t.emit("gmvTargetChanged",i.value)},getSummaries(t){const{columns:a,_:i}=t;return a.map(((t,a)=>{switch(a){case 0:return"合计";case 1:return e.totalData?.gmv?(0,d.dN)(e.totalData.gmv/100,"None"):"0";case 2:return void 0===e.totalData?.gmv_rate||null===e.totalData?.gmv_rate?"--":`${e.totalData?.gmv_rate}%`;case 3:return e.totalData?.live_duration_str?e.totalData?.live_duration_str:"--";case 4:return e.totalData?.estimated_institution_commission?(0,d.dN)(e.totalData.estimated_institution_commission/100,"None"):"0";default:return"--"}}))},formatAmount:d.dN};return(0,s.onUpdated)((()=>{n.value?.focus()})),(0,s.watch)((()=>e.totalData),(e=>{e&&(i.value=e.gmv_goal?new(p())(e.gmv_goal).div(new(p())(100)).toFixed(0):void 0)})),(0,s.onMounted)((()=>{setTimeout((()=>{window.onresize=()=>{o.value=!0}}),500)})),{resizeBool:o,gmvEditing:a,gmvTarget:i,tableData:r,columns:l,gmvInputRef:n,...m}},render(){const e=arguments[0],{columns:t,tableData:a,gmvEditing:i,gmvTarget:r,resizeBool:n}=this,s=this.formatAmount(r??"0","None",!0);return e("div",{class:"daily-data-table-component"},[e("el-table",{class:n?"table-left resize":"table-left",attrs:{data:a,height:"100%",border:!0,stripe:!0,"show-summary":!0,"summary-method":this.getSummaries}},[e("template",{slot:"empty"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})]),t.map(((t,a)=>e("el-table-column",o()([{},{props:{...t}},{key:a}]))))]),e("el-table",{class:this.editEnabled?"table-right editEnabled":"table-right",attrs:{data:[{}],height:"100%",border:!0,"show-summary":!0,"sum-text":s}},[e("el-table-column",{attrs:{resizable:!1,label:"GMV目标 (元)",minWidth:"183",align:"center"}},[e("fragments",i?[e("div",{class:"gmv-target"},[e("el-input",{ref:"gmvInputRef",attrs:{value:r},on:{blur:this.onGMVTargetBlur,input:this.onGMVTargetInput},nativeOn:{keydown:this.onKeydown}})])]:[e("div",{class:r?"gmv-target":"gmv-target-none",on:{dblclick:this.onDbClick}},[r?s:this.editEnabled?"双击进入编辑":"暂无数据"])])])])])}}),v=_,f=a(1001),g=(0,f.Z)(v,i,r,!1,null,null,null),h=g.exports},99824:function(e,t,a){a.d(t,{Z:function(){return h}});var i,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-select-group"},[e.isMcnDouyinDaily?e._e():a("el-select",{staticClass:"time-select-type",staticStyle:{width:"102px"},attrs:{size:"small"},model:{value:e.selectDate.dateType,callback:function(t){e.$set(e.selectDate,"dateType",t)},expression:"selectDate.dateType"}},e._l(e.selectDate.dateTypeList,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1),a("el-select",{style:{width:e.isMonthWeek?"240px":e.isMcnDouyinDaily?"180px":"200px"},attrs:{size:"small"},model:{value:e.selectDate.dateValue,callback:function(t){e.$set(e.selectDate,"dateValue",t)},expression:"selectDate.dateValue"}},e._l(e.selectDate.dateValueList,(function(e){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)},n=[],o=a(97434),s=a(6933),l=a.n(s);(function(e){e[e["Month"]=0]="Month",e[e["Year"]=1]="Year",e[e["Quarter"]=2]="Quarter",e[e["Week"]=3]="Week"})(i||(i={}));const c=(e=!1,t=!1,a=!1)=>{const r=(0,o.ref)(i.Month);let n=[{label:"按月查看",value:i.Month},{label:"按年查看",value:i.Year}];e&&(n=[{label:"按月查看",value:i.Month},{label:"按季查看",value:i.Quarter}]),a&&(n=[{label:"按月查看",value:i.Month},{label:"按周查看",value:i.Week}]);const s=(0,o.ref)(void 0),c=(0,o.ref)([]),u=()=>{if(r.value===i.Year){const e=l()().add(1,"years");c.value=new Array(10).fill(1).map((()=>(e.add(-1,"years"),{label:e.format("YYYY年"),value:e.format("YYYY")}))),s.value=c.value[0].value}else if(r.value===i.Quarter){const e=l()().add(1,"Q");c.value=[],new Array(10).fill(1).map((()=>{if(e.add(-1,"Q"),!(t&&Number(e.format("YYYY"))<2022))return c.value.push({label:e.format("YYYY年Q季度"),value:e.format("YYYY-Q")})})),s.value=c.value[0].value}else if(r.value===i.Month){const e=l()().add(1,"months");c.value=[],new Array(24).fill(1).map((()=>{if(e.add(-1,"months"),!(t&&Number(e.format("YYYY"))<2022))return c.value.push({label:e.format("YYYY年MM月"),value:e.format("YYYYMM")})})),s.value=c.value[0].value}else if(r.value===i.Week){const e=l()().add(1,"w");c.value=[],new Array(30).fill(1).map((()=>{if(e.add(-1,"w"),t&&Number(e.format("YYYY"))<2022)return;const a="MM.DD",i=e.startOf("w").format(a),r=e.endOf("w").format(a);return c.value.push({label:e.format("YYYY年第W周("+i+"-"+r+")"),value:e.format("YYYY-MM-DD")})})),s.value=c.value[0].value}};return(0,o.watch)((()=>r.value),(()=>{s.value=void 0,u()})),u(),(0,o.reactive)({dateType:r,dateTypeList:n,dateValue:s,dateValueList:c})};var u=a(44928),d=a(53451),m=a.n(d);const{debounce:p}=m();var _=(0,o.defineComponent)({props:{isMcnDouyinDaily:{type:Boolean,default:!1,require:!1},isMonthQuarter:{type:Boolean,default:!1,require:!1},isMonthWeek:{type:Boolean,default:!1,require:!1}},setup(e,t){const a=c(e.isMonthQuarter,e.isMcnDouyinDaily||e.isMonthQuarter,e.isMonthWeek),i=(0,u.t)(),{dateValue:r}=i.currentRoute.query;r&&(4===r.length?(a.dateType=1,setTimeout((()=>{a.dateValue=r}))):a.dateValue=r);const n=p((()=>{t.emit("selectDate",a.dateType,a.dateValue)}),200);return n(),(0,o.watch)((()=>a.dateValue),(()=>{n()})),{selectDate:a}}}),v=_,f=a(1001),g=(0,f.Z)(v,r,n,!1,null,"43dd05f4",null),h=g.exports},62068:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{trigger:"hover","popper-class":"pop-receivable",placement:"bottom-end"}},[a("div",{staticClass:"pop-receivable-detail"},[a("div",{staticClass:"receivable-detail-content"},[a("div",{staticClass:"detail-header"},[e.showSettlementUid?a("div",{staticClass:"header column-width"},[e._v("结算单编号")]):e._e(),a("div",{staticClass:"header column-width"},[e._v(e._s(e.firstColumnHeader))]),a("div",{staticClass:"header right column-width"},[e._v("核销金额 (元)")]),a("div",{staticClass:"header column-width"},[e._v("核销人/日期")])]),a("div",{staticClass:"detail-body"},e._l(e.list,(function(t,i){return a("div",{key:i,staticClass:"body-row"},[e.showSettlementUid?a("div",{staticClass:"rg right column-width"},[a("span",[e._v(e._s(t.settlement_uid))])]):e._e(),"receivable"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(e._s(t.receipt_uid))])]):e._e(),"receive"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(e._s(t.receivable_uid))])]):e._e(),"payable"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(" "+e._s(t.cost_id)+" ")])]):e._e(),"commonBusinessPayableActual"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(" "+e._s(t.payable_uid)+" ")])]):e._e(),a("div",{staticClass:"rg right column-width"},[a("span",{style:t.write_off_amount<0?"color: #e91313":""},[e._v(e._s(e.formatAmount(t.write_off_amount,"")))])]),a("div",{staticClass:"rg column-width"},[a("div",[a("p",[e._v(e._s(t.write_off_user))]),a("span",{staticClass:"write-date"},[e._v(e._s(t.write_off_time))])])])])})),0)])]),a("tg-button",{style:{color:e.btncolor},attrs:{slot:"reference",type:"link"},slot:"reference"},[e._v(e._s(e.btntitle))])],1)},r=[],n=a(97434),o=a(61282),s=(0,n.defineComponent)({props:{list:{type:Array,default:()=>[]},type:{type:String,default:"receivable"},btntitle:{type:String,default:"预览"},btncolor:{type:String,default:"#2877ff"},showSettlementUid:{type:Boolean,default:!1}},setup(e,t){const a=(0,n.computed)((()=>{let t="";return"receivable"===e.type?t="单据编号":"receive"===e.type?t="应收编号":"payable"===e.type?t="单据编号":"commonBusinessPayableActual"===e.type&&(t="应付编号"),t}));return{firstColumnHeader:a,formatAmount:o.dN}}}),l=s,c=a(1001),u=(0,c.Z)(l,i,r,!1,null,"6ce85114",null),d=u.exports},13413:function(e,t,a){a.d(t,{Z:function(){return h}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-project-copy-schedule-dialog"},[a("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new",attrs:{visible:e.visible,width:"440px",title:"复制排期排班","close-on-click-modal":!1,"close-on-press-escape":!1},on:{close:e.onClose},scopedSlots:e._u([{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.onClose}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.onSave}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"copy-schedule-dialog-content"},[a("el-form",{attrs:{model:e.DataForm,"label-width":"60px",size:"small","label-position":"top"}},[a("div",{staticClass:"form-row"},[a("el-form-item",{attrs:{label:"请选择需要复制的时间段"}},[a("el-date-picker",{staticStyle:{width:"392px"},attrs:{"picker-options":e.pickerOptions,clearable:"",editable:!1,type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy.MM.dd","value-format":"yyyy-MM-dd"},model:{value:e.DataForm.date_range,callback:function(t){e.$set(e.DataForm,"date_range",t)},expression:"DataForm.date_range"}})],1),a("el-form-item",{attrs:{label:"请选择复制到哪个时间段"}},[a("div",{staticStyle:{display:"flex"}},[a("el-date-picker",{staticStyle:{width:"184px"},attrs:{clearable:"",editable:!1,type:"date","range-separator":"~",placeholder:"开始日期",format:"yyyy.MM.dd","value-format":"yyyy-MM-dd"},on:{change:e.ChangeCopyToStartDate},model:{value:e.DataForm.start_date,callback:function(t){e.$set(e.DataForm,"start_date",t)},expression:"DataForm.start_date"}}),a("div",{staticStyle:{"text-align":"center",width:"24px",color:"#3c5269","font-size":"14px"}},[e._v(" ～ ")]),a("el-date-picker",{staticStyle:{width:"184px"},attrs:{clearable:"",disabled:"",editable:!1,type:"date","range-separator":"~",placeholder:"结束日期",format:"yyyy.MM.dd","value-format":"yyyy-MM-dd"},model:{value:e.DataForm.end_date,callback:function(t){e.$set(e.DataForm,"end_date",t)},expression:"DataForm.end_date"}})],1)])],1)])],1)])],1)},r=[],n=a(3293),o=a(66870),s=a(82741),l=a(44928),c=a(64236),u=a(97434),d=a(6933),m=a.n(d);const p=async e=>{const[{data:t}]=await(0,c.Dc)(200,(0,n.aT)(e));return t};var _=(0,u.defineComponent)({props:{visible:{type:Boolean,default:!1}},setup(e,t){const a=(0,l.t)(),i=a.currentRoute.params.id,r=(0,u.ref)({date_range:[],start_date:"",end_date:""}),c=()=>{r.value={date_range:[],start_date:"",end_date:""}},d={onClose:()=>{c(),t.emit("close"),t.emit("update:visible",!1)},onSave:async()=>{const e=(0,u.ref)(1),a=r.value.date_range[0],l=r.value.date_range[1],c=r.value.start_date;if(m()(c).isBetween(m()(a),m()(l))||a===c||l===c)return void t.root.$message.error("时间段不允许有重叠");const d=await p({project_id:parseInt(i,10),start_date:c,end_date:r.value.end_date.replace(/\./g,"-"),schedule_type:o.Ix.Month});if(!d.success)return void t.root.$message.error("查询排期信息失败，请稍后重试");if(e.value=d.data.length>0?0:1,0===e.value){const a=await(0,s.I)(t,{title:"被覆盖的时间段已存在排班信息，是否覆盖原有排班",confirmText:"直接覆盖",cancelText:"跳过该日期"});e.value=a?0:1}const{data:_}=await(0,n.il)(i,a,l,c,e.value);_.success?(t.root.$message.success(_.message),t.emit("update:visible",!1),t.emit("succeed")):t.root.$message.warning(_.message??"复制失败，稍后重试")}},_=2592e6,v=(0,u.ref)(),f=(0,u.ref)({disabledDate(e){const t=v.value,a=_;return!!t&&(e.getTime()>t.getTime()+a||e.getTime()<t.getTime()-a)},onPick({minDate:e,maxDate:t}){e&&!t&&(v.value=e),t&&(v.value=null)}});function g(e,t){const a=new Date(e),i=new Date(t),r=864e5,n=i.getTime()-a.getTime(),o=Math.round(n/r);return o}const h=e=>{if(r.value.date_range){const t=r.value.date_range[0],a=r.value.date_range[1],i=g(t,a),n=new Date(e);n.setDate(n.getDate()+i);const o=m()(n).format("YYYY.MM.DD");r.value.end_date=o}};return{...d,DataForm:r,pickerOptions:f,ChangeCopyToStartDate:h}}}),v=_,f=a(1001),g=(0,f.Z)(v,i,r,!1,null,null,null),h=g.exports},60097:function(e,t,a){a.d(t,{Z:function(){return p}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-project-final-dialog tg-dialog-vcenter"},[a("el-dialog",{staticClass:"customer-dialog project-form-modal",attrs:{width:"428px",visible:e.visible,"destroy-on-close":!0,"close-on-click-modal":!1},on:{close:e.closeDialog},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("项目完结")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button-line",{attrs:{"justify-content":"center"}},[a("tg-button",{on:{click:e.closeDialog}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")])],1)]},proxy:!0}])},[a("div",{staticClass:"dialog-content dialog-content-form360"},[a("el-form",{ref:"ruleForm",attrs:{rules:e.rules,model:e.form,"label-width":"78px",size:"medium"}},[a("el-form-item",{attrs:{size:"medium",label:"执行结果：",prop:"end_type"}},[a("el-select",{staticClass:"form-select-two",staticStyle:{width:"310px"},attrs:{placeholder:"请选择执行结果"},model:{value:e.form.end_type,callback:function(t){e.$set(e.form,"end_type",t)},expression:"form.end_type"}},[e._l(e.enumEndType(),(function(t){return[e.status!==e.ProjectStatusEnum.executionEnd||3!==t.value?a("el-option",{key:t.value,attrs:{value:t.value,label:t.label}}):e._e()]}))],2)],1),2===e.form.end_type?a("el-form-item",{staticStyle:{"margin-top":"16px"},attrs:{label:"终止处理：",prop:"end_handle_type"}},e._l(e.enumEndHandleType(),(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value},model:{value:e.form.end_handle_type,callback:function(t){e.$set(e.form,"end_handle_type",t)},expression:"form.end_handle_type"}},[e._v(e._s(t.label))])})),1):e._e(),2===e.form.end_handle_type?a("el-form-item",{attrs:{label:"",prop:"end_handle_detail"}},[a("el-input",{staticStyle:{width:"310px"},attrs:{type:"text",placeholder:"请输入处理方案",maxlength:"20","show-word-limit":""},model:{value:e.form.end_handle_detail,callback:function(t){e.$set(e.form,"end_handle_detail",t)},expression:"form.end_handle_detail"}})],1):e._e(),3!==e.form.end_type?a("el-form-item",{staticStyle:{"margin-top":"16px"},attrs:{label:"完结时间：",prop:"end_time"}},[a("el-date-picker",{staticStyle:{width:"310px"},attrs:{type:"date",placeholder:"请选择完结时间",format:"yyyy.MM.dd","value-format":"timestamp"},model:{value:e.form.end_time,callback:function(t){e.$set(e.form,"end_time",t)},expression:"form.end_time"}})],1):e._e()],1),3!==e.form.end_type?a("div",{staticStyle:{"margin-top":"16px",color:"#6a7b92"}},[e._v(" 项目完结后，不允许进行成本和收入结算 ")]):e._e()],1)])],1)},r=[],n=a(97434),o=a(17496),s=a(47583),l=a(29625),c=(0,n.defineComponent)({emit:["getDetail"],props:{visible:{type:Boolean,default:!1},IsMcn:{type:Boolean,default:!1},status:{type:Number}},setup(e,t){const a=(0,n.reactive)({form:{id:parseInt(t.root.$route.params.id,10),end_type:"",end_handle_type:1,end_handle_detail:"",end_time:void 0},rules:{end_type:[{required:!0,message:"请输入执行结果",trigger:"change"}],end_handle_type:[{required:!0,message:"请选择终止处理",trigger:"change"}],end_handle_detail:[{required:!0,message:"请输入处理方案",trigger:"blur"}],end_time:[{required:!0,message:"请选择完结时间",trigger:"change"}]}}),i=i=>{t.refs[i].validate((async i=>{if(!i)return!1;{const{end_time:i,end_handle_type:r,end_handle_detail:n,end_type:o,id:l}=a.form;if(e.IsMcn){const e=await(0,s.S)({end_handle_detail:n,end_handle_type:r,end_type:"3"===String(o)?void 0:o,execute_end:"3"===String(o)?1:void 0,id:l,end_time:(i??0)/1e3});e.data.success?(t.root.$message({type:"success",message:"保存成功"}),t.emit("ProjectFinalStep:close"),t.emit("getDetail")):t.root.$message({type:"error",message:e.data.message})}else{const e=await(0,s.U_)({end_handle_detail:n,end_handle_type:r,end_type:"3"===String(o)?void 0:o,execute_end:"3"===String(o)?1:void 0,id:l,end_time:(i??0)/1e3});e.data.success?(t.root.$message({type:"success",message:"保存成功"}),t.emit("ProjectFinalStep:close"),t.emit("getDetail")):t.root.$message({type:"error",message:e.data.message})}}}))},r=()=>{a.form.id=parseInt(t.root.$route.params.id,10),a.form.end_type="",a.form.end_handle_type=1,a.form.end_handle_detail=""},c=()=>{r(),t.emit("ProjectFinalStep:close")};return{ProjectStatusEnum:l.C_,...(0,n.toRefs)(a),enumEndHandleType:o.M4,enumEndType:o.Im,closeDialog:c,resetForm:r,submitForm:i}}}),u=c,d=a(1001),m=(0,d.Z)(u,i,r,!1,null,null,null),p=m.exports},47583:function(e,t,a){a.d(t,{Fy:function(){return l},S:function(){return n},U_:function(){return r},Yd:function(){return s},a$:function(){return o},js:function(){return c},uZ:function(){return u},xZ:function(){return d}});var i=a(76012);function r(e){return(0,i.ZP)({url:"/api/shop_live/end_project",method:"post",data:e})}function n(e){return(0,i.ZP)({url:"/api/shop_live/end_common_project",method:"post",data:e})}function o(e){return(0,i.ZP)({url:"/api/shop_live/update_project_try_live",method:"post",data:e})}function s(e){return(0,i.ZP)({url:"/api/medium/get_company_name_and_id",method:"get",params:e})}function l(e){return(0,i.ZP)({url:"/api/shop_live/update_area_execute",method:"post",data:e})}function c(e){return(0,i.ZP)({url:"/api/shop_live/save_kol_schedule",method:"post",data:e})}function u(e){return(0,i.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:e})}function d(e){return(0,i.ZP)({url:"/api/shop_live/save_operator_schedule",method:"post",data:e})}},6549:function(e,t,a){a.d(t,{C:function(){return r},j:function(){return i}});const i="/api/auth/query_user_v2",r="/api/auth/get_user_by_role"},87939:function(e,t,a){var i,r;a.d(t,{_:function(){return i},o:function(){return r}}),function(e){e[e["Marketing"]=1]="Marketing",e[e["Taobao"]=2]="Taobao",e[e["Douyin"]=3]="Douyin",e[e["Base"]=4]="Base",e[e["Mcn"]=5]="Mcn",e[e["Area"]=6]="Area"}(i||(i={})),function(e){e[e["Summary"]=0]="Summary",e[e["Gmv"]=1]="Gmv",e[e["LiveDuration"]=2]="LiveDuration",e[e["GmvPercent"]=3]="GmvPercent",e[e["OperatingAmount"]=4]="OperatingAmount",e[e["CommissionAmount"]=5]="CommissionAmount",e[e["Roi"]=6]="Roi",e[e["AnchorCount"]=7]="AnchorCount",e[e["PromoteAmountTop"]=8]="PromoteAmountTop",e[e["NetSalesAmount"]=9]="NetSalesAmount",e[e["IncomeAmount"]=10]="IncomeAmount",e[e["AvgStay"]=11]="AvgStay",e[e["PromoteAmount"]=12]="PromoteAmount",e[e["IncomeAmountPercent"]=13]="IncomeAmountPercent",e[e["LiveCount"]=14]="LiveCount",e[e["MaxUv"]=15]="MaxUv",e[e["NewFansCount"]=16]="NewFansCount"}(r||(r={}))},17809:function(e,t,a){a.d(t,{T:function(){return K}});var i={};a.r(i),a.d(i,{setAdvanceDetailVisible:function(){return $},setAdvanceFormDialogVisible:function(){return F},setAdvanceFormVisible:function(){return V},setApproval:function(){return k},setCustomerDetailVisible:function(){return T},setInvoicingDetailVisible:function(){return E},setInvoicingFormVisible:function(){return I},setLoanDetailVisible:function(){return P},setLoanFormVisible:function(){return A},setProjectApprovalVisible:function(){return G},setRedDetailVisible:function(){return L},setRefundDetailVisible:function(){return R},setRefundFormVisible:function(){return M},setSupplierDetailVisible:function(){return N},setUseSealApplyDetailVisible:function(){return Z},setVoidDetailVisible:function(){return W}});var r={};a.r(r),a.d(r,{advanceDetailVisible:function(){return U},advanceFormDialogVisible:function(){return X},advanceFormVisible:function(){return H},approval:function(){return O},customerDetailVisible:function(){return J},loanDetailVisible:function(){return Y},loanFormVisible:function(){return B},refundDetailVisible:function(){return q},refundFormVisible:function(){return z},supplierDetailVisible:function(){return Q}});const n={approval:void 0,loanFormVisible:!1,loanDetailVisible:!1,refundFormVisible:!1,refundDetailVisible:!1,advanceFormDialogVisible:!1,advanceFormVisible:!1,advanceDetailVisible:!1,invoicingFormVisible:!1,invoicingDetailVisible:!1,customerDetailVisible:!1,supplierDetailVisible:!1,redDetailVisible:!1,voidDetailVisible:!1,useSealApplyDetailVisible:!1,projectApprovalVisible:!1};var o=n;const s="SET_APPROVAL",l="CLEAR_APPROVAL",c="SET_LOAN_FORM_VISIBLE",u="SET_LOAN_DETAIL_VISIBLE",d="SET_REFUND_FORM_VISIBLE",m="SET_REFUND_DETAIL_VISIBLE",p="SET_ADVANCE_FORM_DIALOG_VISIBLE",_="SET_ADVANCE_FORM_VISIBLE",v="SET_ADVANCE_DETAIL_VISIBLE",f="SET_INVOICING_FORM_VISIBLE",g="SET_INVOICING_DETAIL_VISIBLE",h="SET_CUSTOMER_DETAIL_VISIBLE",y="SET_SUPPLIER_DETAIL_VISIBLE",b="SET_RED_DETAIL_VISIBLE",w="SET_VOID_DETAIL_VISIBLE",C="SET_USE_SEAL_DETAIL_VISIBLE",x="SET_PROJECT_APPROVAL_VISIBLE";var j=a(64236);const D={[s]:(e,t)=>{e.approval=(0,j.Qc)(t)},[l]:e=>{e.approval=void 0},[c]:(e,t)=>{e.loanFormVisible=t},[u]:(e,t)=>{e.loanDetailVisible=t},[d]:(e,t)=>{e.refundFormVisible=t},[m]:(e,t)=>{e.refundDetailVisible=t},[h]:(e,t)=>{e.customerDetailVisible=t},[y]:(e,t)=>{e.supplierDetailVisible=t},[p]:(e,t)=>{e.advanceFormDialogVisible=t},[_]:(e,t)=>{e.advanceFormVisible=t},[v]:(e,t)=>{e.advanceDetailVisible=t},[f]:(e,t)=>{e.invoicingFormVisible=t},[g]:(e,t)=>{e.invoicingDetailVisible=t},[b]:(e,t)=>{e.redDetailVisible=t},[w]:(e,t)=>{e.voidDetailVisible=t},[C]:(e,t)=>{e.useSealApplyDetailVisible=t},[x]:(e,t)=>{e.projectApprovalVisible=t}};var S=D;const k=({commit:e},t)=>{e(s,t)},A=({commit:e},t)=>{e(c,t)},P=({commit:e},t)=>{e(u,t)},M=({commit:e},t)=>{e(d,t)},R=({commit:e},t)=>{e(m,t)},T=({commit:e},t)=>{e(h,t)},N=({commit:e},t)=>{e(y,t)},F=({commit:e},t)=>{e(p,t)},V=({commit:e},t)=>{e(_,t)},$=({commit:e},t)=>{e(v,t)},I=({commit:e},t)=>{e(f,t)},E=({commit:e},t)=>{e(g,t)},L=({commit:e},t)=>{e(b,t)},W=({commit:e},t)=>{e(w,t)},Z=({commit:e},t)=>{e(C,t)},G=({commit:e},t)=>{e(x,t)},O=e=>e.approval,B=e=>e.loanFormVisible,Y=e=>e.loanDetailVisible,z=e=>e.refundFormVisible,q=e=>e.refundDetailVisible,X=e=>e.advanceFormDialogVisible,H=e=>e.advanceFormVisible,U=e=>e.advanceDetailVisible,J=e=>e.customerDetailVisible,Q=e=>e.supplierDetailVisible,K={namespaced:!0,state:o,mutations:S,actions:i,getters:r}},99575:function(e,t,a){a.d(t,{j_:function(){return ge},QC:function(){return fe},Av:function(){return z},e_:function(){return G},YM:function(){return K},RG:function(){return Q},Ze:function(){return b},$1:function(){return y},hi:function(){return le},Fy:function(){return ce},hx:function(){return B},hU:function(){return X},_Z:function(){return A},vB:function(){return k},Fr:function(){return D},wT:function(){return j},BP:function(){return x},Qd:function(){return Y},s0:function(){return U},Xj:function(){return J},nM:function(){return N},ki:function(){return E},f:function(){return L},Hk:function(){return O},mX:function(){return oe},GU:function(){return se},xU:function(){return H},tG:function(){return Z},OZ:function(){return V},GX:function(){return I},j1:function(){return W},p8:function(){return F},zG:function(){return de},A0:function(){return ue},nA:function(){return S},wf:function(){return Ne},tF:function(){return w},vN:function(){return C},Yf:function(){return me},R5:function(){return R},Te:function(){return $},GH:function(){return M},N1:function(){return ae},NE:function(){return ie},v3:function(){return re},th:function(){return T},Bm:function(){return te},aH:function(){return ee},$V:function(){return P},F7:function(){return ne},LC:function(){return ve},PG:function(){return _e},Be:function(){return we},Cb:function(){return q},p4:function(){return be},gV:function(){return Ce},ji:function(){return ye},Zn:function(){return Te},v6:function(){return Me},mm:function(){return Pe},yD:function(){return he},Zw:function(){return Re},G2:function(){return Ae},_d:function(){return xe},R0:function(){return De},y2:function(){return je},mW:function(){return ke},mI:function(){return Se},LQ:function(){return pe}});a(21703);var i=a(76012),r=(a(48606),a(64236)),n=a(42963),o=a(74750);const s="/api/shop_live/query_ctr_projects",l="/api/shop_live/query_ctr_shop_live",c="/api/shop_live/query_project_shifts",u="/api/shop_live/query_shift_group_ctr_shop_live",d="/api/shop_live/save_shop_live_live_screenshot",m="/api/shop_live/query_shop_live_statistical_trends",p="/api/shop_live/operating/project_trade_funnel",_="/api/shop_live/operating/project_flow_sunburst",v="/api/shop_live/operating/department_project_statistics_detail",f="/api/shop_live/operating/query_project_top_products",g="/api/shop_live/operating/query_department_project_statistics",h="/api/shop_live/operating/get_last_update_time",y=async e=>(0,i.dX)("/api/data_center/query_common_project",{params:{...(0,r.jG)(e)}}),b=async e=>(0,i.dX)("/api/shop_live/query_project_douyin_by_date",{params:{...(0,r.jG)(e)}}),w=async e=>(0,i.dX)("/api/data_center/query_shop_live_project",{params:{...(0,r.jG)(e)}}),C=async e=>(0,i.dX)("/api/data_center/query_cooperation",{params:{...(0,r.jG)(e)}}),x=async e=>(0,i.dX)("/api/data_center/table",{params:{...(0,r.jG)(e)}}),j=async e=>(0,i.dX)("/api/data_center/chart",{params:{...(0,r.jG)(e)}}),D=async()=>(0,i.dX)("/api/data_center/customer_supplier_manage_table"),S=async()=>(0,i.dX)("/api/data_center/invoice_apply_table"),k=async()=>(0,i.dX)("/api/data_center/customer_pay_apply_table"),A=async()=>(0,i.dX)("/api/data_center/contract_apply_table"),P=async()=>(0,i.dX)("/api/data_center/system_login_table"),M=async()=>(0,i.dX)("/api/data_center/settlement_table"),R=async()=>(0,i.dX)("/api/data_center/project_table"),T=async()=>(0,i.dX)("/api/data_center/shop_live_table"),N=async e=>(0,i.dX)("/api/shop_live/douyin_category_pie_chart",{params:{...(0,r.jG)(e)}}),F=async e=>(0,i.dX)("/api/shop_live/douyin_old_category_pie_chart",{params:{...(0,r.jG)(e)}}),V=async e=>(0,i.dX)("/api/shop_live/douyin_item_pie_chart",{params:{...(0,r.jG)(e)}}),$=async()=>(0,i.dX)("/api/shop_live/query_douyin_report_projects"),I=async e=>e.is_from_project?e.room_id&&""!==e.room_id?(0,i.dX)("/api/shop_live/project_data/douyin_item_report_by_room",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/shop_live/project_data/douyin_item_report",{params:{...(0,r.jG)(e)}}):e.room_id&&""!==e.room_id?(0,i.dX)("/api/shop_live/operating/douyin_item_report_by_room",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/shop_live/douyin_item_report",{params:{...(0,r.jG)(e)}}),E=async e=>(0,i.dX)("/api/shop_live/douyin_category_report",{params:{...(0,r.jG)(e)}}),L=async e=>(0,i.dX)("/api/shop_live/douyin_category_timeline",{params:{...(0,r.jG)(e)}}),W=async e=>(0,i.dX)("/api/shop_live/douyin_item_timeline",{params:{...(0,r.jG)(e)}}),Z=async e=>(0,i.dX)("/api/shop_live/douyin_hot_item_report",{params:{...(0,r.jG)(e)}}),G=async e=>(0,i.dX)("/api/shop_live/check_project_douyin_access",{params:{...(0,r.jG)(e)}}),O=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_item_categories",{params:{...(0,r.jG)(e)}}),B=async()=>(0,i.dX)("/api/shop_live/query_douyin_competitive_shops"),Y=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_items",{params:{...(0,r.jG)(e)}}),z=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_items_total",{params:{...(0,r.jG)(e)}}),q=e=>(0,i.SO)("/api/shop_live/update_douyin_competitive_shops",{...(0,r.jG)({shop_names:e})}),X=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_item_timeline",{params:{...(0,r.jG)(e)}}),H=async()=>(0,i.dX)("/api/data_center/douyin_composite_categories"),U=async e=>(0,i.dX)("/api/data_center/douyin_category_image",{params:{...(0,r.jG)(e)}}),J=async e=>(0,i.dX)("/api/data_center/douyin_category_image_detail",{params:{...(0,r.jG)(e)}}),Q=async e=>(0,i.dX)("/api/shop_live/douyin_year_season_report",{params:{...(0,r.jG)(e)}}),K=async e=>(0,i.dX)("/api/shop_live/douyin_season_year_report",{params:{...(0,r.jG)(e)}}),ee=async e=>(0,i.dX)("/api/shop_live/query_douyin_tiange_category",{params:{...(0,r.jG)(e)}}),te=async e=>e.is_from_project?(0,i.dX)("/api/shop_live/project_data/douyin_tiange_category_report",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/shop_live/douyin_tiange_category_report",{params:{...(0,r.jG)(e)}}),ae=async e=>(0,i.dX)("/api/shop_live/list_douyin_season",{params:{...(0,r.jG)(e)}}),ie=async e=>(0,i.dX)("/api/shop_live/list_douyin_season_year",{params:{...(0,r.jG)(e)}}),re=async e=>e.room_id&&""!==e.room_id?e.is_from_project?(0,i.dX)("/api/shop_live/project_data/query_douyin_tiange_category_by_room",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/shop_live/operating/query_douyin_tiange_category_by_room",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/shop_live/query_douyin_tiange_category",{params:{...(0,r.jG)(e)}}),ne=async e=>(0,i.dX)("/api/shop_live/douyin_contrast_category_timeline",{params:{...(0,r.jG)(e)}}),oe=async e=>(0,i.dX)("/api/data_center/get_douyin_completion_schedule_detail",{params:{...(0,r.jG)(e)}}),se=async e=>(0,i.dX)("/api/data_center/query_douyin_completion_schedule_trend",{params:{...(0,r.jG)(e)}}),le=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_analysis",{params:{...(0,r.jG)(e)}}),ce=async e=>(0,i.dX)("/api/shop_live/query_douyin_competitive_analysis_detail",{params:{...(0,r.jG)(e)}}),ue=async e=>(0,i.dX)("/api/shop_live/query_feigua_hot_item_project",{params:{...(0,r.jG)(e)}}),de=async e=>(0,i.dX)("/api/data_center/hot_item",{params:{...(0,r.jG)(e)}}),me=async e=>(0,i.dX)("/api/data_center/feigua_monitor_config",{params:{...(0,r.jG)(e)}}),pe=e=>(0,i.SO)("/api/data_center/feigua_monitor_config",{...(0,r.jG)(e)}),_e=async(e,t=!1)=>t?(0,i.dX)("/api/data_center/hot_style_every_month",{params:{...(0,r.jG)(e)}}):(0,i.dX)("/api/data_center/hot_style_every_week",{params:{...(0,r.jG)(e)}}),ve=async()=>(0,i.dX)("/api/data_center/tiange_douyin_category",{params:{...(0,r.jG)({level:3})}}),fe=e=>{const t=(0,r.jG)(e),a=n.stringify(t),i=(0,o.LP)();window.open(`https://data.goumee.com/api/shop_live/export_douyin_tiange_category_report?${a}&Authorization=${i}`)},ge=e=>{if(e.room_id&&""!==e.room_id){const t=(0,o.LP)();if(e.is_from_project){e.is_from_project=void 0;const a=(0,r.jG)(e),i=n.stringify(a);window.open(`https://data.goumee.com/api/shop_live/project_data/export_douyin_item_report_by_room?${i}&Authorization=${t}`)}else{e.is_from_project=void 0;const a=(0,r.jG)(e),i=n.stringify(a);window.open(`https://data.goumee.com/api/shop_live/operating/export_douyin_item_report_by_room?${i}&Authorization=${t}`)}}else{e.is_from_project=void 0,e.room_id=void 0;const t=(0,r.jG)(e),a=n.stringify(t),i=(0,o.LP)();window.open(`https://data.goumee.com/api/shop_live/export_douyin_item_report?${a}&Authorization=${i}`)}},he=async()=>(0,i.dX)(c),ye=async e=>(0,i.dX)(l,{params:{...(0,r.jG)(e)}}),be=e=>(0,i.SO)("/api/shop_live/save_shift",{...(0,r.jG)(e)}),we=e=>(0,i.SO)("/api/shop_live/save_shop_live_change_tips",{...e}),Ce=e=>(0,i.dX)(s,{params:{...(0,r.jG)(e??{})}}),xe=e=>(0,i.dX)(u,{params:{...(0,r.jG)(e)}}),je=(e,t)=>(0,i.SO)(d,{...(0,r.jG)({id:e,live_screenshot:t})}),De=e=>(0,i.dX)(m,{params:{...(0,r.jG)(e)}}),Se=async e=>(0,i.dX)("/api/shop_live/query_douyin_category_competitive_items_total",{params:{...(0,r.jG)(e)}}),ke=async(e,t)=>(0,i.dX)("/api/shop_live/get_dp_shop_orders_presell_stat_day",{params:{...(0,r.jG)({...e,...t})}}),Ae=async e=>(0,i.dX)(p,{params:{...(0,r.jG)({...e})}}),Pe=async e=>(0,i.dX)(_,{params:{...(0,r.jG)({...e})}}),Me=async e=>(0,i.dX)(v,{params:{...(0,r.jG)({...e})}}),Re=async e=>(0,i.dX)(f,{params:{...(0,r.jG)({...e})}}),Te=async e=>(0,i.dX)(g,{params:{...(0,r.jG)({...e})}}),Ne=async()=>(0,i.dX)(h)},14782:function(e,t,a){a.d(t,{g:function(){return n},s:function(){return o}});var i=a(76012),r=a(6549);const n=async()=>(0,i.dX)(r.C,{params:{roles:1003}}),o=async()=>(0,i.dX)(r.C,{params:{roles:1008}})},66870:function(e,t,a){var i;a.d(t,{Ix:function(){return o},dr:function(){return n},en:function(){return r},wG:function(){return i}}),function(e){e[e["waitingSchedule"]=1]="waitingSchedule",e[e["waitingLive"]=2]="waitingLive",e[e["waitingTypeIn"]=3]="waitingTypeIn",e[e["lived"]=4]="lived"}(i||(i={}));const r=new Map([[i.waitingSchedule,"待排班"],[i.waitingLive,"待直播"],[i.waitingTypeIn,"待录入"],[i.lived,"已直播"]]);new Map([[i.waitingSchedule,"yellow"],[i.waitingLive,"green"],[i.waitingTypeIn,"yellow"],[i.lived,"gray"]]);var n,o;(function(e){e[e["brand_name"]=1]="brand_name",e[e["studio_name"]=2]="studio_name",e[e["shop_name"]=3]="shop_name",e[e["project_uid"]=4]="project_uid",e[e["live_title"]=5]="live_title",e[e["kol_name"]=6]="kol_name",e[e["operation_assistant_name"]=7]="operation_assistant_name",e[e["project_name"]=8]="project_name"})(n||(n={})),function(e){e[e["Month"]=1]="Month",e[e["Week"]=2]="Week"}(o||(o={}))},43847:function(e,t,a){a.d(t,{Pc:function(){return o},oR:function(){return n}});var i=a(77944),r=a(97434);const n=()=>i.Z,o=()=>{const e=n(),t=(0,r.computed)((()=>e.getters["user/getUserInfo"]));return t}},45781:function(e,t,a){var i=a(49187),r=a(8581),n=a(61282);const o=new i.ZP;t["Z"]={formatEmpty(e,t){return null===e||void 0===e||""===e||e instanceof Array&&e.length<=0?"--":void 0!==t?`${e}${t}`:e},formatTime(e){try{return null===e||void 0===e||""===e?"--":e.replace(/-/g,".")}catch(t){return e}},formatTimespan(e){try{if(null===e||void 0===e||""===e)return"--";const t=new Date;return t.setTime(1e3*e),(0,r.WU)(t,"YYYY.mm.dd")}catch(t){return e}},formatPrice(e,t=i.WL.Fen,a=!0){try{if(null===e||void 0===e||""===e)return"--";const i=o.format(o.parse(e,t));return a?`￥${i}`:i}catch(r){return e}},formatPriceFormYuan(e,t=2,a=!0){try{if(null===e||void 0===e||""===e)return"--";let i=e;return i=e>1e8?(e/1e8).toFixed(t)+"亿":e>1e4?(e/1e4).toFixed(t)+"w":(e-0).toFixed(t),a&&(i=`￥${i}`),i}catch(i){return e}},formatPriceToThousand(e,t=2,a=!0,i=!1){try{if(null===e||void 0===e||""===e)return"--";let r=e;return e>1e4?r=(e/1e4).toFixed(t)+"w":(r=(e-0).toFixed(t),i&&(r=(e-0).toFixed(0))),a&&(r=`￥${r}`),r}catch(r){return e}},formatPriceToThousandformatAmount(e,t=2,a=!0,i=!1){try{if(null===e||void 0===e||""===e)return"--";let r=e;return e>1e4?r=(0,n.dN)((e/1e4).toFixed(2),"None")+"w":(r=(0,n.dN)((e-0).toFixed(t),"None",0===t),i&&(r=(e-0).toFixed(0))),a&&(r=`￥${r}`),r}catch(r){return e}},tranNumber(e,t=2){if(null===e||void 0===e||""===e)return"--";if(!(e>=0))return e||"-";e+="";const a=e.toString(),i=a.split(".")[0],r=i.length;if(r<5)return a;if(r>8){const e=i.substring(i.length-8,i.length-8+t);return parseFloat(parseInt(i/1e8+"",10)+"."+e)+"亿"}if(r>4){const e=i.substring(i.length-4,i.length-4+t);return parseFloat(parseInt(i/1e4+"",10)+"."+e)+"w"}}}},40884:function(e,t,a){var i=a(97434);t["Z"]=(0,i.defineComponent)({name:"TgBtnCapsule",model:{prop:"value",event:"click"},props:{value:{type:String,required:!0}},setup(e,t){const a=(0,i.ref)(e.value),r=(0,i.computed)((()=>"left"===a.value)),n=(0,i.computed)((()=>"right"===a.value)),o=(0,i.computed)((()=>["btn-capsule-left",r.value?"active":""])),s=(0,i.computed)((()=>["btn-capsule-right",n.value?"active":""])),l=e=>{a.value=e,t.emit("click",e)};return{isLeftActive:r,isRightActive:n,leftClass:o,rightClass:s,setActive:l}},render(){const e=arguments[0],t=e("div",{class:this.leftClass,on:{click:()=>{this.isLeftActive||this.setActive("left")}}},[this.$slots.left]),a=e("div",{class:this.rightClass,on:{click:()=>{this.isRightActive||this.setActive("right")}}},[this.$slots.right]);return e("div",{class:"btn-capsule"},[t,e("div",{class:"sep"}),a])}})}}]);