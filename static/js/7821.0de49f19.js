"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[7821],{169:function(a,e,t){t.r(e),t.d(e,{default:function(){return ua}});var s=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"tg-page-container tg-workbench-page"},[t("tg-breadcrumbs",{attrs:{routes:a.routes}}),t("mine",{tag:"component",staticClass:"tg-workbench-tab-pane flex-auto"}),t("LoanFormModal",{attrs:{visible:a.loanFormVisible,approval:a.approval},on:{"dialog:close":a.onLoanFormClose,close:a.onLoanFormClose,"reload:loan":function(e){return a.triggerReload("loan")}}}),a.loanDetailVisible?t("PaymentDetailDialog",{attrs:{visible:a.loanDetailVisible,info:a.approval},on:{"dialog:close":a.onLoanDetailClose,"reload:refund":function(e){return a.triggerReload("refund")}}}):a._e(),t("RefundFormModal",{attrs:{visible:a.refundFormVisible,approval:a.approval},on:{"dialog:close":a.onRefundFormClose,close:a.onRefundFormClose,"reload:refund":function(e){return a.triggerReload("refund")}}}),a.refundDetailVisible?t("RefundDetailDialog",{attrs:{visible:a.refundDetailVisible,info:a.approval},on:{"dialog:close":a.onRefundDetailClose,"reload:refund":function(e){return a.triggerReload("refund")}}}):a._e(),a.customerDetailVisible?t("CustomerDetailDialog",{attrs:{visible:a.customerDetailVisible,info:a.approval},on:{"dialog:close":a.onCustomerDetailClose,"reload:refund":function(e){return a.triggerReload("refund")}}}):a._e(),a.supplierDetailVisible?t("Supplier",{attrs:{visible:a.supplierDetailVisible,info:a.approval},on:{"dialog:close":a.onSupplierDetailClose,"reload:refund":function(e){return a.triggerReload("refund")}}}):a._e(),a.advanceDetailVisible?t("ApplicationDetail",{ref:"applicationDetail",on:{close:a.onAdvanceDetailClose,"reload:application":function(e){return a.triggerReload("application")}}}):a._e(),a.invoicingDetailVisible?t("InvoicesDetail",{ref:"invoicingDetail",on:{close:a.onInvoicingDetailClose,"reload:invoices":function(e){return a.triggerReload("invoices")}}}):a._e(),a.advanceDetailVisible?t("AdvanceDetailDialog",{ref:"advanceDetailDialog",attrs:{visible:a.advanceDetailVisible,info:a.approval},on:{"dialog:close":a.onAdvanceDetailClose,"reload:application":function(e){return a.triggerReload("advance")}}}):a._e(),a.redDetailVisible?t("RedDetail",{ref:"redDetailDialog",on:{close:a.onRedDetailClose,success:function(e){return a.triggerReload("red")}}}):a._e(),a.voidDetailVisible?t("VoidDetail",{ref:"voidDetailDialog",on:{close:a.onVoidDetailClose}}):a._e(),a.useSealApplyDetailVisible?t("UseSealApplyDetail",{ref:"useSealApplyDetailDialog",on:{close:a.onUseSeaalDetailClose,success:function(e){return a.triggerReload("seal")}}}):a._e()],1)},l=[],i=t(97434),o=t(23812),n=t(48797),r=t(75752),c=t(5418),v=t(72301),d=t(17809),p=t(11461),u=t(30340),_=t(42634),m=t(16091),f=t(91660),b=t(61871),C=t(86701),g=t(33018),D=t(5968),h=t(7629),y=t(41532),w=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new advance-detail-dialog customer-detail-dialog",attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:a.visible,isAppendToBody:!0,isfooter:!0,width:"948px"},on:{close:a.emitClose},scopedSlots:a._u([{key:"title",fn:function(){return[t("span",[a._v(a._s(9===a.info.approval_type?"客户":"供应商")+"结算单审批")])]},proxy:!0},{key:"footer",fn:function(){return[t("tg-button",{attrs:{type:"default"},on:{click:a.emitClose}},[a._v("取消")]),1===a.info.approval_status?t("tg-button",{on:{click:a.handleSubmit}},[a._v("撤销")]):a._e(),3===a.info.approval_status&&a.info.partner_id?t("tg-button",{on:{click:a.resubmit}},[a._v("重新提交")]):a._e()]},proxy:!0}])},[t("div",{staticClass:"detail-wrapper"},[t("div",{staticClass:"left-wrapper"},[t("div",{staticClass:"left-header"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("申请人：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.username))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("申请部门：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.create_department))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("发起时间：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.gmt_create.replace(/-/g,".")))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("审批编号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.approval_uid))]),1===a.info.approval_status?t("span",{staticClass:"status"},[a._v("审批中")]):2===a.info.approval_status?t("span",{staticClass:"status success"},[a._v("审批通过")]):3===a.info.approval_status?t("span",{staticClass:"status error"},[a._v("审批失败")]):t("span",{staticClass:"status revoke"},[a._v("已撤销")])])]),t("div",{staticClass:"left-body"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("合同编号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.contract_uid))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("客户名称：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.customer_name))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("项目：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.project_name))])]),5!==a.info.business_type?t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("品牌：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.brand_name?a.info.brand_name:"--"))])]):a._e(),t("div",{class:["line",5===a.info.business_type?"right":"left"]},[t("p",{staticClass:"label"},[a._v("审批金额：")]),t("div",{staticClass:"value"},[a._v(a._s(a.numberFormat(a.info.approve_amount,2)))])]),t("div",{class:["line",5===a.info.business_type?"left":"right"]},[t("p",{staticClass:"label"},[a._v("用章情况：")]),1===a.info.seal_type?t("div",{staticClass:"value"},[a._v("不同印章")]):2===a.info.seal_type?t("div",{staticClass:"value"},[a._v("公章")]):t("div",{staticClass:"value"},[a._v("合同章")])]),t("div",{staticClass:"line",staticStyle:{height:"auto","margin-bottom":"24px"}},[t("p",{staticClass:"label"},[a._v("申请内容：")]),t("div",{staticClass:"value line-value"},[a._v(a._s(a.info.approval_content))])]),t("div",{staticClass:"table-wrapper"},[t("el-table",{attrs:{data:a.info.details,border:""}},[t("el-table-column",{attrs:{align:"left",label:"结算方式",width:"93"},scopedSlots:a._u([{key:"default",fn:function(e){return[1===e.row.settlement_way?t("span",[a._v("对公银行")]):2===e.row.settlement_way?t("span",[a._v("支付宝")]):3===e.row.settlement_way?t("span",[a._v("V任务")]):4===e.row.settlement_way?t("span",[a._v("淘宝联盟")]):t("span",[a._v("巨量百应")])]}}])}),t("el-table-column",{attrs:{align:"right",label:"结算金额",width:"148"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(a.numberFormat(e.row.settle_amount,2)))]}}])}),t("el-table-column",{attrs:{align:"left",label:"开始日期",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(e.row.start_date))]}}])}),t("el-table-column",{attrs:{align:"left",label:"结束日期",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(e.row.end_date))]}}])}),t("el-table-column",{attrs:{align:"left",label:"备注",width:"190"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.comment.length>12?t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:e.row.comment}},[t("p",{staticClass:"line-clamp-1",staticStyle:{width:"170px"},attrs:{slot:"reference"},slot:"reference"},[a._v(" "+a._s(e.row.comment)+" ")])]):t("p",[a._v(" "+a._s(e.row.comment?e.row.comment:"--")+" ")])]}}])})],1)],1),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("附件：")]),t("div",{staticClass:"value line-value"},[a.info.attachment&&a.info.attachment.length>0?[t("Appendix",{attrs:{list:a.info.attachment}})]:t("span",[a._v("--")])],2)])])]),t("div",{staticClass:"right-wrapper"},[t("h5",{staticClass:"right-wrapper-title"},[a._v("审批进度")]),t("WorkbenchTimeLine",{attrs:{"step-status":a.info.approval_status,items:a.info.approval_flow_detail}})],1)])]),t("add-settlement-dialog",{ref:"settlementDialogRef",attrs:{"edit-data":a.editData},on:{added:a.confirmSettlementDialog}}),t("add-statement",{attrs:{visible:a.settlementDialogVisible,isfromworkbench:!0,editData:a.editData},on:{"dialog:close":a.confirmSettlementDialog}}),t("tg-mask-loading",{attrs:{visible:a.saveLoading,content:"  正在提交，请稍候..."}})],1)},k=[],S=t(24643),V=t(79703),x=t(17660),A=t(51351),R=t(64236),F=t(65475),Z=t(82741),L=t(66626),$=(0,i.defineComponent)({name:"advanceDetailDialog",props:{visible:{type:Boolean,required:!1},info:{type:Object,default:()=>({})}},components:{Appendix:V.Z,WorkbenchTimeLine:x.Z,addSettlementDialog:F.Z,AddStatement:L.Z},setup(a,e){const t=(0,i.ref)(!1),s=(0,i.ref)(null),l=(0,i.ref)(!1),o=(a=!1)=>{e.emit("dialog:close",a)},n=async()=>{const s=await new Promise((a=>{e.root.$TDialog({title:"你确定撤销吗",onConfirm:()=>{a(!0)},onCancel:()=>{a(!1)}})}));if(!s)return;t.value=!0;const l={approval_id:a.info.approval_id,update_code:4},[{data:i},n]=await Promise.all([await(0,A.qL)(l),await(0,R._v)(200)]);t.value=!1,i.success?(o(),e.emit("reload:refund",!0),e.root.$message.success("撤销成功")):e.root.$message.error(i.message??"撤销失败")},r=()=>{s.value?.show()},c=a=>{l.value=!1,a&&(o(),e.emit("reload:refund",!0))},v=(0,i.ref)({contract_no:void 0,partner_name:void 0,contract_id:11111111,approval_amount:void 0,comment:"",attachment_url:"",project_id:"",settlement_detail:[{settle_amount:"",settle_way:1,start_date:"",end_date:"",done_amount:"",wait_amount:"",invoice_amount:"",remark:"",shop_name:"",wangwang_num:""}],isEdit:!0}),d=(0,i.ref)(void 0),p=(0,i.ref)({brand_name:"",business_type:"",cooperation_name:"",project_name:"",id:""}),u=(0,i.ref)({contract_info:{id:"",partner_id:"",contract_uid:""},partner_info:{partner_name:""}});(0,i.provide)("project_add_id",d),(0,i.provide)("project",p),(0,i.provide)("contract",u);const _=async()=>{const t=await(0,Z.I)(e,"你确定重新申请吗?");t&&(9===a.info.approval_type?l.value=!0:r())};return(0,i.onMounted)((()=>{v.value=Object.assign({},v.value,{contract_id:a.info.contract_id,contract_no:a.info.contract_uid,partner_name:a.info.customer_name,partner_id:a.info.partner_id,approval_amount:a.info.approve_amount,comment:a.info.approval_content,attachment_url:a.info.attachment.join(","),business_type:a.info.business_type,project_id:a.info.project_id,contract_type:a.info.contract_type,settlement_detail:a.info.details.map((a=>({settle_amount:a.settle_amount,settle_way:a.settlement_way,start_date:a.start_date?.replaceAll(".","-"),end_date:a.end_date?.replaceAll(".","-"),done_amount:"",wait_amount:"",invoice_amount:"",remark:a.comment,shop_name:a.shop_name,wangwang_num:a.wangwang_name})))}),u.value={contract_info:{id:a.info.contract_id,partner_id:a.info.partner_id,contract_uid:a.info.contract_uid},partner_info:{partner_name:a.info.customer_name}},d.value=a.info.project_id,p.value=Object.assign({},{brand_name:a.info.brand_name,business_type:a.info.business_type,cooperation_name:a.info.project_name,project_name:a.info.project_name,id:a.info.project_id})})),{emitClose:o,numberFormat:S.Y4,saveLoading:t,handleSubmit:n,resubmit:_,settlementDialogRef:s,settlementDialogVisible:l,addSettlementDialog:F.Z,confirmSettlementDialog:c,editData:v}}}),j=$,T=t(1001),M=(0,T.Z)(j,w,k,!1,null,"c40171b2",null),U=M.exports,W=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new advance-detail-dialog customer-detail-dialog",attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:a.visible,isAppendToBody:!0,isfooter:!0,width:"948px"},on:{close:a.emitClose},scopedSlots:a._u([{key:"title",fn:function(){return[t("span",[a._v("供应商结算单审批")])]},proxy:!0},{key:"footer",fn:function(){return[t("tg-button",{attrs:{type:"default"},on:{click:a.emitClose}},[a._v("取消")]),1===a.info.approval_status?t("tg-button",{on:{click:a.handleSubmit}},[a._v("撤销")]):a._e()]},proxy:!0}])},[t("div",{staticClass:"detail-wrapper"},[t("div",{staticClass:"left-wrapper"},[t("div",{staticClass:"left-header"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("申请人：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.username))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("申请部门：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.create_department))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("发起时间：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.gmt_create.replace(/-/g,".")))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("审批编号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.approval_uid))]),1===a.info.approval_status?t("span",{staticClass:"status"},[a._v("审批中")]):2===a.info.approval_status?t("span",{staticClass:"status success"},[a._v("审批通过")]):3===a.info.approval_status?t("span",{staticClass:"status error"},[a._v("审批失败")]):t("span",{staticClass:"status revoke"},[a._v("已撤销")])])]),t("div",{staticClass:"left-body"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("合同编号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.contract_uid))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("客户名称：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.customer_name))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("项目：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.project_name))])]),5!==a.info.business_type?t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("品牌：")]),t("div",{staticClass:"value"},[a._v(a._s(a.info.brand_name?a.info.brand_name:"--"))])]):a._e(),t("div",{class:["line",5===a.info.business_type?"right":"left"]},[t("p",{staticClass:"label"},[a._v("审批金额：")]),t("div",{staticClass:"value"},[a._v(a._s(a.numberFormat(a.info.approve_amount,2)))])]),t("div",{class:["line",5===a.info.business_type?"left":"right"]},[t("p",{staticClass:"label"},[a._v("用章情况：")]),1===a.info.seal_type?t("div",{staticClass:"value"},[a._v("不同印章")]):2===a.info.seal_type?t("div",{staticClass:"value"},[a._v("公章")]):t("div",{staticClass:"value"},[a._v("合同章")])]),t("div",{staticClass:"line",staticStyle:{height:"auto","margin-bottom":"24px"}},[t("p",{staticClass:"label"},[a._v("申请内容：")]),t("div",{staticClass:"value line-value"},[a._v(a._s(a.info.approval_content))])]),t("div",{staticClass:"table-wrapper"},[t("el-table",{attrs:{data:a.info.details,border:""}},[t("el-table-column",{attrs:{align:"left",label:"结算方式",width:"93"},scopedSlots:a._u([{key:"default",fn:function(e){return[1===e.row.settlement_way?t("span",[a._v("对公银行")]):2===e.row.settlement_way?t("span",[a._v("支付宝")]):3===e.row.settlement_way?t("span",[a._v("V任务")]):4===e.row.settlement_way?t("span",[a._v("淘宝联盟")]):t("span",[a._v("巨量百应")])]}}])}),t("el-table-column",{attrs:{align:"right",label:"结算金额",width:"148"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(a.numberFormat(e.row.settle_amount,2)))]}}])}),t("el-table-column",{attrs:{align:"left",label:"开始日期",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(e.row.start_date))]}}])}),t("el-table-column",{attrs:{align:"left",label:"结束日期",width:"100"},scopedSlots:a._u([{key:"default",fn:function(e){return[a._v(a._s(e.row.end_date))]}}])}),t("el-table-column",{attrs:{align:"left",label:"备注",width:"190"},scopedSlots:a._u([{key:"default",fn:function(e){return[e.row.comment.length>12?t("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:e.row.comment}},[t("p",{staticClass:"line-clamp-1",staticStyle:{width:"170px"},attrs:{slot:"reference"},slot:"reference"},[a._v(" "+a._s(e.row.comment)+" ")])]):t("p",[a._v(" "+a._s(e.row.comment?e.row.comment:"--")+" ")])]}}])})],1)],1),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("附件：")]),t("div",{staticClass:"value line-value"},[a.info.attachment&&a.info.attachment.length>0?[t("Appendix",{attrs:{list:a.info.attachment}})]:t("span",[a._v("--")])],2)])])]),t("div",{staticClass:"right-wrapper"},[t("h5",{staticClass:"right-wrapper-title"},[a._v("审批进度")]),t("WorkbenchTimeLine",{attrs:{"step-status":a.info.approval_status,items:a.info.approval_flow_detail}})],1)])]),t("tg-mask-loading",{attrs:{visible:a.saveLoading,content:"  正在提交，请稍候..."}})],1)},E=[],I=(0,i.defineComponent)({name:"advanceDetailDialog",props:{visible:{type:Boolean,required:!1},info:{type:Object,default:()=>({})}},components:{Appendix:V.Z,WorkbenchTimeLine:x.Z},setup(a,e){const t=(0,i.ref)(!1),s=(a=!1)=>{e.emit("dialog:close",a)},l=async()=>{const l=await new Promise((a=>{e.root.$TDialog({title:"你确定撤销吗",onConfirm:()=>{a(!0)},onCancel:()=>{a(!1)}})}));if(!l)return;t.value=!0;const i={approval_id:a.info.approval_id,update_code:4},[{data:o},n]=await Promise.all([await(0,A.qL)(i),await(0,R._v)(200)]);t.value=!1,o.success?(s(),e.emit("reload:refund",!0),e.root.$message.success("撤销成功")):e.root.$message.error(o.message??"撤销失败")};return{emitClose:s,numberFormat:S.Y4,saveLoading:t,handleSubmit:l}}}),P=I,Y=(0,T.Z)(P,W,E,!1,null,"60763af6",null),B=Y.exports,O=t(63995),q=function(){var a=this,e=a.$createElement,t=a._self._c||e;return a.visible?t("div",[t("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new advance-detail-dialog red-detail-dialog",attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:a.visible,isAppendToBody:!0,isfooter:!0,width:"948px"},on:{close:a.emitClose},scopedSlots:a._u([{key:"title",fn:function(){return[t("span",[a._v("发票作废申请详情")])]},proxy:!0},{key:"footer",fn:function(){return[t("tg-button",{attrs:{type:"default"},on:{click:a.emitClose}},[a._v("取消")])]},proxy:!0}],null,!1,2790475858)},[t("div",{staticClass:"detail-wrapper"},[t("div",{staticClass:"left-wrapper"},[t("div",{staticClass:"left-header"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("申请人：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.username))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("申请部门：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.create_department))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("发起时间：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.gmt_create.replace(/-/g,".")))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("审批编号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.approval_uid))]),1===a.baseData.approval_status?t("span",{staticClass:"status"},[a._v("审批中")]):2===a.baseData.approval_status?t("span",{staticClass:"status success"},[a._v("审批通过")]):3===a.baseData.approval_status?t("span",{staticClass:"status error"},[a._v("审批失败")]):t("span",{staticClass:"status revoke"},[a._v("已撤销")])])]),t("div",{staticClass:"left-body"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("开票时间：")]),t("div",{staticClass:"value"},[a._v(" "+a._s(a.moment(1e3*a.baseData.approval_detail.invoice_date).format("YYYY.MM.DD"))+" ")])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("发票号码：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.approval_detail.invoice_number))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("发票代码：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.approval_detail.invoice_code))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("开票金额负数：")]),t("div",{staticClass:"value"},[a._v("￥"+a._s(a.baseData.approval_detail.total_amount))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("购买方：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.approval_detail.buyer_name))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("纳税人识别号：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.approval_detail.buyer_tax_number))])]),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("作废原因：")]),t("div",{staticClass:"value line-value"},[a._v(" "+a._s(a.baseData.approval_detail.remark?a.baseData.approval_detail.remark:"--")+" ")])])])]),t("div",{staticClass:"right-wrapper"},[t("h5",{staticClass:"right-wrapper-title"},[a._v("审批进度")]),t("WorkbenchTimeLine",{attrs:{"step-status":a.baseData.approval_status,items:a.baseData.approval_flow_detail}})],1)])])],1):a._e()},G=[],z=t(6933),H=t.n(z),K=(0,i.defineComponent)({name:"InvoiceVoidDetailDialog",components:{WorkbenchTimeLine:x.Z},setup(a,e){const t=(0,i.ref)(!1),s=(0,i.ref)(!1),l=(0,i.ref)(null),o=()=>{s.value=!1,e.emit("close")},n=a=>{l.value=a,s.value=!0},r=()=>{o(),e.emit("success")};return{visible:s,emitClose:o,numberFormat:S.Y4,edit:t,baseData:l,reClose:r,show:n,moment:H()}}}),Q=K,X=(0,T.Z)(Q,q,G,!1,null,"38e23658",null),J=X.exports,N=function(){var a=this,e=a.$createElement,t=a._self._c||e;return a.visible?t("div",[t("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter-new use-seal-apply-detail-dialog",attrs:{"close-on-press-escape":!1,"close-on-click-modal":!1,visible:a.visible,isAppendToBody:!0,isfooter:!0,width:"970px"},on:{close:a.emitClose},scopedSlots:a._u([{key:"title",fn:function(){return[t("span",[a._v("非合同用印申请")])]},proxy:!0},{key:"footer",fn:function(){return[t("tg-button",{attrs:{type:"default"},on:{click:a.emitClose}},[a._v("取消")]),3===a.baseData.approval_status?t("div",{staticClass:"div-default-btn",on:{click:a.reSubmit}},[a._v(" 重新编辑提交 ")]):a._e()]},proxy:!0}],null,!1,3813647889)},[t("div",{staticClass:"detail-wrapper"},[t("div",{staticClass:"left-wrapper"},[t("div",{staticClass:"left-header"},[t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("申请人：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.username))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("申请部门：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.create_department))])]),t("div",{staticClass:"line left"},[t("p",{staticClass:"label"},[a._v("发起时间：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.gmt_create.replace(/-/g,".")))])]),t("div",{staticClass:"line right"},[t("p",{staticClass:"label"},[a._v("审批编号：")]),t("div",{staticClass:"value",staticStyle:{"flex-shrink":"0"}},[a._v(a._s(a.baseData.approval_uid))]),1===a.baseData.approval_status?t("span",{staticClass:"status",staticStyle:{"flex-shrink":"0"}},[a._v("审批中")]):2===a.baseData.approval_status?t("span",{staticClass:"status success",staticStyle:{"flex-shrink":"0"}},[a._v("审批通过")]):3===a.baseData.approval_status?t("span",{staticClass:"status error",staticStyle:{"flex-shrink":"0"}},[a._v("审批失败")]):t("span",{staticClass:"status revoke",staticStyle:{"flex-shrink":"0"}},[a._v("已撤销")])])]),t("div",{staticClass:"left-body"},[t("div",{staticClass:"grid-two-column"},[t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("合作方公司全称：")]),t("tg-textPopover",{attrs:{text:a.baseData.cooperation_company_name,textClass:"value",maxWidth:158}})],1),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("公司名称：")]),t("tg-textPopover",{attrs:{text:a.company_name(a.baseData),textClass:"value",maxWidth:158}})],1),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("印章名称：")]),t("div",{staticClass:"value"},[a._v(a._s(a.seal_name(a.baseData)))])]),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("涉及金额：")]),t("div",{staticClass:"value"},[a._v(a._s(a.amount(a.baseData)))])]),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("是否需要外带：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.is_take_out?"是":"否"))])]),a.baseData.is_take_out?t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("外带时间：")]),t("div",{staticClass:"value"},[a._v(a._s(a.task_out_date_str(a.baseData)))])]):a._e(),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("所属事项：")]),t("div",{staticClass:"value"},[a._v(a._s(a.matter_name(a.baseData)))])]),2===a.baseData.matter_type?t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("业务类型：")]),t("div",{staticClass:"value"},[a._v(a._s(a.business_type_name(a.baseData)))])]):a._e(),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("文件名称：")]),t("tg-textPopover",{attrs:{text:a.baseData.file_name,textClass:"value",maxWidth:158}})],1),t("div",{staticClass:"line"},[t("p",{staticClass:"label"},[a._v("盖章文件份数：")]),t("div",{staticClass:"value"},[a._v(a._s(a.baseData.file_number))])])]),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("使用原因说明：")]),t("div",{staticClass:"value line-value"},[a._v(" "+a._s(a.baseData.reason?a.baseData.reason:"--")+" ")])]),a.baseData.is_express?t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("邮寄信息：")]),t("div",{staticClass:"value line-value"},[t("div",[a._v(" "+a._s((a.baseData.addressee?a.baseData.addressee:"--")+"  "+(a.baseData.phone?a.baseData.phone:"--"))+" ")]),t("div",[a._v(" "+a._s(a.baseData.address?a.baseData.address:"--")+" ")])])]):a._e(),a.baseData.is_express?t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("寄件人/商务处理人：")]),t("div",{staticClass:"value line-value"},[a._v(" "+a._s(a.baseData.sender_name?a.baseData.sender_name:"--")+" ")])]):a._e(),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("附件：")]),t("div",{staticClass:"value line-value"},[a.baseData.attachment&&a.baseData.attachment.length?[t("Appendix",{attrs:{list:a.baseData.attachment}})]:t("span",[a._v("--")])],2)]),t("div",{staticClass:"line",staticStyle:{height:"auto"}},[t("p",{staticClass:"label"},[a._v("用印扫描附件：")]),t("div",{staticClass:"value line-value"},[[2===a.baseData.approval_status&&2!==a.baseData.scan_status?t("div",{staticClass:"upload-box"},[t("tg-upload",{attrs:{disabled:(a.baseData.scan.length||0)>=10,action:"/api/approval/upload_approval_attachment",beforeUpload:a.beforeUpload,success:a.scanSuccessHandle,"show-file-list":!1}},[t("tg-button",{attrs:{disabled:(a.baseData.scan.length||0)>=10,size:"medium",icon:"ico-btn-upload"}},[a._v(" 上传附件 ")])],1)],1):a.baseData.scan&&a.baseData.scan.length?t("span",[a._v("--")]):a._e(),t("div",{staticClass:"file-list-box"},[t("Appendix",{attrs:{list:a.baseData.scan,isDelete:2===a.baseData.approval_status&&2!==a.baseData.scan_status},on:{deleteItem:a.deleteItem}})],1)]],2)])])]),t("div",{staticClass:"right-wrapper"},[t("h5",{staticClass:"right-wrapper-title"},[a._v("审批进度")]),t("WorkbenchTimeLine",{attrs:{"step-status":a.baseData.approval_status,items:a.baseData.approval_flow_detail}})],1)])]),t("UseSealApply",{ref:"useSealApplyRef",on:{success:a.onSuccess}})],1):a._e()},aa=[],ea=t(59406),ta=t(56082),sa=t(61282),la=t(11676),ia=t(74525),oa=(0,i.defineComponent)({name:"InvoiceRedDetailDialog",props:{info:{type:Object,default:()=>({})}},components:{Appendix:V.Z,WorkbenchTimeLine:x.Z,UseSealApply:ea.Z},setup(a,e){const t=(0,i.ref)(!1),s=(0,i.ref)(!1),l=(0,i.ref)(void 0),o=(0,i.ref)([]),n=(0,i.ref)(void 0),r=()=>{s.value=!1,e.emit("close")},c=a=>{l.value=a,console.log(a,"data"),s.value=!0},v=async()=>{n.value?.show(l.value)},d=()=>{r(),e.emit("success")},p=a=>{if(a){const e="yyyy.MM.DD",t=H()(1e3*a.take_out_start_date).format(e),s=H()(1e3*a.take_out_end_date).format(e);return`${t}~${s}`}return"--"},u=a=>{if(a){const e=a.amount_involved>=0?a.amount_involved:"--";return(0,sa.FU)(e)}return"--"},_=a=>a&&a.seal_type?ta.TZ.get(a.seal_type)??"--":"--",m=a=>a&&a.company_name_code?ta.LD.get(a.company_name_code)??"--":"--",f=a=>a&&a.matter_type?ta.dU.get(a.matter_type)??"--":"--",b=a=>a&&a.business_type?ta.zi.get(a.business_type)??"--":"--",C=()=>{d()},g={beforeUpload(a){return(0,la.K)({fileSize:20})(a)},async scanSuccessHandle(a){console.log(l.value),l.value.scan?.push(a.data.source);const t=await(0,ia.C)({approval_id:l.value.approval_id,scans:l.value.scan});console.log(t,"data"),0===t.data.error_code?e.root.$message.success("上传成功"):e.root.$message.error(t.data.message)},async deleteItem(a){const t=await(0,ia.C)({approval_id:l.value.approval_id,scans:l.value.scan.filter((e=>e!==a.link))});0===t.data.error_code?(l.value.scan=l.value.scan.filter((e=>e!==a.link)),e.root.$message.success("删除成功")):e.root.$message.error(t.data.message),console.log(a)}};return{visible:s,attachment:o,emitClose:r,numberFormat:S.Y4,edit:t,reSubmit:v,baseData:l,reClose:d,show:c,moment:H(),useSealApplyRef:n,seal_name:_,company_name:m,matter_name:f,business_type_name:b,task_out_date_str:p,amount:u,onSuccess:C,...g}}}),na=oa,ra=(0,T.Z)(na,N,aa,!1,null,"46090d64",null),ca=ra.exports,va=(0,i.defineComponent)({name:"TgWorkbench",components:{initate:n.Z,mine:r.Z,waiting:c.Z,approved:v.Z,LoanFormModal:u.Z,LoanDetailModal:_.Z,PaymentDetailDialog:h.Z,RefundFormModal:m.Z,RefundDetailModal:f.Z,ApplicationDialog:b.Z,ApplicationDetail:C.Z,InvoicesDetail:g.Z,AdvanceDetailDialog:D.Z,RefundDetailDialog:y.Z,CustomerDetailDialog:U,Supplier:B,RedDetail:O.Z,VoidDetail:J,UseSealApplyDetail:ca},setup(a,e){const t=[{title:"工作台",path:"/workbench"},{title:"我发起的",path:""}],s=(0,o.GQ)(e,[{label:"发起审批",value:"initate"},{label:"我发起的",value:"mine"},{label:"待我审批",value:"waiting"},{label:"我已审批",value:"approved"}],"initate");e.root.$store.hasModule("workbench")||e.root.$store.registerModule("workbench",d.T);const{onLoanFormClose:l,onLoanDetailClose:n,onRefundFormClose:r,onRefundDetailClose:c,onAdvanceDetailClose:v,onInvoicingDetailClose:u,onLoanEdit:_,onRefundEdit:m,onCustomerDetailClose:f,onSupplierDetailClose:b,onRedDetailClose:C,onVoidDetailClose:g,onUseSeaalDetailClose:D}=(0,p.G)(e),h=(0,i.computed)((()=>e.root.$store.state.workbench)),y=(0,i.computed)((()=>h.value.approval)),w=(0,i.computed)((()=>h.value.loanFormVisible)),k=(0,i.computed)((()=>h.value.loanDetailVisible)),S=(0,i.computed)((()=>h.value.refundFormVisible)),V=(0,i.computed)((()=>h.value.refundDetailVisible)),x=(0,i.computed)((()=>h.value.customerDetailVisible)),A=(0,i.computed)((()=>h.value.supplierDetailVisible)),R=(0,i.computed)((()=>h.value.advanceFormVisible)),F=(0,i.computed)((()=>h.value.advanceDetailVisible)),Z=(0,i.computed)((()=>h.value.invoicingFormVisible)),L=(0,i.computed)((()=>h.value.invoicingDetailVisible)),$=(0,i.computed)((()=>h.value.redDetailVisible)),j=(0,i.computed)((()=>h.value.voidDetailVisible)),T=(0,i.computed)((()=>h.value.projectApprovalVisible)),M=(0,i.computed)((()=>h.value.useSealApplyDetailVisible)),U=(0,i.ref)(null),W=(0,i.ref)(null),E=(0,i.ref)(null),I=(0,i.ref)(null),P=(0,i.ref)(null),Y=(0,i.ref)(null),B=(0,i.ref)(null);(0,i.watch)((()=>h.value.advanceFormVisible),((a,e)=>{a&&a!==e&&U.value?.show(y.value)})),(0,i.watch)((()=>h.value.invoicingDetailVisible),((a,t)=>{a&&a!==t&&e.root.$nextTick((()=>{E.value?.show(y.value)}))})),(0,i.watch)((()=>h.value.redDetailVisible),((a,t)=>{a&&a!==t&&e.root.$nextTick((()=>{P.value.show(y.value)}))})),(0,i.watch)((()=>h.value.useSealApplyDetailVisible),((a,t)=>{a&&a!==t&&e.root.$nextTick((()=>{B.value.show(y.value)}))})),(0,i.watch)((()=>h.value.voidDetailVisible),((a,t)=>{a&&a!==t&&e.root.$nextTick((()=>{Y.value.show(y.value)}))}));const O=(0,i.ref)(0),q=a=>{console.group(`${a} trigger reload`),O.value++,console.groupEnd()};return(0,i.provide)("reloadSymbol",O),{...s,approval:y,loanFormVisible:w,loanDetailVisible:k,refundFormVisible:S,refundDetailVisible:V,customerDetailVisible:x,supplierDetailVisible:A,onLoanFormClose:l,onLoanDetailClose:n,onRefundFormClose:r,onRefundDetailClose:c,onCustomerDetailClose:f,onSupplierDetailClose:b,onLoanEdit:_,onRefundEdit:m,advanceFormVisible:R,advanceDetailVisible:F,invoicingFormVisible:Z,invoicingDetailVisible:L,applicationDialog:U,applicationDetail:W,advanceDetailDialog:I,invoicingDetail:E,redDetailDialog:P,redDetailVisible:$,voidDetailVisible:j,useSealApplyDetailVisible:M,voidDetailDialog:Y,onAdvanceDetailClose:v,onInvoicingDetailClose:u,onRedDetailClose:C,onVoidDetailClose:g,onUseSeaalDetailClose:D,triggerReload:q,routes:t,useSealApplyDetailDialog:B,projectApprovalVisible:T}}}),da=va,pa=(0,T.Z)(da,s,l,!1,null,null,null),ua=pa.exports},74525:function(a,e,t){t.d(e,{s:function(){return o},C:function(){return n}});const s="/api/approval/query_use_seals";var l=t(64236),i=t(76012);const o=async a=>(0,i.dX)(s,{params:{...(0,l.jG)(a)}}),n=async a=>(0,i.SO)("/api/approval/update_use_seal",{...(0,l.jG)(a)})}}]);