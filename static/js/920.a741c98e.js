"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[920],{62068:function(t,e,a){a.d(e,{Z:function(){return u}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-popover",{attrs:{trigger:"hover","popper-class":"pop-receivable",placement:"bottom-end"}},[a("div",{staticClass:"pop-receivable-detail"},[a("div",{staticClass:"receivable-detail-content"},[a("div",{staticClass:"detail-header"},[t.showSettlementUid?a("div",{staticClass:"header column-width"},[t._v("结算单编号")]):t._e(),a("div",{staticClass:"header column-width"},[t._v(t._s(t.firstColumnHeader))]),a("div",{staticClass:"header right column-width"},[t._v("核销金额 (元)")]),a("div",{staticClass:"header column-width"},[t._v("核销人/日期")])]),a("div",{staticClass:"detail-body"},t._l(t.list,(function(e,i){return a("div",{key:i,staticClass:"body-row"},[t.showSettlementUid?a("div",{staticClass:"rg right column-width"},[a("span",[t._v(t._s(e.settlement_uid))])]):t._e(),"receivable"===t.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(e.write_off_amount).startsWith("-")?"color: #e91313":""},[t._v(t._s(e.receipt_uid))])]):t._e(),"receive"===t.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(e.write_off_amount).startsWith("-")?"color: #e91313":""},[t._v(t._s(e.receivable_uid))])]):t._e(),"payable"===t.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(e.write_off_amount).startsWith("-")?"color: #e91313":""},[t._v(" "+t._s(e.cost_id)+" ")])]):t._e(),"commonBusinessPayableActual"===t.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(e.write_off_amount).startsWith("-")?"color: #e91313":""},[t._v(" "+t._s(e.payable_uid)+" ")])]):t._e(),a("div",{staticClass:"rg right column-width"},[a("span",{style:e.write_off_amount<0?"color: #e91313":""},[t._v(t._s(t.formatAmount(e.write_off_amount,"")))])]),a("div",{staticClass:"rg column-width"},[a("div",[a("p",[t._v(t._s(e.write_off_user))]),a("span",{staticClass:"write-date"},[t._v(t._s(e.write_off_time))])])])])})),0)])]),a("tg-button",{style:{color:t.btncolor},attrs:{slot:"reference",type:"link"},slot:"reference"},[t._v(t._s(t.btntitle))])],1)},s=[],o=a(97434),l=a(61282),n=(0,o.defineComponent)({props:{list:{type:Array,default:()=>[]},type:{type:String,default:"receivable"},btntitle:{type:String,default:"预览"},btncolor:{type:String,default:"#2877ff"},showSettlementUid:{type:Boolean,default:!1}},setup(t,e){const a=(0,o.computed)((()=>{let e="";return"receivable"===t.type?e="单据编号":"receive"===t.type?e="应收编号":"payable"===t.type?e="单据编号":"commonBusinessPayableActual"===t.type&&(e="应付编号"),e}));return{firstColumnHeader:a,formatAmount:l.dN}}}),r=n,c=a(1001),p=(0,c.Z)(r,i,s,!1,null,"6ce85114",null),u=p.exports},22770:function(t,e,a){a.d(e,{Z:function(){return m}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new tg-reverse-audit-dialog",attrs:{visible:t.visible,"close-on-click-modal":!1,width:"440px"},on:{close:t.close},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("单据冲销")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:t.onRefuse}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary",disabled:t.isConfirmBtnDisabled},on:{click:t.onConfirm}},[t._v("提交")])]},proxy:!0}])},[a("div",{staticClass:"tg-reverse-audit-dialog-content",style:{paddingBottom:0===t.is_pass?"24px":"8px"}},[a("el-form",{staticClass:"el-form-vertical",attrs:{"label-position":"top","show-message":!1}},[a("div",{staticClass:"reverse-reason-label"},[t._v("冲销原因")]),a("div",{staticClass:"reverse-reason-content"},[t._v(" "+t._s(t.reverse_reason)+" ")]),a("el-form-item",{staticClass:"sp-form-item",staticStyle:{"margin-top":"18px"},attrs:{label:"是否通过",prop:"is_pass",required:""}},[a("div",{staticStyle:{width:"100%"}},[a("el-radio-group",{model:{value:t.is_pass,callback:function(e){t.is_pass=e},expression:"is_pass"}},[a("el-radio",{attrs:{label:1}},[t._v("通过")]),a("el-radio",{attrs:{label:0}},[t._v("不通过")])],1)],1)]),a("el-input",{directives:[{name:"show",rawName:"v-show",value:0===t.is_pass,expression:"is_pass === 0"}],attrs:{type:"textarea",placeholder:"请输入不通过原因",clearable:"",maxlength:100,"show-word-limit":""},model:{value:t.reverse_back_reason,callback:function(e){t.reverse_back_reason="string"===typeof e?e.trim():e},expression:"reverse_back_reason"}})],1)],1)])},s=[],o=a(97434),l=a(58861),n=a(22895),r=(0,o.defineComponent)({setup(t,e){const a=(0,o.ref)(""),i=(0,o.ref)(""),s=(0,o.ref)(n.w.YES),r=(0,o.ref)(null),c=(0,o.computed)((()=>s.value===n.w.NO&&""===i.value.trim())),{visible:p,setVisible:u}=(0,l.Z)();(0,o.watch)((()=>p.value),(t=>{console.log({next:t})}));const m=()=>{a.value="",u()},d=async()=>{if(c.value)return void e.root.$message.warning("请填写不通过原因");const t=await(r.value?.(s.value,i.value));t&&(a.value="",u())},_=(t,e)=>{a.value=t,i.value="",s.value=n.w.YES,r.value=e,u(!0)},y=()=>{a.value="",i.value="",r.value=null,u(!1)};return{visible:p,open:_,close:y,is_pass:s,reverse_reason:a,reverse_back_reason:i,onRefuse:m,onConfirm:d,isConfirmBtnDisabled:c}}}),c=r,p=a(1001),u=(0,p.Z)(c,i,s,!1,null,null,null),m=u.exports},97939:function(t,e,a){a.r(e),a.d(e,{default:function(){return Z}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"finance-payment-page flex-auto"},[a("tg-card",{staticClass:"flex-none",attrs:{padding:18},on:{"rect:update":t.onTopCardRectUpdate}},[a("el-form",{staticClass:"filter-form flex-form",attrs:{inline:!0,size:"small","show-message":!1,"label-width":"70px"}},[a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"业务类型："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.business_type,callback:function(e){t.$set(t.queryForm,"business_type",e)},expression:"queryForm.business_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"营销业务",value:1}}),a("el-option",{attrs:{label:"抖音店播",value:3}}),a("el-option",{attrs:{label:"淘宝店播",value:2}}),a("el-option",{attrs:{label:"S2B2C",value:5}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"付款类型："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.pay_type,callback:function(e){t.$set(t.queryForm,"pay_type",e)},expression:"queryForm.pay_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"成本",value:1}}),a("el-option",{attrs:{label:"退款",value:2}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"成本类型："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.new_cost_type,callback:function(e){t.$set(t.queryForm,"new_cost_type",e)},expression:"queryForm.new_cost_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"人员工资",value:1}}),a("el-option",{attrs:{label:"主播服务费",value:2}}),a("el-option",{attrs:{label:"固定资产采购",value:3}}),a("el-option",{attrs:{label:"水电",value:4}}),a("el-option",{attrs:{label:"装修",value:5}}),a("el-option",{attrs:{label:"房租",value:6}}),a("el-option",{attrs:{label:"营销成本",value:7}}),a("el-option",{attrs:{label:"返点",value:8}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"是否开票："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.is_invoice,callback:function(e){t.$set(t.queryForm,"is_invoice",e)},expression:"queryForm.is_invoice"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"打款状态："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.is_pay,callback:function(e){t.$set(t.queryForm,"is_pay",e)},expression:"queryForm.is_pay"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"待打款",value:0}}),a("el-option",{attrs:{label:"已打款",value:1}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"打款方式："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.pay_way,callback:function(e){t.$set(t.queryForm,"pay_way",e)},expression:"queryForm.pay_way"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"支付宝",value:4}}),a("el-option",{attrs:{label:"V任务",value:2}}),a("el-option",{attrs:{label:"对公银行",value:3}}),a("el-option",{attrs:{label:"银行卡",value:1}})],1)],1),a("el-form-item",{staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"核销状态："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.write_off_status,callback:function(e){t.$set(t.queryForm,"write_off_status",e)},expression:"queryForm.write_off_status"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"已核销",value:2}}),a("el-option",{attrs:{label:"部分核销",value:1}}),a("el-option",{attrs:{label:"未核销",value:0}})],1)],1),a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"打款账号："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:t.queryForm.payer_bank_account_id,callback:function(e){t.$set(t.queryForm,"payer_bank_account_id",e)},expression:"queryForm.payer_bank_account_id"}},[a("el-option",{attrs:{label:"全部",value:void 0}}),t._l(t.bankList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.bank_name,value:t.id}})}))],2)],1),a("el-form-item",{staticClass:"flex-form-item form-item-group",staticStyle:{"margin-right":"18px","margin-bottom":"12px"},attrs:{label:"付款搜索："}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"244px"},attrs:{placeholder:"请输入关键字",clearable:""},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getList.apply(null,arguments)}},model:{value:t.queryForm.search_value,callback:function(e){t.$set(t.queryForm,"search_value","string"===typeof e?e.trim():e)},expression:"queryForm.search_value"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.queryForm.search_type,callback:function(e){t.$set(t.queryForm,"search_type",e)},expression:"queryForm.search_type"}},[a("el-option",{attrs:{label:"项目编号",value:1}}),a("el-option",{attrs:{label:"用款审批",value:2}}),a("el-option",{attrs:{label:"客户名称",value:3}}),a("el-option",{attrs:{label:"项目名称",value:4}}),a("el-option",{attrs:{label:"客户经理",value:5}}),a("el-option",{attrs:{label:"付款编号",value:10}}),a("el-option",{attrs:{label:"收款编号",value:6}}),a("el-option",{attrs:{label:"KOL",value:7}}),a("el-option",{attrs:{label:"机构名称",value:8}}),a("el-option",{attrs:{label:"公司名称",value:9}})],1)],1)],1),a("el-form-item",{staticClass:"flex-form-item flex-form-item-time",attrs:{label:"日期选择："}},[a("div",[a("el-select",{staticClass:"time-select-type",attrs:{placeholder:"请选择"},model:{value:t.queryForm.query_date_type,callback:function(e){t.$set(t.queryForm,"query_date_type",e)},expression:"queryForm.query_date_type"}},[a("el-option",{attrs:{label:"用款日期",value:1}}),a("el-option",{attrs:{label:"打款日期",value:2}}),a("el-option",{attrs:{label:"登记时间",value:3}})],1),a("el-date-picker",{staticClass:"time-select-box",attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:t.queryForm.pay_date,callback:function(e){t.$set(t.queryForm,"pay_date",e)},expression:"queryForm.pay_date"}})],1)]),a("el-form-item",{staticClass:"flex-form-item order-100",staticStyle:{"margin-right":"20px"},attrs:{"label-width":"0"}},[a("tg-button",{attrs:{type:"primary"},on:{click:t.onQuerySearchClick}},[t._v("查询")]),a("tg-button",{staticClass:"mgl-12",on:{click:t.onQueryResetClick}},[t._v("重置")])],1)],1)],1),a("tg-card",t._b({staticClass:"mgt-12 flex-auto",attrs:{padding:[12,18,0,18]},on:{"rect:update":t.onRectUpdate}},"tg-card",t.cardProps,!1),[a("div",{staticClass:"main-header"},[a("tg-button-line",[t.permission.link_payment_btn?a("tg-button",{attrs:{type:"default",icon:"ico-relation"},on:{click:t.showLinkPaymentBtnClick}},[t._v("关联付款")]):t._e(),t.permission.payment_export?a("tg-button",{attrs:{type:"default",icon:"ico-btn-export"},on:{click:t.exportBtnClick}},[t._v("导出")]):t._e()],1),a("div",{staticClass:"header"},[a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("已付款笔数：")]),a("span",{staticClass:"text"},[t._v(t._s(t.statistics&&t.numberFormat(t.statistics.count_confirmed_pay_amount,0)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("已付款金额：")]),a("span",{staticClass:"text"},[t._v(t._s(t.statistics&&t.numberMoneyFormat(t.statistics.sum_confirmed_pay_amount,2)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("待确认笔数：")]),a("span",{staticClass:"text gold"},[t._v(t._s(t.statistics&&t.numberFormat(t.statistics.count_unconfirmed_pay_amount,0)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("待确认金额：")]),a("span",{staticClass:"text gold"},[t._v(t._s(t.statistics&&t.numberMoneyFormat(t.statistics.sum_unconfirmed_pay_amount,2)))])])])],1),a("el-table",t._b({directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"mgt-12",attrs:{stripe:"",border:"",data:t.list},on:{"row-click":function(e){return e.target!==e.currentTarget?null:t.onRowClick.apply(null,arguments)}},scopedSlots:t._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无付款数据"}})]},proxy:!0}])},"el-table",t.tableProps,!1),[t._l(t.columns,(function(e,i){return a("el-table-column",t._b({key:i},"el-table-column",e,!1))})),a("el-table-column",{attrs:{label:"付款事由","min-width":"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"line-info"},[a("p",{staticClass:"clamp-1"},[t._v(t._s(t._f("emptyData")(e.row.pay_reason)))])])]}}])}),a("el-table-column",{attrs:{label:"供应商","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"line-info"},[a("p",{staticClass:"clamp-1"},[t._v(t._s(t._f("emptyData")(e.row.cost_company_name)))])])]}}])}),a("el-table-column",{attrs:{className:"ProjectInfoColumn",label:"项目信息",width:"178"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{click:function(a){return a.stopPropagation(),t.goProjectDetail(e.row)}}},[e.row.project_name&&e.row.project_name.length>12?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:e.row.project_name}},[a("p",{staticClass:"line-clamp-1 empty-data-line hover-link",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.project_name)+" ")])]):a("p",{staticClass:"line-clamp-1 empty-data-line hover-link"},[t._v(" "+t._s(e.row.project_name||"--")+" ")])],1)]}}])}),a("el-table-column",{attrs:{label:"业务类型","min-width":"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(" "+t._s(1===e.row.business_type?"营销业务":2===e.row.business_type?"淘宝店播":3===e.row.business_type?"抖音店播":4===e.row.business_type?"基地业务":"S2B2C")+" ")])]}}])}),a("el-table-column",{attrs:{label:"是否开票","min-width":"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.is_invoice?a("div",{staticStyle:{width:"100%"}},[t._v("否")]):a("div",{staticStyle:{width:"100%"}},[e.row.invoice_info.length>0?a("span",[t._v("是(已上传)")]):a("span",[t._v("是(未上传)")])])]}}])}),a("el-table-column",{attrs:{label:"付款时间","min-width":"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"line-info"},[a("p",[t._v(" "+t._s(e.row.pay_date.replace(/-/g,".")||"--")+" ")])])]}}])}),a("el-table-column",{attrs:{label:"付款凭证","min-width":"90",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.pay_certificate_pic?a("div",{staticClass:"button-item",staticStyle:{width:"100%"},on:{click:function(a){return a.stopPropagation(),t.checkoutCertificateBtn(e.row.pay_certificate_pic)}}},[t._v(" 查看 ")]):a("span",[t._v("--")])]}}])}),a("el-table-column",{attrs:{label:"核销状态","min-width":"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.business_type&&8===e.row.new_cost_type||2===e.row.business_type&&0===e.row.is_split||3===e.row.business_type&&0===e.row.is_split?a("div",[a("p",{staticClass:"write-off"},[t._v("--")])]):a("div",[a("div",{staticClass:"line-info"},[2===e.row.write_off_status?a("p",{staticClass:"write-on"},[t.writeOffPopoverVisible(e.row)?a("write-list-pop",{attrs:{list:t.writeOffPopoverInfo(e.row),type:2===e.row.pay_type?"receive":"commonBusinessPayableActual",btntitle:"已核销",btncolor:"#3c5269",showSettlementUid:!0}}):[t._v("已核销")]],2):1===e.row.write_off_status?a("p",{staticClass:"write-off"},[t.writeOffPopoverVisible(e.row)?a("write-list-pop",{attrs:{list:t.writeOffPopoverInfo(e.row),type:2===e.row.pay_type?"receive":"commonBusinessPayableActual",btntitle:"部分核销",btncolor:"#ff7a36",showSettlementUid:!0}}):[t._v("部分核销")]],2):a("p",{staticClass:"write-off"},[t._v("未核销")])])])]}}])}),a("el-table-column",{attrs:{label:"单据状态","min-width":"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!==e.row.reversed_id?a("div",{staticStyle:{color:"#ff7a36"}},[a("span",[t._v("冲销")]),1===e.row.reverse_status?a("span",{staticStyle:{color:"#ff7a36"}},[t._v("(待确认)")]):2===e.row.reverse_status?a("span",{staticStyle:{color:"#02ba3c"}},[t._v("(已确认)")]):3===e.row.reverse_status?a("span",{staticStyle:{color:"#e91313"}},[t._v("(退回)")]):t._e()]):a("div",[0===e.row.is_pay?a("div",{staticClass:"to-pay"},[t._v("待打款")]):a("div",[t._v("已打款")])])]}}])}),t.permission.payment_upload_edit_pay_evidence||t.permission.payment_upload_edit_invoice||t.permission.payment_split_cost?a("el-table-column",{attrs:{align:"left",label:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.reversed_id?a("div",[1===e.row.reverse_status?a("el-button",{staticClass:"button-item-padding reverse-red",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),t.handleReverseAduit(e.row)}}},[t._v("冲销确认")]):t._e(),2===e.row.reverse_status||3===e.row.reverse_status?a("el-button",{staticClass:"button-item-padding",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),t.onReasonViewBtnClick(e.row)}}},[t._v("查看")]):t._e()],1):a("div",[t.permission.payment_upload_edit_pay_evidence&&0===e.row.is_pay?a("el-button",{staticClass:"button-item-padding",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),t.paymentConfirmClick(e.row)}}},[t._v("打款确认")]):t.permission.payment_upload_edit_pay_evidence&&0!==e.row.is_pay?a("el-button",{staticClass:"button-item-padding",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),t.editConfirmClick(e.row)}}},[t._v("编辑凭证")]):t._e(),t.permission.payment_split_cost&&0===e.row.is_split?a("el-button",{staticClass:"button-item-padding",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),t.costSplitBtnClick(e.row)}}},[t._v("成本拆分")]):t._e()],1)]}}],null,!1,3340463288)}):t._e()],2),t.total>0?a("el-pagination",{staticStyle:{margin:"8px 0"},attrs:{"current-page":t.queryForm.page_num,"page-sizes":[10,20,50,100],"page-size":t.queryForm.num,layout:"total, prev, pager, next, sizes, jumper",total:t.total},on:{"update:currentPage":function(e){return t.$set(t.queryForm,"page_num",e)},"update:current-page":function(e){return t.$set(t.queryForm,"page_num",e)},"current-change":t.handleCurrentChange,"size-change":t.handlePageSizeChange}}):t._e()],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{visible:t.paymentConfirmVisible,width:"440px","close-on-click-modal":!1,"destroy-on-close":!0},on:{close:t.paymentConfirmCloseAction},nativeOn:{paste:function(e){return function(e){return t.handlePaste(e,-1)}.apply(null,arguments)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.commonTitle))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:t.paymentConfirmCloseAction}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:function(e){return t.handlePaymentConfirmSaveAction("paymentConfirmRef")}}},[t._v("保存")])]},proxy:!0}])},[a("el-form",{ref:"paymentConfirmRef",staticStyle:{"margin-top":"20px"},attrs:{model:t.paymentConfirmFrom,rules:t.paymentConfirmFromRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"打款时间：",size:"medium",prop:"pay_date"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"请选择打款时间","value-format":"yyyy-MM-dd"},model:{value:t.paymentConfirmFrom.pay_date,callback:function(e){t.$set(t.paymentConfirmFrom,"pay_date",e)},expression:"paymentConfirmFrom.pay_date"}})],1),t.permission.payment_upload_edit_pay_evidence&&0===t.row_is_pay?a("el-form-item",{attrs:{label:"打款账号：",size:"medium",prop:"bank_account_id"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",placeholder:"请选择打款账号"},model:{value:t.paymentConfirmFrom.bank_account_id,callback:function(e){t.$set(t.paymentConfirmFrom,"bank_account_id",e)},expression:"paymentConfirmFrom.bank_account_id"}},t._l(t.bank_account_list,(function(t){return a("el-option",{key:t.id,attrs:{label:t.account_number+" ("+t.bank_name+")",value:t.id}})})),1)],1):t._e(),a("el-form-item",{attrs:{label:"打款凭证：",size:"medium",rules:{required:!0,message:"请上传打款凭证",trigger:["blur","change"]}}},[a("div",{staticStyle:{display:"flex"}},[t._l(t.urlShowList,(function(e,i){return a("div",{key:i,staticClass:"confirm-img-box"},[a("el-button",{staticClass:"item-close",attrs:{icon:"el-icon-close",circle:""},on:{click:function(e){return t.deleteConfirmItemBtn(i)}}}),a("img",{staticClass:"confirm-img",attrs:{src:e}})],1)})),t.urlShowList.length<3?a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":t.uploadConfirmImage.bind(this,!1),"before-upload":t.beforeUpload,"show-file-list":!1,accept:".jpeg,.jpg,.png"}},[a("div",{staticClass:"uploader-icon-box"},[a("p",{staticClass:"el-icon-plus"}),a("p",[t._v("上传图片")])])]):t._e()],2),a("div",{staticClass:"el-upload__tip",staticStyle:{"line-height":"16px",color:"#a4b2c2"}},[t._v(" 点击任意区域，粘贴（ctrl+V）添加图片 ")])])],1)],1)],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic upload-dialog-box",attrs:{visible:t.uploadVisible,width:"550px","close-on-click-modal":!1,"destroy-on-close":!0},on:{close:t.uploadCloseAction},nativeOn:{click:function(e){return t.clearInvoiceListItemActiveIndex.apply(null,arguments)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.commonTitle))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:t.uploadCloseAction}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:function(e){return t.uploadSaveAction("uploadRef")}}},[t._v("保存")])]},proxy:!0}])},[a("div",{staticStyle:{"margin-top":"20px"}},[a("span",{staticStyle:{"margin-left":"45px"}},[t._v("税额：")]),a("el-input",{staticStyle:{width:"430px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入税点金额",clearable:""},on:{input:function(e){return t.inputLoanAmountCost(1,e,2)}},model:{value:t.tax_point,callback:function(e){t.tax_point="string"===typeof e?e.trim():e},expression:"tax_point"}},[a("template",{slot:"append"},[t._v("元")])],2)],1),a("div",{staticClass:"upload-invoice-div"},[a("el-form",{ref:"uploadRef",staticClass:"upload-invoice-form",attrs:{model:t.uploadForm,"label-width":"100px"}},[a("div",{staticClass:"list-form-box"},[a("p",{staticClass:"list-form-title"},[t._v("发票凭证：")]),t._l(t.uploadForm.list,(function(e,i){return a("div",{key:i,class:t.invoiceListItemActiveIndex===i?"list-form-item list-form-item-active":"list-form-item",on:{paste:function(e){return t.handlePaste(e,i)},click:function(e){e.stopPropagation(),t.invoiceListItemActiveIndex=i}}},[t.uploadForm.list.length>1?a("el-button",{staticClass:"form-item-close",attrs:{icon:"el-icon-close",circle:""},on:{click:function(e){return t.deleteUploadItemBtn(i)}}}):t._e(),a("el-form-item",{attrs:{prop:"list."+i+".show_url",label:"发票截图：",size:"medium",rules:{required:!0,message:"请上传发票截图",trigger:["change","blur"]}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":t.uploadImage.bind(this,i,!1),"before-upload":t.beforeUpload,"show-file-list":!1,accept:".jpeg,.jpg,.png"}},[e.show_url&&e.show_url.includes(".pdf")?a("tg-icon",{staticStyle:{"font-size":"90px"},attrs:{name:"ico-pdf"}}):e.show_url?a("img",{staticClass:"avatar",attrs:{src:e.show_url}}):a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"avatar-uploader-icon"},[a("i",{staticClass:"el-icon-plus"}),a("p",[t._v("上传发票")])]),a("div",{staticStyle:{position:"absolute",right:"-50px",top:"32px",color:"rgb(164, 178, 194)"}},[t._v(" 支持pdf，图片格式发票上传 ")]),a("div",{staticClass:"el-upload__tip",staticStyle:{"line-height":"16px",color:"#a4b2c2"},attrs:{slot:"tip"},slot:"tip"},[t._v(" 选中灰色区域，粘贴（ctrl+V）添加图片 ")])],1)],1),a("el-form-item",{attrs:{label:"发票号码：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入8位发票号码",maxlength:"8",clearable:""},model:{value:e.invoice_num,callback:function(a){t.$set(e,"invoice_num","string"===typeof a?a.trim():a)},expression:"item.invoice_num"}})],1),a("el-form-item",{attrs:{label:"开票时间：",size:"medium"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"请选择开票时间","value-format":"yyyy-MM-dd"},model:{value:e.invoice_date,callback:function(a){t.$set(e,"invoice_date",a)},expression:"item.invoice_date"}})],1),a("el-form-item",{attrs:{label:"开票金额：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入开票金额",clearable:""},on:{input:function(e){return t.inputLoanAmountCost(i,e,1)}},model:{value:e.amount,callback:function(a){t.$set(e,"amount","string"===typeof a?a.trim():a)},expression:"item.amount"}},[a("template",{slot:"append"},[t._v("元")])],2)],1),a("el-form-item",{attrs:{label:"开票单位名称：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入开票单位名称",maxlength:"100",clearable:""},model:{value:e.institution,callback:function(a){t.$set(e,"institution","string"===typeof a?a.trim():a)},expression:"item.institution"}})],1)],1)}))],2)])],1),t.uploadForm.list.length<3?a("el-button",{staticClass:"add-upload-form-btn",attrs:{icon:"el-icon-plus"},on:{click:t.addUploadItemBtn}},[t._v("点击添加")]):t._e()],1)],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic upload-dialog-box",attrs:{visible:t.costSplitVisible,width:"510px","close-on-click-modal":!1,"destroy-on-close":!0},on:{close:t.costSplitCloseAction},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("成本拆分")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:t.costSplitCloseAction}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:function(e){return t.costSplitSaveAction("costSplitRef")}}},[t._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"cost-split-scroll"},[a("div",{staticClass:"dialog-line"},[a("span",{staticClass:"label-70"},[t._v("打款金额：")]),a("span",[t._v(t._s(t.numberMoneyFormat(t.costSplitForm.pay_amount,2)))])]),a("div",{staticClass:"dialog-line"},[a("span",{staticClass:"label-70"},[t._v("成本类型：")]),a("span",[t._v(t._s(t.costType(t.costSplitForm.new_cost_type)))])]),a("div",{staticClass:"dialog-line"},[a("span",{staticClass:"label-70"},[t._v("业务类型：")]),a("span",[t._v(t._s(1===t.costSplitForm.business_type?"营销业务":2===t.costSplitForm.business_type_str?"淘宝店播":3===t.costSplitForm.business_type_str?"抖音店播":4===t.costSplitForm.business_type_str?"基地业务":"S2B2C"))])]),a("el-form",{ref:"costSplitRef",staticStyle:{"margin-top":"10px"},attrs:{model:t.costSplitForm,"label-width":"80px"}},[a("div",{staticClass:"list-form-box"},t._l(t.costSplitForm.cost,(function(e,i){return a("div",{key:i,staticClass:"list-form-item cost-list-form-item"},[t.costSplitForm.cost.length>1?a("el-button",{staticClass:"form-item-close",attrs:{icon:"el-icon-close",circle:""},on:{click:function(e){return t.deleteCostSplitItemBtn(i)}}}):t._e(),a("el-form-item",{attrs:{label:"所属项目：",size:"medium",prop:"cost."+i+".project_id",rules:{required:!0,message:"请输入项目编号",trigger:["blur","change"]}}},[a("el-select",{staticStyle:{width:"325px"},attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请输入所属项目","remote-method":t.getCustmerByContractNo,size:"medium"},model:{value:e.project_id,callback:function(a){t.$set(e,"project_id",a)},expression:"item.project_id"}},t._l(t.project_options,(function(t){return a("el-option",{key:t.id,attrs:{label:t.project_uid,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"费用金额：",size:"medium",prop:"cost."+i+".price",rules:{required:!0,message:"请输入项目分摊金额",trigger:["blur","change"]}}},[a("el-input",{staticStyle:{width:"325px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入项目分摊金额",clearable:""},on:{input:function(e){return t.inputLoanAmountCost(i,e,3)}},model:{value:e.price,callback:function(a){t.$set(e,"price","string"===typeof a?a.trim():a)},expression:"item.price"}},[a("template",{slot:"append"},[t._v("元")])],2)],1)],1)})),0)])],1),a("el-button",{staticClass:"cost-split-form-btn",attrs:{icon:"el-icon-plus"},on:{click:t.addCostSplitItemBtn}},[t._v("点击添加")])],1)],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{width:"868px",visible:t.linkPaymentVisible,"close-on-click-modal":!1,"destroy-on-close":!0},on:{close:t.linkPaymentCloseAction},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("关联付款")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:t.linkPaymentCloseAction}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:t.linkPaymentSubmitAction}},[t._v("提交")])]},proxy:!0}])},[a("div",{staticClass:"main-box"},[a("div",{staticClass:"link-payment-tips"},[a("tg-icon",{staticStyle:{"font-size":"20px"},attrs:{name:"ico-warn"}}),a("p",[t._v(" 注意：关联后不可撤销，谨慎操作，如果存在多条已确认的收款，需要选择一条保留并共享打款凭证及发票等信息；如同时含有已打款和未打款的记录，合并后会自动更新为已打款 ")])],1),a("div",{staticClass:"link-payment-search"},[a("div",{staticClass:"link-payment-header"},[a("p",{staticClass:"title"},[t._v("选择付款")]),a("el-input",{staticStyle:{width:"182px","margin-top":"6px"},attrs:{size:"mini",placeholder:"请输入付款ID","suffix-icon":"el-icon-search"},nativeOn:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnterPressLinkPayment.apply(null,arguments)},click:function(e){return t.onEnterPressLinkPayment.apply(null,arguments)}},model:{value:t.link_id,callback:function(e){t.link_id=e},expression:"link_id"}})],1),a("el-table",{staticClass:"customer-table",attrs:{stripe:"",border:"",data:t.search_link_payment,"header-cell-style":{padding:"0",color:"#98A7BA",background:"#ffffff",fontWeight:400,height:"35px"}},scopedSlots:t._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"请搜索付款ID"}})]},proxy:!0}])},[a("el-table-column",{attrs:{align:"left",label:"付款ID",width:"96"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.cost_id))]}}])}),a("el-table-column",{attrs:{align:"right",label:"金额 (元)",width:"136"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.numberMoneyFormat(e.row.pay_amount,2,".",",",!1)))]}}])}),a("el-table-column",{attrs:{align:"left",label:"收款方",width:"356"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.pay_way?[e.row.pay_way_detail.company_name&&e.row.pay_way_detail.company_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.company_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.company_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.company_name))+" ")])]:t._e(),2===e.row.pay_way?[e.row.pay_way_detail.wangwang_name&&e.row.pay_way_detail.wangwang_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.wangwang_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.wangwang_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.wangwang_name))+" ")])]:t._e(),4===e.row.pay_way?[e.row.pay_way_detail.name&&e.row.pay_way_detail.name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.name))+" ")])]:t._e(),1===e.row.pay_way?[e.row.pay_way_detail.real_name&&e.row.pay_way_detail.real_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.real_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.real_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.real_name))+" ")])]:t._e()]}}])}),a("el-table-column",{attrs:{align:"left",label:"打款状态",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_pay?a("p",[t._v("已打款")]):a("p",[t._v("待打款")])]}}])}),a("el-table-column",{attrs:{align:"right",label:"",width:"56"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.active_id?a("el-button",{staticClass:"add-btn-link",attrs:{type:"primary",disabled:"",size:"mini"}},[t._v("添加")]):a("el-button",{staticClass:"add-btn-link",attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handlePushClick(e.row,e.$index)}}},[t._v("添加")])]}}])})],1)],1),a("div",{staticClass:"link-payment-main"},[a("div",{staticClass:"link-payment-header"},[a("p",{staticClass:"title"},[t._v("关联以下付款")])]),a("el-table",{staticClass:"customer-table",attrs:{stripe:"",border:"","max-height":"250",data:t.link_payment_list,"header-cell-style":{padding:"0",color:"#98A7BA",background:"#ffffff",fontWeight:400,height:"35px"}},scopedSlots:t._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无数据"}})]},proxy:!0}])},[a("el-table-column",{attrs:{align:"left",label:"付款ID",width:"96"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.cost_id))]}}])}),a("el-table-column",{attrs:{align:"right",label:"金额 (元)",width:"116"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.numberMoneyFormat(e.row.pay_amount,2,".",",",!1)))]}}])}),a("el-table-column",{attrs:{align:"left",label:"收款方",width:"310"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.pay_way?[e.row.pay_way_detail.company_name&&e.row.pay_way_detail.company_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.company_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.company_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.company_name))+" ")])]:t._e(),2===e.row.pay_way?[e.row.pay_way_detail.wangwang_name&&e.row.pay_way_detail.wangwang_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.wangwang_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.wangwang_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.wangwang_name))+" ")])]:t._e(),4===e.row.pay_way?[e.row.pay_way_detail.name&&e.row.pay_way_detail.name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.name))+" ")])]:t._e(),1===e.row.pay_way?[e.row.pay_way_detail.real_name&&e.row.pay_way_detail.real_name.length>20?a("el-popover",{attrs:{placement:"top-start",width:"300",trigger:"hover",content:e.row.pay_way_detail.real_name}},[a("p",{staticClass:"line-clamp-1",attrs:{slot:"reference"},slot:"reference"},[t._v(" "+t._s(e.row.pay_way_detail.real_name)+" ")])]):a("p",{staticClass:"line-clamp-1"},[t._v(" "+t._s(t._f("emptyData")(e.row.pay_way_detail.real_name))+" ")])]:t._e()]}}])}),a("el-table-column",{attrs:{align:"left",label:"打款状态",width:"86"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_pay?a("p",[t._v("已打款")]):a("p",[t._v("待打款")])]}}])}),a("el-table-column",{attrs:{align:"left",label:"凭证及发票",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_pay?a("el-radio",{attrs:{label:e.row.cost_id},model:{value:t.choose_radio,callback:function(e){t.choose_radio=e},expression:"choose_radio"}},[t._v("保留此条")]):t._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"56"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"add-btn-link",staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"mini"},on:{click:function(a){return t.handleRemoveClick(e.$index,e.row.cost_id)}}},[t._v("移除")])]}}])})],1)],1)])])],1),a("finance-invoice-detail-dialog",{attrs:{visible:t.financeInvoiceDetailVisible,list:t.invoiceList},on:{closeFinanceInvoiceDetailAction:t.closeFinanceInvoiceDetailAction}}),a("Invoicelist",{ref:"invoicelistRef"}),t.applyDetailDialogVisible?a("PaymentDetailDialog",{attrs:{visible:t.applyDetailDialogVisible,info:t.approval},on:{"dialog:close":function(e){t.applyDetailDialogVisible=!1}}}):t._e(),t.refundVisible?a("refund-detail-dialog",{attrs:{visible:t.refundVisible,info:t.approval},on:{"dialog:close":function(e){t.refundVisible=!1}}}):t._e(),t.applicationVisible?a("AdvanceDetailDialog",{attrs:{visible:t.applicationVisible,info:t.approval},on:{"dialog:close":function(e){t.applicationVisible=!1}}}):t._e(),t.invoicesVisible?a("invoices-detail",{ref:"invoicesDetailDialog",on:{close:function(e){t.invoicesVisible=!1}}}):t._e(),a("reverseAuditDialog",{ref:"reverseAuditDialogRef"}),a("tg-mask-loading",{attrs:{visible:t.reverseAuditLoading,content:"正在提交，请稍候..."}}),a("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new",attrs:{visible:t.reasonDialogVisible,width:"440px"},on:{close:t.onReasonDialogClose},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("冲销原因")]},proxy:!0}])},[a("div",{staticClass:"reason-dialog-content"},[t._v(t._s(t.reason))])]),a("div",{staticClass:"tg-dialog-vcenter"},[t.loanDetailVisible?a("LoanfinanceDetailModal",{attrs:{visible:t.loanDetailVisible,detailroval:t.detailroval},on:{"dialog:closerow":t.onLoanDetailClose,"dialog:openpaymentcertificate":t.checkoutCertificateBtn,"dialog:openpaymentinvoice":t.checkoutInvoiceDetailBtn,"dialog:openpaymentcontract":t.goContractDetail,"dialog:openpaymentapproval":t.handleClickApprovalBtn,"dialog:openpaymentimprest":t.handleClickApplicationBtn}}):t._e()],1)],1)},s=[],o=(a(26699),a(97434)),l=a(6933),n=a.n(l),r=a(24643),c=a(86611),p=a(64519),u=a(29625),m=a(91538),d=a(33018),_=a(92656),y=a(34137),f=a(64236),v=a(74750),g=a(21757),h=a(17809),b=a(51351),w=a(57325),C=a(58302),k=a(62068),x=a(22770),S=a(42386),F=a(28348),D=a(76012);const $=async t=>(0,D.dX)("/api/financial/query_pay_list",{params:t});var B=a(67578),j=a(67910),P=a(61282),L=a(85937),A=a.n(L),q=a(7629),I=a(41532),V=a(5968),T=a(40290),R=(0,o.defineComponent)({name:"FinancePayment",setup(t,e){const{jumpProjectDetail:a}=(0,T.k)(e),i=(0,g.gI)(),s=(0,o.computed)((()=>e.root.$store.state.workbench)),l=(0,o.computed)((()=>s.value.approval)),n=(0,o.ref)([]),c=(0,o.ref)([]),p=(0,o.ref)(),u=32,m=46,d=30,_=12,y=(0,o.ref)(!1),f=(0,o.ref)(""),v=(0,o.ref)(0),h=t=>{v.value=t.height},b=(0,C.Z)({compensation:u+m+d+_,fixedBlockHeightRefs:[v]}),w=(0,o.ref)(null),k=async(t,a,i)=>{y.value=!0;const s={id:t.cost_id,reverse_type:F.Jd.payment,is_pass:a,reverse_back_reason:i},o=await(0,S.aH)(s);return y.value=!1,o.data.success?(e.root.$message.success(o.data.message??"确认成功"),p.value&&p.value()):e.root.$message.error(o.data.message??"确认失败"),o.data.success},x=t=>{w.value?.open(t.reverse_reason,((e,a)=>k(t,e,a)))},D=(0,o.ref)(!1),$=(0,o.ref)(""),L=t=>{$.value=t.reverse_reason,D.value=!0},q=()=>{$.value="",D.value=!1},I=(0,o.ref)([]),V=(0,o.ref)([]),R=(t,e)=>e?t.uid:(0,o.h)("span",{class:null!==t.reversed_id?"reverse-red":""},[t.uid]),z=(0,j.zY)(V,"付款编号",R),O=(t,e)=>{const a=`${(0,P.SJ)(new(A())(t.pay_amount))}`;return e?a:(0,o.h)("span",{class:null!==t.reversed_id?"reverse-red":""},[a])},M=(0,j.zY)(V,"付款金额 (元)",O),Z=(t,e)=>{const a=1===t.pay_type?"成本":2===t.pay_type?"退款":"--",i=9!==t.new_cost_type?B.rt.get(t.new_cost_type)??"--":"冲销";return e?(0,P.QN)(a)>(0,P.QN)(i)?a:i:[(0,o.h)("div",[a])]},W=(0,j.zY)(V,"付款类型",Z),U=(t,e)=>{const a=1===t.pay_way?"银行卡":2===t.pay_way?"v任务":3===t.pay_way?"对公银行":4===t.pay_way?"支付宝":"--";return e?a:[(0,o.h)("div",[a])]},Y=(0,j.zY)(V,"付款方式",U),E=(0,o.computed)((()=>[{label:"付款编号",fixed:"left",align:"center",minWidth:z.value<90?90:z.value,formatter:t=>R(t,!1)},{align:"right",label:"付款金额 (元)",minWidth:M.value<120?120:M.value,formatter:t=>O(t,!1)},{label:"付款类型",align:"center",minWidth:W.value,formatter:t=>Z(t,!1)},{label:"付款方式",align:"center",minWidth:Y.value,formatter:t=>U(t,!1)}])),N=t=>{let e=!1;return e=2===t.pay_type?t.refund_write_off_infos&&t.refund_write_off_infos.length>0:t.write_off_infos&&t.write_off_infos.length>0,e},G=t=>{let e=[];return e=2===t.pay_type?(t.refund_write_off_infos??[]).map((t=>{const e={...t};return e.write_off_amount=-1*e.write_off_amount,e})):t.write_off_infos??[],e},H=(0,o.ref)([]),J=()=>{(0,S.k6)().then((t=>{t?.data?.success?H.value=t.data.data:e.root.$message.error(t?.data?.message??"获取银行账号列表失败")}))},Q=(0,o.ref)(!1),K=(0,o.ref)({name:"123"}),X=t=>{K.value=t,Q.value=!0},tt=()=>{Q.value=!1},et=(0,o.ref)([]),at=async()=>{const t=await(0,S.k6)();t.data.success&&(et.value=t.data.data??[])};return(0,o.onMounted)((()=>{at()})),{jumpProjectDetail:a,search_link_payment:I,list:V,columns:E,permission:i,bankList:et,workbenchState:s,approval:l,urlList:n,urlShowList:c,onTopCardRectUpdate:h,...b,onReasonViewBtnClick:L,onReasonDialogClose:q,onReverseAuditConfirm:k,reverseAuditDialogRef:w,reverseAuditLoading:y,reasonDialogVisible:D,reason:$,handleReverseAduit:x,reloadFunc:p,writeOffPopoverVisible:N,writeOffPopoverInfo:G,queryBankAccounts:J,bank_account_list:H,row_is_pay:f,onRowClick:X,loanDetailVisible:Q,detailroval:K,onLoanDetailClose:tt,numberFormat:r.Y4}},components:{LoanfinanceDetailModal:_.Z,FinanceInvoiceDetailDialog:c.Z,Invoicelist:m.Z,InvoicesDetail:d.Z,WriteListPop:k.Z,reverseAuditDialog:x.Z,PaymentDetailDialog:q.Z,RefundDetailDialog:I.Z,AdvanceDetailDialog:V.Z},data(){const t="console"===this.$router.currentRoute.query.source;return{link_payment_list:[],linkPaymentVisible:!1,link_id:"",active_id:!1,choose_radio:"",invoiceListItemActiveIndex:void 0,applyDetailDialogVisible:!1,refundVisible:!1,applicationVisible:!1,invoicesVisible:!1,total:0,statistics:null,queryForm:{business_type:"",pay_type:"",new_cost_type:"",is_invoice:"",is_pay:t?0:"",pay_way:"",is_split:"",write_off_status:"",query_date_type:3,pay_date:"",search_value:"",search_type:1,payer_bank_account_id:void 0,page_num:1,num:20},loading:!1,financeInvoiceDetailVisible:!1,invoiceList:[],paymentConfirmVisible:!1,paymentConfirmFrom:{pay_date:"",bank_account_id:""},paymentConfirmFromRules:{pay_date:{required:!0,message:"请选择打款时间",trigger:["change","blur"]},bank_account_id:{required:!0,message:"请选择打款账号",trigger:["blur","change"]}},fileList:[],uploadVisible:!1,tax_point:"",uploadForm:{list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]},costSplitVisible:!1,costSplitForm:{},commonTitle:"",project_options:[]}},filters:{emptyData(t){return""===t||void 0===t||null===t?"--":t}},computed:{timeDefault(){const t=new Date,e=n()(t.getTime()-2592e6).format("YYYY-MM-DD"),a=n()(t.getTime()).format("YYYY-MM-DD");return[e,a]}},created(){this.queryForm.pay_date=this.timeDefault,this.reloadFunc=()=>{this.getList()},this.getList(),this.costType(1),this.$store.hasModule("workbench")||this.$store.registerModule("workbench",h.T)},methods:{clearInvoiceListItemActiveIndex(){this.invoiceListItemActiveIndex=void 0},onEnterPressLinkPayment(){this.getLinkPaymentList()},handlePushClick(t,e){this.search_link_payment.splice(e,1),this.link_payment_list.unshift(t),this.link_id=""},handleRemoveClick(t,e){this.link_payment_list.splice(t,1),e===this.choose_radio&&(this.choose_radio="")},async getLinkPaymentList(){if(""===this.link_id)return!1;const t=await $({cost_id:this.link_id});if(t.data.success){const e=t.data.data;if(e.data.length>0)if("{}"===JSON.stringify(e.data[0].associate_cost)){const t=this.link_id;this.active_id=this.link_payment_list.some((e=>e.cost_id.toString()===t)),this.search_link_payment=e.data}else this.$message.warning("该付款记录已完成关联!");else this.$message.warning("请输入正确的付款ID!")}else this.$message.warning("请输入正确的付款ID!")},showLinkPaymentBtnClick(){this.linkPaymentVisible=!0},linkPaymentCloseAction(){this.linkPaymentVisible=!1,this.link_payment_list=[],this.search_link_payment=[],this.link_id="",this.choose_radio=""},async linkPaymentSubmitAction(){if(this.link_payment_list.length<2)return this.$message.warning("请添加至少2条付款记录！"),!1;const t=this.link_payment_list,e=t.every((t=>0===t.is_pay));if(!e&&""===this.choose_radio)return this.$message.warning("请选择需要保留的凭证及发票！"),!1;{const e=[];for(let i=0;i<t.length;i++)e.push(t[i].cost_id);const a=await(0,y.GF)({cost_ids:e,reserve_id:this.choose_radio,confirm:!1});a.data.success?this.$confirm("确认将这些付款记录进行关联? 关联成功后不可撤销","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await(0,y.GF)({cost_ids:e,reserve_id:this.choose_radio,confirm:!0});t.data.success?(this.$message({type:"success",message:"关联成功!"}),this.linkPaymentCloseAction(),this.getList()):this.$message({type:"error",message:t.data.message})})).catch((()=>{this.$message({type:"info",message:"已取消"})})):this.$message({type:"error",message:a.data.message})}},handlePaste(t,e){if(-1===e&&3===this.urlList.length)return;const a=(t.clipboardData||window.clipboardData).items;let i=null;if(!a||0===a.length)return void this.$message.error("当前浏览器不支持本地");for(let o=0;o<a.length;o++)if(-1!==a[o].type.indexOf("image")){i=a[o].getAsFile();break}if(!i)return void this.$message.error("粘贴内容非图片");const s=new FileReader;s.onload=()=>{},s.readAsDataURL(i),i&&this.beforeUpload(i)&&(-1===e?this.uploadConfirmImage(!0,{file:i}):this.uploadImage(e,!0,{file:i}))},getToken:v.LP,numberMoneyFormat:r.rH,inputLoanAmountCost(t,e,a){const i=e.replace(/[^\d.]+/gu,"").replace(/^0+(?=\d)/gu,"")??"",s=/\d+(?:\.\d{0,2})?/gu.exec(i)??[""];1===a?this.uploadForm.list[t].amount=s[0]:2===a?this.tax_point=s[0]:3===a&&(this.costSplitForm.cost[t].price=s[0])},async fetchApprovalInfo(t,e){const{data:a}=await(0,b.OC)({approval_id:""===t?void 0:t,approval_uid:e});return a.success?this.$store.dispatch("workbench/setApproval",a.data):this.$message.error(a.message??"获取审批详情失败"),a.data},async handleClickApprovalBtn(t){if(2===t.pay_type)return void(t.business_type===u.WD.marketing?window.open("/marketing/project/"+t.cooperation_id+"/achievement"):t.business_type===u.WD.taobao||t.business_type===u.WD.douyin?window.open("/live/project/"+t.project_id+"/collection/week"):window.open("/commonbusiness/project/"+t.project_id+"/collection"));const e=await this.fetchApprovalInfo(t.approval_id);e&&(1===t.approval_type?this.applyDetailDialogVisible=!0:2===t.approval_type?this.refundVisible=!0:3===t.approval_type?this.applicationVisible=!0:4===t.approval_type&&(this.invoicesVisible=!0,this.$nextTick((()=>{this.$refs.invoicesDetailDialog.show({approval_id:t.approval_id})}))))},async handleClickApplicationBtn(t){if(!t.borrowing_approval_id)return;const e=await this.fetchApprovalInfo(t.borrowing_approval_id);e&&(this.applicationVisible=!0)},costType(t){return new Map([[1,"人员工资"],[2,"主播服务费"],[3,"固定资产采购"],[4,"水电"],[5,"装修"],[6,"房租"],[7,"营销成本"],[8,"返点"]]).get(t)??"--"},checkoutCertificateBtn(t){const e=t.split(",");1===e.length?p.Z.showDetail(e[0]+"?Authorization="+(0,v.LP)()):this.$refs.invoicelistRef.show({title:"打款凭证",list:e.map((t=>t+"?Authorization="+(0,v.LP)())),type:1})},exportBtnClick(){const t=this.getParams();(0,y.KY)({...(0,f.jG)(t)})},async getCustmerByContractNo(t){const e=await(0,y.QC)({project_uid:t,business_type:this.costSplitForm.business_type});e.data.success?this.project_options=e.data.data:this.$message({type:"error",message:e.data.message})},async getList(){this.loading=!0;const t=await $({...(0,f.jG)({...this.getParams(),page_num:this.queryForm.page_num,num:this.queryForm.num})});if(t.data.success){const e=t.data.data;this.list=e.data,this.total=e.total,this.loading=!1,this.statistics=e.statistics_data}else this.$message({type:"error",message:t.data.message})},async goProjectDetail(t){t.business_type===u.WD.marketing?window.open("/marketing/project/"+t.project_id):t.business_type===u.WD.taobao||t.business_type===u.WD.douyin?this.jumpProjectDetail({project_id:t.project_id,newWindow:!0}):window.open("/commonbusiness/project/"+t.project_id)},async goContractDetail(t,e){if(t)if(1===e||2===e)window.open("/legal/contract/customer/"+t);else if(3===e||4===e)window.open("/legal/contract/supplier/"+t);else if(5===e)window.open("/legal/contract/customerTemplate/"+t);else if(6===e)window.open("/legal/contract/supplierTemplate/"+t);else{if(7!==e)return;window.open("/legal/contract/anchorTemplate/"+t)}},getParams(){const t=this.queryForm;return{search_type:t.search_type,search_value:t.search_value,business_type:t.business_type,pay_type:t.pay_type,new_cost_type:t.new_cost_type,is_invoice:t.is_invoice,is_pay:t.is_pay,pay_way:t.pay_way,is_split:t.is_split,write_off_status:t.write_off_status,payer_bank_account_id:t.payer_bank_account_id,query_date_type:t.query_date_type,start_date:t.pay_date?t.pay_date[0]:"",end_date:t.pay_date?t.pay_date[1]:""}},onQuerySearchClick(){this.queryForm.page_num=1,this.getList()},onQueryResetClick(){this.queryForm={business_type:"",pay_type:"",new_cost_type:"",is_invoice:"",is_pay:"",pay_way:"",is_split:"",write_off_status:"",query_date_type:3,payer_bank_account_id:void 0,pay_date:"",search_value:"",search_type:1,page_num:1,num:20},this.queryForm.pay_date=this.timeDefault,this.getList()},handleCurrentChange(t){this.queryForm.page_num=t,this.getList()},handlePageSizeChange(t){this.queryForm.page_num=1,this.queryForm.num=t,this.getList()},checkoutInvoiceDetailBtn(t){this.invoiceList=t,this.financeInvoiceDetailVisible=!0},closeFinanceInvoiceDetailAction(){this.financeInvoiceDetailVisible=!1},paymentConfirmClick(t){this.commonTitle="打款确认",this.row_is_pay=t.is_pay,this.cost_id=t.cost_id,this.paymentConfirmVisible=!0,this.queryBankAccounts()},editConfirmClick(t){this.commonTitle="编辑打款凭证",this.cost_id=t.cost_id,this.paymentConfirmFrom.pay_date=t.pay_date,this.paymentConfirmFrom.bank_account_id=t.bank_account_id,this.row_is_pay=t.is_pay;const e=t.pay_certificate_pic.split(","),a=[];this.urlList=e;for(const i of e)a.push(i+`?Authorization=${(0,v.LP)()}`);this.urlShowList=a,this.paymentConfirmVisible=!0},paymentConfirmCloseAction(){this.paymentConfirmVisible=!1,this.paymentConfirmFrom={pay_date:"",bank_account_id:""},this.urlList=[],this.urlShowList=[]},handlePaymentConfirmSaveAction(t){this.$refs[t].validate((async t=>{if(this.urlList.length<1)return this.$message({message:"请上传打款凭证",type:"warning"}),!1;if(!t)return!1;{const t={cost_id:this.cost_id,pay_certificate_pic:this.urlList,pay_date:this.paymentConfirmFrom.pay_date,bank_account_id:this.paymentConfirmFrom.bank_account_id},e=await(0,y.S8)(t);e.data.success?(this.paymentConfirmVisible=!1,this.urlList=[],this.urlShowList=[],this.paymentConfirmFrom={pay_date:"",bank_account_id:""},this.getList(),this.$message({type:"success",message:e.data.message})):this.$message({type:"error",message:e.data.message})}}))},deleteConfirmItemBtn(t){this.urlList.splice(t,1),this.urlShowList.splice(t,1)},async uploadConfirmImage(t,e){const a=this.cost_id,i=new FormData;i.append("file",e.file),i.append("type","certificate/cost_pay_certificate"),i.append("achievement_or_cost_id",a);const{data:s}=await(0,y.G1)(i);s.success?(this.urlShowList.push(s.data.source+`?Authorization=${(0,v.LP)()}`),this.urlList.push(s.data.source),t&&this.$message.success("粘贴成功！")):this.$message.error("上传失败！")},costSplitBtnClick(t){this.costSplitForm={pay_amount:t.pay_amount,business_type:t.business_type,new_cost_type:t.new_cost_type,cost_id:t.cost_id,cost:[{project_id:"",price:""}]},this.costSplitVisible=!0},costSplitCloseAction(){this.costSplitVisible=!1},costSplitSaveAction(t){this.$refs[t].validate((async t=>{if(!t)return!1;{const t={cost_id:this.costSplitForm.cost_id,cost:this.costSplitForm.cost},e=await(0,y.pt)(t);e.data.success?(this.costSplitVisible=!1,this.costSplitForm={},this.$message({type:"success",message:e.data.message}),this.getList()):this.$message({type:"error",message:e.data.message})}}))},addCostSplitItemBtn(){this.costSplitForm.cost.push({project_id:"",price:""})},deleteCostSplitItemBtn(t){this.costSplitForm.cost.splice(t,1)},uploadCloseAction(){this.uploadVisible=!1,this.clearInvoiceListItemActiveIndex(),this.uploadForm={list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]}},uploadSaveAction(t){this.$refs[t].validate((async t=>{if(Number(this.tax_point)<0)return this.$message({message:"税点金额不能小于0",type:"warning"}),!1;const e=this.uploadForm.list;for(let a=0;a<e.length;a++)if(Number(e[a].amount)<0)return this.$message({message:"开票金额不能小于0",type:"warning"}),!1;if(!t)return!1;{const t={cost_id:this.cost_id,tax_point:this.tax_point,invoice_info:e},a=await(0,y.Jr)(t);a.data.success?(this.uploadVisible=!1,this.uploadForm={list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]},this.getList(),this.$message({type:"success",message:a.data.message})):this.$message({type:"error",message:a.data.message})}}))},beforeUpload(t){const e=t.size/1024/1024<5;return["image/jpeg","image/jpg","image/png"].includes(t.type)||[".jpg",".jpeg",".png"].includes((0,f.mD)(t.name))?!!e||(this.$message.error("上传图片大小不能超过 5MB!"),!1):(this.$message.warning("文件格式不正确，请使用 png / jpg / jpeg"),!1)},async uploadImage(t,e,a){const i=JSON.parse(JSON.stringify(this.uploadForm.list)),s=new FormData;s.append("file",a.file),s.append("type","certificate/cost_invoice_certificate");const{data:o}=await(0,y.G1)(s);if(o.success){const a=o.data.source;i[t].show_url=(0,w.W)(a,!1),i[t].pic_url=a,this.uploadForm.list=i,e&&this.$message.success("粘贴成功！")}else this.$message.error("上传失败！")},addUploadItemBtn(){this.uploadForm.list.push({invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""})},deleteUploadItemBtn(t){this.uploadForm.list.splice(t,1)}}}),z=R,O=a(1001),M=(0,O.Z)(z,i,s,!1,null,"b7a92436",null),Z=M.exports},84731:function(t,e,a){a.d(e,{f:function(){return o}});var i=a(44928),s=a(1763);const o=(t=!1)=>{const e=(0,i.t)(),a=e.currentRoute.name,o=s.u3.project.detail===a||t,l=s.u3.contract.supplier.detail===a||s.u3.contract.supplier.detailTemplate===a||s.u3.contract.anchor.detailTemplate===a,n=s.u3.contract.customer.detail===a||s.u3.contract.customer.detailTemplate===a,r=s.FB.contract.supplier.detail===a||s.FB.contract.supplier.detailTemplate===a||s.FB.contract.anchor.detailTemplate===a,c=s.FB.contract.customer.detail===a||s.FB.contract.customer.detailTemplate===a,p=s.u3.contract.customer.detailTemplate===a,u=s.Z8.contract.supplier.detail===a||s.Z8.contract.supplier.detailTemplate===a||s.Z8.contract.anchor.detailTemplate===a,m=s.Z8.contract.customer.detail===a||s.Z8.contract.customer.detailTemplate===a,d=s.l6.contracts.supplier.detail===a||s.l6.contracts.supplier.detailTemplate===a||s.l6.contracts.anchor.detailTemplate===a,_=s.l6.contracts.customer.detail===a||s.l6.contracts.customer.detailTemplate===a,y=s.l6.statistics.supplier.detail===a||s.l6.statistics.supplier.detailTemplate===a||s.l6.statistics.anchor.detailTemplate===a,f=s.l6.statistics.customer.detail===a||s.l6.statistics.customer.detailTemplate===a,v=s.Z8.project.detail===a,g=s.FB.project.detail===a,h=s.u3.contract.customer.detailTemplate===a||s.l6.contracts.customer.detailTemplate===a||s.Z8.contract.customer.detailTemplate===a||s.FB.contract.customer.detailTemplate===a,b=s.bv.player_contract===a;return{isCustomerDetail:h,isCommonBusinessDetail:o,isCommonBusinessSupplierContractDetail:l,isCommonBusinessCustomerContractDetail:n,isLiveSupplierContractDetail:r,isLiveCustomerContractDetail:c,isLegalCustomerContractDetail:_,isLegalSupplierContractDetail:d,isLegalStatisticsSupplierContractDetail:y,isLegalStatisticsCustomerContractDetail:f,isCoopSupplierContractDetail:u,isCoopCustomerContractDetail:m,isCoopDetail:v,isLiveDetail:g,isisCommonBusinessCustomerContractDetailTemplate:p,isSupplierDetail:b}}},28348:function(t,e,a){a.d(e,{$m:function(){return d},Cy:function(){return y},D_:function(){return r},FA:function(){return c},GG:function(){return m},Jd:function(){return s.Jd},Qn:function(){return u},Ti:function(){return f},br:function(){return p},dw:function(){return l},eY:function(){return _},gf:function(){return v},kX:function(){return i},mR:function(){return g},ne:function(){return n},v$:function(){return o}});var i,s=a(67578);(function(t){t[t["live_taobao"]=1]="live_taobao",t[t["live_douyin"]=2]="live_douyin",t[t["marketing_marketing"]=3]="marketing_marketing",t[t["common_mcn_taobao_cps"]=4]="common_mcn_taobao_cps",t[t["common_mcn_douyin_cps"]=5]="common_mcn_douyin_cps",t[t["common_mcn_vtask"]=6]="common_mcn_vtask",t[t["marketing_vtask"]=7]="marketing_vtask",t[t["s2b2c_douyin_cps"]=8]="s2b2c_douyin_cps"})(i||(i={}));const o=new Map([[i.live_douyin,"抖音店播"],[i.live_taobao,"淘宝店播"],[i.marketing_marketing,"营销-营销"],[i.common_mcn_douyin_cps,"S2B2C-抖音"],[i.common_mcn_taobao_cps,"S2B2C-淘宝CPS"],[i.common_mcn_vtask,"S2B2C-V任务"],[i.marketing_vtask,"营销-V任务"],[i.s2b2c_douyin_cps,"S2B2C-抖音CPS"]]),l=[{value:i.live_douyin,label:"抖音店播",group:"店铺代播"},{value:i.live_taobao,label:"淘宝店播",group:"店铺代播"},{value:i.common_mcn_douyin_cps,label:"S2B2C-抖音",group:"S2B2C"},{value:i.common_mcn_taobao_cps,label:"S2B2C-淘宝CPS",group:"S2B2C"},{value:i.s2b2c_douyin_cps,label:"S2B2C-抖音CPS",group:"S2B2C"},{value:i.common_mcn_vtask,label:"S2B2C-V任务",group:"S2B2C"},{value:i.marketing_marketing,label:"营销-营销",group:"营销"},{value:i.marketing_vtask,label:"营销-V任务",group:"营销"}];var n;(function(t){t[t["unsubmit"]=0]="unsubmit",t[t["wait_confirm"]=1]="wait_confirm",t[t["confirmed"]=2]="confirmed",t[t["refused"]=3]="refused",t[t["wait_project_confirm"]=4]="wait_project_confirm",t[t["nopass_project_confirm"]=5]="nopass_project_confirm"})(n||(n={}));const r=new Map([[n.unsubmit,"未提交"],[n.wait_confirm,"待确认"],[n.confirmed,"已确认"],[n.refused,"退回"],[n.wait_project_confirm,"待项目确认"],[n.nopass_project_confirm,"项目确认不通过"]]),c=[{value:n.unsubmit,label:"未提交"},{value:n.wait_confirm,label:"待确认"},{value:n.confirmed,label:"已确认"},{value:n.refused,label:"退回"},{value:n.wait_project_confirm,label:"待项目确认"},{value:n.nopass_project_confirm,label:"项目确认不通过"}];var p,u,m,d;(function(t){t[t["step_one"]=0]="step_one",t[t["step_two"]=1]="step_two",t[t["step_three"]=2]="step_three"})(p||(p={})),function(t){t[t["income"]=1]="income",t[t["cost"]=2]="cost"}(u||(u={})),function(t){t[t["close"]=0]="close",t[t["prev"]=1]="prev",t[t["next"]=2]="next"}(m||(m={})),function(t){t[t["Hourly"]=1]="Hourly",t[t["Basic_or_commision"]=2]="Basic_or_commision",t[t["Basic_and_commision"]=3]="Basic_and_commision"}(d||(d={}));new Map([[d.Hourly,"时薪"],[d.Basic_or_commision,"底薪/提成(取高的)"],[d.Basic_and_commision,"底薪+提成"]]);var _,y;(function(t){t[t["pit_fee"]=1]="pit_fee",t[t["head_service_fee"]=2]="head_service_fee",t[t["douyin_cps"]=3]="douyin_cps",t[t["xingtu"]=4]="xingtu",t[t["shangguang"]=5]="shangguang",t[t["other"]=6]="other",t[t["talent_cost"]=7]="talent_cost",t[t["put"]=8]="put",t[t["anchor"]=9]="anchor",t[t["unity"]=10]="unity"})(_||(_={})),function(t){t[t["merchant_project"]=1]="merchant_project",t[t["execute_project"]=2]="execute_project"}(y||(y={}));const f=new Map([[_.pit_fee,"坑位费"],[_.head_service_fee,"团长服务费"],[_.douyin_cps,"抖音CPS"],[_.xingtu,"星图"],[_.shangguang,"商广"],[_.other,"其他"]]),v=new Map([[_.pit_fee,"坑位费"],[_.talent_cost,"达人成本"],[_.put,"投放成本"],[_.xingtu,"星图"],[_.shangguang,"商广"],[_.other,"其他"]]),g=new Map([[_.anchor,"主播成本"],[_.put,"投放成本"],[_.other,"其他成本"]])},82741:function(t,e,a){a.d(e,{I:function(){return s},u:function(){return o}});var i=a(71340);const s=(t,e)=>{const a="string"===typeof e?{title:e}:e;return new Promise((e=>{t.root.$TDialog({...a,onConfirm:()=>e(!0),onCancel:()=>e(!1)})}))},o=t=>{const e="string"===typeof t?{title:t}:t;return new Promise(((t,a)=>{(0,i.t)({...e,onConfirm:()=>t(!0),onCancel:()=>a()})}))}},58861:function(t,e,a){var i=a(97434);const s=(t=!1)=>{const e=(0,i.ref)(t),a=(t=!1)=>e.value=t,s=()=>e.value=!e.value;return{visible:(0,i.computed)((()=>e.value)),setVisible:a,toggleVisible:s}};e["Z"]=s},44928:function(t,e,a){a.d(e,{t:function(){return s}});var i=a(86834);const s=()=>{const t=new Proxy({},{get(t,e){return Reflect.get(i.Z,e)}});return t}},40290:function(t,e,a){a.d(e,{k:function(){return s}});var i=a(1763);const s=t=>{const e={jumpProjectDetail:t=>{const a={name:i.FB.project.detail,params:{id:`${t.project_id}`,tab:t.tab??"projectInfo",liveType:t.liveType??"calendar"}},s=t.newWindow??!1;e.jump(a,s)},jumpLiveDisplayDetail:t=>{const a={name:i.FB.display.detail,params:{id:`${t.project_id}`,liveId:`${t.live_id}`,tab:"live",liveType:t.liveType??"calendar"}},s=t.newWindow??!1;e.jump(a,s)},jump:(e,a=!1)=>{if(a){const{href:a}=t.root.$router.resolve(e);window.open(a,"_blank")}else t.root.$router.push(e)}};return{...e}}},43773:function(t,e,a){a.d(e,{R:function(){return m},y:function(){return d}});var i=a(36568),s=a.n(i),o=a(97434),l=a(64923),n=a(77944);let r=1;const c=()=>{const t=document.createElement("div");return t.id="dialog_"+r++,document.body.appendChild(t),t},p=new Function,u=(t,e)=>{let a=t;return void 0===a&&(a={}),Object.keys(e).forEach((t=>{const i=a[t]||p,s=e[t];a[t]=(...t)=>{if(!1!==s(...t))return i(...t)}})),a},m=(t={})=>{const e=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),i=(0,o.ref)(!0),r=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};r(t);const p=(0,o.ref)(u(t.on,{close(){a.visible=!1},updateDialog(t={}){r(t)}})),m=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,o.provide)(e,t.provide[e])}))},render(e){if(i.value&&a.visible)return e("el-dialog",s()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${t.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:p.value},{attrs:{isDialog:!0}}]),[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:p.value}),a.footer&&e("fragments",{slot:"footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{attrs:{type:"primary"},on:{click:m}},[a.okText])])])}});const d=(...t)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},_=t=>(r(t),v),y=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?p.value[t]=e:u(p.value,{[t]:e}),v);(0,o.onUnmounted)((()=>{i.value=!1,a.visible=!1}));const v=(0,o.reactive)({show:d,update:_,on:f,close:y,config:t,data:t.data});return v},d=(t={})=>{const e=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),i=(0,o.ref)(!0),r=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};r(t);const p=(0,o.ref)(u(t.on,{close(){a.visible=!1},updateDialog(t={}){r(t)}})),m=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,o.provide)(e,t.provide[e])}))},render(e){if(!i.value)return;if(!a.visible)return;const{width:o,...l}=a;return e("el-drawer",s()([{class:`tg-drawer-rewrite ${t.class}`},{props:{...l,size:o}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:p.value},{attrs:{isDialog:!0}}]),[e("div",{class:"tg-drawer-content"},[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:p.value})]),a.footer&&e("div",{class:"tg-drawer-footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:m}},[a.okText])])])}});const d=(...t)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},_=t=>(r(t),v),y=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?p.value[t]=e:u(p.value,{[t]:e}),v);(0,o.onUnmounted)((()=>{i.value=!1,a.visible=!1}));const v=(0,o.reactive)({show:d,update:_,on:f,close:y,config:t});return v}}}]);