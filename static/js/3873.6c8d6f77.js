"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[3873],{73873:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var l,s,r=a(36568),o=a.n(r),i=a(97434),n=a(29625),d=a(3293),p=a(7039),u=a(26895),m=(0,i.defineComponent)({name:"",setup(e,t){const{saleData:a,loading:l,total:s,tableColumn:r,getData:o}=(0,p.IU)(t),m=()=>({page_num:1,num:20,department_name:t.root.$route.query.department_name??void 0,business_type:Number(t.root.$route.query.business_type??0)||void 0,department_id:t.root.$route.query.department_id??void 0,department_level:t.root.$route.query.department_level??void 0,start_date:t.root.$route.query.start_date??void 0,end_date:t.root.$route.query.end_date??void 0,project_status:void 0,search_type:1,search_value:""}),c=(0,i.ref)(m()),h=(0,i.computed)((()=>[{label:"全部",value:void 0},{label:"抖音店播",value:n.WD.douyin},{label:"淘宝店播",value:n.WD.taobao},{label:"S2B2C",value:n.WD.mcn},{label:"营销业务",value:n.WD.marketing}])),v=(0,i.ref)([]),g=(0,i.ref)(void 0),y={async getFeishuDepartmentList(e=!1){const a=await(0,d.o1)({});if(a.data.success){const e=a.data.data.data;(0,u.$S)(e,!0,3),v.value=e}else t.root.$message.error(a.data.message??"请求失败，请重试")},handleCheckChange:e=>{g.value?.setCheckedKeys([]),c.value.department_id===e.id?(c.value.department_id=void 0,c.value.department_name=void 0):(c.value.department_id=e.id,c.value.department_name=e.name,c.value.department_level=e.level,g.value?.setCheckedKeys([e.id]))},ondepartmentCleaar(e){g.value?.setCheckedKeys([]),c.value.department_id=void 0,c.value.department_name=void 0,c.value.department_level=void 0,e&&e.stopPropagation()}};(0,i.onMounted)((async()=>{y.getFeishuDepartmentList(!1),o(c.value),c.value.department_id&&g.value?.setCheckedKeys([c.value.department_id])}));const b=async()=>{c.value={page_num:1,num:20,department_name:void 0,business_type:void 0,department_id:void 0,department_level:void 0,start_date:void 0,end_date:void 0,project_status:void 0,search_type:1,search_value:""},y.ondepartmentCleaar(),o(c.value)},_=async()=>{o(c.value)},f=e=>{c.value.page_num=e,o(c.value)},x=e=>{c.value.num=e,o(c.value)},C=(e,t)=>{};return{reset:b,reload:_,onCurrentChange:f,handlePageSizeChange:x,queryForm:c,businessList:h,feishuDepartmentList:v,department_tree:g,ProjectStatusEnum:n.C_,tableLoading:l,total:s,tableColumn:r,saleData:a,handleRowClick:C,...y}},render(){const e=arguments[0],t={label:"name",children:"sons"};return e("div",{class:"tg-contract-page flex-auto"},[e("tg-card",{attrs:{padding:18}},[e("el-form",{class:"filter-form flex-form",attrs:{size:"medium","label-width":"70px","show-message":!1,"label-position":"left",inline:!0}},[e("el-form-item",{attrs:{label:"业务类型："}},[e("el-select",{style:"width: 204px;height: 36px",attrs:{clearable:!0},on:{focus:this.selectControlPopoverHide},model:{value:this.queryForm.business_type,callback:e=>{this.$set(this.queryForm,"business_type",e)}}},[this.businessList.map((t=>e("el-option",{attrs:{label:t.label,value:t.value},key:t.value})))])]),e("el-form-item",{attrs:{label:"归属部门："}},[e("el-popover",{attrs:{placement:"bottom-start",trigger:"click",width:"370","popper-class":"project-fund-statement-tree-popper"}},[e("div",{slot:"reference",class:"department-tree-select",style:"display: block; cursor: pointer;"},[this.queryForm.department_name&&e("div",{class:"depart-select-box"},[e("span",{style:"height: 36px; line-height: 36px;"},[this.queryForm.department_name]),e("i",{style:"margin-top: 10px; color: white",class:"el-icon-circle-close",on:{click:this.ondepartmentCleaar}})]),!this.queryForm.department_name&&e("div",{class:"depart-select-box"},[e("span",{style:"color:rgba(164, 178, 194, 1); height: 36px; line-height: 36px; font-size: 14px;"},["请选择所属部门"]),e("i",{style:"margin-top: 10px; color: #c0c4cc",class:"el-icon-arrow-down"})])]),e("div",{class:"department-tree"},[e("el-tree",o()([{ref:"department_tree"},{props:{props:t}},{attrs:{"check-strictly":!0,"node-key":"id",data:this.feishuDepartmentList,"show-checkbox":!0,"check-on-click-node":!0,"default-expanded-keys":this.queryForm.department_id?[this.queryForm.department_id]:[]},on:{check:this.handleCheckChange}}]))])]),e("li",{style:"display: none",class:"controlPopoverHide"})]),e("el-form-item",{attrs:{label:"项目阶段："}},[e("el-select",{class:"select",attrs:{placeholder:""},style:"width: 100%",model:{value:this.queryForm.project_status,callback:e=>{this.$set(this.queryForm,"project_status",e)}}},[e("el-option",{attrs:{label:"全部",value:void 0}}),e("el-option",{attrs:{label:"试播中",value:n.C_.tryLive}}),e("el-option",{attrs:{label:"项目执行中",value:n.C_.execution}}),e("el-option",{attrs:{label:"区域执行中",value:n.C_.regionExecution}}),e("el-option",{attrs:{label:"执行结束",value:n.C_.executionEnd}}),e("el-option",{attrs:{label:"已完结",value:n.C_.finish}})])]),e("el-form-item",{attrs:{label:""},class:"flex-form-item form-item-group",style:"margin-bottom: 12px"},[e("el-input",{class:"contract-input",style:"width: 290px",attrs:{placeholder:"",clearable:!0},nativeOn:{keypress:this.reload},model:{value:this.queryForm.search_value,callback:e=>{this.$set(this.queryForm,"search_value",e)}}},[e("el-select",{style:"width: 130px",slot:"prepend",model:{value:this.queryForm.search_type,callback:e=>{this.$set(this.queryForm,"search_type",e)}}},[e("el-option",{attrs:{value:4,label:"客户经理"}}),e("el-option",{attrs:{value:5,label:"项目经理"}}),e("el-option",{attrs:{value:1,label:"项目编号"}}),e("el-option",{attrs:{value:6,label:"项目名称"}}),e("el-option",{attrs:{value:7,label:"客户公司名称"}})])])]),e("el-form-item",{class:"flex-form-item order-100",style:"margin-bottom: 14px"},[e("tg-button",{attrs:{type:"primary"},on:{click:this.reload}},["查询"]),e("tg-button",{class:"mgl-12",on:{click:this.reset}},["重置"])])])]),e("section",{class:"table-field"},[e("div",{style:"height: 100%;"},[e("tg-table",{attrs:{stripe:!0,"tooltip-effect":"light",height:this.saleData.length>0?"calc(100vh - 205px)":"calc(100vh - 155px)",border:!0,data:this.saleData},directives:[{name:"loading",value:this.tableLoading}],class:"precharge-table"},[e("template",{slot:"empty"},[e("empty-common",{style:"margin-top:20px",attrs:{imgHeight:"100",imgWidth:"200","detial-text":"暂无数据"}})]),this.tableColumn.map((t=>e("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:t.label,align:t.align,headerAlign:t.headerAlign,minWidth:t.minWidth,formatter:t.formatter}})))])])]),this.saleData.length>0&&e("div",{class:"pagination"},[e("el-pagination",{style:"margin: 8px 0;",class:"flex-none",attrs:{"current-page":this.queryForm.page_num,"page-sizes":[10,20,30,50,100],"page-size":this.queryForm.num,total:this.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"current-change":this.onCurrentChange,"size-change":this.handlePageSizeChange}})])])}}),c=m,h=a(1001),v=(0,h.Z)(c,l,s,!1,null,"6b61f98a",null),g=v.exports}}]);