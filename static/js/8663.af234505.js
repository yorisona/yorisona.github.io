"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[8663],{3283:function(t,e,a){a.d(e,{Z:function(){return p}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"oa-flows"},[a("div",{staticClass:"oa-flows-hd"},[t._v("审批进度")]),a("div",{staticClass:"oa-flows-bd"},[a("el-steps",{attrs:{direction:"vertical",active:t.length}},[""!==t.receivedPersons&&t.isProcessing?a("el-step",{scopedSlots:t._u([{key:"icon",fn:function(){return[a("tg-icon",{staticStyle:{"font-size":"14px"},attrs:{name:"ico-waiting"}})]},proxy:!0},{key:"description",fn:function(){return[a("div",{staticClass:"oa-flow-content",staticStyle:{color:"#a4b2c2"}},[t._v(t._s(t.receivedPersons))]),a("div",{staticClass:"oa-flow-content",staticStyle:{color:"#a4b2c2"}},[t._v("待处理")])]},proxy:!0}],null,!1,2618238872)}):t._e(),t._l(t.flows,(function(e,n){return a("el-step",{key:n,scopedSlots:t._u([{key:"icon",fn:function(){return[e.isFailureNode?a("tg-icon",{staticStyle:{"font-size":"16px"},attrs:{name:"ico-cross-red"}}):a("tg-icon",{staticStyle:{"font-size":"16px"},attrs:{name:"ico-tick"}})]},proxy:!0},{key:"description",fn:function(){return[a("div",{staticClass:"oa-flow-content"},[t._v(t._s(e.nodeName))]),a("div",{staticClass:"oa-flow-content"},[a("span",[t._v("审批人："+t._s(e.operatorName))]),e.isFailureNode&&t.get_node_result(e)?a("span",{staticClass:"fg-failure"},[t._v("("+t._s(t.get_node_result(e))+")")]):t._e()]),a("div",{staticClass:"oa-flow-footer"},[t._v(t._s(e.operateDate)+" "+t._s(e.operateTime))])]},proxy:!0}],null,!0)})}))],2)],1)])},o=[],i=a(97434),r=a(17890),c=(0,i.defineComponent)({props:{removeOaNodeNameIndex:{type:Boolean,default:!1},status:{type:Number}},setup(t){const e=(0,i.inject)("flows")??(0,i.ref)([]),a=e.value[e.value.length-1]?.receivedPersons,n=(0,i.computed)((()=>t.status===r.Kb.Failure)),o=(0,i.computed)((()=>t.status===r.Kb.Processing)),c=e.value.length+(""===a||n.value?0:1),s=t=>t.oa_review_result??t.remark;return{flows:(0,i.computed)((()=>e.value.map((e=>t.removeOaNodeNameIndex?{...e,nodeName:e.nodeName.replace(/^\d+\./u,"")}:e)).map(((t,a)=>{const o=a<e.value.length-1,i=!o&&n.value;return{...t,isFinishNode:o,isFailureNode:i}})).reverse())),receivedPersons:a,length:c,get_node_result:s,isProcessing:o}}}),s=c,l=a(1001),u=(0,l.Z)(s,n,o,!1,null,null,null),p=u.exports},54797:function(t,e,a){a.r(e),a.d(e,{default:function(){return B}});a(26699);var n=a(97434),o=a(44928),i=(a(21703),a(83005)),r=a(84731),c=a(17890),s=a(97484),l=a(82741),u=a(1763),p=a(25711),d=a(64236),m=a(48606),f=a(11676),_=a(86863),v=a(43847);const g=t=>{const e=(0,n.ref)(),a=(0,o.t)(),u=(0,r.f)(),g=(0,v.Pc)();let y=1;const h=(0,n.computed)((()=>(e.value?.contract_info.contract_status===c.Kb.Processing||e.value?.contract_info.contract_status===c.Kb.Failure)&&(null!==e.value?.contract_info.feishu_request_id||null!==e.value?.contract_info.oa_request_id))),{getCache:b,setCache:w}=(0,p.Y)(),C=async t=>{x.flowsLoading=!0;const[{data:e},a]=await Promise.all([await(0,i.eu)(t),await(0,d._v)(200)]);return x.flowsLoading=!1,e.success?(w(t,e.data),x.flowsError="",e.data):(x.flowsError=e.message,!1)},x=(0,n.reactive)({flowsLoading:!0,isFlowFromOA:h,flows:[],status:1,flowsError:"",onFlowsShow:async()=>{const t=e.value?.contract_info.id;if(void 0===t)return;const a=b(t)??await C(t);!1!==a&&(x.flows=a,x.status=e.value?.contract_info.contract_status)}});(0,n.provide)("flows",(0,n.toRef)(x,"flows"));const k=async a=>{y=a;let n,o=5;u.isLegalSupplierContractDetail||u.isLegalCustomerContractDetail?o=2:u.isLiveCustomerContractDetail||u.isLiveSupplierContractDetail?o=3:u.isCoopSupplierContractDetail||u.isCoopCustomerContractDetail?o=4:u.isCommonBusinessCustomerContractDetail||u.isCommonBusinessSupplierContractDetail||u.isisCommonBusinessCustomerContractDetailTemplate?o=5:u.isLegalStatisticsSupplierContractDetail||u.isLegalStatisticsCustomerContractDetail?o=6:u.isSupplierDetail&&(o=7),n=u.isCustomerDetail?1:2;const r=await(0,i.Ue)(a,o);r.success&&r.data?e.value=S(r.data,n):t.root.$message.warning(r.message??"合同详情获取失败，稍后重试")},S=(t,e)=>{if(!t.template_info)return t;const a=t.template_info;t?.contract_detail?.contract_scan_urls&&(t.contract_detail.contract_scan_urls=t?.contract_detail?.contract_scan_urls.map((t=>(t.file_name=decodeURIComponent(t.file_name),t)))),t?.contract_detail?.attachment_url_list&&(t.contract_detail.attachment_url_list=t?.contract_detail?.attachment_url_list.map((t=>(t.file_name=decodeURIComponent(t.file_name),t))));const n={key:"创建人",value:t.contract_info.add_by_name},o={key:"客户名称",value:t?.contract_info?.company_name};2===e&&(o.key="供应商名称"),t.template_info.extend_contract_info=[o,n];const i=["others","margin","pay_condition"];if(i.forEach((t=>{const e={};a[t]&&a[t].forEach((t=>{e[t.key]=t.value})),a[`${t}Map`]=e})),a.hasMargin=1===a.marginMap["是否有保证金"],a.pay_condition){const t=[];let e;if(a.pay_condition=t,e={key:"ROI要求",value:""},"不保量"===a.pay_conditionMap["ROI要求"]?e.value="不保量":"保量"===a.pay_conditionMap["ROI要求"]&&(e.value=`${a.pay_conditionMap["ROI要求保量-服务费"]} : ${a.pay_conditionMap["ROI要求保量-保量销售额"]}`),e.value=e.value.replace(/undefined/g,"--"),t.push(e),t.push({key:"执行要求",value:a.pay_conditionMap["执行要求"]}),t.push({key:"付款要求",value:a.pay_conditionMap["付款要求"]}),t.push({key:"票款要求",value:a.pay_conditionMap["票款要求"]}),e={key:"开票要求",value:a.pay_conditionMap["开票要求"]},"专票"===a.pay_conditionMap["开票要求"]?e.value=`专票${a.pay_conditionMap["开票税率"]}%`:"普票"===a.pay_conditionMap["开票要求"]&&(e.value=`普票${a.pay_conditionMap["开票税率"]}%`),t.push(e),e={key:"收费类型",value:a.pay_conditionMap["收费类型"]},"固定服务费"===a.pay_conditionMap["收费类型"])e.value=`服务费${a.pay_conditionMap["固定服务费"]}`;else if("固定服务费+佣金"===a.pay_conditionMap["收费类型"])if(a.pay_conditionMap["佣金"])e.value=`服务费${a.pay_conditionMap["固定服务费"]}+${a.pay_conditionMap["佣金"]}%`;else if(a.pay_conditionMap["构美佣金"]&&0!==Number(a.pay_conditionMap["构美佣金"])){const t=+a.pay_conditionMap["主播佣金"];e.value=t>0?`服务费${a.pay_conditionMap["固定服务费"]}+${a.pay_conditionMap["主播佣金"]}%(主播佣金)+${a.pay_conditionMap["构美佣金"]}%(构美佣金)`:`服务费${a.pay_conditionMap["固定服务费"]}+${a.pay_conditionMap["构美佣金"]}%(构美佣金)`}else{const t=+a.pay_conditionMap["主播佣金"];e.value=t>0?`服务费${a.pay_conditionMap["固定服务费"]}+${a.pay_conditionMap["主播佣金"]}%(主播佣金)`:`服务费${a.pay_conditionMap["固定服务费"]}`}else if("纯佣金"===a.pay_conditionMap["收费类型"])if(a.pay_conditionMap["佣金"])e.value=`${a.pay_conditionMap["佣金"]}%`;else if(a.pay_conditionMap["构美佣金"]&&0!==Number(a.pay_conditionMap["构美佣金"])){const t=+a.pay_conditionMap["主播佣金"];e.value=t>0?`${a.pay_conditionMap["主播佣金"]}%(主播佣金)+${a.pay_conditionMap["构美佣金"]}%(构美佣金)`:`${a.pay_conditionMap["构美佣金"]}%(构美佣金)`}else{const t=+a.pay_conditionMap["主播佣金"];e.value=t>0?`${a.pay_conditionMap["主播佣金"]}%(主播佣金)`:"--"}else e.value=`其它-${a.pay_conditionMap["其它"]}`;-1!==e.value.indexOf("undefined")&&(e.value="--"),t.push(e),e={key:"付款方式",value:a.pay_conditionMap["付款方式"]},"其它"===e.value&&(e.value=`其它-${a.pay_conditionMap["付款方式-其它"]}`),"V任务下单"===e.value&&(e.value=`V任务下单-${a.pay_conditionMap["V任务下单"]}`),t.push(e)}return t},M=async()=>{k(y)},D=(0,n.computed)((()=>{const t=c.yR.get(e.value?.contract_info.contract_status??2)??"";let a="status-approval";switch(e.value?.contract_info.contract_status){case c.Kb.Failure:a="status-error";break;case c.Kb.Normal:a="status-success";break;case c.Kb.Invalid:a="status-fail";break;default:break}return{text:t,style:a}})),$=async t=>{try{if(!(0,f.K)({excel:!0,pdf:!0,doc:!0,fileSize:50})(t.file))return;const e=new FormData;e.append("file",t.file),e.append("type","contract/scan");const{data:a}=await(0,s.cT)(e);if(!a.success)throw new Error(a.message||"上传失败");return a}catch(e){throw m.Message.error(e.message),e}},Z=async t=>{const a={contract_id:e.value?.contract_info.id,contract_scan_urls:[t],save_for_update:1};try{const{data:t}=await(0,i.ab)(a);if(!t.success)throw new Error(t.message);await M()}catch(n){m.Message.error(n.message)}},P=async a=>{const n=await(0,l.I)(t,"扫描件删除后无法恢复，是否继续操作？");if(!n)return;if(void 0===e.value)return;const{data:o}=await(0,i.dJ)({contract_id:e.value.contract_info.id,contract_scan_urls:[a]});o.success?await M():t.root.$message.error(o.message??"删除失败")},R=async()=>{if(!e.value)return;const a=e.value?.contract_info.id,n=await(0,l.I)(t,{title:"此操作将作废合同, 是否继续",confirmText:"作废合同"});if(!n)return;const{data:o}=await(0,_.it)({contract_id:a,invalid_code:5});o.success?(t.root.$message.success(o.message),await M()):t.root.$message.error(o.message)},T=(0,n.computed)((()=>e.value?.contract_info.contract_status===c.Kb.Normal&&(g.value?.id===e.value?.contract_info.manager_id||g.value?.id===e.value?.contract_info.add_by))),F=(0,n.computed)((()=>{const t=[c.Kb.Invalid,c.Kb.Failure].includes(e.value?.contract_info.contract_status??-1)&&(g.value?.id===e.value?.contract_info.manager_id||g.value?.id===e.value?.contract_detail.add_by);if(t)return u.isLiveCustomerContractDetail||u.isCommonBusinessCustomerContractDetail,!0})),B=async()=>{if(!e.value)return;const n=await(0,l.I)(t,{title:"此操作将删除合同， 确认删除？",confirmText:"删除合同"});if(!n)return;const{data:o}=await(0,_.qJ)({contract_id:[e.value.contract_info.id]});o.success?(m.Message.success("删除成功"),setTimeout((()=>{a.back()}),500)):t.root.$message.error(o.message??"合同删除失败")};return(0,n.reactive)({onDelete:B,hasDelete:F,hasVoidRight:T,toVoid:R,queryContractDetail:k,remove:P,uploadScans:Z,uploadScanFiles:$,detail:e,contract_status:D,reload:M,flow:x,isFlowFromOA:h})},y=()=>{const t=(0,o.t)();let e=[{title:"法务管理",name:u.l6.contact},{title:"合同管理",name:u.l6.contact},{title:"合同详情"}];const a=(0,r.f)();return a.isLiveCustomerContractDetail||a.isLiveSupplierContractDetail?e=[{title:"品牌中心",name:u.FB.project.list},{title:"项目管理",name:u.FB.project.list},{title:"项目详情",name:u.FB.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab,liveType:"calendar"}},{title:"合同详情"}]:a.isCommonBusinessCustomerContractDetail||a.isCommonBusinessSupplierContractDetail?e=[{title:"S2B2C",name:u.u3.project.list},{title:"项目管理",name:u.u3.project.list},{title:"项目详情",name:u.u3.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]:a.isCoopCustomerContractDetail||a.isCoopSupplierContractDetail?e=[{title:"整合营销",name:u.Z8.project.list},{title:"项目管理",name:u.Z8.project.list},{title:"项目详情",name:u.Z8.project.detail,params:{id:t.currentRoute.query.parent_id,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]:a.isLegalCustomerContractDetail||a.isLegalSupplierContractDetail?e=[{title:"法务管理",name:u.l6.contact},{title:"合同管理",name:u.l6.contact},{title:"合同详情"}]:a.isLegalStatisticsCustomerContractDetail||a.isLegalStatisticsSupplierContractDetail?e=[{title:"法务管理",name:u.l6.contact},{title:"合同统计",name:u.l6.constatistics},{title:"合同详情"}]:a.isSupplierDetail&&(e=[{title:"主播管理",name:u.bv.player},{title:"主播详情",name:u.bv.player_detail,params:{id:t.currentRoute.query.anchorId,tab:t.currentRoute.query.parent_tab}},{title:"合同详情"}]),(0,n.reactive)({routes:e})};var h=a(37315),b=a(47143),w=a(3283),C=a(43773),x=a(72253),k=a(21757);const S=(0,k.gI)(),M={functional:!0,render:(t,e)=>t("div",{class:`contract-grid column-${e.props.column} ${e.data.class}`},[e.children])},D={functional:!0,render:(t,e)=>{let a=e.children;a&&0!==a.length||(a="--");const n={minWidth:"ROI要求"===e.props.label?"72px":"产品服务/服务名称"===e.props.label?"100px":e.props.label.length>9?"160px":18*e.props.label.length+"px"};return t("div",{class:`contract-grid-item contract-grid-columnSpan-${e.props.columnSpan}`},[t("div",{class:"label",style:n},[e.props.label,"："]),t("div",{class:"item"},[a])])}};var $,Z,P=(0,n.defineComponent)({components:{supplierAgreementDialog:h.Z,clientAgreementDialog:b.Z,OaFlows:w.Z,toExamineDialog:x.Z},setup(t,e){const a=(0,n.ref)(!1),r=(0,o.t)(),s=g(e),l=y(),u=(0,v.Pc)();(0,n.provide)("project",{}),(0,n.provide)("project_add_id",{});const p=(0,n.ref)(null),d=(0,n.ref)(null);s.queryContractDetail({id:parseInt(r.currentRoute.params.id,10)});const m=t=>{1===t.contract_info.contract_type||2===t.contract_info.contract_type||5===t.contract_info.contract_type?d.value?.show(t):p.value?.show(t)},f=(0,n.computed)((()=>[c.Kb.Failure].includes(s.detail?.contract_info.contract_status??-1)&&(u.value.id===s.detail?.contract_info.manager_id||u.value.id===s.detail?.contract_detail.add_by))),_=S.law_verify_contract_scan,h=(0,n.computed)((()=>(s.detail?.allow_update_contract_scan_user_ids?.includes(u.value.id)||s.detail?.contract_info.add_by===u.value.id)&&s.detail?.contract_info.contract_status===c.Kb.Normal)),b=async t=>{t.status=3,a.value=!0;const n=await(0,i.f6)(t);a.value=!1,n.data.success?(e.root.$message.success(n.data.message??"驳回成功"),s.queryContractDetail({id:parseInt(r.currentRoute.params.id,10)})):e.root.$message.error(n.data.message??"请求失败，请重试")},w=(0,C.R)({component:x.Z,title:"扫描件审核",okText:"驳回",width:"400px",on:{submit:t=>{b(t)}}}),k=()=>{w.show(s.detail?.contract_info?.id)};return{approvalLoading:a,onApprovalHandler:k,canUpload:h,addsupplierTemplateContractRef:p,addclientTemplateContractRef:d,opendialogClick:m,contract:s,breadRouter:l,oprateBtnVisiable:f,hasPermission:_}},render(){const t=arguments[0],{contract:e,breadRouter:a}=this,{detail:n,flow:o}=e,i=n?.template_info;return t("div",{class:"contract-detail"},[t("tg-breadcrumbs",{attrs:{routes:a.routes}}),t("div",{class:"contract-detail-container"},[t("div",{class:"contract-title-box"},[t("div",{class:"contract-title"},["合同编号：",n?.contract_info?.contract_uid]),e.isFlowFromOA?t("el-popover",{attrs:{placement:"right-start",trigger:"hover","popper-class":"approve-progress-popper"},on:{show:e.flow.onFlowsShow}},[t("span",{slot:"reference",class:`status  ${e.contract_status.style}`,style:"cursor:default"},[e.contract_status.text]),o.flowsLoading&&t("div",{style:"padding: 10px 20px"},["正在查询进度..."]),!o.flowsLoading&&o.flows.length>0?t("oa-flows",{attrs:{status:o.status}}):t("div",[o.flowsError])]):t("span",{class:`status  ${e.contract_status.style}`},[e.contract_status.text]),this.oprateBtnVisiable&&5!==n?.contract_info.contract_status&&t("span",{class:"edit",on:{click:()=>{this.opendialogClick(n)}}},[t("tg-icon",{attrs:{name:"ico-edit"}})]),t("div",{class:"fill"}),t("div",{class:"operator"},[e.hasVoidRight&&t("tg-button",{attrs:{size:"small",className:"disabled",type:"negative",icon:"ico-invalid-lite"},on:{click:e.toVoid}},[t("span",["作废"])]),e.hasDelete&&t("tg-button",{attrs:{type:"negative",icon:"ico-btn-delete"},on:{click:e.onDelete}},["删除"])])]),t(M,{attrs:{column:2}},[i?.extend_contract_info?.map((e=>t(D,{attrs:{label:e.key}},[e.value])))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"我方信息"}}),t(M,{attrs:{column:4}},[i?.our_info?.map((e=>t(D,{attrs:{label:e.key}},[e.value])))]),i?.cooperation_content&&t("div",[t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合作内容"}}),t(M,{attrs:{column:4}},[i?.cooperation_content?.map((e=>"其它权益"===e.key?t(D,{attrs:{label:"其它权益",columnSpan:2}},[e.value]):t(D,{attrs:{label:e.key}},[e.value])))])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同期限"}}),5===n?.contract_info.contract_type?t(M,{attrs:{column:4}},[i?.cooperation_duration?.map((e=>"关联主合同"===e.key?e.value?t(D,{attrs:{label:e.key}},[e.value]):void 0:"最后一期款项付款时间"===e.key?t(D,{attrs:{label:"最后一期款项收款时间"}},[e.value]):t(D,{attrs:{label:e.key}},[e.value])))]):t(M,{attrs:{column:4}},[i?.cooperation_duration?.map((e=>"关联主合同"===e.key?e.value?t(D,{attrs:{label:e.key}},[e.value]):void 0:t(D,{attrs:{label:e.key}},[e.value])))]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"收付款条件"}}),console.log(i?.pay_condition,"pay_condition"),5===n?.contract_info.contract_type?t(M,{attrs:{column:4}},[i?.pay_condition?.map((e=>"付款要求"===e.key?t(D,{attrs:{label:"收款要求"}},[e.value]):"付款方式"===e.key?e.value?t(D,{attrs:{label:"收款方式",columnSpan:2}},[e.value]):void 0:t(D,{attrs:{label:e.key}},[e.value])))]):t(M,{attrs:{column:4}},[i?.pay_condition?.map((e=>"付款方式"===e.key?e.value?t(D,{attrs:{label:"付款方式",columnSpan:2}},[e.value]):void 0:t(D,{attrs:{label:e.key}},[e.value])))]),!0===i?.hasMargin&&t("div",[t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"保证金"}}),t(M,{attrs:{column:4}},[i?.margin?.map((e=>"是否有保证金"===e.key&&e.value?t(D,{attrs:{label:e.key}},["是"]):t(D,{attrs:{label:e.key}},[e.value])))])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"其它信息"}}),t(M,{attrs:{column:4}},[t(D,{attrs:{label:"盖章份数"}},[i?.othersMap["盖章份数"]]),t(D,{attrs:{label:"印章名称"}},[i?.othersMap["印章名称"]]),t(D,{attrs:{label:"用印时间"}},[i?.othersMap["用印时间"]]),0===i?.othersMap["是否邮寄"]&&t(D,{attrs:{label:"是否邮寄"}},["否"]),i?.othersMap["邮寄信息"]&&t(D,{attrs:{label:"邮寄信息",columnSpan:4}},[i?.othersMap["邮寄信息"]]),t(D,{attrs:{label:"备注",columnSpan:5}},[i?.frontend_data?.other_remark])]),t("div",{class:"line"}),t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同附件"}}),t("div",{class:"grid-annex "},[0===n?.contract_detail?.attachment_url_list.length&&t("div",["未上传合同附件"]),t("tg-file-card-group",{attrs:{filelist:n?.contract_detail?.attachment_url_list?.map((t=>({filename:t.file_name,url:t.url})))}})]),t("div",{class:"line"}),t("div",{style:"display: flex;"},[t("head-lines",{style:"padding-bottom:18px",attrs:{title:"合同扫描件"}}),this.canUpload&&this.hasPermission&&1===n?.contract_info.contract_scan_status&&(n?.contract_detail?.contract_scan_urls.length??0)>0&&t("tg-button",{attrs:{type:"link"},on:{click:this.onApprovalHandler}},["审核"])]),t("div",{class:"grid-annex"},[t("tg-file-card-group",{attrs:{filelist:n?.contract_detail?.contract_scan_urls?.map((t=>({filename:t.file_name,url:t.url}))),editable:!0},on:{remove:e.remove}},[(2===n?.contract_info.contract_scan_status||3===n?.contract_info.contract_scan_status)&&t("div",{style:{position:"absolute",bottom:"-10px",left:"0","font-size":"12px",width:"178px","text-align":"center",color:3===n?.contract_info.contract_scan_status?"red":"#02ba3c"}},[2===n?.contract_info.contract_scan_status?"审批通过":"已驳回"]),!this.canUpload&&0===n?.contract_detail?.contract_scan_urls.length&&t("div",["未上传合同扫描件"]),this.canUpload&&(0===n?.contract_info.contract_scan_status||3===n?.contract_info.contract_scan_status)&&t("div",{class:"annex"},[t("tg-upload",{attrs:{action:"/api/resources/upload_file","http-request":e.uploadScanFiles,"show-file-list":!1,success:t=>{t.success&&e.uploadScans(t.data.source)}}},[t("div",{class:"annex-upload"},[t("tg-icon",{attrs:{name:"ico-add-thin"}}),t("span",{class:"text"},["支持：docx、excel、pdf 单个文件不超过50M"])])])])])])]),t(h.Z,{attrs:{type:"edit"},ref:"addsupplierTemplateContractRef",on:{added:e.reload}}),t(b.Z,{attrs:{type:"edit"},ref:"addclientTemplateContractRef",on:{added:e.reload}}),t("tg-mask-loading",{attrs:{visible:this.approvalLoading,content:"正在保存，请稍候..."}})])}}),R=P,T=a(1001),F=(0,T.Z)(R,$,Z,!1,null,"7dc8ffe6",null),B=F.exports},86863:function(t,e,a){a.d(e,{B9:function(){return x},C7:function(){return y},E2:function(){return p},Fn:function(){return u},Jv:function(){return w},LK:function(){return m},Ou:function(){return g},TG:function(){return r},Uw:function(){return o},XZ:function(){return d},_6:function(){return b},aw:function(){return Z},cQ:function(){return C},dh:function(){return $},em:function(){return i},g9:function(){return S},iI:function(){return l},it:function(){return h},jy:function(){return _},kT:function(){return k},pc:function(){return c},qJ:function(){return f},qq:function(){return v},ve:function(){return M},vf:function(){return D},w_:function(){return s}});var n=a(76012);a(42963);function o(t){return(0,n.ZP)({url:"/api/cust/del_customer",method:"get",params:t})}function i(t){return(0,n.ZP)({url:"/api/auth/query_user_names",method:"get",params:t})}function r(){return(0,n.ZP)({url:"/api/auth/query_user_names",method:"get"})}function c(t){return(0,n.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:t})}function s(t){return(0,n.ZP)({url:"/api/cont/upload_attachment",method:"post",data:t})}function l(){return(0,n.ZP)({url:"/api/auth/get_department",method:"get"})}function u(){return(0,n.ZP)({url:"/api/cont/get_approver",method:"get"})}function p(t,e=1){const a=1===e?"/api/cont/query_contract":2===e?"/api/cont/query_law_contract":4===e?"/api/cont/query_cooperation_contract":5===e?"/api/cont/query_common_contract":"/api/cont/query_shop_live_contract";return(0,n.ZP)({url:a,method:"get",params:t})}function d(){return(0,n.ZP)({url:"/api/cont/get_contract_uid",method:"get"})}function m(t={}){return(0,n.ZP)({url:"/api/shop_live/get_shop_live_contract_uid",method:"get",params:t})}function f(t){return(0,n.ZP)({url:"/api/cont/del_contract",method:"post",data:t})}function _(t){return(0,n.ZP)({url:"/api/cont/approve_contract",method:"post",data:t})}function v(t){return(0,n.ZP)({url:"/api/cont/del_contract",method:"post",data:t})}function g(t){return(0,n.ZP)({url:`/api/cont/delete_contract_annex/${t}/`,method:"post"})}function y(t){return(0,n.ZP)({url:`/api/cont/delete_contract_statements/${t}/`,method:"post"})}function h(t){return(0,n.ZP)({url:"/api/cont/invalid_contract",method:"post",data:t})}function b(t){return(0,n.ZP)({url:"/api/cont/recycle_contract",method:"post",data:t})}function w(t){return(0,n.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:t})}function C(t){return(0,n.ZP)({url:"/api/cont/get_partner_by_name",method:"get",params:t})}function x(t){return(0,n.ZP)({url:"/api/cont/save_contract_annex",method:"post",data:t})}function k(t){return(0,n.ZP)({url:"/api/cont/del_contract_annex",method:"post",data:t})}function S(t){return(0,n.ZP)({url:"/api/cont/query_contract_annex",method:"get",params:t})}function M(t){return(0,n.ZP)({url:"/api/cont/query_contract_statements",method:"get",params:t})}function D(t){return(0,n.ZP)({url:`/api/cont/get_contract_approval_flow/${t}/`,method:"get"})}function $(t){return(0,n.ZP)({url:`/api/cont/get_contract_annex_approval_flow/${t}/`,method:"get"})}function Z(t){return(0,n.ZP)({url:`/api/cont/get_contract_statements_approval_flow/${t}/`,method:"get"})}},84731:function(t,e,a){a.d(e,{f:function(){return i}});var n=a(44928),o=a(1763);const i=(t=!1)=>{const e=(0,n.t)(),a=e.currentRoute.name,i=o.u3.project.detail===a||t,r=o.u3.contract.supplier.detail===a||o.u3.contract.supplier.detailTemplate===a||o.u3.contract.anchor.detailTemplate===a,c=o.u3.contract.customer.detail===a||o.u3.contract.customer.detailTemplate===a,s=o.FB.contract.supplier.detail===a||o.FB.contract.supplier.detailTemplate===a||o.FB.contract.anchor.detailTemplate===a,l=o.FB.contract.customer.detail===a||o.FB.contract.customer.detailTemplate===a,u=o.u3.contract.customer.detailTemplate===a,p=o.Z8.contract.supplier.detail===a||o.Z8.contract.supplier.detailTemplate===a||o.Z8.contract.anchor.detailTemplate===a,d=o.Z8.contract.customer.detail===a||o.Z8.contract.customer.detailTemplate===a,m=o.l6.contracts.supplier.detail===a||o.l6.contracts.supplier.detailTemplate===a||o.l6.contracts.anchor.detailTemplate===a,f=o.l6.contracts.customer.detail===a||o.l6.contracts.customer.detailTemplate===a,_=o.l6.statistics.supplier.detail===a||o.l6.statistics.supplier.detailTemplate===a||o.l6.statistics.anchor.detailTemplate===a,v=o.l6.statistics.customer.detail===a||o.l6.statistics.customer.detailTemplate===a,g=o.Z8.project.detail===a,y=o.FB.project.detail===a,h=o.u3.contract.customer.detailTemplate===a||o.l6.contracts.customer.detailTemplate===a||o.Z8.contract.customer.detailTemplate===a||o.FB.contract.customer.detailTemplate===a,b=o.bv.player_contract===a;return{isCustomerDetail:h,isCommonBusinessDetail:i,isCommonBusinessSupplierContractDetail:r,isCommonBusinessCustomerContractDetail:c,isLiveSupplierContractDetail:s,isLiveCustomerContractDetail:l,isLegalCustomerContractDetail:f,isLegalSupplierContractDetail:m,isLegalStatisticsSupplierContractDetail:_,isLegalStatisticsCustomerContractDetail:v,isCoopSupplierContractDetail:p,isCoopCustomerContractDetail:d,isCoopDetail:g,isLiveDetail:y,isisCommonBusinessCustomerContractDetailTemplate:u,isSupplierDetail:b}}},11676:function(t,e,a){a.d(e,{K:function(){return p}});a(26699);var n=a(48606);const o=[".pdf",".doc",".docx",".ppt",".pptx"],i=[".mp4"],r=[".png",".jpg",".jpeg"],c=[".xls",".xlsx",".csv"],s=[".doc",".docx"],l=[".pdf"],u=[".csv"],p=t=>e=>{const a=/(\.[^.]+)$/.exec(e.name);let p="";a&&(p=a[1]);const d=[];if(t.image&&d.push(...r),t.file&&d.push(...o),t.video&&d.push(...i),t.excel&&d.push(...c),t.pdf&&d.push(...l),t.doc&&d.push(...s),t.csv&&d.push(...u),t.extensions&&d.push(...t.extensions),d.length>0&&!d.includes(p))return n.Message.warning(`文件格式不正确，请使用 ${d.join(";")}`),!1;if(void 0!==t.fileSize){const a=e.size/1024/1024<t.fileSize;if(!a)return n.Message.warning(`文件不能超过${t.fileSize}MB!`),!1}return!0};e["Z"]={ValidationFileUpload:p}},29625:function(t,e,a){var n,o;a.d(e,{Bs:function(){return m},C_:function(){return c},RB:function(){return f},UN:function(){return u},WD:function(){return n},Wj:function(){return s},Y$:function(){return o},Yh:function(){return r},Zb:function(){return i},i8:function(){return d},kA:function(){return _},x3:function(){return l}}),function(t){t[t["marketing"]=1]="marketing",t[t["taobao"]=2]="taobao",t[t["douyin"]=3]="douyin",t[t["base"]=4]="base",t[t["mcn"]=5]="mcn",t[t["douyinsh"]=7]="douyinsh"}(n||(n={})),function(t){t[t["common"]=1]="common",t[t["system"]=2]="system"}(o||(o={}));const i=new Map([[n.marketing,"营销业务"],[n.douyin,"抖音店播"],[n.taobao,"淘宝店播"],[n.base,"基地业务"],[n.mcn,"S2B2C"],[n.douyinsh,"抖音店播(上海)"]]),r=[{value:n.marketing,label:"整合营销"},{value:n.douyin,label:"抖音店播"},{value:n.taobao,label:"淘宝店播"},{value:n.mcn,label:"S2B2C"},{value:n.douyinsh,label:"抖音店播(上海)"}];var c;(function(t){t[t["creation"]=1]="creation",t[t["tryLive"]=2]="tryLive",t[t["execution"]=3]="execution",t[t["regionExecution"]=4]="regionExecution",t[t["finish"]=5]="finish",t[t["executionEnd"]=6]="executionEnd"})(c||(c={}));const s=new Map([[c.creation,"项目创建"],[c.tryLive,"试播中"],[c.execution,"项目执行中"],[c.regionExecution,"区域执行中"],[c.executionEnd,"执行结束"],[c.finish,"已完结"]]);var l;(function(t){t[t["region"]=2]="region",t[t["selfSupport"]=1]="selfSupport"})(l||(l={}));const u=new Map([[l.region,"区域"],[l.selfSupport,"自营"]]);var p;(function(t){t[t["month"]=1]="month",t[t["quarter"]=2]="quarter",t[t["halfAyear"]=3]="halfAyear"})(p||(p={}));const d=new Map([[p.month,"月结"],[p.quarter,"季结"],[p.halfAyear,"半年"]]),m=new Map([[1,"美妆"],[2,"生活"],[3,"服饰"],[4,"美食"],[5,"母婴"],[6,"数码"],[7,"家装"],[8,"健康"],[9,"宠物"],[10,"时尚"],[11,"配饰"],[12,"家电"],[13,"测评"],[14,"旅行"],[15,"运动"],[16,"摄影"],[17,"情感"],[18,"汽车"],[19,"搞笑"],[20,"教育"],[21,"财经"],[22,"萌娃"],[23,"文化"],[24,"影视"],[25,"娱乐"],[26,"游戏"],[27,"海外"],[28,"才艺"],[29,"三农"],[30,"二次元"],[31,"高颜值"]]);function f(t){return 0===t?"无":m.get(t)??"无"}var _;(function(t){t[t["live"]=1]="live",t[t["marketing"]=2]="marketing",t[t["common_business"]=3]="common_business"})(_||(_={}))},17890:function(t,e,a){var n,o;a.d(e,{Kb:function(){return n},OX:function(){return s},l7:function(){return c},yR:function(){return i}}),function(t){t[t["Pending"]=1]="Pending",t[t["Normal"]=2]="Normal",t[t["Failure"]=3]="Failure",t[t["Processing"]=4]="Processing",t[t["Invalid"]=5]="Invalid"}(n||(n={})),function(t){t[t["Yes"]=0]="Yes",t[t["No"]=1]="No",t[t["Reject"]=2]="Reject"}(o||(o={}));const i=new Map([[n.Pending,"待审批"],[n.Normal,"审批成功"],[n.Failure,"审批失败"],[n.Processing,"审批中"],[n.Invalid,"已作废"]]),r=new Map([[o.Yes,"未上传"],[o.No,"已上传"],[o.Reject,"已驳回"]]),c=[n.Normal,n.Failure,n.Processing,n.Invalid].map((t=>({value:t,label:i.get(t)??""}))),s=[o.Yes,o.No,o.Reject].map((t=>({value:t,label:r.get(t)??""})))},82741:function(t,e,a){a.d(e,{I:function(){return o},u:function(){return i}});var n=a(71340);const o=(t,e)=>{const a="string"===typeof e?{title:e}:e;return new Promise((e=>{t.root.$TDialog({...a,onConfirm:()=>e(!0),onCancel:()=>e(!1)})}))},i=t=>{const e="string"===typeof t?{title:t}:t;return new Promise(((t,a)=>{(0,n.t)({...e,onConfirm:()=>t(!0),onCancel:()=>a()})}))}},44928:function(t,e,a){a.d(e,{t:function(){return o}});var n=a(86834);const o=()=>{const t=new Proxy({},{get(t,e){return Reflect.get(n.Z,e)}});return t}},43847:function(t,e,a){a.d(e,{Pc:function(){return r},oR:function(){return i}});var n=a(77944),o=a(97434);const i=()=>n.Z,r=()=>{const t=i(),e=(0,o.computed)((()=>t.getters["user/getUserInfo"]));return e}},72253:function(t,e,a){var n=a(36568),o=a.n(n),i=a(97434);e["Z"]=(0,i.defineComponent)({name:"",setup(t,e){const a=(0,i.ref)(),n=(0,i.ref)(),o=t=>{n.value=t},r=()=>{const t={contract_id:n.value,message:a.value};e.emit("close"),e.emit("submit",t)};return{reason:a,show:o,dialogSubmit:r}},render(){const t=arguments[0];return t("div",[t("el-form",o()([{class:" pd-18"},{props:{model:this.reason}},{ref:"elFormRef",attrs:{size:"small","label-width":"0"}}]),[t("el-form-item",{attrs:{label:"",prop:"reason"}},[t("el-input",{attrs:{type:"textarea",rows:5,maxlength:50,placeholder:"请填写意见，限50字"},style:"height: 100px;",model:{value:this.reason,callback:t=>{this.reason=t}}})])])])}})},43773:function(t,e,a){a.d(e,{R:function(){return d},y:function(){return m}});var n=a(36568),o=a.n(n),i=a(97434),r=a(64923),c=a(77944);let s=1;const l=()=>{const t=document.createElement("div");return t.id="dialog_"+s++,document.body.appendChild(t),t},u=new Function,p=(t,e)=>{let a=t;return void 0===a&&(a={}),Object.keys(e).forEach((t=>{const n=a[t]||u,o=e[t];a[t]=(...t)=>{if(!1!==o(...t))return n(...t)}})),a},d=(t={})=>{const e=(0,i.ref)(),a=(0,i.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,i.ref)(!0),s=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};s(t);const u=(0,i.ref)(p(t.on,{close(){a.visible=!1},updateDialog(t={}){s(t)}})),d=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new r["default"]({el:l(),store:c.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,i.provide)(e,t.provide[e])}))},render(e){if(n.value&&a.visible)return e("el-dialog",o()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${t.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value}),a.footer&&e("fragments",{slot:"footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,i.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},f=t=>(s(t),g),_=()=>{a.visible=!1},v=(t,e,a=!1)=>(!0===a?u.value[t]=e:p(u.value,{[t]:e}),g);(0,i.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const g=(0,i.reactive)({show:m,update:f,on:v,close:_,config:t,data:t.data});return g},m=(t={})=>{const e=(0,i.ref)(),a=(0,i.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,i.ref)(!0),s=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};s(t);const u=(0,i.ref)(p(t.on,{close(){a.visible=!1},updateDialog(t={}){s(t)}})),d=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new r["default"]({el:l(),store:c.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,i.provide)(e,t.provide[e])}))},render(e){if(!n.value)return;if(!a.visible)return;const{width:i,...r}=a;return e("el-drawer",o()([{class:`tg-drawer-rewrite ${t.class}`},{props:{...r,size:i}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[e("div",{class:"tg-drawer-content"},[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value})]),a.footer&&e("div",{class:"tg-drawer-footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,i.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},f=t=>(s(t),g),_=()=>{a.visible=!1},v=(t,e,a=!1)=>(!0===a?u.value[t]=e:p(u.value,{[t]:e}),g);(0,i.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const g=(0,i.reactive)({show:m,update:f,on:v,close:_,config:t});return g}}}]);