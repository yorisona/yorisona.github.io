"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[7336],{86863:function(e,t,n){n.d(t,{B9:function(){return I},C7:function(){return g},E2:function(){return _},Fn:function(){return l},Jv:function(){return y},LK:function(){return p},Ou:function(){return h},TG:function(){return i},Uw:function(){return r},XZ:function(){return m},_6:function(){return T},aw:function(){return U},cQ:function(){return R},dh:function(){return O},em:function(){return s},g9:function(){return b},iI:function(){return u},it:function(){return E},jy:function(){return f},kT:function(){return S},pc:function(){return o},qJ:function(){return d},qq:function(){return v},ve:function(){return N},vf:function(){return A},w_:function(){return c}});var a=n(76012);n(42963);function r(e){return(0,a.ZP)({url:"/api/cust/del_customer",method:"get",params:e})}function s(e){return(0,a.ZP)({url:"/api/auth/query_user_names",method:"get",params:e})}function i(){return(0,a.ZP)({url:"/api/auth/query_user_names",method:"get"})}function o(e){return(0,a.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:e})}function c(e){return(0,a.ZP)({url:"/api/cont/upload_attachment",method:"post",data:e})}function u(){return(0,a.ZP)({url:"/api/auth/get_department",method:"get"})}function l(){return(0,a.ZP)({url:"/api/cont/get_approver",method:"get"})}function _(e,t=1){const n=1===t?"/api/cont/query_contract":2===t?"/api/cont/query_law_contract":4===t?"/api/cont/query_cooperation_contract":5===t?"/api/cont/query_common_contract":"/api/cont/query_shop_live_contract";return(0,a.ZP)({url:n,method:"get",params:e})}function m(){return(0,a.ZP)({url:"/api/cont/get_contract_uid",method:"get"})}function p(e={}){return(0,a.ZP)({url:"/api/shop_live/get_shop_live_contract_uid",method:"get",params:e})}function d(e){return(0,a.ZP)({url:"/api/cont/del_contract",method:"post",data:e})}function f(e){return(0,a.ZP)({url:"/api/cont/approve_contract",method:"post",data:e})}function v(e){return(0,a.ZP)({url:"/api/cont/del_contract",method:"post",data:e})}function h(e){return(0,a.ZP)({url:`/api/cont/delete_contract_annex/${e}/`,method:"post"})}function g(e){return(0,a.ZP)({url:`/api/cont/delete_contract_statements/${e}/`,method:"post"})}function E(e){return(0,a.ZP)({url:"/api/cont/invalid_contract",method:"post",data:e})}function T(e){return(0,a.ZP)({url:"/api/cont/recycle_contract",method:"post",data:e})}function y(e){return(0,a.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:e})}function R(e){return(0,a.ZP)({url:"/api/cont/get_partner_by_name",method:"get",params:e})}function I(e){return(0,a.ZP)({url:"/api/cont/save_contract_annex",method:"post",data:e})}function S(e){return(0,a.ZP)({url:"/api/cont/del_contract_annex",method:"post",data:e})}function b(e){return(0,a.ZP)({url:"/api/cont/query_contract_annex",method:"get",params:e})}function N(e){return(0,a.ZP)({url:"/api/cont/query_contract_statements",method:"get",params:e})}function A(e){return(0,a.ZP)({url:`/api/cont/get_contract_approval_flow/${e}/`,method:"get"})}function O(e){return(0,a.ZP)({url:`/api/cont/get_contract_annex_approval_flow/${e}/`,method:"get"})}function U(e){return(0,a.ZP)({url:`/api/cont/get_contract_statements_approval_flow/${e}/`,method:"get"})}},15681:function(e,t,n){var a;n.d(t,{F2:function(){return a},Kg:function(){return _},OF:function(){return c},Sr:function(){return i},Tp:function(){return m},__:function(){return l},fB:function(){return o},rD:function(){return r},ts:function(){return s}}),function(e){e[e["RATION"]=1]="RATION",e[e["QUALITATIVE"]=2]="QUALITATIVE",e[e["BONUS"]=3]="BONUS",e[e["DEDUCT"]=4]="DEDUCT"}(a||(a={}));const r=new Map([[a.RATION,"定量指标"],[a.QUALITATIVE,"定性指标"],[a.BONUS,"加分项"],[a.DEDUCT,"扣分项"]]),s=[{label:"定量指标",value:a.RATION},{label:"定性指标",value:a.QUALITATIVE},{label:"加分项",value:a.BONUS},{label:"扣分项",value:a.DEDUCT}];var i;(function(e){e[e["MONTHLY"]=1]="MONTHLY",e[e["QUARTERLY"]=2]="QUARTERLY",e[e["SEMIANNUA"]=3]="SEMIANNUA",e[e["ANNUAL"]=4]="ANNUAL"})(i||(i={}));const o=new Map([[i.MONTHLY,"月度"],[i.QUARTERLY,"季度"],[i.SEMIANNUA,"半年度"],[i.ANNUAL,"年度"]]),c=[{label:"月度",value:i.MONTHLY},{label:"季度",value:i.QUARTERLY},{label:"半年度",value:i.SEMIANNUA},{label:"年度",value:i.ANNUAL}];var u,l;(function(e){e[e["BY_EVALUATION_PERSON"]=1]="BY_EVALUATION_PERSON",e[e["DIRECT_MANAGER"]=2]="DIRECT_MANAGER"})(u||(u={})),function(e){e[e["TARGET_SETTING"]=1]="TARGET_SETTING",e[e["TARGET_CONFIRM"]=2]="TARGET_CONFIRM",e[e["IN_PROGRESS"]=3]="IN_PROGRESS",e[e["SELF"]=4]="SELF",e[e["SUPERIOR"]=5]="SUPERIOR",e[e["SIGNATURE"]=6]="SIGNATURE",e[e["FINISH"]=7]="FINISH"}(l||(l={}));const _=new Map([[l.TARGET_SETTING,"目标制定"],[l.TARGET_CONFIRM,"目标确认"],[l.IN_PROGRESS,"执行中"],[l.SELF,"自评"],[l.SUPERIOR,"上级评分"],[l.SIGNATURE,"签字确认"],[l.FINISH,"考核完成"]]),m=[{label:"目标制定",value:l.TARGET_SETTING},{label:"目标确认",value:l.TARGET_CONFIRM},{label:"执行中",value:l.IN_PROGRESS},{label:"自评",value:l.SELF},{label:"上级评分",value:l.SUPERIOR},{label:"签字确认",value:l.SIGNATURE},{label:"考核完成",value:l.FINISH}]},23624:function(e,t,n){n.d(t,{$K:function(){return A},$R:function(){return S},$b:function(){return z},Cl:function(){return w},Dr:function(){return i},EB:function(){return E},Ev:function(){return f},JP:function(){return N},L5:function(){return q},Mz:function(){return $},O5:function(){return I},UX:function(){return d},Y4:function(){return o},ZM:function(){return g},Z_:function(){return G},ao:function(){return X},bV:function(){return C},bl:function(){return c},dP:function(){return F},g:function(){return y},gb:function(){return P},iC:function(){return R},iL:function(){return p},kT:function(){return h},lI:function(){return v},mS:function(){return u},n5:function(){return T},nQ:function(){return s},oY:function(){return L},o_:function(){return Z},q0:function(){return x},s9:function(){return O},vL:function(){return _},vv:function(){return l},wF:function(){return b},wH:function(){return U},y3:function(){return k},yI:function(){return D},zr:function(){return m}});var a=n(76012),r=n(64236);const s=async(e,t)=>(0,a.dX)("/api/performance_management/query_indicators_library",{params:{...e,...(0,r.jG)(t)}}),i=async e=>(0,a.SO)("/api/performance_management/save_or_modify_indicator",(0,r.jG)(e)),o=async e=>(0,a.HG)("/api/performance_management/delete_indicators",{data:{id_list:e}}),c=async e=>(0,a.dX)("/api/performance_management/query_indicator_tag",{params:{...(0,r.jG)(e)}}),u=async e=>(0,a.SO)("/api/performance_management/modify_move_indicator_tag",{indicator_tag_list:e}),l=async e=>(0,a.SO)("/api/performance_management/save_or_modify_indicator_tag",e),_=async e=>(0,a.HG)(`/api/performance_management/delete_indicators_tag/${e}`),m=async()=>(0,a.dX)("/api/feishu/feishu_department_and_user_list"),p=async e=>(0,a.SO)("/api/performance_management/save_or_modify_evaluation_group",e),d=async(e,t)=>(0,a.dX)("/api/performance_management/query_evaluation_group",{params:(0,r.jG)({...e,...t})}),f=async(e,t)=>(0,a.dX)("/api/performance_management/query_evaluation_group_name",{params:(0,r.jG)({...e,...t})}),v=async e=>(0,a.HG)(`/api/performance_management/delete_evaluation_group/${e}`),h=async(e,t)=>(0,a.dX)("/api/performance_management/query_assessment",{params:(0,r.jG)({...e,...t})}),g=async e=>(0,a.SO)("/api/performance_management/save_assessment",e),E=async e=>(0,a.SO)("/api/performance_management/save_assessment_level_config",e),T=async()=>(0,a.dX)("/api/performance_management/query_assessment_level_config"),y=async(e,t)=>(0,a.dX)("/api/performance_management/query_assessment_detail",{params:(0,r.jG)({...e,...t})}),R=async e=>(0,a.dX)("/api/performance_management/get_assessment_detail_by_my_performance",{params:(0,r.jG)(e)}),I=async(e,t)=>(0,a.dX)("/api/performance_management/query_assessment_detail_by_analysis",{params:(0,r.jG)({...e,...t})}),S=async(e,t)=>(0,a.dX)("/api/performance_management/query_assessment_detail_by_performance_record",{params:(0,r.jG)({...e,...t})}),b=async e=>(0,a.SO)("/api/performance_management/modify_start_score",e),N=async e=>(0,a.SO)("/api/performance_management/modify_assessment_result",e),A=async(e,t)=>(0,a.dX)("/api/performance_management/query_my_performance",{params:(0,r.jG)({...e,...t})}),O=async e=>(0,a.dX)("/api/performance_management/query_assessment_by_id",{params:{assessment_management_id:e}}),U=async e=>{const{assessment_dimension_list:t}=e;return t&&t.length>0&&t.forEach((e=>{e.indicator_list&&e.indicator_list?.forEach((e=>{["self_assessment_score","weight","superior_assessment_score"].forEach((t=>{(0,r.xb)(e[t])&&(e[t]=null)}))}))})),console.log("payload",e),(0,a.SO)("/api/performance_management/modify_performance_process",(0,r.jG)(e))},P=async(e,t)=>(0,a.dX)("/api/performance_management/query_user_performance_record",{params:(0,r.jG)({...t,...e})}),G=async(e,t)=>(0,a.dX)("/api/performance_management/query_user_performance_detail_record",{params:(0,r.jG)({...e,...t})}),D=async(e,t)=>(0,a.dX)("/api/performance_management/query_performance_analysis",{params:(0,r.jG)({...e,...t})}),L=async()=>(0,a.dX)("/api/performance_management/query_finish_assessment"),w=async(e,t)=>(0,a.dX)("/api/performance_management/query_with_me_performance",{params:(0,r.jG)({...e,...t})}),$=async(e,t)=>(0,a.dX)("/api/performance_management/query_subordinate_performance",{params:(0,r.jG)({...e,...t})}),x=async e=>(0,a.SO)("/api/performance_management/check_evaluation_group_user_ids",e),F=async e=>(0,a.SO)("/api/performance_management/modify_reset_process",(0,r.jG)(e)),Z=async e=>(0,a.dX)("/api/performance_management/query_assessment_and_user",{params:e}),q=async e=>(0,a.dX)("/api/performance_management/query_assessment_and_user_by_analysis",{params:e}),k=async e=>(0,a.dX)("/api/performance_management/query_assessment_and_user_by_performance_record",{params:e}),C=async(e,t)=>(0,a.dX)("/api/performance_management/query_assessment_name",{params:(0,r.jG)({...e,...t})}),X=async e=>(0,a.dX)("/api/auth/getuser_leader_by_subordinate_id",{params:{user_id:e}}),z=async e=>(0,a.dX)("/api/performance_management/query_assessment_and_user_by_my_performance",{params:(0,r.jG)(e)})},82741:function(e,t,n){n.d(t,{I:function(){return r},u:function(){return s}});var a=n(71340);const r=(e,t)=>{const n="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...n,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},s=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,n)=>{(0,a.t)({...t,onConfirm:()=>e(!0),onCancel:()=>n()})}))}},44928:function(e,t,n){n.d(t,{t:function(){return r}});var a=n(86834);const r=()=>{const e=new Proxy({},{get(e,t){return Reflect.get(a.Z,t)}});return e}},43847:function(e,t,n){n.d(t,{Pc:function(){return i},oR:function(){return s}});var a=n(77944),r=n(97434);const s=()=>a.Z,i=()=>{const e=s(),t=(0,r.computed)((()=>e.getters["user/getUserInfo"]));return t}},88721:function(e,t,n){var a=n(41572);n(97434);const r={IntergerAndDecimals(e){const t=/(\d+)$|\d+\.?\d{0,2}/.exec(e);return t?t[0]:""},Interger(e){return e.replace(/[^\d]/g,"")},NumberRange(e,t){return n=>{const a=this.IntergerAndDecimals(n);if(""===a)return a;const r=Number(a);return r<e?e+"":r>t?t+"":a}},Thousands(e){if(null===e||void 0===e||""===e)return e;e+="";const t=/^(\d+)(\.\d+$)?$/.exec(e+"");if(!t)return e;const n=t[1],a=t[2];let r=n.replace(/(\d{1,3})(?=(\d{3})+$)/g,(e=>`${e},`));return void 0!==a&&(r=`${r}${a}`),r},NineIntergerAndDecimals(e){const t=(/(?:0|[1-9]\d{0,8})(?:\.\d{0,2})?/u.exec(e.replace(/[^.\d]+/gu,"").replace(a.Pj,""))??[""])[0];return t}};t["Z"]=r},99205:function(e,t,n){n.d(t,{Aw:function(){return E},Io:function(){return g},Sr:function(){return m},Ti:function(){return d},XH:function(){return f},b$:function(){return T},cb:function(){return _},h4:function(){return v},lL:function(){return p}});var a=n(97434),r=n(64236),s=n(15681),i=n(88721),o=n(43847),c=n(86863),u=n(82741);const l="NPerformance.IEvaluationGroup",_=()=>({assessment_dimension_list:[],is_superior_rating:!0,is_self_evaluation:!0,is_target_confirmed:!0,is_modify_indicator:!1,is_transfer:!1,superior_rating:[{is_transfer:!1,scorer:{is_manager:!0,manager:1}}],by_evaluation_person:[]}),m=()=>{const e=localStorage.getItem(l);return null!==e?JSON.parse(e):_()},p=e=>{localStorage.setItem(l,JSON.stringify(e))},d=()=>{localStorage.removeItem(l)},f=e=>{const t=[];return e.assessment_dimension_list.forEach((e=>{let n=!0;e.indicator_list.forEach((a=>{a.assessment_dimension={name:e.name,is_modify_delete:e.is_modify_delete,id:e.id},n?(a.span=[e.indicator_list.length,1],n=!1):a.span=[0,0],t.push(a)}))})),t},v=e=>{e.assessment_dimension_list.forEach((e=>{if(e.is_modify_delete&&0===e.indicator_list.length){const t={};t.indicator_type=e.dimension_type_list[0],t.name="",t.check_standard="",t.indicator_type===s.F2.RATION?(t.is_result=!0,t.is_target=!0,t.weight=""):t.indicator_type===s.F2.QUALITATIVE&&(t.weight=""),t.remark="",t.is_assign_scorer=!1,e.indicator_list.push(t)}}))},g=e=>{if((0,r.xb)(e))return e;const t=e.split("\n"),n=[];for(let a=0;a<t.length;a++)a>0&&n.push(h("br")),n.push(t[a]);return n};var E;(function(e){e[e["NONE"]=0]="NONE",e[e["EDIT_SELF_TARGET"]=1]="EDIT_SELF_TARGET",e[e["EDIT_SELF_RESULT"]=2]="EDIT_SELF_RESULT",e[e["EDIT_SUPPER_SCORE"]=3]="EDIT_SUPPER_SCORE",e[e["EDIT_SUPERIOR_TARGET"]=4]="EDIT_SUPERIOR_TARGET"})(E||(E={}));const T=()=>{const e=(0,a.ref)(E.NONE),t=(0,a.ref)({assessment_dimension_list:[]}),n=(0,a.ref)([]),l=(0,a.computed)((()=>e.value===E.NONE?"":" disabled")),_=(0,o.Pc)(),m=async e=>""===e.trim()?[]:(0,c.em)({username:e}).then((e=>e.data.success?e.data.data.user_data.map((e=>({value:e.id,label:e.username,...e}))):[])),p=(0,a.computed)((()=>{e.value,t.value;const o=n.value.some((e=>e.is_assign_scorer)),c=n.value.some((e=>e.is_result));let p=!0;const d=t.value?.superior_rating||[],f=d[0]?.sum_score;null!==f&&void 0!==f&&(p=!1);const v=n.value.some((e=>e.indicator_type===s.F2.BONUS)),T=n.value.some((e=>e.indicator_type===s.F2.DEDUCT)),y={},R=["remark","self_assessment_score","self_assessment_remark","superior_assessment_score","superior_assessment_remark","assign_scorer_id","assign_assessment_score","assign_assessment_remark","result_ass","level_ass"];return n.value?.forEach((e=>{R.forEach((t=>{(0,r.xb)(e[t])||(y[t]=!0)}))})),[{label:"维度",align:"center",minWidth:80,formatter:e=>h("span",{class:`cell_per ${l.value}`},[e.assessment_dimension?.name])},{minWidth:80,label:"指标名称",formatter:t=>{const n="name",s=`${n}_edit`;if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&!0===t.assessment_dimension.is_modify_delete){const e=void 0===t[s]?t[n]:t[s];return h("fragments",[h("div",{style:"height:40px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"请输入指标名称",size:"small",maxlength:15,value:e,resize:"none"},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,s,e)}},style:"width:100%;height:100%"})])])}return void 0!==t[s]&&(t[s]=void 0),h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t[n])?"":t[n]])}},!(e.value===E.NONE&&!y["remark"])&&{align:"left",label:"指标定义",prop:"remark",minWidth:120,formatter:t=>{const n="remark",s=`${n}_edit`;if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&t.assessment_dimension.is_modify_delete){const e=void 0===t[s]?t[n]:t[s];return h("fragments",[h("div",{style:"height:100px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,s,e)}},attrs:{type:"textarea",placeholder:"请输入指标定义",value:e,resize:"none",maxlength:350,"show-word-limit":!0}})])])}return void 0!==t[s]&&(t[s]=void 0),h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t[n])?"":g(t[n])])}},{label:"考核标准",minWidth:200,align:"left",formatter:t=>{const n="check_standard",s=`${n}_edit`;if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&t.assessment_dimension.is_modify_delete){const e=void 0===t[s]?t[n]:t[s];return h("fragments",[h("div",{class:"cell_per",style:"height:60px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"请输入考核标准",value:e,resize:"none",maxlength:350,"show-word-limit":!0},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,s,e)}}})])])}return void 0!==t[s]&&(t[s]=void 0),h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t[n])?"":g(t[n])])}},c&&{align:"right",label:"目标值",minWidth:70,formatter:t=>{const n="target",r=`${n}_edit`;if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&t.is_target){const e=void 0===t[r]?t[n]:t[r];return h("fragments",[h("div",{class:"cell_per",style:"height:100px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",size:"small",value:e,resize:"none","show-word-limit":!0,maxlength:100,placeholder:"请输入目标值"},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,e)}}})])])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_target?t[n]:"--"])}},c&&t.value.present_stage>=s.__.SELF&&{align:"right",label:"结果值",minWidth:70,formatter:t=>{const n="result",r=`${n}_edit`;if(e.value===E.EDIT_SELF_RESULT&&t.is_result){const e=void 0===t[r]?t[n]:t[r];return h("fragments",[h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{placeholder:"请输入结果值",type:"textarea",size:"small",value:e,resize:"none"},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,e)}},style:"width:100%;height:100%"})])])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_result?t[n]:"--"])}},c&&t.value.present_stage>=s.__.SELF&&{align:"left",label:"结果值说明",minWidth:90,formatter:t=>{const n="result_remark",r=`${n}_edit`;if(e.value===E.EDIT_SELF_RESULT&&t.is_result){const e=void 0===t[r]?t[n]:t[r];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",size:"small",resize:"none",maxlength:100,"show-word-limit":!0,value:e,placeholder:"请输入结果值说明"},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,e)}}})])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_result?t[n]:"--"])}},{align:"center",label:"权重",minWidth:60,formatter:t=>{const n="weight",o=`${n}_edit`;if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&(t.indicator_type===s.F2.QUALITATIVE||t.indicator_type===s.F2.RATION)&&t.assessment_dimension.is_modify_delete){const e=void 0===t[o]?t[n]:t[o];return h("div",{class:"weight edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{maxlength:3,resize:"none",size:"small",placeholder:"请输入权重",value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,o,i.Z.Interger(e))}},style:"width:100%;height:100%"},[h("span",{slot:"append"},["%"])])])}void 0!==t[o]&&(t[o]=void 0);let c="";switch(t.indicator_type){case s.F2.DEDUCT:case s.F2.BONUS:c="--";break;case s.F2.QUALITATIVE:case s.F2.RATION:if((0,r.xb)(t.weight))return"";c=`${t.weight}%`;break}return h("span",{class:`cell_per ${l.value}`},[c])}},v&&{align:"center",label:"加分上限",minWidth:80,formatter:e=>{if(e.indicator_type!==s.F2.BONUS)return h("span",{class:`cell_per ${l.value}`},["--"]);const t="increase_limit";return h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(e[t])?"--":e[t]])}},T&&{align:"center",label:"扣分上限",minWidth:80,formatter:e=>{const t="decrease_limit";return e.indicator_type!==s.F2.DEDUCT?h("span",{class:`cell_per ${l.value}`},["--"]):h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(e[t])?"--":e[t]])}},!(e.value===E.NONE&&!y["self_assessment_score"])&&t.value.present_stage>=s.__.SELF&&{"render-header":()=>h("span",["自评 ",h("br"),"(",t.value?.weight,"%)"]),align:"right",prop:"self_assessment_score",minWidth:60,formatter:t=>{const n="self_assessment_score",s=`${n}_edit`;if(e.value===E.EDIT_SELF_RESULT){const e=void 0===t[s]?t[n]:t[s];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"按百分制进行打分",size:"small",maxlength:3,resize:"none",value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,s,i.Z.Interger(e))}}})])}return void 0!==t[s]&&(t[s]=void 0),h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t[n])?"":t[n]])}},!(e.value===E.NONE&&!y["self_assessment_remark"])&&t.value.present_stage>=s.__.SELF&&{label:"自评说明",align:"left",minWidth:100,formatter:t=>{const n="self_assessment_remark",s=`${n}_edit`;if(e.value===E.EDIT_SELF_RESULT){const e=void 0===t[s]?t[n]:t[s];return h("fragments",[h("div",{style:"height:100px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{placeholder:"请输入自评说明",type:"textarea",resize:"none",maxlength:100,"show-word-limit":!0,size:"small",value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,s,e)}}})])])}return void 0!==t[s]&&(t[s]=void 0),h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t[n])?"":t[n]])}},!(e.value===E.NONE&&!y["superior_assessment_score"])&&t.value.present_stage>=s.__.SUPERIOR&&{"render-header":()=>h("span",["上级评分 ",h("br"),"(",t.value?.superior_rating[0]?.weight,"%)"]),align:"right",prop:"superior_assessment_score",minWidth:80,formatter:t=>{const n="superior_assessment_score",r=`${n}_edit`;if(e.value===E.EDIT_SUPPER_SCORE&&!t.is_assign_scorer&&p){const e=void 0===t[r]?t[n]:t[r];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"按百分制进行打分",size:"small",maxlength:3,resize:"none",value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,i.Z.Interger(e))}},style:"width:100%;height:100%"})])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_assign_scorer?"--":t[n]])}},""===location.href&&(e.value!==E.NONE||y["superior_assessment_remark"])&&t.value.present_stage>=s.__.SUPERIOR&&{label:"上级评分说明",align:"left",minWidth:200,formatter:t=>{const n="superior_assessment_remark",r=`${n}_edit`;if(e.value===E.EDIT_SUPPER_SCORE&&!t.is_assign_scorer&&p){const e=void 0===t[r]?t[n]:t[r];return h("fragments",[h("div",{class:"cell_per",style:"height:100px"}),h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"请输入上级评分说明",size:"small",resize:"none",maxlength:100,"show-word-limit":!0,value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,e)}},style:"width:100%;height:100%"})])])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_assign_scorer?"--":t[n]])}},(e.value!==E.NONE||y["assign_scorer_id"])&&o&&{label:"指定评分人",align:"center",minWidth:100,formatter:t=>{const n="assign_scorer_id",r=`${n}_edit`,s="assign_scorer_username",i="assign_scorer_options";if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&t.is_assign_scorer){const e=void 0===t[r]?t[n]:t[r];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-select",{on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{const n=t[i].find((t=>t.value===e));(0,a.set)(t,r,e),n&&(0,a.set)(t,s,n.label)}},attrs:{size:"small",value:e,filterable:!0,remote:!0,"remote-method":e=>{m(e).then((e=>{(0,a.set)(t,i,e)}))},placeholder:"请选择评分人"},style:"width:100%;height:100%"},[t[i]?.map((e=>h("el-option",{attrs:{label:e.label,value:e.value}})))])])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_assign_scorer?t[s]:"--"])}},(e.value!==E.NONE||y["assign_assessment_score"])&&o&&t.value.present_stage>=s.__.SUPERIOR&&{label:"指定评分人评分",align:"center",prop:"assign_assessment_score",minWidth:190,formatter:t=>{const n="assign_assessment_score",r=`${n}_edit`;if(e.value===E.EDIT_SUPPER_SCORE&&t.is_assign_scorer&&_.value.id===t.assign_scorer_id){const e=void 0===t[r]?t[n]:t[r];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{attrs:{type:"textarea",placeholder:"按百分制进行打分",size:"small",maxlength:3,resize:"none",value:e},on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,i.Z.Interger(e))}},style:"width:100%;height:100%"})])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_assign_scorer?t[n]:"--"])}},""===location.href&&(e.value!==E.NONE||y["assign_assessment_remark"])&&o&&t.value.present_stage>=s.__.SUPERIOR&&{label:"指定评分人说明",align:"left",minWidth:200,formatter:t=>{const n="assign_assessment_remark",r=`${n}_edit`;if(e.value===E.EDIT_SUPPER_SCORE&&t.is_assign_scorer&&_.value.id===t.assign_scorer_id){const e=void 0===t[r]?t[n]:t[r];return h("div",{class:"edit "+(t._active===n?"active":"")},[h("el-input",{on:{focus:()=>(0,a.set)(t,"_active",n),blur:()=>(0,a.set)(t,"_active",""),input:e=>{(0,a.set)(t,r,e)}},attrs:{size:"small",resize:"none",type:"textarea",placeholder:"请输入说明",maxlength:100,"show-word-limit":!0,value:e},style:"width:100%;height:100%"})])}return void 0!==t[r]&&(t[r]=void 0),h("span",{class:`cell_per ${l.value}`},[t.is_assign_scorer?t[n]:"--"])}},t.value.present_stage>=s.__.SIGNATURE&&{label:"考核结果",align:"center",minWidth:90,prop:"result_ass",formatter:()=>h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t.value.result)?"":t.value.result])},t.value.present_stage>=s.__.SIGNATURE&&{label:"绩效等级",align:"center",minWidth:90,prop:"level_ass",formatter:e=>h("span",{class:`cell_per ${l.value}`},[(0,r.xb)(t.value.level)?"":t.value.level])},(e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&{align:"center",label:"操作",width:100,prop:"remark",formatter:(a,r,s,i)=>{if((e.value===E.EDIT_SELF_TARGET||e.value===E.EDIT_SUPERIOR_TARGET)&&a.assessment_dimension.is_modify_delete){const[e,r]=a.span;return 1!==e?h("div",{class:"cell_per"},[h("tg-button",{on:{click:async()=>{if(await(0,u.u)("确定删除指标吗?"),e>0)n.value[i+1].span=[e-1,r];else for(let e=i;e>=0;e--){const[t,a]=n.value[e].span;if(0!==t){n.value[e].span=[t-1,a];break}}n.value.splice(i,1);const s=a.assessment_dimension.id,o=n.value.filter((e=>e.assessment_dimension.id===s)),c=t.value.assessment_dimension_list.find((e=>e.id===s));c.indicator_list=o}},attrs:{type:"link"}},["删除"])]):h("span",{class:`cell_per ${l.value}`})}return h("span",{class:`cell_per ${l.value}`})}}].filter(Boolean)})),d=(0,a.computed)((()=>{const e={props:{columns:p.value,data:n.value,"span-method":e=>{const{row:t,columnIndex:a,column:r,rowIndex:s}=e;return 0===a&&t.span?t.span:"level_ass"===r.property||"result_ass"===r.property?0===s?[n.value.length,1]:[0,0]:[1,1]},border:!0}};return t.value.present_stage>=s.__.SELF&&(e.props["summary-method"]=e=>{const{columns:t}=e;return t.map(((e,t)=>{if(0===t)return h("span",{class:"cell_per"},["总分"]);let a,r;switch(e.prop){case"self_assessment_score":case"assign_assessment_score":case"superior_assessment_score":r=n.value.reduce(((t,n)=>{let a=n[e.prop+"_edit"]||n[e.prop];return isNaN(a)?t:(a=Number(a),n.indicator_type===s.F2.RATION||n.indicator_type===s.F2.QUALITATIVE?a*=n.weight/100:n.indicator_type===s.F2.DEDUCT&&(a=-a),a+t)}),0),a=h("span",{class:"cell_per"},[r.toFixed(2)]);break;default:a=h("span",{class:"cell_per"},["--"]);break}return a}))}),e})),v=t=>{e.value=t?E.EDIT_SELF_RESULT:E.NONE},T=t=>{e.value=t?E.EDIT_SELF_TARGET:E.NONE,t&&n.value.forEach((e=>{e.assign_scorer_id&&!e.assign_scorer_options&&(0,a.set)(e,"assign_scorer_options",[{label:e.assign_scorer_username,value:e.assign_scorer_id}])}))},y=t=>{e.value=t?E.EDIT_SUPPER_SCORE:E.NONE},R=t=>{e.value=t?E.EDIT_SUPERIOR_TARGET:E.NONE,t&&n.value.forEach((e=>{e.assign_scorer_id&&!e.assign_scorer_options&&(0,a.set)(e,"assign_scorer_options",[{label:e.assign_scorer_username,value:e.assign_scorer_id}])}))},I=e=>{const a=f(e);t.value=e,n.value=a};return(0,a.reactive)({tableProps:d,tableData:n,data:t,updateDimension:I,toggleEditSelfResult:v,toggleEditSelfTarget:T,toggleEditSupperScore:y,toggleEditSupperTarget:R,status:e})}}}]);