"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[9001,4206],{24206:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var n,r,i=a(36568),s=a.n(i),o=a(97434),l=a(15681),c=a(23624),m=a(59563),u=a(48606),d=a(70437),p=a(88721),f=a(64236),_=(0,o.defineComponent)({props:{disabledSubmit:{type:Boolean}},setup(e,t){const a=(0,o.ref)({indicator_type:l.F2.RATION}),n=(0,o.ref)(),r=(0,o.ref)([]),i=(0,m.Q)(c.Dr,{manual:!0}),s=(0,m.Q)(c.bl,{manual:e.disabledSubmit,transform(e){return e.map((e=>({label:e.name,value:e.tag_id})))}}),d=(e,t=[])=>{r.value=t,e?a.value=e:t.length>0&&(a.value.indicator_type=t[0])},p=()=>{n.value?.validate((async n=>{if(!n)return;const r={...a.value};r.indicator_type===l.F2.RATION?(r.is_target=!0,r.is_result=!0):r.indicator_type!==l.F2.BONUS&&r.indicator_type!==l.F2.DEDUCT||(r.weight=void 0),(0,f.xb)(r.weight)&&(r.weight=null),(0,f.xb)(r.increase_limit)&&(r.increase_limit=null),(0,f.xb)(r.decrease_limit)&&(r.decrease_limit=null),e.disabledSubmit?t.emit("submit",r):i.runAsync(r).then((()=>{u.Message.success("新增成功 "),t.emit("submit"),t.emit("close")}))}))};return{formData:a,formRef:n,reqTag:s,reqSaveIndicator:i,onSaveBtnClick:p,show:d,dismension_type_list:r}},render(){const e=arguments[0],{formData:t}=this;return e("div",{class:"tg-page-container page-content-container"},[e("div",{class:"content"},[e("el-form",s()([{ref:"formRef",attrs:{size:"small"}},{attrs:{model:this.formData}}]),[!this.disabledSubmit&&e("el-form-item",{attrs:{label:"指标标签："}},[e(d.Z,{style:"width:100%",attrs:{options:this.reqTag.data,filterable:!0,clearable:!0},model:{value:t.tag_id,callback:e=>{this.$set(t,"tag_id",e)}}})]),e("el-form-item",{attrs:{label:"指标类型",prop:"indicator_type","label-position":"top"}},[e("el-radio-group",{style:"width:100%;height:24px; display: flex;align-items: center;",model:{value:this.formData.indicator_type,callback:e=>{this.$set(this.formData,"indicator_type",e)}}},[l.ts.map((t=>{let a=!1;return this.dismension_type_list.length>0&&(a=!this.dismension_type_list.some((e=>e===t.value))),e("el-radio",{attrs:{size:"small",disabled:a,name:"indiactor_type",label:t.value}},[t.label])}))])]),e("el-form-item",{attrs:{label:"指标名称",prop:"name","label-position":"top",rules:[{required:!0,message:"请输入指标名称"}]}},[e("el-input",{attrs:{maxlength:100,placeholder:"请输入指标名称"},model:{value:this.formData.name,callback:e=>{this.$set(this.formData,"name",e)}}})]),e("el-form-item",{attrs:{label:"指标定义","label-position":"top"}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入指标定义",maxlength:350,"show-word-limit":!0},model:{value:t.remark,callback:e=>{this.$set(t,"remark",e)}}})]),e("el-form-item",{attrs:{label:"考核标准",prop:"check_standard","label-position":"top",rules:[{required:!0,message:"请输入考核标准"}]}},[e("el-input",{attrs:{placeholder:"请输入考核标准",type:"textarea",maxlength:350,"show-word-limit":!0},model:{value:t.check_standard,callback:e=>{this.$set(t,"check_standard",e)}}})]),t.indicator_type===l.F2.RATION&&e("el-form-item",{attrs:{label:"目标值：",prop:"increase_limit"},class:"content-flex"},[e("el-switch",{attrs:{value:!0,disabled:!0}})]),t.indicator_type===l.F2.RATION&&e("el-form-item",{attrs:{label:"结果值：",prop:"increase_limit"},class:"content-flex"},[e("el-switch",{attrs:{value:!0,disabled:!0}})]),t.indicator_type===l.F2.BONUS&&e("el-form-item",{attrs:{label:"加分上限","label-position":"top",prop:"increase_limit"}},[e("el-input",{model:{value:t.increase_limit,callback:e=>{this.$set(t,"increase_limit",e)}}})]),t.indicator_type===l.F2.DEDUCT&&e("el-form-item",{attrs:{label:"扣分上限","label-position":"top",prop:"decrease_limit"}},[e("el-input",{model:{value:t.decrease_limit,callback:e=>{this.$set(t,"decrease_limit",e)}}})]),t.indicator_type!==l.F2.DEDUCT&&t.indicator_type!==l.F2.BONUS&&e("el-form-item",{attrs:{label:"权重",prop:"check_standard","label-position":"top"}},[e("el-input",{attrs:{maxlength:"3",placeholder:"请输入权重"},on:{input:e=>{t.weight=p.Z.Interger(e)}},model:{value:t.weight,callback:e=>{this.$set(t,"weight",e)}}},[e("span",{slot:"append"},["%"])])]),e("el-form-item",{attrs:{label:"评分方式："}},[e("div",{class:"sheng"},["直接输入分数 "])]),e("el-form-item",{attrs:{label:"指定评分人："}},[e("el-switch",{style:"position: relative; top: -2px;",model:{value:t.is_assign_scorer,callback:e=>{this.$set(t,"is_assign_scorer",e)}}}),e("div",{class:"sheng"},["开启后，该指标如被引用，则被考核人需在考核表设置指定评分人。 "])])])])])}}),g=_,v=a(1001),h=(0,v.Z)(g,n,r,!1,null,"21bc63a9",null),b=h.exports},15681:function(e,t,a){var n;a.d(t,{F2:function(){return n},Kg:function(){return u},OF:function(){return l},Sr:function(){return s},Tp:function(){return d},__:function(){return m},fB:function(){return o},rD:function(){return r},ts:function(){return i}}),function(e){e[e["RATION"]=1]="RATION",e[e["QUALITATIVE"]=2]="QUALITATIVE",e[e["BONUS"]=3]="BONUS",e[e["DEDUCT"]=4]="DEDUCT"}(n||(n={}));const r=new Map([[n.RATION,"定量指标"],[n.QUALITATIVE,"定性指标"],[n.BONUS,"加分项"],[n.DEDUCT,"扣分项"]]),i=[{label:"定量指标",value:n.RATION},{label:"定性指标",value:n.QUALITATIVE},{label:"加分项",value:n.BONUS},{label:"扣分项",value:n.DEDUCT}];var s;(function(e){e[e["MONTHLY"]=1]="MONTHLY",e[e["QUARTERLY"]=2]="QUARTERLY",e[e["SEMIANNUA"]=3]="SEMIANNUA",e[e["ANNUAL"]=4]="ANNUAL"})(s||(s={}));const o=new Map([[s.MONTHLY,"月度"],[s.QUARTERLY,"季度"],[s.SEMIANNUA,"半年度"],[s.ANNUAL,"年度"]]),l=[{label:"月度",value:s.MONTHLY},{label:"季度",value:s.QUARTERLY},{label:"半年度",value:s.SEMIANNUA},{label:"年度",value:s.ANNUAL}];var c,m;(function(e){e[e["BY_EVALUATION_PERSON"]=1]="BY_EVALUATION_PERSON",e[e["DIRECT_MANAGER"]=2]="DIRECT_MANAGER"})(c||(c={})),function(e){e[e["TARGET_SETTING"]=1]="TARGET_SETTING",e[e["TARGET_CONFIRM"]=2]="TARGET_CONFIRM",e[e["IN_PROGRESS"]=3]="IN_PROGRESS",e[e["SELF"]=4]="SELF",e[e["SUPERIOR"]=5]="SUPERIOR",e[e["SIGNATURE"]=6]="SIGNATURE",e[e["FINISH"]=7]="FINISH"}(m||(m={}));const u=new Map([[m.TARGET_SETTING,"目标制定"],[m.TARGET_CONFIRM,"目标确认"],[m.IN_PROGRESS,"执行中"],[m.SELF,"自评"],[m.SUPERIOR,"上级评分"],[m.SIGNATURE,"签字确认"],[m.FINISH,"考核完成"]]),d=[{label:"目标制定",value:m.TARGET_SETTING},{label:"目标确认",value:m.TARGET_CONFIRM},{label:"执行中",value:m.IN_PROGRESS},{label:"自评",value:m.SELF},{label:"上级评分",value:m.SUPERIOR},{label:"签字确认",value:m.SIGNATURE},{label:"考核完成",value:m.FINISH}]},59563:function(e,t,a){a.d(t,{Q:function(){return i},h:function(){return s}});a(21703);var n=a(97434),r=a(48606);const i=(e,{manual:t,onError:a,onSuccess:i,defaultParams:s,transform:o}={})=>{const l=(0,n.ref)(),c=(0,n.ref)(),m=(0,n.ref)(!1),u=(0,n.ref)([]),d=()=>{p(...u.value)},p=(...t)=>Promise.resolve(t||s).then((()=>{m.value=!0})).then((()=>0===t.length&&s&&s.length>0?s:t)).then((e=>(u.value=e,e))).then((t=>e(...t))).then((e=>{if(!e.data.success)throw new Error(e.data.message);return l.value=o?o(e.data.data):e.data.data,i&&i(l.value,e.data),e})).then((()=>{m.value=!1})).catch((e=>{throw m.value=!1,c.value=e.message,a&&a(e),r.Message.error(e.message),e})),f=p;return t||p(...s||[]),(0,n.reactive)({data:l,error:c,loading:m,reload:d,run:p,runAsync:f,params:u})},s=(e,t={})=>{const{defaultPageSize:a=20,defaultParams:r=[],transform:s,...o}=t,l=(0,n.ref)(),c=(0,n.reactive)({total:0,page_num:1,page_size:a,onCurrentChange:e=>{const t=[...d.params];t[0]?t[0].page_num=e:t[0]={num:a,page_num:e},d.runAsync(...t).then((()=>{c.page_num=e}))},refresh:()=>c.onCurrentChange(1),reQuery(...e){const t=[];return d.params[0]?(t[0]=d.params[0],t[0].page_num=1,c.page_num=1):(t[0]={num:a,page_num:1},c.page_num=1),t.push(...e),d.runAsync(...t)}}),[m={num:a,page_num:1},...u]=r,d=i(e,{defaultParams:[m,...u],...o,onSuccess(e,a){l.value=s?s(e):e.data,c.total=e.total,t.onSuccess&&t.onSuccess(l.value,a)}}),{data:p,...f}=(0,n.toRefs)(d);return(0,n.reactive)({...f,data:l,pagination:c})}},23624:function(e,t,a){a.d(t,{$K:function(){return E},$R:function(){return A},$b:function(){return Q},Cl:function(){return U},Dr:function(){return s},EB:function(){return b},Ev:function(){return _},JP:function(){return k},L5:function(){return F},Mz:function(){return $},O5:function(){return S},UX:function(){return f},Y4:function(){return o},ZM:function(){return h},Z_:function(){return O},ao:function(){return M},bV:function(){return B},bl:function(){return l},dP:function(){return L},g:function(){return T},gb:function(){return D},iC:function(){return w},iL:function(){return p},kT:function(){return v},lI:function(){return g},mS:function(){return c},n5:function(){return y},nQ:function(){return i},oY:function(){return q},o_:function(){return x},q0:function(){return G},s9:function(){return I},vL:function(){return u},vv:function(){return m},wF:function(){return R},wH:function(){return N},y3:function(){return j},yI:function(){return C},zr:function(){return d}});var n=a(76012),r=a(64236);const i=async(e,t)=>(0,n.dX)("/api/performance_management/query_indicators_library",{params:{...e,...(0,r.jG)(t)}}),s=async e=>(0,n.SO)("/api/performance_management/save_or_modify_indicator",(0,r.jG)(e)),o=async e=>(0,n.HG)("/api/performance_management/delete_indicators",{data:{id_list:e}}),l=async e=>(0,n.dX)("/api/performance_management/query_indicator_tag",{params:{...(0,r.jG)(e)}}),c=async e=>(0,n.SO)("/api/performance_management/modify_move_indicator_tag",{indicator_tag_list:e}),m=async e=>(0,n.SO)("/api/performance_management/save_or_modify_indicator_tag",e),u=async e=>(0,n.HG)(`/api/performance_management/delete_indicators_tag/${e}`),d=async()=>(0,n.dX)("/api/feishu/feishu_department_and_user_list"),p=async e=>(0,n.SO)("/api/performance_management/save_or_modify_evaluation_group",e),f=async(e,t)=>(0,n.dX)("/api/performance_management/query_evaluation_group",{params:(0,r.jG)({...e,...t})}),_=async(e,t)=>(0,n.dX)("/api/performance_management/query_evaluation_group_name",{params:(0,r.jG)({...e,...t})}),g=async e=>(0,n.HG)(`/api/performance_management/delete_evaluation_group/${e}`),v=async(e,t)=>(0,n.dX)("/api/performance_management/query_assessment",{params:(0,r.jG)({...e,...t})}),h=async e=>(0,n.SO)("/api/performance_management/save_assessment",e),b=async e=>(0,n.SO)("/api/performance_management/save_assessment_level_config",e),y=async()=>(0,n.dX)("/api/performance_management/query_assessment_level_config"),T=async(e,t)=>(0,n.dX)("/api/performance_management/query_assessment_detail",{params:(0,r.jG)({...e,...t})}),w=async e=>(0,n.dX)("/api/performance_management/get_assessment_detail_by_my_performance",{params:(0,r.jG)(e)}),S=async(e,t)=>(0,n.dX)("/api/performance_management/query_assessment_detail_by_analysis",{params:(0,r.jG)({...e,...t})}),A=async(e,t)=>(0,n.dX)("/api/performance_management/query_assessment_detail_by_performance_record",{params:(0,r.jG)({...e,...t})}),R=async e=>(0,n.SO)("/api/performance_management/modify_start_score",e),k=async e=>(0,n.SO)("/api/performance_management/modify_assessment_result",e),E=async(e,t)=>(0,n.dX)("/api/performance_management/query_my_performance",{params:(0,r.jG)({...e,...t})}),I=async e=>(0,n.dX)("/api/performance_management/query_assessment_by_id",{params:{assessment_management_id:e}}),N=async e=>{const{assessment_dimension_list:t}=e;return t&&t.length>0&&t.forEach((e=>{e.indicator_list&&e.indicator_list?.forEach((e=>{["self_assessment_score","weight","superior_assessment_score"].forEach((t=>{(0,r.xb)(e[t])&&(e[t]=null)}))}))})),console.log("payload",e),(0,n.SO)("/api/performance_management/modify_performance_process",(0,r.jG)(e))},D=async(e,t)=>(0,n.dX)("/api/performance_management/query_user_performance_record",{params:(0,r.jG)({...t,...e})}),O=async(e,t)=>(0,n.dX)("/api/performance_management/query_user_performance_detail_record",{params:(0,r.jG)({...e,...t})}),C=async(e,t)=>(0,n.dX)("/api/performance_management/query_performance_analysis",{params:(0,r.jG)({...e,...t})}),q=async()=>(0,n.dX)("/api/performance_management/query_finish_assessment"),U=async(e,t)=>(0,n.dX)("/api/performance_management/query_with_me_performance",{params:(0,r.jG)({...e,...t})}),$=async(e,t)=>(0,n.dX)("/api/performance_management/query_subordinate_performance",{params:(0,r.jG)({...e,...t})}),G=async e=>(0,n.SO)("/api/performance_management/check_evaluation_group_user_ids",e),L=async e=>(0,n.SO)("/api/performance_management/modify_reset_process",(0,r.jG)(e)),x=async e=>(0,n.dX)("/api/performance_management/query_assessment_and_user",{params:e}),F=async e=>(0,n.dX)("/api/performance_management/query_assessment_and_user_by_analysis",{params:e}),j=async e=>(0,n.dX)("/api/performance_management/query_assessment_and_user_by_performance_record",{params:e}),B=async(e,t)=>(0,n.dX)("/api/performance_management/query_assessment_name",{params:(0,r.jG)({...e,...t})}),M=async e=>(0,n.dX)("/api/auth/getuser_leader_by_subordinate_id",{params:{user_id:e}}),Q=async e=>(0,n.dX)("/api/performance_management/query_assessment_and_user_by_my_performance",{params:(0,r.jG)(e)})},82741:function(e,t,a){a.d(t,{I:function(){return r},u:function(){return i}});var n=a(71340);const r=(e,t)=>{const a="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...a,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},i=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,a)=>{(0,n.t)({...t,onConfirm:()=>e(!0),onCancel:()=>a()})}))}},88721:function(e,t,a){var n=a(41572);a(97434);const r={IntergerAndDecimals(e){const t=/(\d+)$|\d+\.?\d{0,2}/.exec(e);return t?t[0]:""},Interger(e){return e.replace(/[^\d]/g,"")},NumberRange(e,t){return a=>{const n=this.IntergerAndDecimals(a);if(""===n)return n;const r=Number(n);return r<e?e+"":r>t?t+"":n}},Thousands(e){if(null===e||void 0===e||""===e)return e;e+="";const t=/^(\d+)(\.\d+$)?$/.exec(e+"");if(!t)return e;const a=t[1],n=t[2];let r=a.replace(/(\d{1,3})(?=(\d{3})+$)/g,(e=>`${e},`));return void 0!==n&&(r=`${r}${n}`),r},NineIntergerAndDecimals(e){const t=(/(?:0|[1-9]\d{0,8})(?:\.\d{0,2})?/u.exec(e.replace(/[^.\d]+/gu,"").replace(n.Pj,""))??[""])[0];return t}};t["Z"]=r},70437:function(e,t,a){var n=a(36568),r=a.n(n);const i={functional:!0,render:(e,t)=>{const{props:a}=t,{showAll:n=!1,showAllText:i="全部",clearable:s=!0}=a,o={props:{...t.value,clearable:s},on:t.listeners,attrs:t.data.attrs};return e("el-select",r()([{},o]),[n&&e("el-option",{attrs:{label:i,value:void 0}}),a.options?.map(((t,a)=>e("el-option",{attrs:{disabled:t.disabled,label:t.label,value:t.value},key:a})))])}};t["Z"]=i},21495:function(e,t,a){a.d(t,{L:function(){return i}});var n=a(97434),r={template:"template-fe9519",searchBar:"searchBar-c522bd",formItemContainer:"formItemContainer-d53e08",formItem:"formItem-c6ff4c",bodyContainer:"bodyContainer-b06936",btnLine:"btnLine-d428fc",tableContainer:"tableContainer-dd87f4"},i=(0,n.defineComponent)({props:{columns:{type:Array,default:()=>[]},value:{type:Object},routes:{},service:{required:!0,type:Function},config:{type:Object,default:()=>{}}},setup(e,t){const a=(0,n.ref)(),{reset:r}=e.config||{},i=e.service,s=()=>{const t=i.params;return t[0]&&(t[0].page_num=1),i.runAsync(t[0],e.value)},o=()=>{r&&r(),(0,n.nextTick)(s)};return{formRef:a,onReset:o,reqData:i,search:s}},render(){const e=arguments[0];return e("div",{class:["tg-page-container",r.template]},[this.routes&&e("tg-breadcrumbs",{attrs:{routes:this.routes}}),this.$slots.default&&e("div",{class:["tg-card",r.searchBar]},[e("el-form",{attrs:{size:"small","show-message":!1,"hide-required-asterisk":!0,"label-width":"70px"},ref:"formRef"},[e("div",{class:r.formItemContainer},[this.$slots.default?.map((t=>e("div",{class:r.formItem},[t]))),this.$slots.searchBtn?this.$slots.searchBtn:e("div",[e("tg-button",{attrs:{type:"primary"},on:{click:this.search}},["查询"]),e("tg-button",{class:"mgl-12",on:{click:this.onReset}},["重置"])])])])]),this.$slots.middle,e("div",{class:r.bodyContainer},[this.$slots.btnLine&&e("div",{class:r.btnLine},[this.$slots.btnLine]),e("div",{class:r.tableContainer},[e("tg-table",{attrs:{stripe:!0,columns:this.columns,height:"100%",data:this.reqData.data,pagination:this.reqData.pagination},directives:[{name:"loading",value:this.reqData.loading}],on:{"selection-change":this.config?.table?.selectionChange}},[e("div",{class:"tg-page-empty",slot:"empty"},[e("empty-common")])])])])])}})},29001:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var n=a(97434),r=a(21495),i={btnLines:"btnLines-e75ea2",tags:"tags-cace93",btns:"btns-cffdb2",popover:"popover-a2f716"},s=a(23624),o=a(15681),l=a(70437),c=a(82741),m=a(59563),u=a(48606),d={DialogContainer:"DialogContainer-dc0e60"},p=(0,n.defineComponent)({setup(e,t){const a=(0,m.Q)(s.bl,{transform(e){return e.map((e=>({label:e.name,value:e.tag_id})))}}),r=(0,m.Q)(s.mS,{manual:!0}),i=(0,n.ref)(),o=(0,n.ref)([]),l=e=>{o.value=e,console.log("value",e)},c=()=>{if(void 0===i.value)return void u.Message.error("请选择标签");const e=o.value.map((e=>({indicator_id:e.id,old_tag_id:e.tag_id??0,tag_id:i.value})));r.runAsync(e).then((()=>{u.Message.success("移动成功"),t.emit("close"),t.emit("submit")}))};return{reqTag:a,tag_id:i,onSaveBtnClick:c,show:l}},render(){const e=arguments[0];return e("div",{class:d.DialogContainer},[e("el-form",{attrs:{size:"small","show-message":!1,"hide-required-asterisk":!0,labelPosition:"top"}},[e("el-form-item",{attrs:{label:"标签名称"}},[e(l.Z,{attrs:{options:this.reqTag.data},style:"width:100%",model:{value:this.tag_id,callback:e=>{this.tag_id=e}}})])])])}}),f={DialogContainer:"DialogContainer-d90c8f"},_=(0,n.defineComponent)({setup(e,t){const a=(0,n.ref)({name:void 0,id:void 0}),r=e=>{e&&(a.value={name:e.name,id:e.tag_id})},i=(0,m.Q)(s.vv,{manual:!0}),o=()=>{void 0!==a.value.name&&(/^\s*$/.test(a.value.name)||i.runAsync(a.value).then((()=>{u.Message.success("新增成功"),t.emit("close"),t.emit("submit")})))};return{formData:a,onSaveBtnClick:o,show:r,reqSaveTag:i}},render(){const e=arguments[0];return e("div",{class:f.DialogContainer},[e("el-form",{attrs:{size:"small","show-message":!1,"hide-required-asterisk":!0,labelPosition:"top"}},[e("el-form-item",{attrs:{label:"标签名称"}},[e("el-input",{attrs:{placeholder:"请输入标签名称"},style:"width:100%",model:{value:this.formData.name,callback:e=>{this.$set(this.formData,"name",e)}}})])])])}}),g=a(43773),v=a(24206),b=a(21757),y=a(64236),T=(0,n.defineComponent)({setup:()=>{const e=(0,b.gI)(),t=[{type:"selection",width:40},{align:"left",label:"指标名称",minWidth:150,prop:"name","show-overflow-tooltip":!0},{label:"指标类型",minWidth:80,prop:"indicator_type",formatter:e=>o.rD.get(e.indicator_type)},{label:"指标定义",minWidth:180,prop:"remark","show-overflow-tooltip":!0},{label:"考核标准",minWidth:200,prop:"check_standard","show-overflow-tooltip":!0},{label:"权重",align:"center",minWidth:60,formatter:e=>{switch(e.indicator_type){case o.F2.DEDUCT:case o.F2.BONUS:return"--";case o.F2.QUALITATIVE:case o.F2.RATION:return(0,y.xb)(e.weight)?"":`${e.weight}%`}}},{label:"扣分上限",align:"center",minWidth:80,prop:"decrease_limit",formatter:e=>e.indicator_type!==o.F2.DEDUCT?"--":e.decrease_limit},{label:"加分上限",align:"center",minWidth:80,prop:"increase_limit",formatter:e=>e.indicator_type!==o.F2.BONUS?"--":e.increase_limit},{label:"操作",minWidth:80,formatter:t=>h("div",[e.indicators_library_edit&&h("tg-button",{attrs:{type:"link"},on:{click:()=>{R.update({title:"编辑指标"}).show(t)}}},["修改"]),e.indicators_library_delete&&h("tg-button",{attrs:{type:"link"},class:"mgl-12",on:{click:()=>{(0,c.u)("确认删除该指标").then((()=>{u.runAsync([t.id]).then((()=>{d.reload(),f.reload()}))}))}}},["删除"])])}],a=(0,n.ref)(),r=()=>({name:void 0,indicator_type:void 0,tag_id:void 0}),i=(0,n.ref)(r()),l=(0,n.ref)({reset:()=>i.value=r(),table:{selectionChange:e=>{T.value=e}}}),u=(0,m.Q)(s.Y4,{manual:!0}),d=(0,m.h)(s.nQ),f=(0,m.Q)(s.bl),T=(0,n.ref)([]),w=(0,m.Q)(s.vL,{manual:!0}),S=(0,g.R)({component:p,title:"移动指标",width:"400px",on:{submit:()=>{d.reload(),f.reload()}}}),A=(0,g.R)({component:_,title:"创建标签",width:"300px",on:{submit:f.reload}}),R=(0,g.y)({component:v["default"],width:"523px",title:"新增指标",on:{submit:()=>{f.reload(),d.reload()}}});return{columns:t,formData:i,configTemplate:l,reqDelete:u,selected:T,tempListRef:a,reqList:d,reqQueryTag:f,dialogMoveTag:S,createTag:A,reqDelTag:w,drawerCreate:R,permission:e}},render(){const e=arguments[0],{formData:t,permission:a}=this;return e(r.L,{ref:"tempListRef",attrs:{columns:this.columns,service:this.reqList,config:this.configTemplate},model:{value:this.formData,callback:e=>{this.formData=e}}},[e("el-form-item",{attrs:{label:"指标名称："}},[e("el-input",{attrs:{placeholder:"指标名称"},model:{value:t.name,callback:e=>{this.$set(t,"name",e)}}})]),e("el-form-item",{attrs:{label:"指标类型："}},[e(l.Z,{attrs:{placeholder:"请选择",options:o.ts,clearable:!0},model:{value:t.indicator_type,callback:e=>{this.$set(t,"indicator_type",e)}}})]),e("div",{slot:"btnLine",class:i.btnLines},[e("div",{class:i.tags},[e("span",["指标标签："]),e("span",{class:`mgl-18 tag-item ${void 0!==t.tag_id?"":"active"} `,on:{click:()=>{this.formData.tag_id=void 0,this.reqList.pagination.reQuery(this.formData)}}},["全部"]),this.reqQueryTag.data?.map((n=>e("div",{class:`mgl-18 tag-item ${n.tag_id===t.tag_id?"active":""} `,on:{click:()=>{this.formData.tag_id=n.tag_id,this.reqList.pagination.reQuery(this.formData)}}},[e("span",{class:"tag-item-title"},[n.name,"(",n.count,")"]),0!==n.tag_id&&(a.indicators_library_tag_edit||a.indicators_library_tag_delete)&&e("el-popover",{attrs:{trigger:"hover","open-delay":100,"popper-class":i.popover}},[e("i",{slot:"reference",class:"el-icon-more"}),a.indicators_library_tag_edit&&e("div",{class:"item",on:{click:()=>{this.createTag.update({title:"编辑标签"}).show(n)}}},["编辑"]),a.indicators_library_tag_delete&&e("div",{class:"item",on:{click:async()=>{await(0,c.u)("确定删除该标签吗?"),await this.reqDelTag.runAsync(n.tag_id),u.Message.success("删除成功"),this.reqQueryTag.reload()}}},["删除"])])]))),a.indicators_library_tag_edit&&e("span",{class:"mgl-12 tag-item add",on:{click:()=>{this.createTag.update({title:"新增标签"}).show()}}},["+新增标签"])]),e("div",{class:i.btns},[a.indicators_library_edit&&e("tg-button",{attrs:{type:"primary"},on:{click:()=>{this.drawerCreate.update({title:"新增指标"}).show()}}},["新增指标"]),a.indicators_library_move&&e("tg-button",{attrs:{disabled:0===this.selected.length},on:{click:()=>this.dialogMoveTag.show(this.selected)}},["移动到"]),a.indicators_library_delete&&e("tg-button",{attrs:{disabled:0===this.selected.length},on:{click:()=>{(0,c.u)("确定删除指标吗?").then((()=>{this.reqDelete.runAsync(this.selected.map((e=>e.id))).then((()=>{u.Message.success("删除成功")})).then((()=>{this.reqList.reload(),this.reqQueryTag.reload()}))}))}}},["删除"])])])])}})},43773:function(e,t,a){a.d(t,{R:function(){return d},y:function(){return p}});var n=a(36568),r=a.n(n),i=a(97434),s=a(64923),o=a(77944);let l=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+l++,document.body.appendChild(e),e},m=new Function,u=(e,t)=>{let a=e;return void 0===a&&(a={}),Object.keys(t).forEach((e=>{const n=a[e]||m,r=t[e];a[e]=(...e)=>{if(!1!==r(...e))return n(...e)}})),a},d=(e={})=>{const t=(0,i.ref)(),a=(0,i.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,i.ref)(!0),l=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};l(e);const m=(0,i.ref)(u(e.on,{close(){a.visible=!1},updateDialog(e={}){l(e)}})),d=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new s["default"]({el:c(),store:o.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,i.provide)(t,e.provide[t])}))},render(t){if(n.value&&a.visible)return t("el-dialog",r()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:m.value},{attrs:{isDialog:!0}}]),[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:m.value}),a.footer&&t("fragments",{slot:"footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const p=(...e)=>{a.visible||(a.visible=!0,(0,i.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},f=e=>(l(e),v),_=()=>{a.visible=!1},g=(e,t,a=!1)=>(!0===a?m.value[e]=t:u(m.value,{[e]:t}),v);(0,i.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const v=(0,i.reactive)({show:p,update:f,on:g,close:_,config:e,data:e.data});return v},p=(e={})=>{const t=(0,i.ref)(),a=(0,i.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,i.ref)(!0),l=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};l(e);const m=(0,i.ref)(u(e.on,{close(){a.visible=!1},updateDialog(e={}){l(e)}})),d=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new s["default"]({el:c(),store:o.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,i.provide)(t,e.provide[t])}))},render(t){if(!n.value)return;if(!a.visible)return;const{width:i,...s}=a;return t("el-drawer",r()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...s,size:i}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:m.value},{attrs:{isDialog:!0}}]),[t("div",{class:"tg-drawer-content"},[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:m.value})]),a.footer&&t("div",{class:"tg-drawer-footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const p=(...e)=>{a.visible||(a.visible=!0,(0,i.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},f=e=>(l(e),v),_=()=>{a.visible=!1},g=(e,t,a=!1)=>(!0===a?m.value[e]=t:u(m.value,{[e]:t}),v);(0,i.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const v=(0,i.reactive)({show:p,update:f,on:g,close:_,config:e});return v}}}]);