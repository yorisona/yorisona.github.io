"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[9576],{49998:function(e,t,a){a.d(t,{Z:function(){return _}});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"customer-dialog annex-dialog",attrs:{visible:e.visible,width:"450px",top:"0"},on:{close:e.emitClose},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0}])},[a("div",{staticStyle:{"max-height":"480px","overflow-y":"auto",padding:"18px 20px 32px"}},[a("el-table",{attrs:{stripe:"",data:e.annex}},e._l(e.columns,(function(t,o){return a("el-table-column",e._b({key:o},"el-table-column",t,!1))})),1)],1)])},n=[],s=a(97434),c=a(57325),i=a(64236),r=a(17890),l=a(74750),p=(0,s.defineComponent)({name:"AnnexDialog",props:{noStatus:{type:Boolean,default:!1},title:{type:String,default:"合同附件"}},setup(e,t){const a=(0,s.inject)("annex-dialog-visible")??(0,s.ref)(!1),o=(0,s.inject)("annex-data"),n=(0,s.ref)([{label:"附件类型",property:"type",align:"center",headerAlign:"center",width:90},{label:e.title,property:"file_name",align:"left",headerAlign:"left",minWidth:170,showOverflowTooltip:!0,formatter:(e,t,a)=>(0,s.h)("a",{on:{click:()=>{_(e.url)}}},[decodeURIComponent(a)])}]),p=(0,s.ref)([{label:"状态",property:"status_str",align:"center",headerAlign:"center",width:86,formatter:({status_str:e,status:t})=>(console.log(e,"status_str"),(0,s.h)("span",{class:[`fg-${r.Kb[t]}`.toLowerCase()]},[e]))}]),d=(0,s.ref)([{label:"操作",align:"center",headerAlign:"center",minWidth:64,formatter:e=>(0,s.h)("div",{class:"operation"},[(0,s.h)("tg-icon",{props:{name:"ico-download"},on:{click:()=>{const a={headers:{Authorization:(0,l.LP)()??""}};fetch(e.url,a).then((async a=>{const o=a.clone();try{const e=await o.json();t.root.$message.error(e.message)}catch{if(200===a.status){const t=await a.blob(),o=e.url.split("/")[e.url.split("/").length-1];(0,i.uA)(t,e.file_name?e.file_name:o)}else t.root.$message.error("下载失败")}}))}}}),(0,s.h)("tg-icon",{props:{name:"ico-preview"},on:{click:()=>{_(e.url)}}})])}]),m=(0,s.computed)((()=>[...n.value,...e.noStatus?[]:p.value,...d.value])),u=()=>{t.emit("dialog:close")},_=e=>{const t=/\.(?:doc|ppt|xls)x?$/u,a=t.test(e)?`https://view.officeapps.live.com/op/view.aspx?src=${encodeURIComponent((0,c.W)(e,!1))}`:(0,c.W)(e,!1);window.open(a)};return{visible:a,emitClose:u,annex:o,columns:m,preview:_}}}),d=p,m=a(1001),u=(0,m.Z)(d,o,n,!1,null,null,null),_=u.exports},63787:function(e,t,a){a.d(t,{Z:function(){return g}});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"tg-customer-contract-form-annex-dialog customer-dialog tg-dialog-vcenter",attrs:{visible:e.dialogVisible,width:"850px","close-on-click-modal":!1,"close-on-press-escape":!1,"custom-class":"add-attachment-dialog"},on:{close:e.handleDialogClose},scopedSlots:e._u([{key:"title",fn:function(){return[a("span",[e._v("新增补充协议")])]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.handleDialogClose}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.handleAttachmentSubmitClick}},[e._v("提交")])]},proxy:!0}])},[a("div",{staticStyle:{padding:"20px"}},[a("el-form",{ref:"annexFormRef",staticClass:"dialog-content",attrs:{model:e.annexForm,rules:e.contract_attachment_rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"关联客户合同：",prop:"contract_type"}},[a("el-radio-group",{staticStyle:{display:"inline-flex"},attrs:{disabled:e.lockContract},model:{value:e.annexForm.contract_type,callback:function(t){e.$set(e.annexForm,"contract_type",t)},expression:"annexForm.contract_type"}},e._l(e.contractTypeOptions,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",{staticClass:"sub-form-item",attrs:{label:"关联合同编号：","label-width":"114px",prop:"contract_id"}},[e.lockContract?a("el-input",{attrs:{disabled:""},model:{value:e.locked_contract_uid,callback:function(t){e.locked_contract_uid=t},expression:"locked_contract_uid"}}):a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请输入或者搜索合同编号","remote-method":e.getCustmerByContractNo,size:"medium",loading:e.contract_uid_loading},on:{change:e.onContractUidChange},model:{value:e.contract_uid,callback:function(t){e.contract_uid=t},expression:"contract_uid"}},e._l(e.custmerOption,(function(e){return a("el-option",{key:e.contract_uid,attrs:{label:e.contract_uid,value:e.contract_uid}})})),1)],1),a("el-form-item",{attrs:{label:"客户(公司)名称：",prop:"partner_name"}},[e.lockContract?a("el-input",{attrs:{disabled:""},model:{value:e.locked_partner_name,callback:function(t){e.locked_partner_name=t},expression:"locked_partner_name"}}):a("el-input",{attrs:{size:"medium",placeholder:"请选择关联合同编号",disabled:""},model:{value:e.annexForm.partner_name,callback:function(t){e.$set(e.annexForm,"partner_name",t)},expression:"annexForm.partner_name"}})],1),a("el-form-item",{attrs:{label:"审批金额：",prop:"approval_amount"}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入审批金额"},on:{input:e.inputApprovalAmount},model:{value:e.annexForm.approval_amount,callback:function(t){e.$set(e.annexForm,"approval_amount",t)},expression:"annexForm.approval_amount"}})],1),a("el-form-item",{attrs:{label:"用章情况：",prop:"seal_type"}},[a("el-radio-group",{staticStyle:{display:"inline-flex"},attrs:{size:"medium"},model:{value:e.annexForm.seal_type,callback:function(t){e.$set(e.annexForm,"seal_type",t)},expression:"annexForm.seal_type"}},e._l(e.SealTypeOptions,(function(t){return a("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),a("el-form-item",{attrs:{label:"申请内容：",prop:"comment"}},[a("el-input",{attrs:{size:"medium",placeholder:"请输入申请内容",maxlength:100,"show-word-limit":!0},model:{value:e.annexForm.comment,callback:function(t){e.$set(e.annexForm,"comment","string"===typeof t?t.trim():t)},expression:"annexForm.comment"}})],1),a("el-form-item",{attrs:{label:"附件单：",prop:"attachment_url"}},[a("div",{staticClass:"upload-btn-wrap"},[a("el-upload",{staticClass:"upload-attachment",attrs:{action:"/",multiple:!1,"show-file-list":!1,"http-request":e.uploadAttachmentFile,accept:".docx,.pdf,.jpg,.jpeg,.xlsx,.png,.xls",disabled:e.uploadedAttachmentList.length>=5}},[a("tg-button",{attrs:{icon:"ico-btn-upload",disabled:e.uploadedAttachmentList.length>=5}},[e._v("上传文件")])],1)],1),a("span",{staticClass:"upload-tips mgl-16"},[e._v("支持扩展名：.docx .pdf .jpg .png .xlsx .xls；最多上传5个文件夹(单个文件大小不超过30M)")]),a("div",{staticClass:"uploaded-list"},e._l(e.uploadedAttachmentList,(function(t,o){return a("div",{key:o},[a("tg-icon",{staticStyle:{"font-size":"14px"},attrs:{name:"ico-annex"}}),a("a",{staticStyle:{"margin-left":"4px"}},[e._v(e._s(t.file))]),a("tg-icon",{staticStyle:{"margin-left":"4px","font-size":"14px",cursor:"pointer"},attrs:{name:"ico-cross","hover-name":"ico-cross-red"},on:{click:function(t){return e.handleAttachmentClick(o)}}})],1)})),0)])],1)],1)]),a("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"  正在提交数据，请稍候..."}})],1)},n=[],s=(a(26699),a(86863)),c=a(97434),i=a(89935),r=a(93889),l=a(83005),p=a(12205),d=a(84731),m=a(64236),u=a(48606),_=(0,c.defineComponent)({name:"AnnexFormDialog",setup(e,t){const a=(0,c.ref)(!1),o=(0,c.ref)(null),n=(0,c.ref)(!1),s=(0,c.inject)("contract"),l=(0,c.inject)("project_add_id"),m=(0,d.f)();let _=1;m.isLiveDetail||m.isCommonBusinessDetail?_=1:m.isCoopDetail&&(_=2);const h=(0,c.ref)({contract_id:"",approval_amount:"",comment:"",attachment_url:[],manager_id:"",department:"",partner_id:"",partner_name:"",contract_annex_type:1,contract_type:r.RJ.Sales,seal_type:r.N5.Type2,current_project_id:l,project_type:_}),f=(0,c.computed)((()=>void 0!==s?.value)),v=(0,c.ref)(""),g=(0,c.ref)(""),y=()=>{if(void 0===s?.value)return;const{contract_info:{id:e,contract_type:t,partner_id:a,contract_uid:o},partner_info:{partner_name:n}}=s.value;h.value.contract_id=e,v.value=o,h.value.partner_id=a,h.value.partner_name=n,g.value=n,h.value.contract_type=t},b=(0,c.ref)({contract_id:[{required:!0,message:"请选择关联合同",trigger:"change"}],approval_amount:[{required:!0,message:"请输入审批金额",trigger:"blur"}],attachment_url:[{required:!0,message:"请上传附件",trigger:"blur"}],department:[{required:!0,message:"请先选择客户经理",trigger:"blur"}],partner_name:[{required:!0,message:"请选择关联合同",trigger:"blur"}]}),x=()=>{h.value={contract_id:"",approval_amount:"",comment:"",attachment_url:[],partner_id:"",partner_name:"",contract_annex_type:1,contract_type:r.RJ.Sales,seal_type:r.N5.Type2,current_project_id:l,project_type:_},C.value="",o.value?.resetFields()},{contract_uid:C,contract_uid_loading:w,contractInfoRecords:k,getCustmerByContractUid:S,...A}=(0,p.b)(h,o),j=e=>{A.onContractUidChange(e)},F=e=>{const t=e.trim().replace(/[^.\d]+/gu,"").replace(/^0+(?=\d+)/gu,"");h.value.approval_amount=(/^\d+(\.\d{0,2})?/gu.exec(t)??[""])[0]},$=(0,c.ref)([]);(0,c.watch)((()=>h.value.contract_type),((e,a)=>{e!==a&&(A.resetContractUid(),t.root.$nextTick((()=>{o.value?.clearValidate()})))}));const L=()=>{x(),y(),n.value=!0};let D;const R=()=>{D=u.Loading.service({lock:!0,text:"加载中……",background:"rgba(0, 0, 0, 0.7)"})},N=()=>{D.close()};return{saveLoading:a,startLoading:R,closeLoading:N,project_add_id:l,annexFormRef:o,lockContract:f,contractTypeOptions:i.Rd,dialogVisible:n,locked_contract_uid:v,locked_partner_name:g,initForm:y,show:L,annexForm:h,resetForm:x,contract_uid:C,contract_attachment_rules:b,accountManager:[],departmentName:"",custmerOption:k,contract_uid_loading:w,getCustmerByContractNo:S,onContractUidChange:j,inputApprovalAmount:F,uploadAttachmentUploading:!1,uploadedAttachmentList:$,SealTypeOptions:r.Vx,breadcrumb:m}},methods:{async handleAttachmentSubmitClick(){this.lockContract&&this.initForm();const e=await new Promise((e=>{this.annexFormRef?.validate((t=>{e(t)}))}));if(!e)return;const{contract_id:t,manager_id:a,partner_id:o,partner_name:n,...s}=this.annexForm;if(""===t||""===o)return void this.$message.error("请选择关联合同");const c={contract_id:t,partner_id:o,partner_name:this.lockContract?this.locked_partner_name:n,...s},i=()=>this.breadcrumb.isLiveDetail?(0,l.XL)(c):this.breadcrumb.isCommonBusinessDetail?(0,l.AE)(c):this.breadcrumb.isCoopDetail?(0,l.fY)(c):(0,l.bR)(c);this.saveLoading=!0;const{data:r}=await i();this.saveLoading=!1,r.success?(this.$message.success({message:r.message,showClose:!0,duration:3e3}),this.$emit("added"),this.resetForm(),this.dialogVisible=!1):this.$message.error({message:r.message??"新增合同附件失败，请稍后重试",showClose:!0,duration:3e3})},beforeUpload(e){return this.loading=!0,e.size>31457280?(this.$message.error(`${e.name} ${(e.size/1024/1024).toFixed(2)}MB 请限制在30MB以内`),this.loading=!1,!1):!(!["image/jpeg","image/jpg","image/png","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(e.type)&&![".jpeg",".jpg",".png",".pdf",".doc",".docx",".xls",".xlsx"].includes((0,m.mD)(e.name)))||(this.$message.warning("文件格式不正确，请使用 jpg / png / pdf / docx / xlsx"),this.loading=!1,!1)},async uploadAttachmentFile(e){if(!this.beforeUpload(e.file))return;const t=new FormData;t.append("file",e.file,e.file.name),t.append("attachment_type","contract_annex"),this.startLoading(),this.uploadAttachmentUploading=!0;const a=await(0,s.w_)(t);if(this.uploadAttachmentUploading=!1,this.closeLoading(),a.data.success){this.uploadedAttachmentList.push({file:e.file.name,path:a.data.data.source});const t=this.uploadedAttachmentList.map((e=>e.path));this.annexForm.attachment_url=t,this.annexFormRef?.validateField("attachment_url")}else this.$message({type:"warning",message:a.data.message??"上传失败，稍后重试",showClose:!0,duration:3e3})},handleAttachmentClick(e){this.uploadedAttachmentList.splice(e,1)},handleDialogClose(){this.dialogVisible=!1,this.resetForm(),this.custmerOption=[],this.uploadedAttachmentList=[]}}}),h=_,f=a(1001),v=(0,f.Z)(h,o,n,!1,null,null,null),g=v.exports},22910:function(e,t,a){a.d(t,{Z:function(){return F}});var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new contract-form-modal",attrs:{visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"850px",top:"70px"},on:{close:function(t){e.visible=!1}},scopedSlots:e._u([{key:"title",fn:function(){return[o("span",[e._v(e._s("add"===e.type?"新增客户合同":"编辑客户合同"))])]},proxy:!0},{key:"footer",fn:function(){return[o("tg-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),o("tg-button",{attrs:{type:"primary",disabled:e.saveLoading},on:{click:e.onSaveBtnClick}},[e._v("提交")])]},proxy:!0}])},[o("div",{staticClass:"dialog-content",staticStyle:{padding:"10px 20px","overflow-y":"auto","max-height":"554px"}},[o("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.formRules,"label-width":"134px"}},[o("div",{staticClass:"subject"},[e._v("合同基础信息")]),o("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"合同编号：",prop:"contract_uid"}},[o("div",[e._v(e._s(e.form.contract_uid)+"（系统生成）")])]),o("el-form-item",{attrs:{label:"合同类型：",prop:"contract_type"}},[o("el-radio-group",{staticStyle:{display:"inline-flex"},model:{value:e.form.contract_type,callback:function(t){e.$set(e.form,"contract_type",t)},expression:"form.contract_type"}},e._l(e.contractTypeOptions,(function(t){return o("el-radio",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),e.isSales?o("el-form-item",{key:"contract",staticClass:"sub-form-item",attrs:{prop:"frame_contract_id","label-width":"114px"},scopedSlots:e._u([{key:"label",fn:function(){return[o("el-popover",{attrs:{placement:"top",trigger:"hover"}},[o("tg-icon",{staticStyle:{"font-size":"14px"},attrs:{slot:"reference",name:"ico-question-gray","hover-name":"ico-question-blue"},slot:"reference"}),o("span",[e._v("如与客户有签订框架合同请关联（非必填）")])],1),o("span",{staticStyle:{"margin-left":"2px"}},[e._v("关联合同：")])]},proxy:!0}],null,!1,1648252082)},[o("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",remote:"","reserve-keyword":"",placeholder:"请搜索并选择合同编号","remote-method":e.getCustmerByContractUid,loading:e.contract_uid_loading,"popper-class":"frame_contract_popper-custoner"},on:{change:e.onContractUidChange},model:{value:e.frame_contract_uid,callback:function(t){e.frame_contract_uid=t},expression:"frame_contract_uid"}},e._l(e.contractInfoRecords,(function(e){return o("el-option",{key:e.contract_id,attrs:{label:e.contract_uid,value:e.contract_id}})})),1)],1):e._e(),o("el-form-item",{attrs:{label:"关联店铺：",prop:"partner_id"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"","reserve-keyword":"",disabled:!e.is_mcn_type,value:e.form.partner_id,placeholder:"请搜索并选择店铺名称",size:"medium","remote-method":function(t){return e.refillShopNameSearchKey(t,!0)}},on:{change:e.onShopChanged}},e._l(e.allStoreName,(function(t,a){return o("el-option",{key:a,attrs:{label:t.shop_name,value:t.shop_id||t.id}},[o("span",[e._v(e._s(t.shop_name))]),o("span",{staticStyle:{color:"#999"}},[e._v(e._s(t.shop_type?"("+e.shop_type_str(t.shop_type)+")":"(--)"))])])})),1)],1),e.is_mcn_type?o("el-form-item",{attrs:{label:"客户(公司)名称：",prop:"company_id"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{value:e.form.company_id,size:"medium",placeholder:"请选择客户(公司)名称",filterable:""},on:{change:e.onCompanyChanged}},e._l(e.mcn_company_options,(function(e,t){return o("el-option",{key:t,attrs:{label:e.company_name,value:e.company_id}})})),1)],1):o("el-form-item",{attrs:{label:"客户(公司)名称：",prop:"company_id"}},[o("el-input",{attrs:{size:"medium",placeholder:"该店铺未设置关联公司，请在客户管理中进行设置",disabled:!e.is_mcn_type},scopedSlots:e._u([{key:"suffix",fn:function(){return[o("p",{directives:[{name:"show",rawName:"v-show",value:!e.form.customer_company_name&&!e.is_mcn_type,expression:"!form.customer_company_name && !is_mcn_type"}],staticClass:"company-name-slot",staticStyle:{"font-size":"12px"}},[e._v(" 该店铺没有录入公司名称 "),o("a",{staticStyle:{"font-size":"12px"},on:{click:e.handleAddCompanyNameClick}},[e._v("去补充>")])])]},proxy:!0}],null,!1,284959358),model:{value:e.form.customer_company_name,callback:function(t){e.$set(e.form,"customer_company_name",t)},expression:"form.customer_company_name"}})],1),o("el-form-item",{attrs:{label:"合作期限：",prop:"coop_date"}},[o("el-date-picker",{staticStyle:{width:"240px"},attrs:{type:"daterange",size:"small","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.form.coop_date,callback:function(t){e.$set(e.form,"coop_date",t)},expression:"form.coop_date"}})],1),o("el-form-item",{attrs:{label:"销售渠道：",prop:"sale_chance"}},[o("el-checkbox",{attrs:{indeterminate:e.saleChance.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.saleChance.checkAll,callback:function(t){e.$set(e.saleChance,"checkAll",t)},expression:"saleChance.checkAll"}},[e._v("全选")]),o("el-checkbox-group",{staticClass:"contract-checkbox-group",on:{change:e.handleCheckedSaleChanceChange},model:{value:e.form.sale_chance,callback:function(t){e.$set(e.form,"sale_chance",t)},expression:"form.sale_chance"}},e._l(e.saleChances,(function(t,a){return o("el-checkbox",{key:a,staticClass:"chance-checkbox",staticStyle:{height:"16px","line-height":"16px"},attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),o("div",{staticClass:"subject mgt-10"},[e._v("合同明细")]),o("el-form-item",{attrs:{label:"产品（销售渠道）："}},[o("div",{staticStyle:{"line-height":"20px","padding-top":"9px"}},[e._v(e._s(e.checkedChances))])]),e.isSales?o("el-form-item",{staticStyle:{display:"inline-block",width:"378px"},attrs:{label:"合同金额：",prop:"contract_amount"}},[o("el-input",{staticStyle:{width:"244px"},attrs:{placeholder:"0.00",size:"medium"},on:{input:e.inputContractAmount},model:{value:e.form.contract_amount,callback:function(t){e.$set(e.form,"contract_amount",t)},expression:"form.contract_amount"}})],1):e._e(),e.isSales?o("el-form-item",{staticStyle:{display:"inline-block",width:"378px"},attrs:{label:"标准单价：",prop:"price"}},[o("el-input",{staticStyle:{width:"244px"},attrs:{placeholder:"请输入标准单价",size:"medium"},on:{input:e.inputPrice},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1):e._e(),e.isSales?o("el-form-item",{staticStyle:{display:"inline-block",width:"378px"},attrs:{label:"数量：",prop:"num"}},[o("el-input",{staticStyle:{width:"244px"},attrs:{placeholder:"请输入数量",size:"medium"},on:{input:function(t){return e.onlyPositiveInteger(t)}},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1):e._e(),e.isSales?o("el-form-item",{staticStyle:{display:"inline-block",width:"378px"},attrs:{label:"折扣：",prop:"discount"}},[o("el-input",{staticStyle:{width:"244px"},attrs:{placeholder:"输入1.0 - 10.0的数字",size:"medium"},on:{input:e.inputDiscount},model:{value:e.form.discount,callback:function(t){e.$set(e.form,"discount",t)},expression:"form.discount"}})],1):e._e(),e.isSales?o("el-form-item",{staticStyle:{display:"inline-block",width:"378px"},attrs:{label:"单位：",prop:"unit"}},[o("el-select",{staticClass:"short-input",staticStyle:{width:"244px"},attrs:{size:"medium",placeholder:"请选择单位"},model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit",t)},expression:"form.unit"}},[o("el-option",{attrs:{label:"场",value:1}}),o("el-option",{attrs:{label:"次",value:2}})],1)],1):e._e(),o("el-form-item",{attrs:{label:"合同附件：",prop:"attachment_url"}},[o("el-upload",{staticClass:"upload-btn-wrap",attrs:{action:"","show-file-list":!1,multiple:!1,"http-request":e.uploadAttachmentFile,accept:".doc,.docx,.pdf,.jpg,.jpeg,.png,.xlsx,.xls",disabled:e.form.attachment_url.length>=5}},[o("tg-button",{attrs:{icon:"ico-btn-upload",disabled:e.form.attachment_url.length>=5}},[e._v("上传文件")])],1),o("span",{staticClass:"upload-tips mgl-16"},[e._v(" 支持扩展名：.docx .doc .pdf .jpg .png .xlsx .xls；最多上传5个文件（单个文件大小不超过30M） ")]),o("div",{staticClass:"uploaded-list"},e._l(this.form.attachment_url,(function(t,n){return o("p",{key:n,staticStyle:{"margin-right":"10px","line-height":"30px"}},[o("img",{staticClass:"attachment-icon",attrs:{src:a(76194)}}),t?o("span",{staticClass:"uploaded-attachment-name"},[e._v(e._s(decodeURIComponent(t.split("/")[t.split("/").length-1]||"--")))]):e._e(),t?o("i",{staticClass:"el-icon-circle-close-outline clear-uploaded-file",on:{click:function(t){return e.clearUploadedFile(n)}}}):e._e()])})),0)],1),o("el-form-item",{attrs:{label:"备注："}},[o("el-input",{staticStyle:{width:"620px"},attrs:{type:"textarea",rows:2,size:"small",placeholder:"请输入备注",maxlength:"50","show-word-limit":""},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark","string"===typeof t?t.trim():t)},expression:"form.remark"}})],1),e.isSales?[o("div",{staticClass:"subject mgb-10"},[e._v("收款计划")]),e._l(e.proceeds_plan,(function(t,a){return o("div",{key:a,staticClass:"plan-item mgb-10"},[o("div",{staticClass:"settlement-detail-item-grid"},[o("el-form-item",{staticStyle:{order:"1"},attrs:{prop:"proceeds_amount",label:"收款金额：","label-width":"106px"}},[o("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"0.00"},model:{value:t.proceeds_amount,callback:function(a){e.$set(t,"proceeds_amount",a)},expression:"plan.proceeds_amount"}})],1),o("el-form-item",{staticStyle:{order:"10"},attrs:{prop:"proceeds_plan_date",label:"计划收款日期：","label-width":"106px"}},[o("el-date-picker",{staticClass:"plan-date",staticStyle:{width:"140px"},attrs:{size:"small","value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.proceeds_plan_date,callback:function(a){e.$set(t,"proceeds_plan_date",a)},expression:"plan.proceeds_plan_date"}})],1),o("el-form-item",{staticStyle:{order:"1"},attrs:{prop:"obtained_amount",label:"已收金额：","label-width":"106px"}},[o("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"0.00"},model:{value:t.obtained_amount,callback:function(a){e.$set(t,"obtained_amount",a)},expression:"plan.obtained_amount"}})],1),o("el-form-item",{staticStyle:{order:"1"},attrs:{prop:"to_obtain_amount",label:"待收金额：","label-width":"106px"}},[o("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"0.00"},model:{value:t.to_obtain_amount,callback:function(a){e.$set(t,"to_obtain_amount",a)},expression:"plan.to_obtain_amount"}})],1),o("el-form-item",{staticStyle:{order:"1"},attrs:{prop:"invoice_amount",label:"已开票金额：","label-width":"106px"}},[o("el-input",{staticStyle:{width:"140px"},attrs:{size:"small",placeholder:"0.00"},model:{value:t.invoice_amount,callback:function(a){e.$set(t,"invoice_amount",a)},expression:"plan.invoice_amount"}})],1)],1),e.isOnlyEmpty?e._e():o("div",{staticClass:"close-btn",on:{click:function(t){return e.removePlan(a)}}},[o("tg-icon",{attrs:{name:"ico-cross-lite"}})],1)])})),o("div",{staticClass:"plan-add-btn",on:{click:e.addOnePlan}},[o("tg-icon",{attrs:{name:"ico-btn-add"}}),o("span",[e._v("点击添加")])],1)]:e._e(),e._e()],2)],1)]),o("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"  正在提交数据，请稍候..."}})],1)},n=[],s=(a(26699),a(97434)),c=a(89935),i=a(86863),r=a(62707),l=a(93889),p=a(12205),d=a(61282),m=a(83005),u=a(53451),_=a.n(u),h=a(84731),f=a(44928),v=a(29625),g=a(41572),y=a(79433),b=a(64236),x=a(48606);const{debounce:C}=_(),w=()=>{const e=(0,s.ref)([]),t=(0,s.ref)([]),a=JSON.stringify({proceeds_plan_date:"",proceeds_amount:"",obtained_amount:"",to_obtain_amount:"",invoice_amount:""}),o=()=>{e.value.push({proceeds_plan_date:"",proceeds_amount:"",obtained_amount:"",to_obtain_amount:"",invoice_amount:""})},n=e=>JSON.stringify(e)===a,c=a=>{e.value[a].id&&(e.value[a].is_delete=1,t.value.push(e.value[a])),e.value.splice(a,1),0===e.value.length&&o()},i=(0,s.computed)((()=>1===e.value.length&&n(e.value[0])));return o(),{proceeds_plan:e,deletedPlans:t,addOnePlan:o,removePlan:c,isOnlyEmpty:i}};var k=(0,s.defineComponent)({name:"AddContract",props:{type:{type:String,default:"add"}},data(){return{no_upload_click:!1,isAddingEditing:!1,contractTypeOptions:c.Rd,saleChances:c.KL,planData:[],accountManager:[],approver:[],uploadAttachment:[],approverList:[{id:6,username:""},{id:61,username:""},{id:74,username:""}],companyNameIsShow:!1}},computed:{selectedSaleChances(){const e=this.saleChances.filter((e=>!!this.form.sale_chance.find((t=>t===e.value))));return e}},setup(e,t){const a=(0,f.t)(),o=(0,s.ref)(!1),n=(0,s.ref)(null),i=(0,s.inject)("project_add_id"),u=(0,s.inject)("project"),_=(0,h.f)(),b=(0,s.computed)((()=>5===u.value?.business_type)),k=(0,s.computed)((()=>{const e=F.allStoreName.value.find((e=>e.shop_id===j.value.partner_id));return e?.companies??[]})),S=(0,s.ref)(l.RJ.Sales),A=(0,s.computed)((()=>{switch(u.value?.business_type){case v.WD.marketing:return v.kA.marketing;case v.WD.base:case v.WD.mcn:return v.kA.common_business;case v.WD.douyin:case v.WD.taobao:case v.WD.douyinsh:return v.kA.live}}));_.isLegalSupplierContractDetail||_.isLegalCustomerContractDetail||_.isLegalStatisticsSupplierContractDetail||_.isLegalStatisticsCustomerContractDetail?S.value=l.RJ.Framework:_.isCommonBusinessDetail||_.isCommonBusinessCustomerContractDetail||_.isCommonBusinessSupplierContractDetail||_.isLiveDetail?S.value=l.RJ.Purchase:_.isCoopDetail&&(S.value=l.RJ.SupplierFramework);const j=(0,s.ref)({company_id:void 0,shop_name:"",contract_uid:"",customer_company_name:"",contract_type:l.RJ.Sales,sale_chance:[],num:"",price:"",unit:1,discount:"",contract_amount:"",attachment_url:[],remark:"",proceeds_plan:[{proceeds_plan_date:"",proceeds_amount:"",obtained_amount:"",to_obtain_amount:"",invoice_amount:""}],partner_id:"",coop_date:[]}),F=(0,p.j)(j,n),{clearContractInfoRecords:$,contract_uid_loading:L,contractInfoRecords:D,getCustmerByContractUid:R,resetContractUid:N,resetFrameContractUid:B,refillContractUid:z,contract_uid:U}=(0,p.b)(j,n,1,l.RJ.Framework);(0,s.watch)((()=>j.value.contract_type),((e,t)=>{e!==t&&(j.value.frame_contract_id=void 0,B())}));const I=(0,s.ref)({checkAll:!1,isIndeterminate:!1}),P=e=>{j.value.sale_chance=e?c.KL.map((e=>e.value)):[],I.value.isIndeterminate=!1},T=(0,s.computed)((()=>c.KL.filter((e=>j.value.sale_chance.includes(e.value))).map((e=>e.label)).join("、"))),O=(0,s.ref)([]),K=(0,s.computed)((()=>j.value.contract_type===l.RJ.Sales)),q=e=>{n.value?.clearValidate();const t=D.value.find((t=>t.contract_id===e));if(void 0===t)return;const{contract_id:a}=t;j.value.frame_contract_id=a},E=(0,s.ref)(""),J=async e=>{try{const{data:a}=await(0,y.iY)({customer_id:e});if(a.success){const e=a.data.data[0];E.value=e.company_name}else t.root.$message.error(a.message)}catch(a){t.root.$message.error(a.message)}};(0,s.watch)((()=>o.value),(async e=>{if(e&&u.value){const e=u.value.id?u.value.id:u.value.cooperation_id;if(j.value.current_project_id=e,j.value.project_id=e,j.value.project_type=A.value,j.value.customer_company_name="--"===j.value.customer_company_name?"":j.value.customer_company_name,j.value.customer_company_name||(u.value.cooperation_id||u.value.customer_type&&2===u.value.customer_type)&&(await J(u.value.customer_id),j.value.customer_company_name=E.value),A.value===v.kA.live){const e=u.value.business_type===v.WD.taobao?"TDHT":"DDHT";R(e)}else if(A.value===v.kA.common_business){const e=u.value.business_type===v.WD.base?"JDYW":"MCN";R(e)}b.value||(j.value.partner_id=u.value.customer_id,F.shopNameSearchKey.value=u.value.shop_name,j.value.shop_name=u.value.shop_name,j.value.customer_company_name=u.value.customer_company_name??u.value.company_name,j.value.company_id=u.value.company_id,F.refillShopNameSearchKey(j.value.shop_name,b.value))}}));const M=e=>{j.value.contract_amount=(0,d.nA)(e),j.value.discount=""},V=e=>{j.value.price=(0,d.nA)(e),Y()},W=e=>{j.value.num=(0,d.nA)(e),Y()},Z=e=>{const t=(0,d.nA)(e),a=(/^(?:10(?:\.0?)?|\d(?:\.\d?)?)/u.exec(t)??[""])[0];j.value.discount=a,Y()},Y=()=>{const{num:e,price:t,discount:a}=j.value;let o;""!==e&&""!==t&&""===a?o=Number(e)*Number(t):""!==e&&""!==t&&""!==a&&(o=Number(e)*Number(t)*Number(a)/10),j.value.contract_amount=o?o.toFixed(0):""},Q=e=>{const t=e=>e.replace(/\D/g,"").replace(g.Pj,"");j.value.num=t(e)},X=(0,s.ref)({contract_type:[{required:!0,message:"请选择合同类型",trigger:"change"}],partner_id:[{required:!0,message:"请选择关联店铺",trigger:["blur","change"]}],company_id:[{required:!0,message:"请选择客户(公司)名称",trigger:["change","blur"]}],coop_date:[{required:!0,message:"请选择合作期限",trigger:"blur"}],sale_chance:[{required:!0,message:"请选择销售渠道",trigger:"change"}],contract_amount:[{required:!0,message:"请输入合同金额",trigger:"blur"}],attachment_url:[],proceeds_plan:[]}),H=w(),G=(0,s.ref)(!1),ee=async()=>{if(G.value)return;"edit"===e.type?j.value.proceeds_plan=H.proceeds_plan.value.concat(H.deletedPlans.value):j.value.proceeds_plan=H.proceeds_plan.value;const a=await new Promise((e=>n.value?.validate((t=>e(t)))));if(!a)return void(document.getElementsByClassName("dialog-content")[0]&&(document.getElementsByClassName("dialog-content")[0].scrollTop=0));const{contract_uid:s,contract_type:c,partner_id:i,company_id:r,sale_chance:p,coop_date:[d,u],..._}=j.value,h=c===l.RJ.Sales?{contract_uid:s,contract_type:c,sale_chance:p.map((e=>`${e}`)),coop_start_date:d,coop_end_date:u,shop_name:j.value.shop_name,remark:j.value.remark,customer_company_name:j.value.customer_company_name,partner_id:i,company_id:r,..._}:{partner_id:i,company_id:r,id:_.id,contract_uid:s,contract_type:c,sale_chance:p.map((e=>`${e}`)),coop_start_date:d,coop_end_date:u,remark:j.value.remark,shop_name:j.value.shop_name,attachment_url:j.value.attachment_url,customer_company_name:j.value.customer_company_name};let f;if(h.project_id=j.value.project_id,G.value=!0,A.value===v.kA.common_business){const e=await(0,m.ZS)({...h,project_id:h.project_id});f=e.data}else if(A.value===v.kA.marketing){const e=await(0,m.TG)({...h,project_id:h.project_id,cooperation_id:h.project_id});f=e.data}else{const e=await(0,m.U9)({...h,project_id:h.project_id});f=e.data}G.value=!1,f.success?(o.value=!1,H.proceeds_plan.value=[{proceeds_plan_date:"",proceeds_amount:"",obtained_amount:"",to_obtain_amount:"",invoice_amount:""}],H.deletedPlans.value=[],t.root.$message.success(f.message),t.emit("add"===e.type?"added":"edited")):t.root.$message.error(f.message??"合同保存失败，稍后重试")},te=C(ee,200);let ae;const oe=()=>{ae=x.Loading.service({lock:!0,text:"加载中……",background:"rgba(0, 0, 0, 0.7)"})},ne=()=>{ae.close()},se=e=>{const t=F.allStoreName.value.find((t=>t.shop_id===e));F.shopNameSearchKey.value=t?.shop_name,j.value.partner_id=t?.shop_id,j.value.shop_name=t?.shop_name,j.value.company_id=void 0,j.value.customer_company_name=void 0},ce=e=>{const t=k.value.find((t=>t.company_id===e));j.value.company_id=t?.company_id,j.value.customer_company_name=t?.company_name},ie=e=>1===e?"淘宝":2===e?"天猫":"抖音";return{startLoading:oe,closeLoading:ne,onlyPositiveInteger:Q,project:u,project_add_id:i,visible:o,CONSTRACT_APPROVER:r.Rs,formRef:n,form:j,formRules:X,saleChance:I,checkedChances:T,handleCheckAllChange:P,department:O,isSales:K,resetContractUid:N,frame_contract_uid:U,refillContractUid:z,...F,clearContractInfoRecords:$,contract_uid_loading:L,contractInfoRecords:D,getCustmerByContractUid:R,onContractUidChange:q,inputContractAmount:M,inputPrice:V,inputNum:W,inputDiscount:Z,computeContractAmount:Y,...H,saveLoading:G,onSaveBtnClick:te,project_contract_type:S,breadcrumb:_,router:a,project_type:A,is_mcn_type:b,mcn_company_options:k,onShopChanged:se,onCompanyChanged:ce,shop_type_str:ie}},methods:{show(e){if(this.no_upload_click=!1,"add"===this.type&&this.getContractNumber(),this.resetForm(),this.$nextTick((()=>{this.formRef?.clearValidate()})),"edit"===this.type){if(!e)return!1;this.saleChance.checkAll=e.contract_info.sale_chance.length===c.KL.length,this.saleChance.isIndeterminate=e.contract_info.sale_chance.length!==c.KL.length&&0!==e.contract_info.sale_chance.length,this.uploadAttachment.file=e.contract_detail.attachment_url?{name:e.contract_detail.attachment_url.split("/")[e.contract_detail.attachment_url.split("/").length-1]}:null;const{contract_info:{id:t,company_id:a,contract_uid:o,contract_type:n,sale_chance:s,coop_start_date:i,coop_end_date:r,frame_contract_id:p,frame_contract_uid:d,company_name:m,shop_name:u},contract_detail:{contract_amount:_,attachment_url:h,discount:f,num:v,price:g,unit:y,remark:b},proceeds_plan:x}=e,{contract_info:{partner_id:C}}=e,w=n===l.RJ.Sales;this.form={id:t,customer_company_name:m,company_id:a,contract_uid:o,contract_type:n,sale_chance:s.map((e=>e.value)),num:`${v}`,price:g,unit:y,discount:"0.00"===f?"":f,contract_amount:_,attachment_url:h.split(",").filter((e=>""!==e)),remark:b,proceeds_plan:x,partner_id:C,shop_name:u,coop_date:[i,r],...w?{frame_contract_id:p??void 0,frame_contract_uid:d??void 0}:{},project_id:e.contract_info.project_id},this.refillShopNameSearchKey(u,this.is_mcn_type),w&&null!==d&&this.refillContractUid(d),this.refillShopNameSearchKey(u,this.is_mcn_type)}else this.form.project_id=void 0;this.visible=!0,setTimeout((()=>{document.getElementsByClassName("dialog-content")[0]&&(document.getElementsByClassName("dialog-content")[0].scrollTop=0)}),100)},handleCheckedSaleChanceChange(e){const t=e.length;this.saleChance.checkAll=t===c.KL.length,this.saleChance.isIndeterminate=t>0&&t<c.KL.length},beforeUpload(e){return e.size>31457280?(this.$message.error(`${e.name} ${(e.size/1024/1024).toFixed(2)}MB 请限制在30MB以内`),!1):!(!["image/jpeg","image/png","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword",".sheet"].includes(e.type)&&![".jpg",".jpeg",".png",".pdf",".doc",".docx",".xlsx"].includes((0,b.mD)(e.name)))||(this.$message.warning("文件格式不正确，请使用  pdf / docx / doc / jpg / png / xlsx"),!1)},uploadAttachmentFile(e){const t=this.beforeUpload(e.file);if(!t)return;const a=new FormData;a.append("file",e.file,e.file.name),a.append("attachment_type","contract"),this.uploadAttachment.file=e.file,this.startLoading(),(0,i.w_)(a).then((e=>{this.closeLoading(),e.data.success?(this.form.attachment_url.push(e.data.data.source),5===this.form.attachment_url.length?this.no_upload_click=!0:this.no_upload_click=!1):(this.uploadAttachment.file=null,this.$message({type:"warning",message:e.data.message,showClose:!0,duration:2e3}))})).catch((e=>{this.closeLoading(),this.$message({type:"warning",message:"上传失败，稍后重试",showClose:!0,duration:2e3}),console.log(e.message)}))},clearUploadedFile(e){this.form.attachment_url.splice(e,1),this.no_upload_click=!1},async getContractNumber(){Promise.resolve().then((()=>this.project_contract_type===l.RJ.Purchase?(0,i.LK)({business_type:this.project?.business_type}):(this.project_contract_type,l.RJ.SupplierFramework,(0,i.XZ)()))).then((e=>{e.data.success?this.form.contract_uid=e.data.data:this.$message({type:"warning",message:e.data.message,duration:2e3,showClose:!0})})).catch((e=>{this.$message({type:"error",message:"合同编号获取失败，稍后重试",duration:2e3,showClose:!0}),console.log(e.message)}))},resetForm(){this.form={company_id:void 0,shop_name:"",customer_company_name:"",contract_uid:"",contract_type:l.RJ.Sales,sale_chance:[],num:"",price:"",unit:1,discount:"",contract_amount:"",attachment_url:[],remark:"",proceeds_plan:[{proceeds_plan_date:"",proceeds_amount:"",obtained_amount:"",to_obtain_amount:"",invoice_amount:""}],partner_id:"",coop_date:[],current_project_id:this.project_add_id?.value,project_type:this.project_type},this.saleChance.checkAll=!1,this.saleChance.isIndeterminate=!1,this.resetContractUid(),this.resetShopName()},handleAddCompanyNameClick(){this.visible=!1,window.open("/customer/list")}}}),S=k,A=a(1001),j=(0,A.Z)(S,o,n,!1,null,null,null),F=j.exports},65122:function(e,t,a){a.d(t,{Z:function(){return l}});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"approve-progress"}},[a("div",{staticClass:"progress-header"},[e._v("审批进度")]),a("div",{staticClass:"progress-main"},[e._l(e.workInfos,(function(t,o){return a("div",{key:o,class:["progress-item",e.handleProgressStatus(t.result)]},[a("div",{staticClass:"progress-item-header"},["status-success"===e.handleProgressStatus(t.result)?a("i",{staticClass:"status-icon el-icon-circle-check"}):e._e(),"status-warning"===e.handleProgressStatus(t.result)?a("i",{staticClass:"status-icon el-icon-warning"}):e._e(),a("span",{staticClass:"header-text"},[e._v(e._s(t.user))]),a("span",{staticClass:"step-time"},[e._v(e._s(e.approveTime(t.create_time_str)))])]),a("div",{staticClass:"progress-item-body"},[a("span",{staticClass:"status-text"},[e._v(e._s(t.result_str))]),t.comment?a("p",{staticClass:"reason-text"},[e._v(e._s(t.comment))]):e._e()])])})),"ht"===e.type&&e.contractInfo.contract_info&&e.contractInfo.contract_info.contract_todo_str?a("div",{class:["progress-item",{"status-success":2===e.contractInfo.contract_info.contract_status}]},[a("div",{staticClass:"progress-item-header"},[a("i",{staticClass:"status-icon el-icon-circle-check"}),a("span",{staticClass:"header-text"},[e._v(e._s(e.contractInfo.contract_info.contract_todo_str))])]),a("div",{staticClass:"progress-item-body"})]):e._e(),"fj"===e.type&&e.contractInfo.contract_annex_info.length>0?a("div",{class:["progress-item",{"status-success":2===e.contractInfo.contract_annex_info[0].contract_annex_status}]},[a("div",{staticClass:"progress-item-header"},[a("i",{staticClass:"status-icon el-icon-circle-check"}),a("span",{staticClass:"header-text"},[e._v(e._s(e.contractInfo.contract_annex_info[0].contract_annex_todo_str))])]),a("div",{staticClass:"progress-item-body"})]):e._e(),"fjapproval"===e.type&&e.contractInfo.contract_annex_info?a("div",{class:["progress-item",{"status-success":2===e.contractInfo.contract_annex_info.contract_annex_status}]},[a("div",{staticClass:"progress-item-header"},[a("i",{staticClass:"status-icon el-icon-circle-check"}),a("span",{staticClass:"header-text"},[e._v(e._s(e.contractInfo.contract_annex_info.contract_annex_todao_str))])]),a("div",{staticClass:"progress-item-body"})]):e._e()],2)])},n=[],s={name:"ApproveProgress",props:{workInfos:{type:Array,default:()=>[]},contractInfo:{type:Object,default:()=>{}},type:{type:String,default:"ht"}},mounted(){},methods:{handleProgressStatus(e){return 1e3===e||1002===e||1100===e||1102===e||2e3===e||2002===e||2100===e||2102===e?"status-success":1001===e||1003===e||1101===e||1103===e||2001===e||2003===e||2101===e||2103===e?"status-warning":""},approveTime(e){return e.length>=16?e.substr(0,16):""}}},c=s,i=a(1001),r=(0,i.Z)(c,o,n,!1,null,"6d03ea96",null),l=r.exports},62083:function(e,t,a){a.d(t,{q:function(){return l}});var o=a(97434),n=a(83005),s=a(64236),c=a(25711),i=a(17890);const r=new Map([["contract",n.eu],["annex",n.tZ],["statement",n.ot]]),l=(e="contract")=>{const{getCache:t,setCache:a}=(0,c.Y)(),l=(0,o.ref)([]),p=(0,o.ref)(!1),d=(0,o.ref)("");(0,o.provide)("flows",l);const m=async t=>{p.value=!0;const[{data:o},c]=await Promise.all([await(r.get(e)??n.eu)(t),await(0,s._v)(200)]);if(p.value=!1,o.success){const e=o.data;return a(t,e),d.value="",e}d.value=o.message},u=async e=>{l.value=[];const a=t(e)??await m(e);void 0!==a&&(l.value=a)},_=()=>{d.value="",p.value=!1},h=e=>{const t=e===i.Kb.Failure,a=l.value[l.value.length-1]?.receivedPersons,n=l.value.length+(""===a||t?0:1);return(0,o.h)("div",{class:["oa-flows-new"]},[(0,o.h)("div",{class:"oa-flows-hd"},["审批进度"]),(0,o.h)("div",{class:"oa-flows-bd",style:"overflow-x: hidden !important;margin-top:4px;"},[(0,o.h)("el-steps",{attrs:{direction:"vertical",active:n}},[l.value.map(((e,n)=>{const s=n<l.value.length-1,c=!s&&t,i=c?(0,o.h)("tg-icon",{slot:"icon",attrs:{name:"ico-cross-red"},style:"font-size: 12px"}):(0,o.h)("tg-icon",{slot:"icon",attrs:{name:"ico-right"},style:"font-size: 12px"});let r="";return""===a||t||(r="oa-flow-step-padding-bottom"),(0,o.h)("el-step",{class:r,key:n,attrs:{status:c?"error":"finish"}},[i,(0,o.h)("div",{slot:"description",class:"oa-flow-content",style:"height:18px;line-height:18px;margin-top:12px !important；color:#3C5269;"},[e.nodeName]),(0,o.h)("div",{slot:"description",class:"oa-flow-content mgt-6",style:"height:18px;line-height:18px"},[(0,o.h)("span",{style:"color: #6A7B92"},["审批人：",e.operatorName])]),c&&(e.oa_review_result||e.remark)?(0,o.h)("div",{slot:"description",class:"oa-flow-content mgt-6",style:"line-height:18px;color:#ED3434"},[(0,o.h)("span",{class:"error-reason"},[e.oa_review_result??e.remark])]):"",c?"":(0,o.h)("div",{slot:"description",style:"color:#A4B2C2",class:"oa-flow-footer mgt-6"},[e.operateDate," ",e.operateTime])])})),""===a||t?"":(0,o.h)("el-step",{attrs:{status:"wait"}},[(0,o.h)("div",{slot:"icon",style:"font-size: 12px;color:#A4B2C2;"},[(0,o.h)("div",{style:"width:30px;text-align: center;"},[l.value.length+1])]),(0,o.h)("div",{slot:"description",class:"oa-flow-content wait"},[(0,o.h)("div",{style:"color:#A4B2C2"},[a]),(0,o.h)("div",{class:"mgt-6",style:"color:#A4B2C2"},["待处理"])])])])])])};return{flowsError:d,flowsLoading:p,oaflowsRender:h,onFlowsHide:_,onFlowsShow:u}}},76194:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAMAAAANmfvwAAAAflBMVEUAAAC/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wci/wcgi05TZAAAAKXRSTlMAAvQ+n/gG6x8ZFOXdpZpGEPDX0MW1q4FTOzcxIwuuem9LKcy+upWPifpT59wAAADpSURBVDjL7dFXcsMwDEVRkBKLCmXJVreqa97+N5jQyvhDIbOATO73GQwGoP9eHe6cl+1vosGrxi8+IOY4XoDeA9gTot3kwyMeECtpuxAqt8ggDhTwhmiBcYoQ3AqEbFBoXcKAB5u4JKjYTyFrFN1b3EaHmFD0mzgr3Me8HvYkgzq/RSXzK277q4N/i77AJOMTUr0jE2bqrOgK1FYcI9qVYKD0SwQchkVHhyBA5hBWhFacYiLHFKlQCmRMp05BBg21Anhacc3JUQfeUxRouqQoncLehc+aRQtHORL5vrxlrPC01glUtdLf7xP0+BZj4PzI1QAAAABJRU5ErkJggg=="}}]);