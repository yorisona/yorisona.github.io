"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[8177],{59563:function(e,t,a){a.d(t,{Q:function(){return o},h:function(){return l}});a(21703);var s=a(97434),r=a(48606);const o=(e,{manual:t,onError:a,onSuccess:o,defaultParams:l,transform:n}={})=>{const i=(0,s.ref)(),c=(0,s.ref)(),u=(0,s.ref)(!1),d=(0,s.ref)([]),p=()=>{g(...d.value)},g=(...t)=>Promise.resolve(t||l).then((()=>{u.value=!0})).then((()=>0===t.length&&l&&l.length>0?l:t)).then((e=>(d.value=e,e))).then((t=>e(...t))).then((e=>{if(!e.data.success)throw new Error(e.data.message);return i.value=n?n(e.data.data):e.data.data,o&&o(i.value,e.data),e})).then((()=>{u.value=!1})).catch((e=>{throw u.value=!1,c.value=e.message,a&&a(e),r.Message.error(e.message),e})),m=g;return t||g(...l||[]),(0,s.reactive)({data:i,error:c,loading:u,reload:p,run:g,runAsync:m,params:d})},l=(e,t={})=>{const{defaultPageSize:a=20,defaultParams:r=[],transform:l,...n}=t,i=(0,s.ref)(),c=(0,s.reactive)({total:0,page_num:1,page_size:a,onCurrentChange:e=>{const t=[...p.params];t[0]?t[0].page_num=e:t[0]={num:a,page_num:e},p.runAsync(...t).then((()=>{c.page_num=e}))},refresh:()=>c.onCurrentChange(1),reQuery(...e){const t=[];return p.params[0]?(t[0]=p.params[0],t[0].page_num=1,c.page_num=1):(t[0]={num:a,page_num:1},c.page_num=1),t.push(...e),p.runAsync(...t)}}),[u={num:a,page_num:1},...d]=r,p=o(e,{defaultParams:[u,...d],...n,onSuccess(e,a){i.value=l?l(e):e.data,c.total=e.total,t.onSuccess&&t.onSuccess(i.value,a)}}),{data:g,...m}=(0,s.toRefs)(p);return(0,s.reactive)({...m,data:i,pagination:c})}},50737:function(e,t,a){a.d(t,{SL:function(){return i},bO:function(){return l},f8:function(){return o},sR:function(){return n}});var s=a(76012),r=a(64236);const o=(e={})=>(0,s.dX)("/api/maycur/list_expense_categories",{params:{...(0,r.jG)(e)}}),l=e=>(0,s.SO)("/api/maycur/save_expense_category",(0,r.jG)(e)),n=(e={})=>(0,s.dX)("/api/maycur/list_expense_types",{params:{...(0,r.jG)(e)}}),i=e=>(0,s.SO)("/api/maycur/save_expense_type",(0,r.jG)(e))},82741:function(e,t,a){a.d(t,{I:function(){return r},u:function(){return o}});var s=a(71340);const r=(e,t)=>{const a="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...a,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},o=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,a)=>{(0,s.t)({...t,onConfirm:()=>e(!0),onCancel:()=>a()})}))}},23812:function(e,t,a){a.d(t,{GQ:function(){return n},YE:function(){return o},cY:function(){return i},pK:function(){return l}});var s=a(97434),r=a(44928);const o=(e,t)=>({tabs:(0,s.reactive)([...e]),checkedTab:(0,s.ref)(t??(e.length<1?"":e[0].value))}),l=(e,t)=>{const a=(0,s.isRef)(e)?e:(0,s.ref)(e),r=(0,s.isRef)(t)?(0,s.unref)(t):t,o=a.value.length<1?"":a.value[0].value,l=(0,s.ref)(r??o);return{tabs:a,checkedTab:l}},n=(e,t,a)=>{const r=(0,s.reactive)([...t]),o=(0,s.ref)(a??(t.length<1?"":`${t[0].value}`)),l=t=>{e.root.$router.push({path:e.root.$route.path,query:{tab:`${t.value}`}})};return(0,s.onBeforeMount)((()=>{const s=e.root.$route.query.tab;o.value="string"===typeof s?s:a??(t.length<1?"":`${t[0].value}`)})),{tabs:r,checkedTab:o,onTabChange:l}},i=(e,t)=>{const a=(0,s.reactive)([...e]),o=(0,s.ref)(t??(e.length<1?"":`${e[0].value}`)),l=(0,r.t)(),n=e=>{const t=l.currentRoute,a={...t.params,tab:e.value};l.push({name:t.name,params:a})};return o.value=l.currentRoute.params.tab||t||o.value,{tabs:a,checkedTab:o,onTabChange:n}}},44928:function(e,t,a){a.d(t,{t:function(){return r}});var s=a(86834);const r=()=>{const e=new Proxy({},{get(e,t){return Reflect.get(s.Z,t)}});return e}},68177:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var s=a(97434),r=a(1763);const o=e=>s.defineComponent(e);var l,n,i,c,u,d,p,g,m=a(23812),v=a(44928),f=a(50737),b=a(59563),_=a(36568),y=a.n(_),k=(0,s.defineComponent)({setup:(e,t)=>{const a=(0,s.ref)(null),r=(0,s.ref)({}),o=(0,b.Q)(f.bO,{manual:!0,onSuccess:(e,a)=>{t.root.$message.success(a.message??"保存成功")},onError:e=>{t.root.$message.error(e??"保存失败")}}),l=e=>{r.value=void 0===e?{is_active:!0}:{...e}},n=()=>{a.value?.validate((async e=>{e&&(await o.runAsync(r.value),t.emit("close"),t.emit("submit"))}))};return{formRef:a,show:l,dialogSubmit:n,form:r}},render(){const e=arguments[0],t=this.form;return e("div",{class:"dialog-content"},[e("el-form",y()([{ref:"formRef"},{attrs:{model:t}},{attrs:{"label-width":"70px",size:"small","hide-required-asterisk":!0}}]),[e("el-form-item",{attrs:{label:"科目编码：",prop:"expense_category_code",rules:{required:!0,message:"请输入科目编码",trigger:["blur"]}}},[e("el-input",{attrs:{placeholder:"请输入",maxlength:30},on:{input:e=>{t.expense_category_code=e.replace(/[^.\d]/g,"")}},model:{value:t.expense_category_code,callback:e=>{this.$set(t,"expense_category_code",e)}}})]),e("el-form-item",{attrs:{label:"科目名称：",prop:"expense_category_name",rules:{required:!0,message:"请输入科目名称",trigger:["blur"]}}},[e("el-input",{attrs:{maxlength:15,placeholder:"请输入 (限15字)"},model:{value:t.expense_category_name,callback:e=>{this.$set(t,"expense_category_name",e)}}})]),e("el-form-item",{attrs:{label:"状态：",prop:"is_active",rules:{required:!0,message:"请选择状态",trigger:["blur"]}}},[e("el-radio",{attrs:{label:!0},model:{value:t.is_active,callback:e=>{this.$set(t,"is_active",e)}}},["启用"]),e("el-radio",{attrs:{label:!1},model:{value:t.is_active,callback:e=>{this.$set(t,"is_active",e)}}},["停用"])])])])}}),x=k,w=a(1001),C=(0,w.Z)(x,l,n,!1,null,"8691dc24",null),$=C.exports,S=a(43773),T=(0,s.defineComponent)({setup:(e,t)=>{const a=(0,s.ref)(null),r=(0,s.ref)({is_active:!0,is_allocated:!1}),o=(0,b.Q)(f.SL,{manual:!0,onSuccess:(e,a)=>{t.root.$message.success(a.message??"保存成功")},onError:e=>{t.root.$message.error(e??"保存失败")}}),l=(0,b.h)(f.f8,{defaultPageSize:1e4,manual:!0}),n=(0,S.R)({component:$,width:"370px",title:"新增会计科目",on:{submit:l.reload}}),i=e=>{if(l.reload(),void 0===e)r.value={is_active:!0,is_allocated:!1};else{const{is_allocated:t,...a}=e;r.value={is_allocated:!!t,...a}}},c=()=>{a.value?.validate((async e=>{e&&(console.log("form.value",r.value),await o.runAsync(r.value),t.emit("close"),t.emit("submit"))}))};return{formRef:a,show:i,dialogSubmit:c,form:r,reqListCategories:l,dialog:n}},render(){const e=arguments[0],t=this.form;return e("div",{class:"dialog-content mg-12"},[e("el-form",y()([{ref:"formRef"},{attrs:{model:t}},{attrs:{"label-width":"90px",size:"small","hide-required-asterisk":!0}}]),[e("el-form-item",{attrs:{label:"类别编码：",prop:"expense_type_biz_code",rules:{required:!0,message:"请输入支出类别",trigger:["blur"]}}},[e("el-input",{on:{input:e=>{t.expense_type_biz_code=e.replace(/[^.\d]/g,"")}},attrs:{placeholder:"请输入"},style:"width:216px",model:{value:t.expense_type_biz_code,callback:e=>{this.$set(t,"expense_type_biz_code",e)}}})]),e("el-form-item",{attrs:{label:"类别名称：",prop:"expense_type_name",rules:{required:!0,message:"请输入类别名称",trigger:["blur"]}}},[e("el-input",{attrs:{maxlength:15,placeholder:"请输入 (限15字)"},style:"width:216px",model:{value:t.expense_type_name,callback:e=>{this.$set(t,"expense_type_name",e)}}})]),e("el-form-item",{attrs:{label:"会计科目：",prop:"expense_category_code",rules:{required:!0,message:"请选择会计科目",trigger:["blur"]}}},[e("div",{class:"expense_category_code"},[e("el-select",{class:"mgr-12",style:"width:216px",attrs:{filterable:!0},model:{value:t.expense_category_code,callback:e=>{this.$set(t,"expense_category_code",e)}}},[this.reqListCategories.data?.filter((e=>e.is_active)).map(((t,a)=>e("el-option",{key:a,attrs:{value:t.expense_category_code,label:t.expense_category_name}})))]),e("tg-button",{attrs:{type:"link"},on:{click:()=>this.dialog.show()}},["新增"])])]),e("el-form-item",{attrs:{label:"是否分摊：",prop:"is_allocated",rules:{required:!0,message:"请选择是否分摊费用",trigger:["blur"]}}},[e("el-radio",{attrs:{label:!1},model:{value:t.is_allocated,callback:e=>{this.$set(t,"is_allocated",e)}}},["否"]),e("el-radio",{attrs:{label:!0},model:{value:t.is_allocated,callback:e=>{this.$set(t,"is_allocated",e)}}},["是"])]),e("el-form-item",{attrs:{label:"状态：",prop:"is_active",rules:{required:!0,message:"请选择状态",trigger:["blur"]}}},[e("el-radio",{attrs:{label:!0},model:{value:t.is_active,callback:e=>{this.$set(t,"is_active",e)}}},["启用"]),e("el-radio",{attrs:{label:!1},model:{value:t.is_active,callback:e=>{this.$set(t,"is_active",e)}}},["停用"])])])])}}),R=T,q=(0,w.Z)(R,i,c,!1,null,"2966bfd7",null),O=q.exports,j=a(82741),z=(0,s.defineComponent)({setup:(e,t)=>{const a=(0,b.h)(f.sR,{defaultPageSize:1e4}),r=(0,b.Q)(f.SL,{manual:!0,onSuccess:(e,a)=>{t.root.$message.success(a.message)},onError:e=>{t.root.$message.success(e)}}),o=(0,S.R)({component:O,width:"370px",okText:"保存",on:{submit:a.reload}}),l=async e=>{const t={...e,is_active:!e.is_active};await(0,j.u)(`确定要${e.is_active?"停用":"启用"}吗?`),r.runAsync(t).then(a.reload)},n=(0,s.ref)([{label:"支出类别代码",prop:"expense_type_biz_code",minWidth:100,align:"center"},{label:"支出类别",prop:"expense_type_name",minWidth:100,align:"left"},{label:"所属会计科目",prop:"expense_category_name",align:"left",showOverflowTooltip:!0,minWidth:250},{label:"状态",prop:"is_active",minWidth:88,align:"center",formatter:e=>e.is_active?"启用":"停用"},{label:"费用是否分摊",prop:"is_active",minWidth:100,align:"center",formatter:e=>e.is_allocated?"是":"否"},{label:"操作",minWidth:118,align:"center",prop:"is_active",formatter:e=>h("div",{class:"status-box"},[h("tg-button",{attrs:{type:"link"},class:"mgr-12",on:{click:()=>l(e)}},[e.is_active?"停用":"启用"]),h("tg-button",{attrs:{type:"link"},on:{click:()=>{o.update({title:"编辑支出类别"}).show(e)}}},["编辑"])])}]);return{columns:n,reqCategoriesData:a,dialog:o}},render(){const e=arguments[0];return e("div",{class:"spendingCategory"},[e("div",{class:"mgt-12 mgb-12"},[e("tg-button",{attrs:{type:"primary",icon:"ico-btn-add"},on:{click:()=>{this.dialog.update({title:"新增支出类别"}).show()}}},["新增类别"])]),e("div",{class:"content flex-fill mgb-12"},[e("tg-table",{attrs:{columns:this.columns,height:"100%",data:this.reqCategoriesData.data},directives:[{name:"loading",value:this.reqCategoriesData.loading}]})])])}}),D=z,E=(0,w.Z)(D,u,d,!1,null,"1a35f75a",null),P=E.exports,W=(0,s.defineComponent)({setup:(e,t)=>{const a=(0,b.h)(f.f8,{defaultPageSize:1e4}),r=(0,b.Q)(f.bO,{manual:!0,onSuccess:(e,a)=>{t.root.$message.success(a.message)},onError:e=>{t.root.$message.success(e)}}),o=(0,S.R)({component:$,width:"370px",okText:"保存",on:{submit:a.reload}}),l=async e=>{const t={...e,is_active:!e.is_active};await(0,j.u)(`确定要${e.is_active?"停用":"启用"}吗?`),console.log("para",t),r.runAsync(t).then(a.reload)},n=(0,s.ref)([{label:"编码",prop:"expense_category_code",minWidth:80,align:"center"},{label:"科目名称",prop:"expense_category_name",minWidth:100,align:"left"},{label:"支出类别",prop:"expense_types",align:"left",showOverflowTooltip:!0,minWidth:250},{label:"状态",prop:"is_active",minWidth:88,align:"center",formatter:e=>e.is_active?"启用":"停用"},{label:"操作",minWidth:118,align:"center",prop:"is_active",formatter:e=>h("div",{class:"status-box"},[h("tg-button",{attrs:{type:"link"},class:"mgr-12",on:{click:()=>l(e)}},[e.is_active?"停用":"启用"]),h("tg-button",{attrs:{type:"link"},on:{click:()=>{o.update({title:"编辑会计科目"}).show(e)}}},["编辑"])])}]);return{columns:n,reqCategoriesData:a,dialog:o}},render(){const e=arguments[0];return e("div",{class:"spendingCategory"},[e("div",{class:"mgt-12 mgb-12"},[e("tg-button",{attrs:{type:"primary",icon:"ico-btn-add"},on:{click:()=>{this.dialog.update({title:"新增会计科目"}).show()}}},["新增科目"])]),e("div",{class:"content flex-fill mgb-12"},[e("tg-table",{attrs:{columns:this.columns,height:"100%",data:this.reqCategoriesData.data},directives:[{name:"loading",value:this.reqCategoriesData.loading}]})])])}}),A=W,B=(0,w.Z)(A,p,g,!1,null,"a39ed600",null),Q=B.exports,Z=o({components:{spendingCategory:P,accountingSubjects:Q},setup(){const e=K();return{tabs:e}},render(){const e=arguments[0];return e("div",{class:"tg-page-container"},[e("tg-tabs",{attrs:{tabs:this.tabs.tabs,className:"flex-none"},on:{change:this.tabs.jump},model:{value:this.tabs.checkedTab,callback:e=>{this.$set(this.tabs,"checkedTab",e)}}}),e("div",{class:"flex-fill tg-card mgt-12 pdl-18 pdr-18"},[e(this.tabs.checkedTab)])])}});const K=()=>{const e=(0,v.t)(),t=e.currentRoute.params.type,{tabs:a,checkedTab:o}=(0,m.pK)([{label:"会计科目",value:"accountingSubjects"},{label:"支出类别",value:"spendingCategory"}],t);void 0===e.currentRoute.params.type&&e.replace({name:r.Ny.spendingCategory,params:{type:o.value}});const l=t=>{e.push({name:r.Ny.spendingCategory,params:{type:t.value}})};return(0,s.reactive)({tabs:a.value,checkedTab:o,jump:l})}},43773:function(e,t,a){a.d(t,{R:function(){return p},y:function(){return g}});var s=a(36568),r=a.n(s),o=a(97434),l=a(64923),n=a(77944);let i=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+i++,document.body.appendChild(e),e},u=new Function,d=(e,t)=>{let a=e;return void 0===a&&(a={}),Object.keys(t).forEach((e=>{const s=a[e]||u,r=t[e];a[e]=(...e)=>{if(!1!==r(...e))return s(...e)}})),a},p=(e={})=>{const t=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,o.ref)(!0),i=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};i(e);const u=(0,o.ref)(d(e.on,{close(){a.visible=!1},updateDialog(e={}){i(e)}})),p=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,o.provide)(t,e.provide[t])}))},render(t){if(s.value&&a.visible)return t("el-dialog",r()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value}),a.footer&&t("fragments",{slot:"footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const g=(...e)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},m=e=>(i(e),b),v=()=>{a.visible=!1},f=(e,t,a=!1)=>(!0===a?u.value[e]=t:d(u.value,{[e]:t}),b);(0,o.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const b=(0,o.reactive)({show:g,update:m,on:f,close:v,config:e,data:e.data});return b},g=(e={})=>{const t=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,o.ref)(!0),i=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};i(e);const u=(0,o.ref)(d(e.on,{close(){a.visible=!1},updateDialog(e={}){i(e)}})),p=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,o.provide)(t,e.provide[t])}))},render(t){if(!s.value)return;if(!a.visible)return;const{width:o,...l}=a;return t("el-drawer",r()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...l,size:o}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[t("div",{class:"tg-drawer-content"},[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value})]),a.footer&&t("div",{class:"tg-drawer-footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:p}},[a.okText])])])}});const g=(...e)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},m=e=>(i(e),b),v=()=>{a.visible=!1},f=(e,t,a=!1)=>(!0===a?u.value[e]=t:d(u.value,{[e]:t}),b);(0,o.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const b=(0,o.reactive)({show:g,update:m,on:f,close:v,config:e});return b}}}]);