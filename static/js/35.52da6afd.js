"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[35],{86919:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"overview-switch"},[a("div",{class:["base",{active:0===e.index}],on:{click:function(t){return e.handleCheckBtn(0)}}},[a("tg-icon",{attrs:{name:"ico-list"}}),e._v("列表样式 ")],1),a("div",{class:["base",{active:1===e.index}],on:{click:function(t){return e.handleCheckBtn(1)}}},[a("tg-icon",{attrs:{name:"ico-chart"}}),e._v("图表样式 ")],1)])},s=[],n=a(97434),o=(0,n.defineComponent)({name:"OverviewTab",props:{index:{type:Number,default:0}},setup(e,t){const a=e=>{t.emit("checkATab",e)};return{handleCheckBtn:a}}}),l=o,r=a(1001),c=(0,r.Z)(l,i,s,!1,null,"1e6dd9b8",null),d=c.exports},15883:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ie}});var i,s,n,o,l,r,c=a(36568),d=a.n(c),p=a(97434),u=a(86919),h=a(11676),m=a(99575),v=a(59760),g=a(61282),f=(0,p.defineComponent)({setup(e,t){const a=(0,p.ref)(!1),i=(0,p.ref)(!1),s=(0,p.ref)(void 0),n={show(e){a.value=!0,s.value=e},onClose(){a.value=!1},beforeUpload(e){return(0,h.K)({image:!0,fileSize:2})(e)},successHandle(e){if(!0!==e.success)t.root.$message.error(e.message??"上传失败，稍后重试");else{const t=e.data.source;n.saveShopLiveScreenshot(t)}},async saveShopLiveScreenshot(e){const a=await(0,m.y2)(s.value?.id,e);a.data.success?(s.value&&(s.value.live_screenshot_url=e),t.root.$message.success(a.data.message??"上传成功")):t.root.$message.error(a.data.message??"上传失败，稍后重试")}};return{emptyGoods:v,liveModel:s,visible:a,loading:i,...n}},render(){const e=arguments[0],{visible:t,loading:a}=this;return e("div",{class:"live-screen-dialog-container"},[e("el-dialog",{attrs:{visible:t,title:"直播画面",width:"318px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{close:this.onClose},class:"tg-dialog-classic workbench-use-seal-dialog tg-dialog-vcenter-new"},[e("div",{class:"screen-body"},[e("el-image",{attrs:{src:(0,g.E)(this.liveModel?.live_screenshot_url),lazy:!0},class:"screen-img"},[e("template",{slot:"error"},[e("el-image",{attrs:{src:this.emptyGoods},style:"height: 120px; width: 120px; margin: 210px 0"})])]),e("tg-upload",{attrs:{action:"/api/resources/upload_file",data:{type:"shop_live_live_screenshot"},beforeUpload:this.beforeUpload,success:this.successHandle,"show-file-list":!1},class:"screen-upload"},[e("tg-button",{attrs:{size:"small",icon:"ico-btn-upload"}},["上传新图"])])])]),e("tg-mask-loading",{attrs:{visible:a&&t,content:"正在保存，请稍候..."}})])}}),_=f,y=a(1001),x=(0,y.Z)(_,i,s,!1,null,"63890cbe",null),b=x.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter",attrs:{width:"312px",visible:e.visiableSign,height:"400px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleCloseAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("标记变更")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{attrs:{type:"primary"},on:{click:e.handleSaveAction}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticStyle:{margin:"0px 8px 8px 8px"}},[a("el-checkbox-group",{model:{value:e.selectSigns,callback:function(t){e.selectSigns=t},expression:"selectSigns"}},e._l(e.formList,(function(t){return a("el-checkbox",{key:t.value,staticClass:"chance-checkbox",staticStyle:{height:"40px","line-height":"40px",color:"#3c5269","font-weight":"400"},attrs:{value:t.value,label:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)]),a("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"  正在保存，请稍候..."}})],1)},k=[],S=(0,p.defineComponent)({props:{list:{type:Array,default:()=>[]},visiableSign:{type:Boolean,default:!1},sessionId:{type:Number,default:0}},setup(e,t){const a=(0,p.ref)(!1),i=(0,p.ref)([]);i.value=[],e.list.map((e=>{i.value.push(e)}));const s=(0,p.ref)([{label:"硬装",value:1},{label:"灯光",value:2},{label:"机位",value:3},{label:"陈列",value:4},{label:"贴片",value:5},{label:"调色",value:6}]),n=()=>{t.emit("closeAction")},o=async()=>{const a=await(0,m.Be)({id:e.sessionId,change_tips:i.value||[]});a.data.success?(t.root.$message.success(a.data.message),t.emit("closeAction",!0)):t.root.$message.error(a.data.message)};return(0,p.watch)((()=>e.visiableSign),(()=>{e.visiableSign&&(i.value=[],e.list.map((e=>{i.value.push(e)})))})),{selectSigns:i,formList:s,saveLoading:a,handleSaveAction:o,handleCloseAction:n}}}),C=S,$=(0,y.Z)(C,w,k,!1,null,"6a20171e",null),D=$.exports,z=a(64236),A=a(6933),L=a.n(A),j=(0,p.defineComponent)({name:"crtList",components:{LiveScreen:b,SignDialog:D},setup(e,t){const a=(0,p.ref)(void 0),i=(0,p.ref)({num:20,page_num:1,total:0,project_id:void 0,dates:[],shift_id:void 0}),s=(0,p.ref)(!1),n=(0,p.ref)([]),o=(0,p.ref)([{label:"场次名称",minWidth:156,showOverflowTooltip:!0,formatter:e=>e.live_title?e.live_title:"--"},{label:"直播时间",align:"center",minWidth:292,formatter:e=>{if(e.live_start_time&&e.live_end_time){const t="yyyy.MM.DD HH:mm:ss",a=L()(1e3*e.live_start_time).format(t),i=L()(1e3*e.live_end_time).format(t),s=`${a} ~ ${i}`;return s}return"--"}},{label:"直播班次",minWidth:90,align:"center",showOverflowTooltip:!0,formatter:e=>e.shift_name},{label:"直播销售额 (元)",minWidth:120,align:"center",showOverflowTooltip:!0,formatter:e=>e.actual_gmv},{label:"直播间曝光人数",minWidth:118,align:"right",formatter:e=>(0,g.dN)(e.room_exposure_ucnt??0,"None",!0)},{label:"直播间进入人数",minWidth:118,align:"right",formatter:e=>(0,g.dN)(e.room_watch_ucnt??0,"None",!0)},{label:"进入率（人数）",minWidth:118,align:"right",formatter:e=>`${e.exposure_watch_ucnt_ratio}%`},{label:"直播间曝光人次",minWidth:118,align:"right",formatter:e=>(0,g.dN)(e.room_exposure_times??0,"None",!0)},{label:"直播间进入人次",minWidth:118,align:"right",formatter:e=>(0,g.dN)(e.room_watch_times??0,"None",!0)},{label:"进入率（人次）",minWidth:118,align:"right",formatter:e=>`${e.exposure_watch_times_ratio}%`},{label:"直播画面",align:"center",minWidth:118,formatter:e=>(0,p.h)("div",{class:"buttons-lines"},[(0,p.h)("tg-button",{props:{type:"link"},on:{click:()=>u.liveCheck(e)}},"查看"),(0,p.h)("tg-button",{props:{type:"link"},on:{click:()=>u.signChange(e)}},"标记变更")])}]),l=(0,p.ref)(!1),r=(0,p.ref)([]),c=(0,p.ref)(0),d={reload(e){const{dates:t,shift_id:a,project_id:s,page_num:n}=e,[o,l]=t;i.value=n?{...i.value,...e}:{...i.value,...e,page_num:1};const r={start_date:o,end_date:l,num:i.value.num,page_num:i.value.page_num,shift_id:a,project_id:s};u.queryCtrShopLive(r)}},u={liveCheck(e){a.value?.show?.(e)},async queryCtrShopLive(e){s.value=!0;const[a]=await(0,z.Dc)(500,(0,m.ji)(e));s.value=!1,a.data.success?(n.value=a.data.data.data,i.value.total=a.data.data.total):t.root.$message.error(a.data.message??"请求失败")},signChange(e){r.value=e.change_tips||[],c.value=e.id,console.log(e.id),l.value=!0},onHide(e=!1){l.value=!1,e&&d.reload(i.value)}};return{signList:r,signId:c,loading:s,isShowSignDialog:l,columns:o,tableData:n,liveScreenRef:a,paginationForm:i,...u,...d}},render(){const e=arguments[0];return e("div",{class:"crt-list-page-container"},[e("tg-table",d()([{directives:[{name:"loading",value:this.loading}],class:"ctr-table",attrs:{border:!0,stripe:!0,height:"calc(100% - 50px)"}},{attrs:{data:this.tableData}}]),[this.columns.map(((t,a)=>e("el-table-column",d()([{},{attrs:{...t}},{key:a}])))),e("template",{slot:"empty"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})])]),this.tableData.length>0&&e("el-pagination",{style:"margin: 8px 0;",class:"flex-none",attrs:{"current-page":this.paginationForm.page_num,"page-sizes":[20,30,50,100],pageSize:this.paginationForm.num,total:this.paginationForm.total,layout:"total, prev, pager, next, sizes, jumper"},on:{"current-change":e=>{this.paginationForm.page_num=e,this.reload(this.paginationForm)},"size-change":e=>{this.paginationForm.num=e,this.reload(this.paginationForm)}}}),e("live-screen",{ref:"liveScreenRef"}),e("sign-dialog",{attrs:{list:this.signList,sessionId:this.signId,visiableSign:this.isShowSignDialog},on:{closeAction:this.onHide}})])}}),H=j,F=(0,y.Z)(H,n,o,!1,null,"0e449e53",null),M=F.exports,N=(0,p.defineComponent)({setup(){const e={reload(e){console.log("month-reload",e)}},t={};return{...t,...e}},render(){const e=arguments[0];return e("div",{class:"month-trend-page-container"},["月度趋势"])}}),I=N,T=(0,y.Z)(I,l,r,!1,null,"75b21c4f",null),Z=T.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"345px",width:"100%"},attrs:{id:"trendChart"+e.index}},[e.date.length>0?a("base-echarts",{attrs:{options:e.baseOptions}}):a("Empty")],1)},E=[],R=a(32200),O=a(45781),W=a(99197),P=a(8136);const{tranNumber:q}=O.Z;var G,U,Q,J,K,V,X={components:{BaseEcharts:R.Z,Empty:W.Z},props:{loading:{type:Boolean,default:!1},date:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},originDataList:{type:Array,efault:()=>[]},legend:{type:Boolean,default:!0},color:{type:Array},percentage:{type:Boolean,default:!1},index:{type:Number,default:0}},data(){const e=this.index,t=this.originDataList,a=v;return{baseOptions:{grid:{left:73,right:73,top:10,bottom:84},tooltip:{trigger:"axis",backgroundColor:"#fff",padding:0,appendToBody:!0,position:function(t,a,i,s,n){const o=document.getElementById(`trendChart${e}`),l=window.innerHeight,r=o.getBoundingClientRect().top,c=n.viewSize[0],d=i.clientWidth,p=r+t[1]+i.clientHeight,u=l-p,h=u<0?u-24:0;return c/2>=t[0]?[t[0]+30,t[1]+h]:[t[0]-d-30,t[1]+h]},formatter:e=>{const i=({change_tip:e})=>{let t,a,i;switch(`${e}`){case"1":t="#556FF6",a="#556ff614",i="硬装";break;case"2":t="#00F7E9",a="#00f7e914",i="灯光";break;case"3":t="#FF6A39",a="#ff6a3914",i="机位";break;case"4":t="#FFBD00",a="#ffbd0014",i="陈列";break;case"5":t="#00CE59",a="#00ce5914",i="贴片";break;case"6":t="#FF6FCD",a="#ff6fcd14",i="调色";break;default:break}return{color:t,backgroundColor:a,text:i}},s=e=>{if(!e.live_start_time||!e.live_end_time)return"--";const t="yyyy.MM.DD HH:mm:ss",a=L()(1e3*e.live_start_time).format(t),i=L()(1e3*e.live_end_time).format(t);return[a,i]},n=e[0].dataIndex,o=t[n],l=o.change_tips??[],r=0===l.length?"--":l.map((e=>{const t=i(e),a=`<span style="margin-left: 4px;font-size: 12px;">(${e.username?e.username:""})</span>`;return`<span style="margin-left: 4px; background-color: ${t.backgroundColor}; color: ${t.color}; border-radius: 2px; padding: 2px 4px; font-size: 12px;">${t.text}</span>${e.username?a:""}`})).join(""),[c,d]=s(o),p=`<div style="padding: 18px">\n              <div style="display:flex;">\n                <div>场次时间:&nbsp;</div>\n                <div>\n                  <div>${c} ～</div>\n                  <div>${d}</div>\n                </div>\n              </div>\n              <div style="display: grid; grid-template-columns: repeat(2, auto); column-gap: 12px; row-gap: 8px; font-weight: 500; margin-top: 16px;">\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">曝光人数: </span>\n\n                  <span style="font-size: 12px; color: #19232D;">${(0,g.dN)(o.room_exposure_ucnt??0,"None",!0)}</span>\n                </div>\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">曝光人次: </span>\n                  <span style="font-size: 12px; color: #19232D;">${(0,g.dN)(o.room_exposure_times??0,"None",!0)}</span>\n                </div>\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">进入人数: </span>\n                  <span style="font-size: 12px; color: #19232D;">${(0,g.dN)(o.room_watch_ucnt??0,"None",!0)}</span>\n                </div>\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">进入人次: </span>\n                  <span style="font-size: 12px; color: #19232D;">${(0,g.dN)(o.room_watch_times??0,"None",!0)}</span>\n                </div>\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">进入率(人数): </span>\n                  <span style="font-size: 12px; color: #19232D;">${o.exposure_watch_ucnt_ratio}%</span>\n                </div>\n                <div style="height: 16px; line-height: 16px;">\n                  <span style="font-size: 12px; color: #606974;">进入率(人次): </span>\n                  <span style="font-size: 12px; color: #19232D;">${o.exposure_watch_times_ratio}%</span>\n                </div>\n              </div>\n              <div style="height: 1px; border-top: 1px dashed rgba(164,178,194,0.30); margin: 12px 0;"></div>\n              <div style="font-size: 12; font-weight: 400;">\n                <span style="color: #606974;">变更信息: </span>\n                <div style="width:320px; display: flex;align-items: center;flex-wrap: wrap;margin-top:5px;">\n                  ${r}\n                </div>\n              </div>\n              <div style="margin-top: 16px; width: 320px; height: 505px; display: flex; align-items: center; justify-content: center; background-color: #F5F9FC;">\n                <img src="${(0,g.E)(o.live_screenshot_url)}" style="width: 100%; height: 100%; object-fit: contain; display: ${o.live_screenshot_url?void 0:"none"}"/>\n                <img src="${a}" style="width: 160px; height: 160px; display: ${o.live_screenshot_url?"none":void 0}"/>\n              </div>\n            </div>`;return p},textStyle:{color:"#343F4C",fontSize:14,fontWeight:"bold"},extraCssText:"box-shadow: 1px 2px 8px 0px rgba(0, 0, 0, 0.26);"},legend:{show:this.legend,bottom:26,left:"153"},xAxis:{type:"category",data:[],axisLine:{lineStyle:{color:"rgba(52,63,76,0.30)"}},axisTick:{lineStyle:{opacity:0}},axisLabel:{color:"#606974",fontSize:11},splitLine:{show:!1}},color:this.color?this.color:P.nA,yAxis:[{type:"value",scale:!0,nameTextStyle:{color:"#666",fontSize:14},min:0,splitLine:{show:!0,lineStyle:{color:["#eee"],type:"dashed"}},axisTick:{lineStyle:{opacity:0}},axisLabel:{color:"#606974",formatter:(...e)=>{const t=q(...e);return!0===this.percentage?`${e[0]}%`:t}},axisLine:{lineStyle:{type:"solid",color:"rgba(52,63,76,0.30)",width:"1"}}}],series:[]}}},created(){this.init()},watch:{date:{handler(){this.init()},deep:!0},list:{handler(){this.init()},deep:!0}},methods:{init(){const e=JSON.parse(JSON.stringify(this.list));for(let t=0;t<e.length;t++)for(let a=0;a<e[t].data.length;a++)e[t].data[a]||(e[t].data[a]=0);this.baseOptions.xAxis.data=this.date,this.baseOptions.series=e}}},Y=X,ee=(0,y.Z)(Y,B,E,!1,null,null,null),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter",attrs:{visible:e.visiable,"append-to-body":"","close-on-click-modal":!1},on:{close:e.handleCloseAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("场景对比")]},proxy:!0}])},[a("div",{staticClass:"news-body"},[e._l(e.formList,(function(t,i){return[a("div",{key:i,staticClass:"select-item",attrs:{size:"medium"}},[a("el-image",{attrs:{src:e.imgTokenUrl(t.live_screenshot_url),lazy:""},scopedSlots:e._u([{key:"error",fn:function(){return[a("el-image",{staticStyle:{height:"120px",width:"120px",margin:"180px 80px"},attrs:{src:e.emptyGoods}})]},proxy:!0}],null,!0)}),a("div",{staticClass:"title"},[e._v(e._s(e.gettimeStr(t.live_start_time,t.live_end_time)))]),a("div",[e._v(" 进入率（人数）："),a("span",[e._v(e._s(t.exposure_watch_ucnt_ratio)+"%")])]),a("div",[e._v(" 进入率（人次）："),a("span",[e._v(e._s(t.exposure_watch_times_ratio)+"%")])]),t.change_tips&&t.change_tips.length>0?a("div",{staticClass:"change"},[e._v(" 变更信息："),t.change_tips.includes(1)?a("span",{staticClass:"yingzhuang"},[e._v("硬装")]):e._e(),t.change_tips.includes(2)?a("span",{staticClass:"dengguang"},[e._v("灯光")]):e._e(),t.change_tips.includes(3)?a("span",{staticClass:"jiwei"},[e._v("机位")]):e._e(),t.change_tips.includes(4)?a("span",{staticClass:"chenlie"},[e._v("陈列")]):e._e(),t.change_tips.includes(5)?a("span",{staticClass:"tiepian"},[e._v("贴片")]):e._e(),t.change_tips.includes(6)?a("span",{staticClass:"tiaose"},[e._v("调色")]):e._e()]):a("div",{staticClass:"change"},[e._v("变更信息：--")])],1)]})),e.formList.length<1?a("div",{staticStyle:{margin:"auto 20px"}},[a("empty-common")],1):e._e()],2)])],1)},ie=[],se=(0,p.defineComponent)({props:{list:{type:Array,default:()=>[]},visiable:{type:Boolean,default:!1}},setup(e,t){const a=(0,p.ref)(e.list||[]),i=()=>{t.emit("closeAction")};(0,p.watch)((()=>e.visiable),(()=>{e.visiable&&(a.value=[],e.list.map((e=>{a.value.push(e)})))}));const s=(e,t)=>{if(e&&t){const a=L()(1e3*e),i=L()(1e3*t);return a.format("yyyy.MM.DD HH:mm:ss")+" ~ "+i.format("yyyy.MM.DD HH:mm:ss")}return"--"};return{imgTokenUrl:g.E,gettimeStr:s,handleCloseAction:i,formList:a,emptyGoods:v}}}),ne=se,oe=(0,y.Z)(ne,ae,ie,!1,null,"6794ce05",null),le=oe.exports,re=a(91907),ce=a(14587),de=a(23168),pe=a(99933),ue=a(759),he=a(24183),me=a(59141),ve=(0,p.defineComponent)({components:{displayTrendChart:te,SceneContrast:le,ChangeTip:re.Z},setup(e,t){const a={reload(e){const[t,a]=e.dates,i={project_id:e.project_id,shift_id:e.shift_id,start_date:t,end_date:a};l.queryShiftGroupCtrShopLive(i)}},i=(0,p.ref)([]),s=(0,p.ref)(!1),n=(0,p.ref)(!1),o=(0,p.ref)([]),l={sessionClick(e){s.value=!0,o.value=i.value[e].shop_live_list},onHide(){s.value=!1},async queryShiftGroupCtrShopLive(e){n.value=!0;const[a]=await(0,z.Dc)(300,(0,m._d)(e));n.value=!1,a.data.success?i.value=a.data.data:t.root.$message.error(a.data.message??"请求失败，请稍后重试")}},r=[ce,de,pe,ue,he,me],c=e=>{const t=[];return(e.shop_live_list??[]).forEach(((e,a)=>{(e.change_tips??[]).forEach(((e,i)=>{t.push({coord:[a,0],name:`${e.change_tip}`,value:e.change_tip,symbolOffset:[0,-10*i-7],symbol:`image://${r[e.change_tip-1]}`})}))})),t.reverse()};return{tipsData:c,...c,selectRow:o,loading:n,chartData:i,isShowDialog:s,...l,...a}},render(){const e=arguments[0];return e("div",{class:"display-trend-page-container",directives:[{name:"loading",value:this.loading}]},[this.chartData.map(((t,a)=>e("div",{class:"chat-container",style:0===a?"":"margin-top: 24px;",key:`${L()().milliseconds()}-${t.shift_id}-${a}`},[e("div",{style:"padding: 24px 30px 0"},[e("span",{style:"font-weight: 600;"},[t.shift_name]),e("tg-button",{style:"margin-left: 10px; font-size: 12px",attrs:{type:"link"},on:{click:()=>{this.sessionClick(a)}}},["场景对比"])]),e(te,{attrs:{index:a,percentage:!0,originDataList:t.shop_live_list??[],date:(t.shop_live_list??[]).map((e=>{const t=L()(1e3*(e.live_start_time??0)).format("MM.DD");return t})),list:[{name:"进入率 (人数)",type:"line",smooth:!0,data:(t.shop_live_list??[]).map((e=>e.exposure_watch_ucnt_ratio)),markPoint:{symbolSize:[12,17],label:{show:!1},data:this.tipsData(t)}},{name:"进入率 (人次)",type:"line",smooth:!0,data:(t.shop_live_list??[]).map((e=>e.exposure_watch_times_ratio)),markPoint:{symbolSize:[12,17],label:{show:!1},data:this.tipsData(t)}}]},style:"margin-top: 24px;"}),(t.shop_live_list??[]).length>0&&e("change-tip",{style:"position: absolute; left: 400px; bottom: 30px;"})]))),0===this.chartData.length&&e("div",{class:"chart-empty"},[e("empty-common",{attrs:{"detial-text":"暂无数据"}})]),e("scene-contrast",{attrs:{list:this.selectRow,visiable:this.isShowDialog},on:{closeAction:this.onHide}})])}}),ge=ve,fe=(0,y.Z)(ge,G,U,!1,null,"294c1fc4",null),_e=fe.exports,ye=(0,p.defineComponent)({name:"crtChart",components:{monthTrend:Z,displayTrend:_e},setup(){const e=(0,p.ref)(0),t=(0,p.ref)(void 0),a={reload(e){t.value?.reload?.(e)}},i={onSwitch(t){e.value=t}};return{chartRef:t,currentIndex:e,...i,...a}},render(){const e=arguments[0];return e("div",{class:"tg-crt-chart-page-container"},[e(_e,{ref:"chartRef"})])}}),xe=ye,be=(0,y.Z)(xe,Q,J,!1,null,"7e5933c2",null),we=be.exports,ke=a(74750),Se=a(42963),Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"customer-dialog tg-dialog-vcenter",attrs:{width:"532px",visible:e.visiable,height:"400px","append-to-body":"","close-on-click-modal":!1},on:{close:e.handleCloseAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("班次管理")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.handleCloseAction}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.handleSaveAction}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"news-body"},[a("div",[a("div",{staticClass:"header-title"},[a("tg-icon",{attrs:{name:"ico-warn"}}),e._v("班次管理以开播时间为准，开播时间没有在指定班次时间内的场次统一计未其他班次 ")],1),a("div",{staticStyle:{"margin-top":"6px","margin-bottom":"16px"}},[a("div",{staticClass:"title-item"},[a("div",{staticStyle:{width:"176px"}},[e._v("班次")]),a("div",{staticStyle:{width:"264px","margin-left":"20px"}},[e._v("开播时间")])]),e._l(e.formList,(function(t,i){return[a("div",{key:i,staticClass:"select-item",attrs:{size:"medium"}},[a("div",[a("el-input",{attrs:{placeholder:"请输入班次名称"},model:{value:t.shift_name,callback:function(a){e.$set(t,"shift_name",a)},expression:"item.shift_name"}})],1),a("div",{staticStyle:{width:"264px","margin-left":"20px",border:"1px solid rgba(164, 178, 194, 0.5)","border-radius":"2px"}},[a("el-time-picker",{attrs:{"popper-class":"tpc",editable:!1,clearable:!1,placeholder:"开始时间",format:"HH","value-format":"HH","picker-options":{start:"00:00",step:"01:00",end:"23:00"}},model:{value:t.dates[0],callback:function(a){e.$set(t.dates,0,a)},expression:"item.dates[0]"}}),a("span",{staticClass:"date-picker-separator"},[e._v("~")]),a("el-time-picker",{staticClass:"noshowtime",attrs:{"popper-class":"tpc",editable:!1,clearable:!1,type:"date",placeholder:"结束时间",format:"HH","value-format":"HH"},model:{value:t.dates[1],callback:function(a){e.$set(t.dates,1,a)},expression:"item.dates[1]"}})],1),e.formList.length>1?a("i",{staticClass:"el-input__icon el-icon-delete",on:{click:function(t){return e.deleteClick(i)}}}):e._e()])]}))],2)]),a("tg-button",{staticStyle:{"margin-left":"24px","margin-bottom":"24px"},attrs:{icon:"ico-btn-add",type:"primary"},on:{click:e.AddShiftItem}},[e._v("增加班次")])],1)]),a("tg-mask-loading",{attrs:{visible:e.saveLoading,content:"  正在保存，请稍候..."}})],1)},$e=[],De=(0,p.defineComponent)({props:{list:{type:Array,default:()=>[]},visiable:{type:Boolean,default:!1}},setup(e,t){const a=(0,p.ref)(!1),i=(0,p.ref)([]);e.list.map((e=>{i.value.push({shift_id:e.shift_id||"",shift_name:e.shift_name,dates:[e.shift_start_time,e.shift_end_time]})})),i.value=i.value.length<1?[{shift_name:"",dates:["",""]}]:i.value;const s=()=>{t.emit("closeAction")},n=async()=>{const a=(0,p.ref)([]),s=(0,p.ref)(!0);if(console.log(e.list),i.value.map((e=>{e.shift_name&&e.dates?a.value.push({shift_id:e.shift_id||void 0,shift_name:e.shift_name,shift_start_time:String(e.dates[0]).length<3?e.dates[0]+":00:00":e.dates[0],shift_end_time:String(e.dates[1]).length<3?e.dates[1]+":00:00":e.dates[1]}):s.value=!1})),s.value){const e=await(0,m.p4)({shifts:a.value||[]});e.data.success?(t.root.$message.success(e.data.message),t.emit("closeAction",!0)):t.root.$message.error(e.data.message)}else t.root.$message.warning("请将班次数据完善完整！！！")},o=()=>{const e=i.value;e.push({shift_name:"",dates:["",""]}),i.value=e},l=e=>{const t=i.value;t.splice(e,1),i.value=t};return(0,p.watch)((()=>e.visiable),(()=>{e.visiable&&(i.value=[],e.list.map((e=>{i.value.push({shift_id:e.shift_id||"",shift_name:e.shift_name,dates:[e.shift_start_time,e.shift_end_time]})})),i.value=i.value.length<1?[{shift_name:"",dates:["",""]}]:i.value)})),{deleteClick:l,AddShiftItem:o,formList:i,saveLoading:a,handleSaveAction:n,handleCloseAction:s}}}),ze=De,Ae=(0,y.Z)(ze,Ce,$e,!1,null,"63460e36",null),Le=Ae.exports,je=a(1763),He=a(44928),Fe=(0,p.defineComponent)({components:{styleSwitch:u.Z,ctrList:M,ctrChart:we,shiftSetting:Le},setup(e,t){const a=(0,He.t)(),i=a.currentRoute.params.id,s=()=>{const e="yyyy-MM-DD",t=L()().subtract(1,"days"),a=t.clone().subtract(6,"days");return{project_id:i?parseInt(i,10):void 0,dates:[a.format(e),t.format(e)],shift_id:void 0}},n=(0,p.ref)(s()),o=(0,p.ref)([]),l=(0,p.ref)(0),r=(0,p.ref)(void 0),c=(0,p.ref)(!1),d=(0,p.ref)([]),u={onQuery(){r.value?.reload?.(n.value)},onSwitch(e){l.value=e,(0,p.nextTick)((()=>{r.value?.reload?.(n.value)}))},async getShiftInfo(){const e=await(0,m.yD)();e.data.success&&(o.value=e.data.data)},onShift(){c.value=!0},async onHide(e=!1){e&&(await u.getShiftInfo(),r.value?.reload?.(n.value)),c.value=!1},async queryCTRProjects(){const e=await(0,m.gV)();e.data.success&&(d.value=e.data.data)},onProjectChange(e){t.root.$router.replace({params:{id:`${e}`}})},exportQuick(){const e={start_date:n.value.dates[0],end_date:n.value.dates[1],project_id:n.value.project_id,shift_id:n.value.shift_id},t=Se.stringify({...(0,z.jG)(e)}),a=(0,ke.LP)();console.log(t,"ppp"),window.open(`https://data.goumee.com/api/shop_live/query_ctr_shop_live/export?${t}&Authorization=${a}`)}};console.log(n.value,"vale");const h=[{name:je.xx.ctrDataAnalysis,title:"CTR数据分析"},{path:"",title:"项目明细"}];(0,p.onBeforeMount)((()=>{u.getShiftInfo(),u.queryCTRProjects()})),(0,p.onMounted)((()=>{(0,p.nextTick)((()=>{r.value?.reload?.(n.value)}))}));const v=(0,p.ref)(void 0),g={onPick({maxDate:e,minDate:t}){v.value=e?void 0:t},disabledDate(e){if(!v.value)return!1;const t=L()(v.value),a=L()(e),i=t.clone().subtract(29,"day"),s=t.clone().add(29,"day");return!(!a.isBefore(i)&&!a.isAfter(s))}};return{projectList:d,routes:h,shouldShiftSetting:c,ctrRef:r,formData:n,shiftInfo:o,currentIndex:l,dayPickerOptions:g,pickDate:v,...u}},render(){const e=arguments[0],{projectList:t}=this;return e("div",{class:"datacenter-ctr-detail-page-container"},[e("tgBreadcrumbs",{attrs:{routes:this.routes}}),e("div",{class:"query-container"},[e("el-form",d()([{attrs:{"label-width":"70px",size:"small"}},{props:{model:this.formData}},{class:"query-form"}]),[e("el-form-item",{attrs:{label:"项目名称："}},[e("el-select",{attrs:{filterable:!0,placeholder:"请输入并选择项目"},style:"width: 100%;",on:{change:this.onProjectChange},model:{value:this.formData.project_id,callback:e=>{this.$set(this.formData,"project_id",e)}}},[t.map((t=>e("el-option",{attrs:{label:t.project_name,value:t.project_id},key:t.project_id})))])]),e("el-form-item",{attrs:{label:"查询日期："}},[e("el-date-picker",{attrs:{clearable:!1,editable:!1,type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy.MM.dd","value-format":"yyyy-MM-dd",pickerOptions:this.dayPickerOptions},style:"width: 100%;",on:{blur:()=>{this.pickDate=void 0}},model:{value:this.formData.dates,callback:e=>{this.$set(this.formData,"dates",e)}}})]),e("el-form-item",{attrs:{label:"选择班次："}},[e("el-select",{style:"width: 100%;",model:{value:this.formData.shift_id,callback:e=>{this.$set(this.formData,"shift_id",e)}}},[e("el-option",{attrs:{label:"全部",value:void 0},key:-1}),this.shiftInfo.map(((t,a)=>e("el-option",{attrs:{label:t.shift_name,value:t.shift_id},key:t.shift_id}))),e("el-option",{attrs:{label:"其他",value:0},key:-2})])]),e("el-form-item",{attrs:{"label-width":"0px"}},[e("tg-button",{attrs:{type:"primary"},on:{click:this.onQuery}},["查询"])])])]),e("div",{class:"style-switch-container mgt-12",attrs:{"border-bottom":0!==this.currentIndex}},[e("div",{class:"lt-box"},[e("tg-button",{attrs:{type:"primary"},on:{click:this.onShift}},["班次设置"]),e("tg-button",{class:"mgl-12",attrs:{icon:"ico-btn-export",type:"default"},on:{click:this.exportQuick}},["导出"])]),e(u.Z,{attrs:{index:this.currentIndex},on:{checkATab:this.onSwitch}})]),e("div",{class:0===this.currentIndex?"ctr-data-container":"ctr-data-container chart"},[0===this.currentIndex?e(M,{ref:"ctrRef"}):e(we,{ref:"ctrRef"})]),e(Le,{attrs:{visiable:this.shouldShiftSetting,list:this.shiftInfo},on:{closeAction:this.onHide}})])}}),Me=Fe,Ne=(0,y.Z)(Me,K,V,!1,null,"d094359a",null),Ie=Ne.exports},11676:function(e,t,a){a.d(t,{K:function(){return p}});a(26699);var i=a(48606);const s=[".pdf",".doc",".docx",".ppt",".pptx"],n=[".mp4"],o=[".png",".jpg",".jpeg"],l=[".xls",".xlsx",".csv"],r=[".doc",".docx"],c=[".pdf"],d=[".csv"],p=e=>t=>{const a=/(\.[^.]+)$/.exec(t.name);let p="";a&&(p=a[1]);const u=[];if(e.image&&u.push(...o),e.file&&u.push(...s),e.video&&u.push(...n),e.excel&&u.push(...l),e.pdf&&u.push(...c),e.doc&&u.push(...r),e.csv&&u.push(...d),e.extensions&&u.push(...e.extensions),u.length>0&&!u.includes(p))return i.Message.warning(`文件格式不正确，请使用 ${u.join(";")}`),!1;if(void 0!==e.fileSize){const a=t.size/1024/1024<e.fileSize;if(!a)return i.Message.warning(`文件不能超过${e.fileSize}MB!`),!1}return!0};t["Z"]={ValidationFileUpload:p}},44928:function(e,t,a){a.d(t,{t:function(){return s}});var i=a(86834);const s=()=>{const e=new Proxy({},{get(e,t){return Reflect.get(i.Z,t)}});return e}}}]);