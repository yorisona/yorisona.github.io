"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[8042],{60677:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-live-display-page"},[a("tg-card",{attrs:{padding:[18,18,6,18]},on:{"rect:update":e.onTopCardRectUpdate}},[a("el-form",{attrs:{size:"small","show-message":!1,"label-width":"70px"}},[a("div",{staticClass:"filter-form-div"},[a("div",{staticClass:"filter-form-item"},[a("el-form-item",{attrs:{label:"直播状态："}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.queryParams.live_status,callback:function(t){e.$set(e.queryParams,"live_status",t)},expression:"queryParams.live_status"}},e._l(e.liveStatusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"filter-form-item"},[a("el-form-item",{attrs:{label:"直播日期："}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",editable:!1,placeholder:"请选择直播日期","value-format":"yyyy-MM-dd"},model:{value:e.queryParams.live_start_date,callback:function(t){e.$set(e.queryParams,"live_start_date",t)},expression:"queryParams.live_start_date"}})],1)],1),a("div",{staticClass:"filter-form-item"},[a("el-form-item",{attrs:{label:"业务类型："}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.queryParams.business_type,callback:function(t){e.$set(e.queryParams,"business_type",t)},expression:"queryParams.business_type"}},e._l(e.businessTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"filter-form-item",staticStyle:{"min-width":"314px"}},[a("el-form-item",{attrs:{label:"直播搜索："}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"244px"},attrs:{type:"text",clearable:"",placeholder:"请输入关键词"},model:{value:e.queryParams.search_value,callback:function(t){e.$set(e.queryParams,"search_value","string"===typeof t?t.trim():t)},expression:"queryParams.search_value"}},[a("el-select",{staticClass:"live_search_type",staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.queryParams.search_type,callback:function(t){e.$set(e.queryParams,"search_type",t)},expression:"queryParams.search_type"}},e._l(e.searchTypeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("div",{staticClass:"filter-form-item"},[a("el-form-item",{attrs:{"label-width":"0"}},[a("div",{staticClass:"filter-form-item-btn"},[a("tg-button",{attrs:{type:"primary"},on:{click:e.handleQueryAction}},[e._v("查询")]),a("tg-button",{staticClass:"mgl-12",on:{click:e.handleResetAction}},[e._v("重置")])],1)])],1)])])],1),a("tg-card",e._b({staticClass:"live-display-content mgt-18 flex-auto",attrs:{padding:[18,18,0,18]},on:{"rect:update":e.onRectUpdate}},"tg-card",e.cardProps,!1),[e.Permission.canEdit?a("div",{staticClass:"add-live-display-btn"},[a("tg-button",{attrs:{type:"primary",size:"small",icon:"ico-btn-add"},on:{click:e.handleAddLiveDisplayAction}},[e._v("新增场次")])],1):e._e(),a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{stripe:"",data:e.list,"cell-style":{cursor:"pointer"}},on:{"row-click":e.jumpDetail},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂未添加直播场次"}})]},proxy:!0}])},"el-table",e.tableProps,!1),e._l(e.columns,(function(t,n){return a("el-table-column",e._b({key:n},"el-table-column",t,!1))})),1),e.Permission.canViewList&&e.total>0?a("el-pagination",{staticStyle:{margin:"8px 0"},attrs:{"current-page":e.queryParams.page_num,"page-sizes":[10,20,50,100],"page-size":e.queryParams.num,layout:"total, slot, prev, pager, next, sizes, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"page_num",t)},"update:current-page":function(t){return e.$set(e.queryParams,"page_num",t)},"current-change":e.handleCurrentChange,"size-change":e.handlePageSizeChange}}):e._e()],1),a("liveDisplayAddDialog",{attrs:{visible:e.shouldEditing},on:{succeed:e.handleSaveSucceedAction,closeAction:e.handleCloseAction}})],1)},r=[],l=a(1763),i=a(97434),s=a(66870),o=a(29625);const u=()=>{const e=(0,i.ref)([{label:"品牌名称",value:s.dr.brand_name??"--"},{label:"直播间",value:s.dr.studio_name},{label:"客户名称",value:s.dr.shop_name},{label:"项目编号",value:s.dr.project_uid},{label:"项目名称",value:s.dr.project_name},{label:"直播标题",value:s.dr.live_title},{label:"主播名称",value:s.dr.kol_name},{label:"运营助理",value:s.dr.operation_assistant_name}]),t=(0,i.ref)([{label:"全部",value:void 0},{label:"待排班",value:s.wG.waitingSchedule},{label:"待直播",value:s.wG.waitingLive},{label:"待录入",value:s.wG.waitingTypeIn},{label:"已直播",value:s.wG.lived}]),a=[{label:"全部",value:void 0},{label:"抖音店播",value:o.WD.douyin},{label:"淘宝店播",value:o.WD.taobao}],n=e=>{switch(e){case s.dr.brand_name:return"请输入品牌名称";case s.dr.studio_name:return"请输入直播间名称";case s.dr.shop_name:return"请输入客户名称";case s.dr.project_uid:return"请输入项目编号";case s.dr.live_title:return"请输入直播标题";case s.dr.kol_name:return"请输入主播名称";case s.dr.operation_assistant_name:return"请输入运营助理名称";default:return""}};return{searchTypeList:e,liveStatusList:t,businessTypeList:a,searchPlaceholder:n}};var c=a(3293),d=a(64236),p=a(61282),m=a(67910);const v=e=>{const t=(0,i.ref)(!1),a=(0,i.ref)(0),n=(0,i.ref)([]),r=async r=>{t.value=!0;const[{data:l}]=await(0,d.Dc)(500,(0,c.HU)(r));t.value=!1,l.success?(n.value=l.data.data,a.value=l.data.total):(n.value=[],a.value=0,e.root.$message.warning(l.message??"查询失败，稍后重试"))},u=(e,t)=>{if(!e||!t)return"";const a=`${e} ~ ${t}`;return a.replace(/-/g,".")},v=e=>{switch(e){case s.wG.lived:return"color: #A4B2C2";case s.wG.waitingLive:return"color: #02BA3C";default:return"color: #FF7A36"}},_=t=>{const{href:a}=e.root.$router.resolve({name:l.FB.project.detail,params:{id:`${t.project_id}`,type:"1",step:"2"}});window.open(a,"_blank")},h=(e,t)=>{const{is_folded:a,text:n,folded_text:r}=(0,p.zb)(e.live_title,12);return t||!a?r:(0,i.h)("el-popover",{props:{placement:"bottom",trigger:"hover",content:n}},[(0,i.h)("span",{slot:"reference"},[r])])},f=(0,m.zY)(n,"直播标题",h),g=e=>u(e.live_start_time,e.live_end_time),y=e=>e.brand_name?e.brand_name:"--",b=(0,m.zY)(n,"品牌",y),w=(e,t)=>{const{is_folded:a,folded_text:n}=(0,p.zb)(e.studio_name?e.studio_name:"--");return t?n:a?(0,i.h)("el-popover",{props:{placement:"top",trigger:"hover",content:e.studio_name}},[(0,i.h)("span",{slot:"reference"},[n])]):n},P=(0,m.zY)(n,"直播间",w),C=(0,i.computed)((()=>[{label:"直播标题",property:"live_title",minWidth:f.value,formatter:e=>h(e,!1)},{label:"直播时间",property:"live_start_time",minWidth:290,formatter:g},{label:"品牌",property:"brand_name",minWidth:b.value,formatter:y},{label:"直播间",property:"studio_name",minWidth:P.value,formatter:e=>w(e,!1)},{label:"项目信息",property:"project_uid",align:"left",minWidth:163,headerAlign:"left",formatter:e=>(0,i.h)("a",{class:"project-info",on:{click:t=>{_(e),t.stopPropagation()}}},[(0,i.h)("div",{class:"line-clamp-1"},e.project_name??"--"),(0,i.h)("div",{class:"line-clamp-1"},e.project_uid)])},{label:"业务类型",property:"business_type",align:"center",minWidth:80,headerAlign:"center",formatter:e=>(0,i.h)("span",o.Zb.get(e.business_type))},{label:"直播状态",property:"live_status",align:"left",headerAlign:"left",minWidth:80,formatter:e=>(0,i.h)("span",{style:v(e.live_status)},s.en.get(e.live_status))}]));return{columns:C,list:n,total:a,loading:t,loadData:r}};var _=a(45028),h=a(78902),f=a(21757),g=a(44928),y=a(43847),b=a(58302),w=(0,i.defineComponent)({name:"TgPublicStudio",components:{liveDisplayAddDialog:_.Z},setup(e,t){const a=(0,i.ref)(!1),n=(0,g.t)(),r="console_luru"===n.currentRoute.query.source,o=(0,y.Pc)(),c=(0,i.ref)({num:20,page_num:1,search_type:r?s.dr.operation_assistant_name:s.dr.brand_name,search_value:r?o.value.username:void 0,live_status:"console"===n.currentRoute.query.source?1:r?3:void 0,live_start_date:void 0,business_type:void 0}),d=v(t),p=e=>{t.root.$router.push({name:l.FB.display.detail,params:{liveId:`${e.id}`,id:`${e.project_id}`,tab:"live"}})},m=async(e=c.value.page_num,t=c.value.num,a=c.value.search_type,n=c.value.search_value,r=c.value.live_status,l=c.value.live_start_date,i=c.value.business_type)=>{const s={num:t,page_num:e,search_type:a,search_value:n,live_status:r,live_start_date:l,business_type:i};await d.loadData(s)},_=e=>{c.value.page_num=e,m(e)},w=e=>{c.value.num=e,m(c.value.page_num,e)},P=async()=>{c.value.page_num=1,await d.loadData(c.value)},C=()=>{c.value={num:c.value.num,page_num:1,search_type:s.dr.brand_name,search_value:void 0,live_status:void 0,live_start_date:void 0,business_type:void 0},P()},k=()=>{a.value=!0},x=()=>{a.value=!1},S=()=>{a.value=!1,m()};m();const q=(0,i.computed)((()=>{const e=(0,f.kG)(h.HN.live_display_view),t=(0,f.kG)(h.HN.live_display_save);return{canEdit:t,canViewList:e}})),j=32,A=34,$=36,Z=31,L=(0,i.ref)(0),z=e=>{L.value=e.height},D=(0,b.Z)({compensation:(0,i.computed)((()=>j+A+$+Z)),fixedBlockHeightRefs:[L],tableMinHeight:100});return{Permission:q,shouldEditing:a,...u(),...d,reload:m,queryParams:c,jumpDetail:p,handleCurrentChange:_,handlePageSizeChange:w,handleQueryAction:P,handleResetAction:C,handleAddLiveDisplayAction:k,handleCloseAction:x,handleSaveSucceedAction:S,onTopCardRectUpdate:z,...D}}}),P=w,C=a(1001),k=(0,C.Z)(P,n,r,!1,null,null,null),x=k.exports},47583:function(e,t,a){a.d(t,{Fy:function(){return o},S:function(){return l},U_:function(){return r},Yd:function(){return s},a$:function(){return i},js:function(){return u},uZ:function(){return c},xZ:function(){return d}});var n=a(76012);function r(e){return(0,n.ZP)({url:"/api/shop_live/end_project",method:"post",data:e})}function l(e){return(0,n.ZP)({url:"/api/shop_live/end_common_project",method:"post",data:e})}function i(e){return(0,n.ZP)({url:"/api/shop_live/update_project_try_live",method:"post",data:e})}function s(e){return(0,n.ZP)({url:"/api/medium/get_company_name_and_id",method:"get",params:e})}function o(e){return(0,n.ZP)({url:"/api/shop_live/update_area_execute",method:"post",data:e})}function u(e){return(0,n.ZP)({url:"/api/shop_live/save_kol_schedule",method:"post",data:e})}function c(e){return(0,n.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:e})}function d(e){return(0,n.ZP)({url:"/api/shop_live/save_operator_schedule",method:"post",data:e})}},66870:function(e,t,a){var n;a.d(t,{Ix:function(){return i},dr:function(){return l},en:function(){return r},wG:function(){return n}}),function(e){e[e["waitingSchedule"]=1]="waitingSchedule",e[e["waitingLive"]=2]="waitingLive",e[e["waitingTypeIn"]=3]="waitingTypeIn",e[e["lived"]=4]="lived"}(n||(n={}));const r=new Map([[n.waitingSchedule,"待排班"],[n.waitingLive,"待直播"],[n.waitingTypeIn,"待录入"],[n.lived,"已直播"]]);new Map([[n.waitingSchedule,"yellow"],[n.waitingLive,"green"],[n.waitingTypeIn,"yellow"],[n.lived,"gray"]]);var l,i;(function(e){e[e["brand_name"]=1]="brand_name",e[e["studio_name"]=2]="studio_name",e[e["shop_name"]=3]="shop_name",e[e["project_uid"]=4]="project_uid",e[e["live_title"]=5]="live_title",e[e["kol_name"]=6]="kol_name",e[e["operation_assistant_name"]=7]="operation_assistant_name",e[e["project_name"]=8]="project_name"})(l||(l={})),function(e){e[e["Month"]=1]="Month",e[e["Week"]=2]="Week"}(i||(i={}))},82741:function(e,t,a){a.d(t,{I:function(){return r},u:function(){return l}});var n=a(71340);const r=(e,t)=>{const a="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...a,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},l=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,a)=>{(0,n.t)({...t,onConfirm:()=>e(!0),onCancel:()=>a()})}))}},58302:function(e,t,a){var n=a(97434),r=a(77944),l=a(52140);const i=e=>{const t=(0,n.computed)((()=>r.Z.getters["global/scrollbarSetting"])),a=(0,n.computed)((()=>void 0!==e.pagename?!0!==t.value.find((t=>t.key===e.pagename))?.value:e.disable??!1)),i=(0,n.computed)((()=>{const t=(e.fixedBlockHeightRefs??[]).map((e=>(0,n.unref)(e))).reduce(((e,t)=>(0,n.unref)(e)+(0,n.unref)(t)),0);return a.value?"max-content":`calc(100vh - ${(0,n.unref)(t)+56+36}px)`})),s=(0,n.computed)((()=>(a.value,"flex-auto"))),o=(0,n.computed)((()=>({height:i.value,overflowInBody:!a.value}))),u=(0,n.ref)(0),c=(0,n.computed)((()=>a.value?{}:{height:Math.max(u.value-(0,n.unref)((0,n.unref)(e.compensation)),e.tableMinHeight??0)})),d=a.value?()=>{}:e=>{u.value!==e&&(u.value=e,(0,l.S)())},p=a.value?()=>{}:t=>{0===u.value?setTimeout((()=>{d(t.height)}),e.delay??1200):d(t.height)};return{cardHeight:i,tableProps:c,onRectUpdate:p,rectHeight:u,cardFlexClass:s,cardProps:o}};t["Z"]=i},44928:function(e,t,a){a.d(t,{t:function(){return r}});var n=a(86834);const r=()=>{const e=new Proxy({},{get(e,t){return Reflect.get(n.Z,t)}});return e}},43847:function(e,t,a){a.d(t,{Pc:function(){return i},oR:function(){return l}});var n=a(77944),r=a(97434);const l=()=>n.Z,i=()=>{const e=l(),t=(0,r.computed)((()=>e.getters["user/getUserInfo"]));return t}},52140:function(e,t,a){a.d(t,{S:function(){return n},n:function(){return r}});const n=()=>{const e=document.createEvent("Event");e.initEvent("resize",!0,!0),window.dispatchEvent(e)},r=()=>{const{width:e,height:t}=document.body.getBoundingClientRect();return{width:e,height:t}}},67910:function(e,t,a){a.d(t,{P6:function(){return o},zY:function(){return s}});var n=a(97434),r=a(61282),l=a(85937),i=a.n(l);const s=(e,t,a,l=20)=>(0,n.computed)((()=>Math.ceil(Math.max(...e.value.map((e=>(0,r.QN)(a(e,!0)))),(0,r.QN)(t)))+l+6)),o=(e,t=!0)=>{let a;return a=""===e||void 0===e?"--":(0,r.SJ)(new(i())(e??0)),t?(0,n.h)("span",[`￥${a}`]):(0,n.h)("span",[`${a}`])}}}]);