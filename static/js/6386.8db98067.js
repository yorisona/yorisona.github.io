"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[6386],{24522:function(e,t,a){a.d(t,{Z:function(){return d}});var s,i,n=a(97434),r=(0,n.defineComponent)({setup(){const e=(0,n.ref)(),t=t=>{e.value=t};return{dialogImage:e,show:t}},render(){const e=arguments[0];return e("div",{class:"dialog-wrapper"},[e("img",{attrs:{src:this.dialogImage}})])}}),o=r,l=a(1001),c=(0,l.Z)(o,s,i,!1,null,"060530ce",null),d=c.exports},16386:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});var s=a(97434),i=a(1763),n=a(6933),r=a.n(n),o=a(99575),l=a(59563),c=a(44928),d=a(74750),p=a(42963),u=a(64236),m=a(43773),g=a(24522),v=a(59760),y=a(24643);const f=(0,m.R)({component:g.Z,width:"700px",footer:!1}),_=[{name:i.xx.commodityAnalysis,title:"品牌商品分析"},{path:"",title:"预售商品分析"}],b=new Map([[-1,"全部"],[1,"全款预售"],[0,"现货发货"],[2,"阶梯发货"]]);var k,w,T=(0,s.defineComponent)({setup:()=>{const e=(0,c.t)(),{project_id:t,project_name:a}=e.currentRoute.query,i=(0,s.ref)({}),n=(0,s.ref)([]),m=(0,s.ref)([]),g=(0,s.ref)(1),_=(0,s.ref)(),k=(0,s.ref)(),w=(0,s.ref)(),T=(0,l.h)(o.mW,{defaultPageSize:10,manual:!0,onSuccess(e,{data:{project:t,statistics_data:a,items:s}}){i.value=t,n.value=a,m.value=s}}),x=()=>{T.runAsync({page_num:1,num:10},{project_id:t,start_date:_.value,end_date:k.value,pre_sale_type:w.value}).then((e=>{const t=e.data.data.statistics_data;(0,s.nextTick)((()=>{t.forEach((e=>{w.value===e.pre_sale_type&&A.value?.tableRef.setCurrentRow(e)}))}))}))},Y=[{label:"发货模式",prop:"pre_sale_type",align:"center",formatter:e=>b.get(e.pre_sale_type)},{label:"款数及占比",prop:"item_count_rate",headerAlign:"center",align:"center",minWidth:140,formatter:e=>{let t=e.item_count;null===t&&(t="--");let a=e.item_count_rate;return a=null===a?"--":`${(0,y.Y4)(a,2)}%`,h("span",{class:"item_count_rate_box"},[h("span",{class:"item_count"},[t]),h("span",["|"]),h("span",{class:"item_count_rate"},[a])])}},{label:"店铺销量",prop:"sale_count",headerAlign:"center",align:"right",dataType:"money",minWidth:150},{label:"店铺销售额 (元)",headerAlign:"center",prop:"gmv",minWidth:160,dataType:{type:"money",unit:100,toFixed:2},align:"right"},{label:"发货前退款销售额 (元)",prop:"shop_refund_status21_gmv",headerAlign:"center",minWidth:180,dataType:{type:"money",unit:100,toFixed:2},align:"right"},{label:"已发货销售额 (元)",prop:"sent_gmv",align:"right",minWidth:160,headerAlign:"center",dataType:{type:"money",unit:100,toFixed:2}},{label:"未发货销售额及占比",prop:"not_send_gmv_rate",headerAlign:"center",dataType:{suffix:"%"},minWidth:180,formatter:e=>{let t=e.not_send_gmv;t=null===t?"--":"￥"+(0,y.Y4)(t/100,2,".",",");let a=e.not_send_gmv_rate;return a=null===a?"--":`${(0,y.Y4)(a,2)}%`,h("span",{class:"item_count_rate_box"},[h("span",{class:"item_count"},[t]),h("span",["|"]),h("span",{class:"item_count_rate"},[a])])}}],D=[{label:"商品信息",minWidth:320,headerAlign:"center",formatter:e=>h("div",{class:"commodity-box"},[h("div",{class:"pic-box"},[h("el-image",{attrs:{fit:"contain",src:e.image_url?e.image_url:v},on:{click:()=>{f.show(e.image_url)}}})]),h("div",{class:"info-box"},[h("div",{class:"id-line"},[h("p",{class:"commodity-id"},[e.item_id])]),h("a",{attrs:{target:"_blank",href:`https://haohuo.jinritemai.com/views/product/item2?id=${e.item_id}`},class:"commodity-name"},[e.title]),h("p",{class:"code"},[e.item_sn?e.item_sn:"--"])])])},{label:"官方类目",minWidth:150,align:"center",formatter:e=>{const{first_tiange_cat:t,second_tiange_cat:a,third_tiange_cat:s}=e;return h("span",{class:"goods_code"},[t+"-"+a+"-"+s])}},{label:"发货模式",minWidth:80,align:"center",prop:"pre_sale_type",formatter:e=>b.get(e.pre_sale_type)},{label:"平均销售价 (元)",prop:"avg_price",minWidth:120,dataType:{type:"money",unit:100,toFixed:2},headerAlign:"center",align:"right"},{label:"点击率",align:"right",headerAlign:"center",prop:"click_rate",minWidth:80,dataType:{suffix:"%"}},{label:"转化率",align:"right",headerAlign:"center",prop:"pay_rate",minWidth:80,dataType:{suffix:"%"}},{label:"店铺销量",prop:"sale_count",dataType:"money",minWidth:80,headerAlign:"center",align:"right"},{label:"店铺销售额 (元)",prop:"gmv",minWidth:120,dataType:{type:"money",unit:100,toFixed:2},align:"right"},{label:"发货前退款销售额 (元)",minWidth:180,prop:"shop_refund_status21_gmv",align:"right",headerAlign:"center",dataType:{type:"money",unit:100,toFixed:2}},{label:"已发货销量",prop:"sent_sale_count",align:"right",headerAlign:"center",minWidth:100},{label:"已发货销售额 (元)",prop:"sent_gmv",align:"right",headerAlign:"center",dataType:{type:"money",unit:100,toFixed:2},minWidth:140},{label:"未发货销量",prop:"not_send_count",headerAlign:"center",align:"right",dataType:"money",minWidth:100},{label:"未发货销售额及占比",prop:"not_send_gmv_rate",dataType:{suffix:"%"},width:180,formatter:e=>{let t=e.not_send_gmv;t=null===t?"--":"￥"+(0,y.Y4)(t/100,2,".",",");let a=e.not_send_gmv_rate;return a=null===a?"--":`${(0,y.Y4)(a,2)}%`,h("span",{class:"item_count_rate_box",style:"grid-template-columns: 110px auto 63px;"},[h("span",{class:"item_count"},[t]),h("span",["|"]),h("span",{class:"item_count_rate"},[a])])}}],S=e=>{w.value=-1===e.pre_sale_type?void 0:e.pre_sale_type,x()},O=(e,t)=>{switch(e){case 1:case 3:case 7:case 15:case 30:_.value=r()().subtract(e,"days").startOf("day").format("YYYY-MM-DD"),k.value=r()().subtract(1,"days").endOf("day").format("YYYY-MM-DD"),g.value=e;break;case"day":_.value=r()(t).startOf("day").format("YYYY-MM-DD"),k.value=r()(t).endOf("day").format("YYYY-MM-DD"),g.value=e;break;case"week":_.value=r()(t).subtract(1,"days").startOf("day").format("YYYY-MM-DD"),k.value=r()(t).add(5,"days").endOf("day").format("YYYY-MM-DD"),g.value=e;break;case"month":_.value=r()(t).format("YYYY-MM-DD"),k.value=r()(t).endOf("month").format("YYYY-MM-DD"),g.value=e;break}x()},A=(0,s.ref)();O(1);const W=(0,s.reactive)({day:!1,week:!1,month:!1}),$=()=>{const e=T.params[1],t=p.stringify({...(0,u.jG)(e)}),a=(0,d.LP)();window.open(`https://data.goumee.com/api/shop_live/export_dp_shop_orders_presell_stat_day?${t}&Authorization=${a}`)};return(0,s.reactive)({reqShopOrders:T,project_name:a,columnsOverView:Y,columnsDetailed:D,query:x,dataOverView:n,dataDetailed:m,project_info:i,onRowClick:S,tableRef:A,dayType:g,popoverVisible:W,changeDayType:O,exportQuick:$})},render(){const e=arguments[0];return e("div",{class:"competitive-pre-sale"},[e("tg-breadcrumbs",{attrs:{routes:_}}),e("tg-card",{attrs:{padding:[18]}},[e("el-form",{class:"filter-form flex-form",attrs:{size:"small","show-message":!1,inline:!0}},[e("el-form-item",{attrs:{label:"项目名称："}},[e("el-select",{attrs:{disabled:!0,value:this.project_name}})])])]),e("tg-card",{class:"pre-sale-body mgt-12",attrs:{padding:[20,18,20,18]}},[e("div",{class:"filter-bar mgb-18"},[e("span",{class:"date"},[this.project_info.start_date===this.project_info.end_date?this.project_info.start_date:`${this.project_info.start_date} ～ ${this.project_info.end_date}`]),e("span",{class:"split"}),e("span",{class:"tips"},["数据更新于 ",this.project_info.update_date]),e("span",{class:"flex-fill"}),e("div",{class:"days"},[e("span",{class:1===this.dayType?"day active":"day",on:{click:()=>{this.changeDayType(1)}}},["近1天"]),e("span",{class:3===this.dayType?"day active":"day",on:{click:()=>{this.changeDayType(3)}}},["近3天"]),e("span",{class:7===this.dayType?"day active":"day",on:{click:()=>{this.changeDayType(7)}}},["近7天"]),e("span",{class:15===this.dayType?"day active":"day",on:{click:()=>{this.changeDayType(15)}}},["近15天"]),e("span",{class:30===this.dayType?"day active":"day",on:{click:()=>{this.changeDayType(30)}}},["近30天"]),e("el-popover",{attrs:{trigger:"click"},model:{value:this.popoverVisible.day,callback:e=>{this.$set(this.popoverVisible,"day",e)}}},[e("span",{slot:"reference",class:"day"===this.dayType?"day active":"day"},["自然日"]),e("el-date-picker",{attrs:{size:"small",placeholder:"选择一个自然日"},on:{input:e=>{this.changeDayType("day",e),this.popoverVisible.day=!1}}})]),e("el-popover",{attrs:{trigger:"click"},model:{value:this.popoverVisible.week,callback:e=>{this.$set(this.popoverVisible,"week",e)}}},[e("span",{slot:"reference",class:"week"===this.dayType?"day active":"day"},["自然周"]),e("el-date-picker",{attrs:{size:"small",placeholder:"选择一个自然周",format:"yyyy 第 WW 周",type:"week"},on:{input:e=>{this.changeDayType("week",e),this.popoverVisible.week=!1}}})]),e("el-popover",{attrs:{trigger:"click"},model:{value:this.popoverVisible.month,callback:e=>{this.$set(this.popoverVisible,"month",e)}}},[e("span",{slot:"reference",class:"month"===this.dayType?"day active":"day"},["自然月"]),e("el-date-picker",{attrs:{size:"small",placeholder:"选择一个自然月",type:"month"},on:{input:e=>{this.changeDayType("month",e),this.popoverVisible.month=!1}}})]),e("tg-button",{attrs:{icon:"ico-btn-export",size:"mini",type:"default"},class:"day",on:{click:this.exportQuick}},["导出"])])]),e("div",{class:"tilte-bar mgb-12"},[e("span",{class:"title"},["数据概览"]),e("span",{class:"split"}),e("span",["了解发货数据、提升运营效果"])]),e("div",{class:"table mgb-18"},[e("tg-table",{attrs:{border:!0,columns:this.columnsOverView,data:this.dataOverView,"highlight-current-row":!0},ref:"tableRef",on:{"row-click":this.onRowClick}})]),e("div",{class:"tilte-bar mgb-12"},[e("span",{class:"title"},["商品明细"])]),e("div",{class:"table table-detail"},[e("tg-table",{style:"width:100%",attrs:{border:!0,stripe:!0,columns:this.columnsDetailed,data:this.dataDetailed,pagination:this.reqShopOrders.pagination}})])])])}}),x=T,Y=a(1001),D=(0,Y.Z)(x,k,w,!1,null,"ae856106",null),S=D.exports},59563:function(e,t,a){a.d(t,{Q:function(){return n},h:function(){return r}});a(21703);var s=a(97434),i=a(48606);const n=(e,{manual:t,onError:a,onSuccess:n,defaultParams:r,transform:o}={})=>{const l=(0,s.ref)(),c=(0,s.ref)(),d=(0,s.ref)(!1),p=(0,s.ref)([]),u=()=>{h(...p.value)},h=(...t)=>Promise.resolve(t||r).then((()=>{d.value=!0})).then((()=>0===t.length&&r&&r.length>0?r:t)).then((e=>(p.value=e,e))).then((t=>e(...t))).then((e=>{if(!e.data.success)throw new Error(e.data.message);return l.value=o?o(e.data.data):e.data.data,n&&n(l.value,e.data),e})).then((()=>{d.value=!1})).catch((e=>{throw d.value=!1,c.value=e.message,a&&a(e),i.Message.error(e.message),e})),m=h;return t||h(...r||[]),(0,s.reactive)({data:l,error:c,loading:d,reload:u,run:h,runAsync:m,params:p})},r=(e,t={})=>{const{defaultPageSize:a=20,defaultParams:i=[],transform:r,...o}=t,l=(0,s.ref)(),c=(0,s.reactive)({total:0,page_num:1,page_size:a,onCurrentChange:e=>{const t=[...u.params];t[0]?t[0].page_num=e:t[0]={num:a,page_num:e},u.runAsync(...t).then((()=>{c.page_num=e}))},refresh:()=>c.onCurrentChange(1),reQuery(...e){const t=[];return u.params[0]?(t[0]=u.params[0],t[0].page_num=1,c.page_num=1):(t[0]={num:a,page_num:1},c.page_num=1),t.push(...e),u.runAsync(...t)}}),[d={num:a,page_num:1},...p]=i,u=n(e,{defaultParams:[d,...p],...o,onSuccess(e,a){l.value=r?r(e):e.data,c.total=e.total,t.onSuccess&&t.onSuccess(l.value,a)}}),{data:h,...m}=(0,s.toRefs)(u);return(0,s.reactive)({...m,data:l,pagination:c})}},44928:function(e,t,a){a.d(t,{t:function(){return i}});var s=a(86834);const i=()=>{const e=new Proxy({},{get(e,t){return Reflect.get(s.Z,t)}});return e}},43773:function(e,t,a){a.d(t,{R:function(){return u},y:function(){return h}});var s=a(36568),i=a.n(s),n=a(97434),r=a(64923),o=a(77944);let l=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+l++,document.body.appendChild(e),e},d=new Function,p=(e,t)=>{let a=e;return void 0===a&&(a={}),Object.keys(t).forEach((e=>{const s=a[e]||d,i=t[e];a[e]=(...e)=>{if(!1!==i(...e))return s(...e)}})),a},u=(e={})=>{const t=(0,n.ref)(),a=(0,n.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,n.ref)(!0),l=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};l(e);const d=(0,n.ref)(p(e.on,{close(){a.visible=!1},updateDialog(e={}){l(e)}})),u=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new r["default"]({el:c(),store:o.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,n.provide)(t,e.provide[t])}))},render(t){if(s.value&&a.visible)return t("el-dialog",i()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:d.value},{attrs:{isDialog:!0}}]),[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:d.value}),a.footer&&t("fragments",{slot:"footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{attrs:{type:"primary"},on:{click:u}},[a.okText])])])}});const h=(...e)=>{a.visible||(a.visible=!0,(0,n.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},m=e=>(l(e),y),g=()=>{a.visible=!1},v=(e,t,a=!1)=>(!0===a?d.value[e]=t:p(d.value,{[e]:t}),y);(0,n.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const y=(0,n.reactive)({show:h,update:m,on:v,close:g,config:e,data:e.data});return y},h=(e={})=>{const t=(0,n.ref)(),a=(0,n.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),s=(0,n.ref)(!0),l=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};l(e);const d=(0,n.ref)(p(e.on,{close(){a.visible=!1},updateDialog(e={}){l(e)}})),u=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new r["default"]({el:c(),store:o.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,n.provide)(t,e.provide[t])}))},render(t){if(!s.value)return;if(!a.visible)return;const{width:n,...r}=a;return t("el-drawer",i()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...r,size:n}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:d.value},{attrs:{isDialog:!0}}]),[t("div",{class:"tg-drawer-content"},[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:d.value})]),a.footer&&t("div",{class:"tg-drawer-footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:u}},[a.okText])])])}});const h=(...e)=>{a.visible||(a.visible=!0,(0,n.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},m=e=>(l(e),y),g=()=>{a.visible=!1},v=(e,t,a=!1)=>(!0===a?d.value[e]=t:p(d.value,{[e]:t}),y);(0,n.onUnmounted)((()=>{s.value=!1,a.visible=!1}));const y=(0,n.reactive)({show:h,update:m,on:v,close:g,config:e});return y}}}]);