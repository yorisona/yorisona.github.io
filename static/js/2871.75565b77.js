"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[2871],{62068:function(e,t,a){a.d(t,{Z:function(){return p}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{trigger:"hover","popper-class":"pop-receivable",placement:"bottom-end"}},[a("div",{staticClass:"pop-receivable-detail"},[a("div",{staticClass:"receivable-detail-content"},[a("div",{staticClass:"detail-header"},[e.showSettlementUid?a("div",{staticClass:"header column-width"},[e._v("结算单编号")]):e._e(),a("div",{staticClass:"header column-width"},[e._v(e._s(e.firstColumnHeader))]),a("div",{staticClass:"header right column-width"},[e._v("核销金额 (元)")]),a("div",{staticClass:"header column-width"},[e._v("核销人/日期")])]),a("div",{staticClass:"detail-body"},e._l(e.list,(function(t,i){return a("div",{key:i,staticClass:"body-row"},[e.showSettlementUid?a("div",{staticClass:"rg right column-width"},[a("span",[e._v(e._s(t.settlement_uid))])]):e._e(),"receivable"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(e._s(t.receipt_uid))])]):e._e(),"receive"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(e._s(t.receivable_uid))])]):e._e(),"payable"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(" "+e._s(t.cost_id)+" ")])]):e._e(),"commonBusinessPayableActual"===e.type?a("div",{staticClass:"rg right column-width"},[a("span",{style:String(t.write_off_amount).startsWith("-")?"color: #e91313":""},[e._v(" "+e._s(t.payable_uid)+" ")])]):e._e(),a("div",{staticClass:"rg right column-width"},[a("span",{style:t.write_off_amount<0?"color: #e91313":""},[e._v(e._s(e.formatAmount(t.write_off_amount,"")))])]),a("div",{staticClass:"rg column-width"},[a("div",[a("p",[e._v(e._s(t.write_off_user))]),a("span",{staticClass:"write-date"},[e._v(e._s(t.write_off_time))])])])])})),0)])]),a("tg-button",{style:{color:e.btncolor},attrs:{slot:"reference",type:"link"},slot:"reference"},[e._v(e._s(e.btntitle))])],1)},o=[],s=a(97434),l=a(61282),n=(0,s.defineComponent)({props:{list:{type:Array,default:()=>[]},type:{type:String,default:"receivable"},btntitle:{type:String,default:"预览"},btncolor:{type:String,default:"#2877ff"},showSettlementUid:{type:Boolean,default:!1}},setup(e,t){const a=(0,s.computed)((()=>{let t="";return"receivable"===e.type?t="单据编号":"receive"===e.type?t="应收编号":"payable"===e.type?t="单据编号":"commonBusinessPayableActual"===e.type&&(t="应付编号"),t}));return{firstColumnHeader:a,formatAmount:l.dN}}}),r=n,c=a(1001),u=(0,c.Z)(r,i,o,!1,null,"6ce85114",null),p=u.exports},22770:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new tg-reverse-audit-dialog",attrs:{visible:e.visible,"close-on-click-modal":!1,width:"440px"},on:{close:e.close},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("单据冲销")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.onRefuse}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary",disabled:e.isConfirmBtnDisabled},on:{click:e.onConfirm}},[e._v("提交")])]},proxy:!0}])},[a("div",{staticClass:"tg-reverse-audit-dialog-content",style:{paddingBottom:0===e.is_pass?"24px":"8px"}},[a("el-form",{staticClass:"el-form-vertical",attrs:{"label-position":"top","show-message":!1}},[a("div",{staticClass:"reverse-reason-label"},[e._v("冲销原因")]),a("div",{staticClass:"reverse-reason-content"},[e._v(" "+e._s(e.reverse_reason)+" ")]),a("el-form-item",{staticClass:"sp-form-item",staticStyle:{"margin-top":"18px"},attrs:{label:"是否通过",prop:"is_pass",required:""}},[a("div",{staticStyle:{width:"100%"}},[a("el-radio-group",{model:{value:e.is_pass,callback:function(t){e.is_pass=t},expression:"is_pass"}},[a("el-radio",{attrs:{label:1}},[e._v("通过")]),a("el-radio",{attrs:{label:0}},[e._v("不通过")])],1)],1)]),a("el-input",{directives:[{name:"show",rawName:"v-show",value:0===e.is_pass,expression:"is_pass === 0"}],attrs:{type:"textarea",placeholder:"请输入不通过原因",clearable:"",maxlength:100,"show-word-limit":""},model:{value:e.reverse_back_reason,callback:function(t){e.reverse_back_reason="string"===typeof t?t.trim():t},expression:"reverse_back_reason"}})],1)],1)])},o=[],s=a(97434),l=a(58861),n=a(22895),r=(0,s.defineComponent)({setup(e,t){const a=(0,s.ref)(""),i=(0,s.ref)(""),o=(0,s.ref)(n.w.YES),r=(0,s.ref)(null),c=(0,s.computed)((()=>o.value===n.w.NO&&""===i.value.trim())),{visible:u,setVisible:p}=(0,l.Z)();(0,s.watch)((()=>u.value),(e=>{console.log({next:e})}));const d=()=>{a.value="",p()},v=async()=>{if(c.value)return void t.root.$message.warning("请填写不通过原因");const e=await(r.value?.(o.value,i.value));e&&(a.value="",p())},_=(e,t)=>{a.value=e,i.value="",o.value=n.w.YES,r.value=t,p(!0)},m=()=>{a.value="",i.value="",r.value=null,p(!1)};return{visible:u,open:_,close:m,is_pass:o,reverse_reason:a,reverse_back_reason:i,onRefuse:d,onConfirm:v,isConfirmBtnDisabled:c}}}),c=r,u=a(1001),p=(0,u.Z)(c,i,o,!1,null,null,null),d=p.exports},86611:function(e,t,a){a.d(t,{Z:function(){return d}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"invoice-detail-dialog"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{visible:e.visible,width:"550px",center:!0,"close-on-click-modal":!1,"destroy-on-close":!0},on:{close:e.closeAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.title))]},proxy:!0}])},[a("div",{staticClass:"dialog-height-scroll"},e._l(e.list,(function(t,i){return a("div",{key:i,staticClass:"list"},[a("h3",{staticClass:"list-item-title"},[e._v("凭证"+e._s(i+1))]),a("div",{staticClass:"list-item"},[a("img",{staticClass:"list-item-img",attrs:{src:t.pic_url+"?Authorization="+e.getToken(),alt:""},on:{click:function(a){e.checkoutPaymentBtn(t.pic_url+"?Authorization="+e.getToken())}}}),a("div",{staticClass:"list-item-detail"},[a("p",[a("span",{staticClass:"label"},[e._v("发票号码：")]),a("span",[e._v(e._s(e._f("emptyData")(t.invoice_num)))])]),a("p",[a("span",{staticClass:"label"},[e._v("开票时间：")]),a("span",[e._v(e._s(e._f("emptyData")(t.invoice_date.replace(/-/g,"."))))])]),a("p",[a("span",{staticClass:"label"},[e._v("开票金额：")]),a("span",[e._v(e._s(e.numberMoneyFormat(t.amount,2)))])]),a("div",{staticStyle:{display:"flex"}},[a("span",{staticClass:"label"},[e._v("开票公司：")]),a("p",{staticClass:"line-clamp-1",staticStyle:{width:"210px"}},[e._v(" "+e._s(e._f("emptyData")(t.institution))+" ")])])])])])})),0)])],1)},o=[],s=a(24643),l=a(74750),n=a(64519),r={name:"FinanceCertificate",props:{title:{type:String,default:"发票详情"},list:{type:Array,default:()=>[]},visible:{type:Boolean,default:!1}},filters:{emptyData(e){return""===e||void 0===e||null===e?"--":e}},methods:{getToken:l.LP,numberMoneyFormat:s.rH,checkoutPaymentBtn(e){n.Z.showDetail(e)},closeAction(){this.$emit("closeFinanceInvoiceDetailAction")}}},c=r,u=a(1001),p=(0,u.Z)(c,i,o,!1,null,"02371747",null),d=p.exports},49398:function(e,t,a){a.r(t),a.d(t,{default:function(){return J}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"finance-receive-page flex-auto"},[a("tg-card",{staticClass:"flex-none",attrs:{padding:18},on:{"rect:update":e.onTopCardRectUpdate}},[a("el-form",{staticClass:"filter-form flex-form",attrs:{inline:!0,size:"small","show-message":!1,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"业务类型："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.business_type,callback:function(t){e.$set(e.queryForm,"business_type",t)},expression:"queryForm.business_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"营销业务",value:1}}),a("el-option",{attrs:{label:"抖音店播",value:3}}),a("el-option",{attrs:{label:"淘宝店播",value:2}}),a("el-option",{attrs:{label:"S2B2C",value:5}})],1)],1),a("el-form-item",{attrs:{label:"收款类型："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.gather_type,callback:function(t){e.$set(e.queryForm,"gather_type",t)},expression:"queryForm.gather_type"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"佣金",value:2}}),a("el-option",{attrs:{label:"服务费",value:1}}),a("el-option",{attrs:{label:"其他",value:3}})],1)],1),a("el-form-item",{attrs:{label:"需要开票："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.is_invoice,callback:function(t){e.$set(e.queryForm,"is_invoice",t)},expression:"queryForm.is_invoice"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"是",value:1}}),a("el-option",{attrs:{label:"否",value:0}})],1)],1),a("el-form-item",{attrs:{label:"发票上传："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.has_invoice_certificate,callback:function(t){e.$set(e.queryForm,"has_invoice_certificate",t)},expression:"queryForm.has_invoice_certificate"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"已上传",value:1}}),a("el-option",{attrs:{label:"未上传",value:0}})],1)],1),a("el-form-item",{attrs:{label:"收款状态："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.is_gather,callback:function(t){e.$set(e.queryForm,"is_gather",t)},expression:"queryForm.is_gather"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"已收款",value:1}}),a("el-option",{attrs:{label:"未收款",value:0}})],1)],1),a("el-form-item",{attrs:{label:"收款方式："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.gather_way,callback:function(t){e.$set(e.queryForm,"gather_way",t)},expression:"queryForm.gather_way"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"支付宝",value:2}}),a("el-option",{attrs:{label:"V任务",value:1}}),a("el-option",{attrs:{label:"对公银行",value:3}}),a("el-option",{attrs:{label:"阿里妈妈",value:4}}),a("el-option",{attrs:{label:"巨量百应",value:5}})],1)],1),a("el-form-item",{attrs:{label:"核销状态："}},[a("el-select",{staticClass:"select",staticStyle:{width:"192px"},attrs:{placeholder:""},model:{value:e.queryForm.write_off_status,callback:function(t){e.$set(e.queryForm,"write_off_status",t)},expression:"queryForm.write_off_status"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"已核销",value:2}}),a("el-option",{attrs:{label:"部分核销",value:1}}),a("el-option",{attrs:{label:"未核销",value:0}})],1)],1),a("el-form-item",{staticClass:"form-item-group",attrs:{label:"收款搜索："},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getList.apply(null,arguments)}}},[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"244px"},attrs:{placeholder:"请输入关键字",maxlength:"100",clearable:""},model:{value:e.queryForm.search_value,callback:function(t){e.$set(e.queryForm,"search_value","string"===typeof t?t.trim():t)},expression:"queryForm.search_value"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.queryForm.search_type,callback:function(t){e.$set(e.queryForm,"search_type",t)},expression:"queryForm.search_type"}},[a("el-option",{attrs:{label:"收款编号",value:1}}),a("el-option",{attrs:{label:"业绩名称",value:2}}),a("el-option",{attrs:{label:"项目编号",value:3}}),a("el-option",{attrs:{label:"客户经理",value:4}}),a("el-option",{attrs:{label:"客户名称",value:5}}),a("el-option",{attrs:{label:"项目名称",value:6}})],1)],1)],1),a("el-form-item",{staticClass:"flex-form-item-time",attrs:{label:"日期选择："}},[a("el-select",{staticClass:"time-select-type",staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.queryForm.query_date_type,callback:function(t){e.$set(e.queryForm,"query_date_type",t)},expression:"queryForm.query_date_type"}},[a("el-option",{attrs:{label:"收款时间",value:1}}),a("el-option",{attrs:{label:"登记时间",value:2}})],1),a("el-date-picker",{staticClass:"time-select-box",attrs:{type:"daterange","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.queryForm.pay_date,callback:function(t){e.$set(e.queryForm,"pay_date",t)},expression:"queryForm.pay_date"}})],1),a("el-form-item",{staticStyle:{"margin-right":"20px"},attrs:{"label-width":"0"}},[a("tg-button",{attrs:{type:"primary"},on:{click:e.onQuerySearchClick}},[e._v("查询")]),a("tg-button",{staticClass:"mgl-12",on:{click:e.onQueryResetClick}},[e._v("重置")])],1)],1)],1),a("tg-card",e._b({staticClass:"mgt-12",class:e.cardFlexClass,attrs:{padding:[12,18,0,18]},on:{"rect:update":e.onRectUpdate}},"tg-card",e.cardProps,!1),[a("div",{staticClass:"main-header"},[e.permission.gathering_export?a("tg-button",{attrs:{type:"default",icon:"ico-btn-export"},on:{click:e.exportBtnClick}},[e._v("导出")]):e._e(),a("div",{staticClass:"header"},[a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[e._v("已收款笔数：")]),a("span",{staticClass:"text"},[e._v(e._s(e.statistics&&e.numberFormat(e.statistics.count_confirmed_gather_amount,0)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[e._v("已收款金额：")]),a("span",{staticClass:"text"},[e._v(e._s(e.statistics&&e.numberMoneyFormat(e.statistics.sum_confirmed_gather_amount,2)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[e._v("待确认笔数：")]),a("span",{staticClass:"text gold"},[e._v(e._s(e.statistics&&e.numberFormat(e.statistics.count_unconfirmed_gather_amount,0)))])]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[e._v("待确认金额：")]),a("span",{staticClass:"text gold"},[e._v(e._s(e.statistics&&e.numberMoneyFormat(e.statistics.sum_unconfirmed_gather_amount,2)))])])])],1),a("el-table",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mgt-12",attrs:{stripe:"",border:"",data:e.list},on:{"row-click":function(t){return t.target!==t.currentTarget?null:e.onRowClick.apply(null,arguments)}},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无收款数据"}})]},proxy:!0}])},"el-table",e.tableProps,!1),[e._l(e.columns,(function(t,i){return a("el-table-column",e._b({key:i},"el-table-column",t,!1))})),a("el-table-column",{attrs:{label:"收款类型","min-width":"86",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.gather_type?a("div",[e._v("服务费")]):2===t.row.gather_type?a("div",[e._v("佣金")]):3===t.row.gather_type?a("div",[e._v("其他")]):4===t.row.gather_type?a("div",{staticClass:"reverse-red"},[e._v("冲销")]):a("div",[e._v("--")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"收款方式","min-width":"108"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"line-info"},[a("p",[e._v(e._s(e.receiveType(t.row.gather_way)))])])]}}])}),a("el-table-column",{attrs:{align:"left",className:"ProjectInfoColumn",label:"项目信息","min-width":"178"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(a){return a.stopPropagation(),e.goProjectDetail(t.row)}}},[t.row.project_name&&t.row.project_name.length>12?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:t.row.project_name}},[a("p",{staticClass:"line-clamp-1 empty-data-line hover-link",attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(t.row.project_name)+" ")])]):a("p",{staticClass:"line-clamp-1 empty-data-line hover-link"},[e._v(" "+e._s(t.row.project_name||"--")+" ")])],1)]}}])}),a("el-table-column",{attrs:{align:"center",label:"业务类型","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(" "+e._s(1===t.row.business_type_str?"营销业务":2===t.row.business_type_str?"淘宝店播":3===t.row.business_type_str?"抖音店播":4===t.row.business_type_str?"基地业务":"S2B2C")+" ")])]}}])}),a("el-table-column",{attrs:{align:"left",label:"客户公司","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"line-info"},[t.row.customer_info.company_name&&t.row.customer_info.company_name.length>10?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:t.row.customer_info.company_name}},[a("p",{staticClass:"clamp-1 customer-name",staticStyle:{width:"150px"},attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(t.row.customer_info.company_name)+" ")])]):a("p",{staticClass:"clamp-1"},[e._v(" "+e._s(e.fillEmptyStr(t.row.customer_info.company_name))+" ")])],1)]}}])}),a("el-table-column",{attrs:{align:"left",label:"客户店铺","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"line-info"},[t.row.customer_info.shop_name&&t.row.customer_info.shop_name.length>10?a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:t.row.customer_info.shop_name}},[a("p",{staticClass:"clamp-1 customer-name",staticStyle:{width:"150px"},attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(t.row.customer_info.shop_name)+" ")])]):a("p",{staticClass:"clamp-1 customer-name"},[e._v(" "+e._s(e.fillEmptyStr(t.row.customer_info.shop_name))+" ")])],1)]}}])}),a("el-table-column",{attrs:{label:"是否开票","min-width":"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"line-info",staticStyle:{"justify-content":"center"}},[a("p",{style:{width:1===t.row.is_invoice?"30px":"100%",textAlign:1===t.row.is_invoice?"right":"center"}},[e._v(" "+e._s(1===t.row.is_invoice?"是":"否")+" ")]),1===t.row.is_invoice?a("p",{staticStyle:{width:"60px","text-align":"left"}},[e._v(" ("+e._s(t.row.invoice_info.length>=1?"已上传":"未上传")+") ")]):e._e()])]}}])}),a("el-table-column",{attrs:{label:"收款时间","min-width":"90",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[a("span",[e._v(" "+e._s(t.row.gather_confirm_detail.order_date?e.fillEmptyStr(t.row.gather_confirm_detail.order_date.replace(/\x2D/g,".")):"--"))])])]}}])}),a("el-table-column",{attrs:{label:"收款凭证",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.gather_certificate_pic?a("el-button",{staticClass:"button-item",attrs:{type:"text"},nativeOn:{click:function(a){return a.stopPropagation(),e.checkoutPaymentBtn(t.row.gather_certificate_pic)}}},[e._v("查看")]):a("span",[e._v("--")])]}}])}),a("el-table-column",{attrs:{label:"核销状态","min-width":"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"line-info"},[(5===t.row.gather_type?2===t.row.refund_write_off_status:2===t.row.write_off_status)?a("p",{staticClass:"write-on"},[e.writeOffPopoverVisible(t.row)?a("write-list-pop",{attrs:{list:e.writeOffPopoverInfo(t.row),type:5===t.row.gather_type?"commonBusinessPayableActual":"receive",btntitle:"已核销",btncolor:"#3c5269",showSettlementUid:!0}}):[e._v("已核销")]],2):(5===t.row.gather_type?1===t.row.refund_write_off_status:1===t.row.write_off_status)?a("p",{staticClass:"write-off"},[e.writeOffPopoverVisible(t.row)?a("write-list-pop",{attrs:{list:e.writeOffPopoverInfo(t.row),type:5===t.row.gather_type?"commonBusinessPayableActual":"receive",btntitle:"部分核销",btncolor:"#ff7a36",showSettlementUid:!0}}):[e._v("部分核销")]],2):a("p",{staticClass:"write-off"},[e._v("未核销")])])]}}])}),a("el-table-column",{attrs:{align:"center",label:"单据状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[4===t.row.gather_type?a("div",{staticStyle:{color:"#ff7a36"}},[a("span",[e._v("冲销")]),1===t.row.reverse_status?a("span",{staticStyle:{color:"#ff7a36"}},[e._v("(待确认)")]):2===t.row.reverse_status?a("span",{staticStyle:{color:"#02ba3c"}},[e._v("(已确认)")]):3===t.row.reverse_status?a("span",{staticStyle:{color:"#e91313"}},[e._v("(退回)")]):e._e()]):a("div",[0===t.row.is_gather?a("div",{staticClass:"to-pay"},[e._v("待确认")]):a("div",[e._v("已确认")])])]}}])}),e._l(e.op_columns,(function(t,i){return a("el-table-column",e._b({key:"op-"+i},"el-table-column",t,!1))}))],2),e.total>0?a("el-pagination",{staticStyle:{margin:"8px 0"},attrs:{"current-page":e.queryForm.page,"page-sizes":[10,20,50,100],"page-size":e.queryForm.size,layout:"total, prev, pager, next, sizes, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.queryForm,"page",t)},"update:current-page":function(t){return e.$set(e.queryForm,"page",t)},"current-change":e.handleCurrentChange,"size-change":e.handlePageSizeChange}}):e._e()],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic",attrs:{visible:e.receiveConfirmVisible,width:"440px","close-on-click-modal":!1,"destroy-on-close":!0},on:{close:e.receiveConfirmCloseAction},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("收款确认")]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.receiveConfirmCloseAction}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.handleReceiveConfirmSaveAction}},[e._v("保存")])]},proxy:!0}])},[a("el-form",{ref:"receiveConfirmRef",staticStyle:{"margin-top":"20px"},attrs:{model:e.receiveConfirm,rules:e.receiveConfirmRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"收款时间：",size:"small",prop:"order_date"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"请选择收款时间","value-format":"yyyy.MM.dd",disabled:!(!e.confirmRow||!e.confirmRow.revenue_flow_id)},model:{value:e.receiveConfirm.order_date,callback:function(t){e.$set(e.receiveConfirm,"order_date",t)},expression:"receiveConfirm.order_date"}})],1),2===e.gather_way||3===e.gather_way?a("el-form-item",{attrs:{label:"收款账号：",size:"medium",prop:"receive_account"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择收款账号",clearable:"",maxlength:"100",disabled:!(!e.confirmRow||!e.confirmRow.revenue_flow_id)},on:{change:e.receiveAccountChange},model:{value:e.receiveConfirm.receive_account,callback:function(t){e.$set(e.receiveConfirm,"receive_account","string"===typeof t?t.trim():t)},expression:"receiveConfirm.receive_account"}},e._l(e.bankAccounts,(function(e){return a("el-option",{key:e.id,attrs:{label:e.account_number+"("+e.bank_name+")",value:e.id}})})),1)],1):e._e(),1!==e.gather_way?a("el-form-item",{attrs:{label:"名称：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入付款方名称",clearable:"",maxlength:"100",disabled:(2===e.gather_way||3===e.gather_way)&&"disabled"},model:{value:e.receiveConfirm.pay_company_name,callback:function(t){e.$set(e.receiveConfirm,"pay_company_name","string"===typeof t?t.trim():t)},expression:"receiveConfirm.pay_company_name"}})],1):e._e(),1!==e.gather_way?a("el-form-item",{attrs:{label:"账号：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入付款方账号",clearable:"",maxlength:"100",disabled:(2===e.gather_way||3===e.gather_way)&&"disabled"},model:{value:e.receiveConfirm.account,callback:function(t){e.$set(e.receiveConfirm,"account","string"===typeof t?t.trim():t)},expression:"receiveConfirm.account"}})],1):e._e(),3===e.gather_way?a("el-form-item",{attrs:{label:"开户行：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入付款方开户行",clearable:"",maxlength:"100",disabled:(2===e.gather_way||3===e.gather_way)&&"disabled"},model:{value:e.receiveConfirm.bank_of_deposit,callback:function(t){e.$set(e.receiveConfirm,"bank_of_deposit","string"===typeof t?t.trim():t)},expression:"receiveConfirm.bank_of_deposit"}})],1):e._e()],1)],1)],1),a("div",{staticClass:"tg-dialog-vcenter"},[a("el-dialog",{staticClass:"tg-dialog-classic upload-dialog-box",attrs:{visible:e.uploadVisible,width:"550px","close-on-click-modal":!1,"destroy-on-close":!0},on:{close:e.uploadCloseAction},nativeOn:{click:function(t){return t.stopPropagation(),e.clearInvoiceListItemActiveIndex.apply(null,arguments)}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.commonTitle))]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.uploadCloseAction}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:function(t){return e.uploadSaveAction("uploadRef")}}},[e._v("保存")])]},proxy:!0}])},[a("el-form",{ref:"uploadRef",staticClass:"upload-invoice-form",attrs:{model:e.uploadForm,"label-width":"100px"}},[a("div",{staticClass:"list-form-box"},[a("p",{staticClass:"list-form-title",staticStyle:{"margin-top":"8px"}},[e._v("发票凭证：")]),e._l(e.uploadForm.list,(function(t,i){return a("div",{key:i,class:e.invoiceListItemActiveIndex===i?"list-form-item list-form-item-active":"list-form-item",staticStyle:{"margin-top":"8px"},on:{paste:function(t){return e.handlePaste(t,i)},click:function(t){t.stopPropagation(),e.invoiceListItemActiveIndex=i}}},[e.uploadForm.list.length>1?a("el-button",{staticClass:"form-item-close",attrs:{icon:"el-icon-close",circle:""},on:{click:function(t){return e.deleteUploadItemBtn(i)}}}):e._e(),a("el-form-item",{attrs:{prop:"list."+i+".show_url",label:"发票截图：",size:"medium",rules:{required:!0,message:"请上传发票截图",trigger:["change","blur"]}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"","http-request":e.uploadImage.bind(this,i,!1),"before-upload":e.beforeAvatarUpload,"show-file-list":!1,accept:".jpeg,.jpg,.png"}},[t.show_url&&t.show_url.includes(".pdf")?a("tg-icon",{staticStyle:{"font-size":"90px"},attrs:{name:"ico-pdf"}}):t.show_url?a("img",{staticClass:"avatar",attrs:{src:t.show_url}}):a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"avatar-uploader-icon"},[a("i",{staticClass:"el-icon-plus"}),a("p",[e._v("上传发票")])]),a("div",{staticStyle:{position:"absolute",right:"-50px",top:"32px",color:"rgb(164, 178, 194)"}},[e._v(" 支持pdf，图片格式发票上传 ")]),a("div",{staticClass:"el-upload__tip",staticStyle:{"line-height":"16px",color:"#a4b2c2"},attrs:{slot:"tip"},slot:"tip"},[e._v(" 选中灰色区域，粘贴（ctrl+V）添加图片 ")])],1)],1),a("el-form-item",{attrs:{label:"发票号码：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入8位发票号码",maxlength:"8",clearable:""},model:{value:t.invoice_num,callback:function(a){e.$set(t,"invoice_num","string"===typeof a?a.trim():a)},expression:"item.invoice_num"}})],1),a("el-form-item",{attrs:{label:"开票时间：",size:"medium"}},[a("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",placeholder:"请选择开票时间","value-format":"yyyy-MM-dd"},model:{value:t.invoice_date,callback:function(a){e.$set(t,"invoice_date",a)},expression:"item.invoice_date"}})],1),a("el-form-item",{attrs:{label:"开票金额：",size:"medium",rule:e.uploadFormRules.amount}},[a("el-input",{staticStyle:{width:"300px"},attrs:{oninput:"value=value.replace(/[^\\d.]/g,'')",placeholder:"请输入开票金额",clearable:""},on:{input:function(t){return e.inputLoanAmountCost(t,i)}},model:{value:t.amount,callback:function(a){e.$set(t,"amount","string"===typeof a?a.trim():a)},expression:"item.amount"}},[a("template",{slot:"append"},[e._v("元")])],2)],1),a("el-form-item",{attrs:{label:"开票单位名称：",size:"medium"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入开票单位名称",maxlength:"100",clearable:""},model:{value:t.institution,callback:function(a){e.$set(t,"institution","string"===typeof a?a.trim():a)},expression:"item.institution"}})],1)],1)}))],2)]),e.uploadForm.list.length<3?a("tg-ghost-button",{staticClass:"add-upload-form-btn",on:{click:e.addUploadItemBtn}},[e._v("点击添加")]):e._e()],1)],1),a("finance-invoice-detail-dialog",{attrs:{visible:e.financeInvoiceDetailVisible,list:e.invoiceList},on:{closeFinanceInvoiceDetailAction:e.closeFinanceInvoiceDetailAction}}),a("Invoicelist",{ref:"invoicelistRef"}),a("invoices-detail",{ref:"invoicesDetailDialogRef"}),a("reverseAuditDialog",{ref:"reverseAuditDialogRef"}),a("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new",attrs:{visible:e.reasonDialogVisible,width:"440px"},on:{close:e.onReasonDialogClose},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("冲销原因")]},proxy:!0}])},[a("div",{staticClass:"reason-dialog-content"},[e._v(e._s(e.reason))])]),e.loanDetailVisible?a("LoanfinanceDetailModal",{attrs:{visible:e.loanDetailVisible,detailroval:e.detailroval},on:{"dialog:closerow":e.onLoanDetailClose,"dialog:openreceivecertificate":e.checkoutPaymentBtn,"dialog:openreceiveinvoice":e.checkoutInvoiceDetailBtn,"dialog:openreceivecontract":e.goContractDetail,"dialog:openreceiveApproval":e.handleClickApprovalBtn}}):e._e()],1)},o=[],s=(a(21703),a(26699),a(97434)),l=a(86611),n=a(24643),r=a(76012),c=a(42963),u=a(74750),p=a(64236);const d=async e=>(0,r.dX)("/api/financial/query_collection",{params:{...(0,p.jG)(e)}}),v=async e=>(0,r.dX)("/api/financial/query_receive_account",{params:{gather_way:e}});function _(e){return(0,r.ZP)({url:"/api/financial/update_collection",method:"post",data:e})}function m(e){const t=c.stringify(e),a=(0,u.LP)();window.open(`https://data.goumee.com/api/financial/export_collection?${t}&Authorization=${a}`)}function f(e){return(0,r.ZP)({url:"/api/coop/save_collection_invoice",method:"post",data:e})}var g=a(34137),h=a(21757),b=a(64519),y=a(91538),w=a(29625),C=a(33018),k=a(62068),S=a(17809),x=a(51351),D=a(61282),V=a(57325),A=a(58302),F=a(22770),I=a(28348),E=a(58861),B=a(42386),$=a(67578),R=a(67910),j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"customer-dialog loan-detail-dialog el-dialog-center-rewrite",attrs:{isAppendToBody:!0,visible:e.visible,width:"900px",isfooter:!0,"close-on-click-modal":!1,title:"收款详情"},on:{close:e.emitClose}},[[a("div",{staticClass:"container-max"},[a("div",{staticClass:"main"},[a("div",{staticClass:"main-middle"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"from-middle-first"},[a("span",{staticClass:"color-9"},[e._v("收款编号：")]),a("span",[e._v(e._s(e.detailroval.achievement_uid))])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("业绩名称：")]),a("span",[e._v(" "+e._s(e.detailroval.achievement_name)+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("项目编码：")]),a("span",[e._v(" "+e._s(e.detailroval.project_uid)+" ")])])])],1),[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("项目名称：")]),a("span",[e._v(" "+e._s(e.detailroval.project_name)+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("客户经理：")]),a("span",[e._v(" "+e._s(e.detailroval.manager)+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("业务类型：")]),a("span",[e._v(" "+e._s(1===e.detailroval.business_type_str?"营销业务":2===e.detailroval.business_type_str?"淘宝店播":3===e.detailroval.business_type_str?"抖音店播":4===e.detailroval.business_type_str?"基地业务":"S2B2C")+" ")])])])],1),a("div",{staticClass:"linediv"}),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("客户公司：")]),a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.customer_info.company_name))+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v(" 客户店铺：")]),a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.customer_info.shop_name))+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("品牌：")]),a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.customer_info.brand_name))+" ")])])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("收款类型：")]),1===e.detailroval.gather_type?a("span",[e._v("服务费")]):2===e.detailroval.gather_type?a("span",[e._v("佣金")]):3===e.detailroval.gather_type?a("span",[e._v("其他")]):4===e.detailroval.gather_type?a("span",{staticClass:"reverse-red"},[e._v("冲销")]):a("span",[e._v("--")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("收款金额：")]),a("span",[e._v(" "+e._s(e.detailroval.gather_amount_str)+" 元")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("打款方式：")]),a("span",[e._v(" "+e._s(e.receiveType(e.detailroval.gather_way))+" ")])])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("收款凭证：")]),e.detailroval.gather_certificate_pic?a("span",{staticStyle:{color:"#2877ff",cursor:"pointer"},on:{click:function(t){return e.checkoutPaymentBtn(e.detailroval.gather_certificate_pic)}}},[e._v(" 查看 ")]):a("span",[e._v("--")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("发票信息：")]),e.detailroval.invoice_info.length>=1?a("span",{staticStyle:{color:"#2877ff",cursor:"pointer"},on:{click:function(t){return e.openinvoicefinance(e.detailroval.invoice_info)}}},[e._v(" 查看 ")]):a("span",[e._v("--")])])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:22}},[a("div",[a("span",{staticClass:"color-9"},[e._v("关联单据：")]),a("p",[5===e.detailroval.gather_type?[e._v(" 原单号 ("),a("span",{on:{click:function(t){return e.checkoutreceiveApprovalBtn(e.detailroval)}}},[e._v(e._s(e.detailroval.refund_cost_id))]),e._v(")")]:[e._v(" 合同 ("),e.detailroval.contract_uid?a("span",{style:{color:"#2877ff",cursor:e.contract_id?"pointer":""},on:{click:function(t){return e.checkoutreceivecontractBtn(e.detailroval.contract_id,e.detailroval.contract_type)}}},[e._v(e._s(e.detailroval.contract_uid))]):a("span",[e._v("--")]),e._v(")     开票审批 ("),e.detailroval.approval_uid?a("span",{on:{click:function(t){return e.checkoutreceiveApprovalBtn(e.detailroval)}}},[e._v(e._s(e.detailroval.approval_uid))]):a("span",[e._v("--")]),e._v(")")]],2)])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:23}},[a("div",[a("span",{staticClass:"color-9"},[e._v("收款账号：")]),3===e.detailroval.gather_way?a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.pay_company_name))+"     "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.bank_of_deposit))+"      "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.account)))]):2===e.detailroval.gather_way?a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.pay_company_name))+"     "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.account)))]):a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_detail.pay_company_name)))])])])],1),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:23}},[a("div",[a("span",{staticClass:"color-9"},[e._v("付款账号：")]),1===e.detailroval.gather_way?a("span",[e._v(e._s(e.fillEmptyStr(e.detailroval.gather_way_detail.order_wangwang_id)))]):a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.gather_way_detail.pay_company_name)))])])])],1),a("div",{staticClass:"linediv"}),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("核销状态：")]),(5===e.detailroval.gather_type?2===e.detailroval.refund_write_off_status:2===e.detailroval.write_off_status)?a("span",{staticClass:"write-on"},[e._v(" 已核销 ")]):(5===e.detailroval.gather_type?1===e.detailroval.refund_write_off_status:1===e.detailroval.write_off_status)?a("span",{staticClass:"write-off"},[e._v(" 部分核销 ")]):a("span",{staticClass:"write-off"},[e._v("未核销")])])])],1),e.detailroval.write_off_infos.length>0?a("el-row",{staticStyle:{"margin-bottom":"20px !important"},attrs:{gutter:20}},[a("el-col",{staticStyle:{"background-color":"#ffffff",width:"30px"},attrs:{span:1}},[a("div",[a("span",{staticStyle:{color:"#ffffff"}},[e._v("jjj")])])]),a("el-col",{attrs:{span:22}},[a("div",[a("el-table",{style:{height:e.detailroval.write_off_infos.length<1?"100px":""},attrs:{data:e.detailroval.write_off_infos,border:"","empty-text":"暂无收款记录"}},[a("el-table-column",{attrs:{prop:"settlement_uid",label:"结算单号","min-width":"80",align:"center"}}),a("el-table-column",{attrs:{prop:"receivable_uid",label:"应收单号","min-width":"80",align:"center"}}),a("el-table-column",{attrs:{label:"核销金额 (元)","min-width":"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("span",{},[e._v(" "+e._s(e.gettwonomalAmount(t.row.write_off_amount))+" ")])}}],null,!1,2564872674)}),a("el-table-column",{attrs:{prop:"write_off_user",label:"核销人","min-width":"80",align:"center"}}),a("el-table-column",{attrs:{prop:"write_off_time",label:"核销时间","min-width":"80",align:"center"}})],1)],1)])],1):e._e(),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v("录入人：")]),a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.add_by))+"  "+e._s(e.fillEmptyStr(e.detailroval.registration_time))+" ")])])]),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"color-9"},[e._v(" 确认人：")]),a("span",[e._v(" "+e._s(e.fillEmptyStr(e.detailroval.gather_confirm_by_name))+"   "+e._s(e.detailroval.gather_date.split(" ")[0].replace(/-/g,"."))+" ")])])])],1)]],2)])])]],2)},L=[],T=a(85937),P=a.n(T),q=(0,s.defineComponent)({name:"ReceiveLoanDetailModal",props:{visible:{type:Boolean,required:!0},detailroval:{type:Object}},components:{},mounted(){},setup(e,t){const a=()=>t.emit("dialog:closerow"),i=e=>{e&&t.emit("dialog:openreceivecertificate",e)},o=(e,a)=>{e&&t.emit("dialog:openreceivecontract",e,a)},s=e=>{},l=e=>{t.emit("dialog:openreceiveinvoice",e)},r=e=>`${(0,D.SJ)(new(P())(e))}`;return{numberMoneyFormat:n.rH,gettwonomalAmount:r,checkoutreceiveApprovalBtn:s,fillEmptyStr:D.Vw,emitClose:a,openinvoicefinance:l,checkoutPaymentBtn:i,checkoutreceivecontractBtn:o}},methods:{receiveType(e){return 1===e?"V任务":2===e?"支付宝":3===e?"对公银行":4===e?"阿里妈妈":5===e?"巨量百应":"--"}}}),M=q,O=a(1001),Z=(0,O.Z)(M,j,L,!1,null,"0c490c8d",null),z=Z.exports,U=a(40290),N=a(6933),W=a.n(N),Y=(0,s.defineComponent)({name:"FinanceReceive",setup(e,t){const a=(0,h.gI)(),i=(0,s.computed)((()=>"console"===t.root.$router.currentRoute.query.source)),o=(0,s.computed)((()=>"console_kaipiao"===t.root.$router.currentRoute.query.source)),l=(0,s.computed)((()=>"dialog"===t.root.$router.currentRoute.query.source)),r=(0,s.computed)((()=>t.root.$router.currentRoute.query.achievement)),c=(0,s.ref)(void 0),u=(0,s.ref)(!1),y=(0,s.ref)({business_type:"",gather_type:"",query_date_type:2,pay_date:"",gather_way:"",write_off_status:"",is_invoice:o.value?1:"",has_invoice_certificate:o.value?0:"",is_gather:i.value?0:"",gather_date:"",gmt_create:"",search_value:l.value?r.value:"",search_type:1,page:1,size:20}),C=(0,s.computed)((()=>{const e=new Date,t=W()(e.getTime()-2592e6).format("YYYY-MM-DD"),a=W()(e.getTime()).format("YYYY-MM-DD");return[t,a]}));y.value.pay_date=C.value;const k=(0,s.ref)([]),F=(0,s.ref)(null),j=(0,s.ref)(0),L=(0,s.ref)(!0),T=(0,s.ref)(!1),P=(0,s.ref)({order_date:"",receive_account:"",pay_company_name:"",account:"",bank_of_deposit:""}),q=(0,s.ref)(""),M=(0,s.ref)(""),O=(0,s.ref)({order_date:{required:!0,message:"请选择收款时间",trigger:["change","blur"]},receive_account:{required:!0,message:"请选择收款账号",trigger:["change","blur"]}}),Z=(0,s.ref)(!1),z=(0,s.ref)({list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]}),N=(0,s.ref)({amount:[{validator:(e,t,a)=>{""===t?a():Number(t)<0?a(new Error("开票金额不能小于0")):a()}}]}),Y=(0,s.ref)(!1),H=(0,s.ref)([]),G=(0,s.ref)(""),J=(0,s.computed)((()=>t.root.$store.state.workbench)),Q=(0,s.computed)((()=>J.value.approval)),K=()=>{c.value=void 0},X=e=>{const a=e.size/1024/1024<5;return["image/jpeg","image/jpg","image/png"].includes(e.type)||[".jpg",".jpeg",".png"].includes((0,p.mD)(e.name))?!!a||(t.root.$message.error("上传图片大小不能超过 5MB!"),!1):(t.root.$message.warning("文件格式不正确，请使用 png / jpg / jpeg"),!1)},ee=async(e,a,i)=>{const o=z.value.list.map((e=>({...e}))),s=new FormData;s.append("file",i.file),s.append("type","certificate/achievement_invoice_certificate"),s.append("achievement_or_cost_id",`${q.value}`);const[{data:l}]=await Promise.all([await(0,g.G1)(s),await(0,p._v)(500)]);if(l.success){const i=l.data.source;o[e].show_url=(0,V.W)(i,!1),o[e].pic_url=i,z.value.list=o,a&&t.root.$message.success("粘贴成功！")}else t.root.$message.error("上传失败！")},te=(e,a)=>{const i=(e.clipboardData||window.clipboardData)?.items;let o=null;if(!i||0===i.length)return void t.root.$message.error("当前浏览器不支持本地");for(let t=0;t<i.length;t++)if(-1!==i[t].type.indexOf("image")){o=i[t].getAsFile();break}if(!o)return void t.root.$message.error("粘贴内容非图片");const s=new FileReader;s.onload=()=>{},s.readAsDataURL(o),o&&X(o)&&ee(a,!0,{file:o})},ae=(e,t)=>{const a=e.replace(/[^\d.]+/gu,"").replace(/^0+(?=\d)/gu,"")??"",i=/\d+(?:\.\d{0,2})?/gu.exec(a)??[""];z.value.list[t].amount=i[0]},ie=async(e,a)=>{const{data:i}=await(0,x.OC)({approval_id:""===e?void 0:e,approval_uid:a});return i.success?t.root.$store.dispatch("workbench/setApproval",i.data):t.root.$message.error(i.message??"获取审批详情失败"),i.data},oe=()=>{const e=y.value;return{achievement_uid:1===e.search_type?e.search_value:"",achievement_name:2===e.search_type?e.search_value:"",project_uid:3===e.search_type?e.search_value:"",manager_name:4===e.search_type?e.search_value:"",shop_or_company_name:5===e.search_type?e.search_value:"",project_name:6===e.search_type?e.search_value:"",business_type:e.business_type,gather_type:e.gather_type,gather_way:e.gather_way,write_off_status:e.write_off_status,is_invoice:e.is_invoice,has_invoice_certificate:e.has_invoice_certificate,is_gather:e.is_gather,gather_date_min:1===e.query_date_type?e.pay_date?e.pay_date[0]:"":void 0,gather_date_max:1===e.query_date_type?e.pay_date?e.pay_date[1]:"":void 0,gmt_create_min:2===e.query_date_type?e.pay_date?e.pay_date[0]:"":void 0,gmt_create_max:2===e.query_date_type?e.pay_date?e.pay_date[1]:"":void 0}},se=async()=>{L.value=!0;const e={...oe(),page:y.value.page,size:y.value.size},a=await d(e);if(a.data.success){const e=a.data.data;k.value=e.data,j.value=e.total,L.value=!1,F.value=e.statistics_data}else t.root.$message.error(a.data.message)},le=()=>{y.value.business_type="",y.value.gather_type="",y.value.gather_way="",y.value.write_off_status="",y.value.is_invoice="",y.value.has_invoice_certificate="",y.value.is_gather="",y.value.gather_date="",y.value.gmt_create="",y.value.search_value="",y.value.search_type=1,y.value.page=1,y.value.size=20,y.value.query_date_type=2,y.value.pay_date=C.value,se()},ne=()=>{m(oe())},re=async()=>{y.value.page=1,se()},ce=e=>{y.value.page=e,se()},ue=e=>{y.value.page=1,y.value.size=e,se()},pe=(0,s.ref)([]),de=(0,s.ref)(void 0),ve=async e=>{if(q.value=e.achievement_id,M.value=e.gather_way,2===e.gather_way||3===e.gather_way){const t=await v(e.gather_way);t.data.success&&(pe.value=t.data.data)}else pe.value=[];e.revenue_flow_id&&(P.value.order_date=e.order_date?.replace(/-/g,"."),P.value.receive_account=e.receive_account,P.value.pay_company_name=e?.capital_revenue_flow?.payer,P.value.account=e?.capital_revenue_flow?.payment_account),de.value=e,T.value=!0},_e=e=>{const t=pe.value.find((t=>t.id===e));t?(P.value.pay_company_name=t.account_name,P.value.account=t.account_number,P.value.bank_of_deposit=t.bank_name):(P.value.pay_company_name="",P.value.account="",P.value.bank_of_deposit="")},me=()=>{T.value=!1,P.value={order_date:"",receive_account:"",pay_company_name:"",account:"",bank_of_deposit:""}},fe=()=>{K(),Z.value=!1,z.value={list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]}},ge=e=>{z.value.list.splice(e,1)},{jumpProjectDetail:he}=(0,U.k)(t),be=async e=>{e.business_type===w.WD.marketing?window.open("/marketing/project/"+e.project_id):e.business_type===w.WD.taobao||e.business_type===w.WD.douyin?he({project_id:e.project_id,newWindow:!0}):window.open("/commonbusiness/project/"+e.project_id)},ye=async(e,t)=>{if(e)if(1===t||2===t)window.open("/legal/contract/customer/"+e);else if(3===t||4===t)window.open("/legal/contract/supplier/"+e);else if(5===t)window.open("/legal/contract/customerTemplate/"+e);else if(6===t)window.open("/legal/contract/supplierTemplate/"+e);else{if(7!==t)return;window.open("/legal/contract/anchorTemplate/"+e)}},we=(0,s.ref)(null),Ce=async e=>{if(5===e.gather_type)return void(e.business_type===w.WD.marketing?window.open("/marketing/project/"+e.cooperation_id+"/achievement"):e.business_type===w.WD.taobao||e.business_type===w.WD.douyin?window.open("/live/project/"+e.project_id+"/collection/week"):window.open("/commonbusiness/project/"+e.project_id+"/collection"));if(!e.approval_id)return;const t=await ie(e.approval_id);we.value?.show(t)},ke=(0,s.ref)(null),Se=e=>{const t=e.split(",");1===t.length?b.Z.showDetail((0,V.W)(t[0],!1)):ke.value?.show({title:"打款凭证",list:t.map((e=>(0,V.W)(e,!1))),type:1})},xe=(0,s.ref)(null),De=async()=>{const e=await new Promise((e=>{xe.value?.validate((async t=>{e(t)}))}));if(!e)return;const a={achievement_id:q.value,gather_confirm_detail:P.value},i=await _(a);i.data.success?(T.value=!1,P.value={order_date:"",receive_account:"",pay_company_name:"",account:"",bank_of_deposit:""},t.root.$message.success(i.data.message),se()):t.root.$message.error(i.data.message)},Ve=(0,s.ref)(null),Ae=async()=>{const e=await new Promise((e=>{Ve.value?.validate((t=>{e(t)}))}));if(!e)return;const a=z.value.list,i={achievement_id:q.value,invoice_info:a.map((e=>{const{show_url:t,...a}=e;return{...a}}))},o=await f(i);o.data.success?(Z.value=!1,z.value={list:[{invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""}]},se(),t.root.$message({type:"success",message:o.data.message})):t.root.$message({type:"error",message:o.data.message})};(0,s.onMounted)((()=>{se(),t.root.$store.hasModule("workbench")||t.root.$store.registerModule("workbench",S.T)}));const Fe=32,Ie=46,Ee=30,Be=12,$e=(0,s.ref)(0),Re=e=>{$e.value=e.height},je=(0,A.Z)({compensation:Fe+Ie+Ee+Be,fixedBlockHeightRefs:[$e],tableMinHeight:100,delay:20}),Le=(0,s.ref)(null),{visible:Te,toggleVisible:Pe}=(0,E.Z)(),qe=async(e,a,i)=>{Pe();const o={id:e,reverse_type:I.Jd.receive,is_pass:a,reverse_back_reason:i},[{data:s}]=await(0,p.Dc)(500,(0,B.aH)(o));return Pe(),s.success?t.root.$message.success(s.message??"提交成功"):t.root.$message.error(s.message??"提交失败"),se(),s.success},Me=(e,t)=>{Le.value?.open(t,((t,a)=>qe(e,t,a)))},Oe=(0,s.ref)(!1),Ze=(0,s.ref)(""),ze=e=>{Ze.value=e,Oe.value=!0},Ue=()=>{Ze.value="",Oe.value=!1},Ne=e=>{const{achievement_uid:t,reversed_id:a}=e;return(0,s.h)("div",{class:"number-div"},[(0,s.h)("span",{class:"number-span "+(null!==a?"reverse-red":"")},t)])},We=(e,t)=>t?`${e.gather_amount_str}`:(0,s.h)("span",{class:null!==e.reversed_id?"reverse-red":""},[`${e.gather_amount_str}`]),Ye=(0,R.zY)(k,"收款金额 (元)",We),He=(e,t)=>{const i=[];if(a.gathering_confirm||a.gathering_upload_edit_invoice){if(null!==e.reversed_id&&e.reverse_status!==$.h0.wait_confirm){const a=t?"查看":(0,s.h)("a",{on:{click:t=>{t.stopPropagation(),ze(e.reverse_reason)}}},["查看"]);i.push(a)}if(null!==e.reversed_id&&e.reverse_status===$.h0.wait_confirm){const a=t?"冲销确认":(0,s.h)("a",{class:"reverse-red",on:{click:t=>{t.stopPropagation(),Me(e.achievement_id,e.reverse_reason)}}},["冲销确认"]);i.push(a)}if(a.gathering_confirm&&0===e.is_gather){const a=t?"收款确认":(0,s.h)("a",{on:{click:t=>{t.stopPropagation(),ve(e)}}},["收款确认"]);i.push(a)}}return t?i.join("  "):(0,s.h)("div",{class:"operation"},i)},Ge=(0,R.zY)(k,"操作",He),Je=(0,s.computed)((()=>[{label:"收款编号",property:"achievement_uid",fixed:"left",minWidth:170,formatter:e=>Ne(e)},{align:"right",label:"收款金额 (元)",fixed:"left",minWidth:Ye.value,formatter:e=>We(e,!1)}])),Qe=(0,s.computed)((()=>[{label:"操作",fixed:"right",align:"center",minWidth:Ge.value,formatter:e=>He(e,!1)}])),Ke=e=>{let t=!1;return t=5===Number(e.gather_type)?e.refund_write_off_info_items&&e.refund_write_off_info_items.length>0:e.write_off_infos&&e.write_off_infos.length>0,t},Xe=e=>{let t=[];return 5===Number(e.gather_type)?(t=e.refund_write_off_info_items??[],t=(e.refund_write_off_info_items??[]).map((e=>{const t={...e};return t.write_off_amount=-1*t.write_off_amount,t}))):t=e.write_off_infos??[],t},et=(0,s.ref)(!1),tt=(0,s.ref)({name:"123"}),at=e=>{tt.value=e,et.value=!0},it=()=>{et.value=!1};return{confirmRow:de,columns:Je,op_columns:Qe,reason:Ze,onReasonViewBtnClick:ze,onReasonDialogClose:Ue,reasonDialogVisible:Oe,ReverseStatus:$.h0,onReverseAuditBtnClick:Me,reverseAuditLoading:Te,reverseAuditDialogRef:Le,onReverseAuditConfirm:qe,invoiceListItemActiveIndex:c,invoicesVisible:u,queryForm:y,list:k,total:j,statistics:F,loading:L,receiveConfirmVisible:T,receiveConfirm:P,achievement_id:q,gather_way:M,receiveConfirmRules:O,uploadVisible:Z,uploadForm:z,uploadFormRules:N,financeInvoiceDetailVisible:Y,invoiceList:H,commonTitle:G,fillEmptyStr:D.Vw,permission:a,workbenchState:J,approval:Q,clearInvoiceListItemActiveIndex:K,beforeAvatarUpload:X,uploadImage:ee,handlePaste:te,inputLoanAmountCost:ae,fetchApprovalInfo:ie,onQueryResetClick:le,getList:se,exportBtnClick:ne,onQuerySearchClick:re,handleCurrentChange:ce,handlePageSizeChange:ue,receiveConfirmBtnClick:ve,receiveConfirmCloseAction:me,uploadCloseAction:fe,deleteUploadItemBtn:ge,goProjectDetail:be,goContractDetail:ye,invoicesDetailDialogRef:we,handleClickApprovalBtn:Ce,invoicelistRef:ke,checkoutPaymentBtn:Se,receiveConfirmRef:xe,handleReceiveConfirmSaveAction:De,uploadRef:Ve,uploadSaveAction:Ae,...je,onTopCardRectUpdate:Re,writeOffPopoverVisible:Ke,writeOffPopoverInfo:Xe,bankAccounts:pe,receiveAccountChange:_e,onRowClick:at,loanDetailVisible:et,detailroval:tt,onLoanDetailClose:it,numberFormat:n.Y4}},components:{LoanfinanceDetailModal:z,reverseAuditDialog:F.Z,FinanceInvoiceDetailDialog:l.Z,Invoicelist:y.Z,InvoicesDetail:C.Z,WriteListPop:k.Z},methods:{numberMoneyFormat:n.rH,receiveType(e){return 1===e?"V任务":2===e?"支付宝":3===e?"对公银行":4===e?"阿里妈妈":5===e?"巨量百应":"--"},addUploadItemBtn(){if(this.uploadForm.list.length>=3)return this.$message.error("最多上传3个!"),!1;this.uploadForm.list.push({invoice_date:"",invoice_num:"",institution:"",amount:"",pic_url:"",show_url:""})},checkoutInvoiceDetailBtn(e){this.invoiceList=e,this.financeInvoiceDetailVisible=!0},closeFinanceInvoiceDetailAction(){this.financeInvoiceDetailVisible=!1}}}),H=Y,G=(0,O.Z)(H,i,o,!1,null,"5f3a764e",null),J=G.exports},17660:function(e,t,a){a.d(t,{Z:function(){return u}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-steps",{staticClass:"invoice-steps",attrs:{direction:"vertical",active:e.items.length}},[e._l(e.items,(function(t,i){return a("el-step",{key:t.nodeId+i},[3===e.stepStatus&&i===e.items.length-1?a("div",{staticClass:"my-icon error",attrs:{slot:"icon"},slot:"icon"},[a("tg-icon",{attrs:{name:"ico-cross-red"}})],1):a("div",{staticClass:"my-icon success",attrs:{slot:"icon"},slot:"icon"},[a("tg-icon",{attrs:{name:"ico-a-chenggong2x"}})],1),a("div",{staticClass:"step-title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(t.nodeName))])]),a("div",{staticClass:"description",attrs:{slot:"description"},slot:"description"},[a("div",{staticClass:"operator"},[a("span",[e._v("审批人：")]),a("span",[e._v(e._s(t.operatorName))])]),t.remark?a("div",{staticClass:"remark",class:3===e.stepStatus&&e.items.length-1===i&&"error-text"},[a("span",[e._v("理由：")]),a("span",[e._v(e._s(t.remark))])]):e._e(),a("div",{staticClass:"timestamp"},[a("span",[e._v(e._s(t.approval_date))])])])])})),1===e.stepStatus&&e.items[e.items.length-1].receivedPersons?a("el-step",[a("div",{staticClass:"my-icon",attrs:{slot:"icon"},slot:"icon"},[a("span",{staticClass:"num received"},[e._v(e._s(e.items.length+1))])]),a("div",{staticClass:"step-title",attrs:{slot:"title"},slot:"title"},[a("span",{staticStyle:{color:"#a4b2c2"}},[e._v(e._s(e.items[e.items.length-1].receivedPersons))])]),a("div",{staticClass:"operator received",attrs:{slot:"description"},slot:"description"},[a("span",{staticStyle:{color:"#a4b2c2"}},[e._v("待处理")])])]):e._e()],2)},o=[],s=a(97434),l=(0,s.defineComponent)({props:{items:{type:Array,default:()=>[]},stepStatus:{type:Number,default:0}}}),n=l,r=a(1001),c=(0,r.Z)(n,i,o,!1,null,null,null),u=c.exports},33018:function(e,t,a){a.d(t,{Z:function(){return w}});var i=a(97434),o=a(61282),s=a(17660),l=a(17496),n=a(64236),r=a(82741),c=a(74750),u=a(51351),p=a(79703),d=a(80972);const v=new Map([[1,"审批中"],[2,"审批成功"],[3,"审批失败"],[4,"已撤销"]]),_=e=>{const t=(0,i.ref)(!1);return{revokeLoading:t}};var m,f,g=(0,i.defineComponent)({components:{Appendix:p.Z,workbenchTimeLine:s.Z,invoiceDialog:d.Z},setup(e,t){const a=(0,i.ref)(null),s=(0,i.ref)(!1),p=(0,i.ref)(!1),d=_(t),m=(0,i.ref)({}),f=(0,i.computed)((()=>t.root.$store.getters["user/getUserInfo"])),g=()=>{t.emit("close"),p.value=!1},h=e=>{m.value=e,p.value=!0},b=e=>(0,u.qL)(e).then((e=>e&&e.data&&e.data.success?(t.root.$message.success("保存成功"),g(),t.emit("reload:invoices"),e):(t.root.$message.error("保存失败"),e.data.message))),y=async()=>{const e=await(0,r.I)(t,"你确定撤销吗?");if(e){const e={approval_id:m.value.approval_id,update_code:4};b(e)}},w=e=>{if(!e)return!1;const a={headers:{Authorization:(0,c.LP)()??""}};fetch(e,a).then((async a=>{const i=a.clone();try{const e=await i.json();t.root.$message.error(e.message)}catch{if(200===a.status){const t=await a.blob(),i=decodeURIComponent(e.split("/")[e.split("/").length-1]);(0,n.uA)(t,i)}else t.root.$message.error("下载失败")}}))},C=e=>{if(!e)return"ico-picture";switch(e.toLowerCase()){case"docx":case"doc":return"ico-word";case"xlsx":case"xls":return"ico-excel";case"pdf":return"ico-pdf";case"mp4":return"ico-picture2";default:return"ico-picture"}},k=()=>{if(m.value.attachment){const e=m.value.attachment.map((e=>{const t=e.split("/"),a=t[t.length-1],o=a.split("."),s=o[o.length-1];return(0,i.h)("span",{class:"value",on:{click(){w(e)}}},[(0,i.h)("tg-icon",{attrs:{name:C(s)}},s),a])}));return(0,i.h)("div",{class:"load"},[e])}return(0,i.h)("span",{class:"value"},"--")},S=(0,i.computed)((()=>f&&f.value.id===m.value.now_id)),x=(0,i.computed)((()=>f&&f.value.id===m.value.add_by)),D=()=>{a.value?.show()},V=async()=>{const e=await(0,r.I)(t,"你确定重新提交吗?");e&&Promise.resolve().then((()=>{s.value=!0})).then((()=>{D()}))},A=()=>{s.value=!1,g(),t.emit("reload:invoices")};return{show:h,hide:g,revoke:y,visible:p,btnVisiable:S,invoiceDetail:m,contractStatus:v,Decimal2String:o.SJ,...d,renderAttachment:k,enumLevelTwoTypes:l.rw,revocationVisiable:x,reApply:V,invoiceDialogRef:a,confirmInvoiceDialog:A,invoiceDialogVisible:s}},render(){const e=arguments[0];return e("div",[e("el-dialog",{class:"tg-dialog-classic tg-dialog-vcenter-new new-invoice-detail-dialog",attrs:{width:"948px",visible:this.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1},on:{close:this.hide}},[e("template",{slot:"title"},["开票申请详情"]),e("div",{class:"new-invoice-detail"},[e("div",{class:"invoice-detail"},[e("div",{class:"invoice-detail-info"},[e("div",{class:"detail-row"},[e("span",{class:"label"},["申请人："]),e("span",{class:"value"},[this.invoiceDetail.username])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["申请部门："]),e("span",{class:"value"},[this.invoiceDetail.create_department])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["发起时间："]),e("span",{class:"value"},[this.invoiceDetail.gmt_create])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["审批编号："]),e("span",{class:"value"},[this.invoiceDetail.approval_uid]),e("span",{class:"contract-status status-"+this.invoiceDetail.approval_status},[this.contractStatus.get(this.invoiceDetail.approval_status)])]),e("div",{class:"line"}),e("div",{class:"detail-row",style:"margin-top: 22px"},[e("span",{class:"label"},["开票金额："]),e("span",{class:"value"},[this.invoiceDetail.invoice_amount_str])]),e("div",{class:"detail-row",style:"margin-top: 22px"},[e("span",{class:"label"},["开票类型："]),e("span",{class:"value"},[this.enumLevelTwoTypes(this.invoiceDetail.level_two_types)])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["寄送方式："]),e("span",{class:"value"},[1===this.invoiceDetail.invoice_send_type?"快递寄送":"自行送达"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["是否收到款项："]),e("span",{class:"value"},[this.invoiceDetail.is_received?"是":"否"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},[this.invoiceDetail.is_received?"":"预计","收款时间："]),e("span",{class:"value"},[this.invoiceDetail.received_date])]),1===this.invoiceDetail.is_received&&e("div",{class:"detail-row"},[e("span",{class:"label"},["收款编号："]),e("span",{class:"value"},[this.invoiceDetail.achievement_uid])])]),e("div",{class:"invoice-detail-table"},[e("div",{class:"detail-table-head"},[e("span",{class:"table-head-td"},["项目"]),e("span",{class:"table-head-td"},["结算单编号"]),e("span",{class:"table-head-td text-r"},["结算金额 (元)"]),e("span",{class:"table-head-td text-r"},["本次开票金额 (元)"])]),e("div",{class:"detail-table-body"},[this.invoiceDetail.details&&this.invoiceDetail.details.map((t=>e("div",{class:"table-body-tr"},[e("span",{class:"table-body-td"},[t.project_name]),e("span",{class:"table-body-td"},[t.settlement_no]),e("span",{class:"table-body-td text-r"},[this.Decimal2String(t.settlement_amount)]),e("span",{class:"table-body-td text-r"},[this.Decimal2String(t.invoice_amount)])])))])]),e("div",{class:"line2",style:"margin-top: 32px;"}),e("div",{class:"invoice-detail-info"},[e("div",{class:"detail-row"},[e("span",{class:"label"},["公司名称："]),e("span",{class:"value"},[this.invoiceDetail.collecting_company||"--"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["纳税人识别号："]),e("span",{class:"value"},[this.invoiceDetail.tax_number||"--"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["地址|电话："]),e("span",{class:"value block"},[this.invoiceDetail.address||"--"," ",this.invoiceDetail.phone||"--"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["开户行|账号："]),e("span",{class:"value block"},[this.invoiceDetail.bank_of_deposit||"--","  ",this.invoiceDetail.bank_card_number||"--"])])]),e("div",{class:"line2"}),e("div",{class:"invoice-detail-info"},[e("div",{class:"detail-row"},[e("span",{class:"label"},["备注："]),e("span",{class:"value block"},[this.invoiceDetail.remark||"--"])]),e("div",{class:"detail-row"},[e("span",{class:"label"},["附件："]),this.invoiceDetail?.attachment?.length?e("appendix",{attrs:{list:this.invoiceDetail.attachment}}):e("span",{class:"value"},["--"])])])]),e("div",{class:"invoice-press"},[e("h5",{class:"title"},["审批进度"]),e(s.Z,{attrs:{"step-status":this.invoiceDetail.approval_status,items:this.invoiceDetail.approval_flow_detail}})])]),e("template",{slot:"footer"},[e("tg-button",{on:{click:this.hide}},["取消"]),1===this.invoiceDetail.approval_status&&this.revocationVisiable&&e("div",{class:"div-default-btn",on:{click:this.revoke},directives:[{name:"loading",value:this.saveLoading}]},["撤销"]),3===this.invoiceDetail.approval_status&&e("div",{class:"div-default-btn",on:{click:this.reApply},directives:[{name:"loading",value:this.saveLoading}]},["重新编辑提交"])])]),this.invoiceDialogVisible&&e(d.Z,{ref:"invoiceDialogRef",attrs:{confirm:this.confirmInvoiceDialog,data:this.invoiceDetail,edit:!0}})])}}),h=g,b=a(1001),y=(0,b.Z)(h,m,f,!1,null,null,null),w=y.exports},17809:function(e,t,a){a.d(t,{T:function(){return X}});var i={};a.r(i),a.d(i,{setAdvanceDetailVisible:function(){return L},setAdvanceFormDialogVisible:function(){return R},setAdvanceFormVisible:function(){return j},setApproval:function(){return V},setCustomerDetailVisible:function(){return B},setInvoicingDetailVisible:function(){return P},setInvoicingFormVisible:function(){return T},setLoanDetailVisible:function(){return F},setLoanFormVisible:function(){return A},setProjectApprovalVisible:function(){return Z},setRedDetailVisible:function(){return q},setRefundDetailVisible:function(){return E},setRefundFormVisible:function(){return I},setSupplierDetailVisible:function(){return $},setUseSealApplyDetailVisible:function(){return O},setVoidDetailVisible:function(){return M}});var o={};a.r(o),a.d(o,{advanceDetailVisible:function(){return J},advanceFormDialogVisible:function(){return H},advanceFormVisible:function(){return G},approval:function(){return z},customerDetailVisible:function(){return Q},loanDetailVisible:function(){return N},loanFormVisible:function(){return U},refundDetailVisible:function(){return Y},refundFormVisible:function(){return W},supplierDetailVisible:function(){return K}});const s={approval:void 0,loanFormVisible:!1,loanDetailVisible:!1,refundFormVisible:!1,refundDetailVisible:!1,advanceFormDialogVisible:!1,advanceFormVisible:!1,advanceDetailVisible:!1,invoicingFormVisible:!1,invoicingDetailVisible:!1,customerDetailVisible:!1,supplierDetailVisible:!1,redDetailVisible:!1,voidDetailVisible:!1,useSealApplyDetailVisible:!1,projectApprovalVisible:!1};var l=s;const n="SET_APPROVAL",r="CLEAR_APPROVAL",c="SET_LOAN_FORM_VISIBLE",u="SET_LOAN_DETAIL_VISIBLE",p="SET_REFUND_FORM_VISIBLE",d="SET_REFUND_DETAIL_VISIBLE",v="SET_ADVANCE_FORM_DIALOG_VISIBLE",_="SET_ADVANCE_FORM_VISIBLE",m="SET_ADVANCE_DETAIL_VISIBLE",f="SET_INVOICING_FORM_VISIBLE",g="SET_INVOICING_DETAIL_VISIBLE",h="SET_CUSTOMER_DETAIL_VISIBLE",b="SET_SUPPLIER_DETAIL_VISIBLE",y="SET_RED_DETAIL_VISIBLE",w="SET_VOID_DETAIL_VISIBLE",C="SET_USE_SEAL_DETAIL_VISIBLE",k="SET_PROJECT_APPROVAL_VISIBLE";var S=a(64236);const x={[n]:(e,t)=>{e.approval=(0,S.Qc)(t)},[r]:e=>{e.approval=void 0},[c]:(e,t)=>{e.loanFormVisible=t},[u]:(e,t)=>{e.loanDetailVisible=t},[p]:(e,t)=>{e.refundFormVisible=t},[d]:(e,t)=>{e.refundDetailVisible=t},[h]:(e,t)=>{e.customerDetailVisible=t},[b]:(e,t)=>{e.supplierDetailVisible=t},[v]:(e,t)=>{e.advanceFormDialogVisible=t},[_]:(e,t)=>{e.advanceFormVisible=t},[m]:(e,t)=>{e.advanceDetailVisible=t},[f]:(e,t)=>{e.invoicingFormVisible=t},[g]:(e,t)=>{e.invoicingDetailVisible=t},[y]:(e,t)=>{e.redDetailVisible=t},[w]:(e,t)=>{e.voidDetailVisible=t},[C]:(e,t)=>{e.useSealApplyDetailVisible=t},[k]:(e,t)=>{e.projectApprovalVisible=t}};var D=x;const V=({commit:e},t)=>{e(n,t)},A=({commit:e},t)=>{e(c,t)},F=({commit:e},t)=>{e(u,t)},I=({commit:e},t)=>{e(p,t)},E=({commit:e},t)=>{e(d,t)},B=({commit:e},t)=>{e(h,t)},$=({commit:e},t)=>{e(b,t)},R=({commit:e},t)=>{e(v,t)},j=({commit:e},t)=>{e(_,t)},L=({commit:e},t)=>{e(m,t)},T=({commit:e},t)=>{e(f,t)},P=({commit:e},t)=>{e(g,t)},q=({commit:e},t)=>{e(y,t)},M=({commit:e},t)=>{e(w,t)},O=({commit:e},t)=>{e(C,t)},Z=({commit:e},t)=>{e(k,t)},z=e=>e.approval,U=e=>e.loanFormVisible,N=e=>e.loanDetailVisible,W=e=>e.refundFormVisible,Y=e=>e.refundDetailVisible,H=e=>e.advanceFormDialogVisible,G=e=>e.advanceFormVisible,J=e=>e.advanceDetailVisible,Q=e=>e.customerDetailVisible,K=e=>e.supplierDetailVisible,X={namespaced:!0,state:l,mutations:D,actions:i,getters:o}},29625:function(e,t,a){var i,o;a.d(t,{Bs:function(){return v},C_:function(){return n},RB:function(){return _},UN:function(){return u},WD:function(){return i},Wj:function(){return r},Y$:function(){return o},Yh:function(){return l},Zb:function(){return s},i8:function(){return d},kA:function(){return m},x3:function(){return c}}),function(e){e[e["marketing"]=1]="marketing",e[e["taobao"]=2]="taobao",e[e["douyin"]=3]="douyin",e[e["base"]=4]="base",e[e["mcn"]=5]="mcn",e[e["douyinsh"]=7]="douyinsh"}(i||(i={})),function(e){e[e["common"]=1]="common",e[e["system"]=2]="system"}(o||(o={}));const s=new Map([[i.marketing,"营销业务"],[i.douyin,"抖音店播"],[i.taobao,"淘宝店播"],[i.base,"基地业务"],[i.mcn,"S2B2C"],[i.douyinsh,"抖音店播(上海)"]]),l=[{value:i.marketing,label:"整合营销"},{value:i.douyin,label:"抖音店播"},{value:i.taobao,label:"淘宝店播"},{value:i.mcn,label:"S2B2C"},{value:i.douyinsh,label:"抖音店播(上海)"}];var n;(function(e){e[e["creation"]=1]="creation",e[e["tryLive"]=2]="tryLive",e[e["execution"]=3]="execution",e[e["regionExecution"]=4]="regionExecution",e[e["finish"]=5]="finish",e[e["executionEnd"]=6]="executionEnd"})(n||(n={}));const r=new Map([[n.creation,"项目创建"],[n.tryLive,"试播中"],[n.execution,"项目执行中"],[n.regionExecution,"区域执行中"],[n.executionEnd,"执行结束"],[n.finish,"已完结"]]);var c;(function(e){e[e["region"]=2]="region",e[e["selfSupport"]=1]="selfSupport"})(c||(c={}));const u=new Map([[c.region,"区域"],[c.selfSupport,"自营"]]);var p;(function(e){e[e["month"]=1]="month",e[e["quarter"]=2]="quarter",e[e["halfAyear"]=3]="halfAyear"})(p||(p={}));const d=new Map([[p.month,"月结"],[p.quarter,"季结"],[p.halfAyear,"半年"]]),v=new Map([[1,"美妆"],[2,"生活"],[3,"服饰"],[4,"美食"],[5,"母婴"],[6,"数码"],[7,"家装"],[8,"健康"],[9,"宠物"],[10,"时尚"],[11,"配饰"],[12,"家电"],[13,"测评"],[14,"旅行"],[15,"运动"],[16,"摄影"],[17,"情感"],[18,"汽车"],[19,"搞笑"],[20,"教育"],[21,"财经"],[22,"萌娃"],[23,"文化"],[24,"影视"],[25,"娱乐"],[26,"游戏"],[27,"海外"],[28,"才艺"],[29,"三农"],[30,"二次元"],[31,"高颜值"]]);function _(e){return 0===e?"无":v.get(e)??"无"}var m;(function(e){e[e["live"]=1]="live",e[e["marketing"]=2]="marketing",e[e["common_business"]=3]="common_business"})(m||(m={}))},28348:function(e,t,a){a.d(t,{$m:function(){return v},Cy:function(){return m},D_:function(){return r},FA:function(){return c},GG:function(){return d},Jd:function(){return o.Jd},Qn:function(){return p},Ti:function(){return f},br:function(){return u},dw:function(){return l},eY:function(){return _},gf:function(){return g},kX:function(){return i},mR:function(){return h},ne:function(){return n},v$:function(){return s}});var i,o=a(67578);(function(e){e[e["live_taobao"]=1]="live_taobao",e[e["live_douyin"]=2]="live_douyin",e[e["marketing_marketing"]=3]="marketing_marketing",e[e["common_mcn_taobao_cps"]=4]="common_mcn_taobao_cps",e[e["common_mcn_douyin_cps"]=5]="common_mcn_douyin_cps",e[e["common_mcn_vtask"]=6]="common_mcn_vtask",e[e["marketing_vtask"]=7]="marketing_vtask",e[e["s2b2c_douyin_cps"]=8]="s2b2c_douyin_cps"})(i||(i={}));const s=new Map([[i.live_douyin,"抖音店播"],[i.live_taobao,"淘宝店播"],[i.marketing_marketing,"营销-营销"],[i.common_mcn_douyin_cps,"S2B2C-抖音"],[i.common_mcn_taobao_cps,"S2B2C-淘宝CPS"],[i.common_mcn_vtask,"S2B2C-V任务"],[i.marketing_vtask,"营销-V任务"],[i.s2b2c_douyin_cps,"S2B2C-抖音CPS"]]),l=[{value:i.live_douyin,label:"抖音店播",group:"店铺代播"},{value:i.live_taobao,label:"淘宝店播",group:"店铺代播"},{value:i.common_mcn_douyin_cps,label:"S2B2C-抖音",group:"S2B2C"},{value:i.common_mcn_taobao_cps,label:"S2B2C-淘宝CPS",group:"S2B2C"},{value:i.s2b2c_douyin_cps,label:"S2B2C-抖音CPS",group:"S2B2C"},{value:i.common_mcn_vtask,label:"S2B2C-V任务",group:"S2B2C"},{value:i.marketing_marketing,label:"营销-营销",group:"营销"},{value:i.marketing_vtask,label:"营销-V任务",group:"营销"}];var n;(function(e){e[e["unsubmit"]=0]="unsubmit",e[e["wait_confirm"]=1]="wait_confirm",e[e["confirmed"]=2]="confirmed",e[e["refused"]=3]="refused",e[e["wait_project_confirm"]=4]="wait_project_confirm",e[e["nopass_project_confirm"]=5]="nopass_project_confirm"})(n||(n={}));const r=new Map([[n.unsubmit,"未提交"],[n.wait_confirm,"待确认"],[n.confirmed,"已确认"],[n.refused,"退回"],[n.wait_project_confirm,"待项目确认"],[n.nopass_project_confirm,"项目确认不通过"]]),c=[{value:n.unsubmit,label:"未提交"},{value:n.wait_confirm,label:"待确认"},{value:n.confirmed,label:"已确认"},{value:n.refused,label:"退回"},{value:n.wait_project_confirm,label:"待项目确认"},{value:n.nopass_project_confirm,label:"项目确认不通过"}];var u,p,d,v;(function(e){e[e["step_one"]=0]="step_one",e[e["step_two"]=1]="step_two",e[e["step_three"]=2]="step_three"})(u||(u={})),function(e){e[e["income"]=1]="income",e[e["cost"]=2]="cost"}(p||(p={})),function(e){e[e["close"]=0]="close",e[e["prev"]=1]="prev",e[e["next"]=2]="next"}(d||(d={})),function(e){e[e["Hourly"]=1]="Hourly",e[e["Basic_or_commision"]=2]="Basic_or_commision",e[e["Basic_and_commision"]=3]="Basic_and_commision"}(v||(v={}));new Map([[v.Hourly,"时薪"],[v.Basic_or_commision,"底薪/提成(取高的)"],[v.Basic_and_commision,"底薪+提成"]]);var _,m;(function(e){e[e["pit_fee"]=1]="pit_fee",e[e["head_service_fee"]=2]="head_service_fee",e[e["douyin_cps"]=3]="douyin_cps",e[e["xingtu"]=4]="xingtu",e[e["shangguang"]=5]="shangguang",e[e["other"]=6]="other",e[e["talent_cost"]=7]="talent_cost",e[e["put"]=8]="put",e[e["anchor"]=9]="anchor",e[e["unity"]=10]="unity"})(_||(_={})),function(e){e[e["merchant_project"]=1]="merchant_project",e[e["execute_project"]=2]="execute_project"}(m||(m={}));const f=new Map([[_.pit_fee,"坑位费"],[_.head_service_fee,"团长服务费"],[_.douyin_cps,"抖音CPS"],[_.xingtu,"星图"],[_.shangguang,"商广"],[_.other,"其他"]]),g=new Map([[_.pit_fee,"坑位费"],[_.talent_cost,"达人成本"],[_.put,"投放成本"],[_.xingtu,"星图"],[_.shangguang,"商广"],[_.other,"其他"]]),h=new Map([[_.anchor,"主播成本"],[_.put,"投放成本"],[_.other,"其他成本"]])},82741:function(e,t,a){a.d(t,{I:function(){return o},u:function(){return s}});var i=a(71340);const o=(e,t)=>{const a="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...a,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},s=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,a)=>{(0,i.t)({...t,onConfirm:()=>e(!0),onCancel:()=>a()})}))}},58861:function(e,t,a){var i=a(97434);const o=(e=!1)=>{const t=(0,i.ref)(e),a=(e=!1)=>t.value=e,o=()=>t.value=!t.value;return{visible:(0,i.computed)((()=>t.value)),setVisible:a,toggleVisible:o}};t["Z"]=o},40290:function(e,t,a){a.d(t,{k:function(){return o}});var i=a(1763);const o=e=>{const t={jumpProjectDetail:e=>{const a={name:i.FB.project.detail,params:{id:`${e.project_id}`,tab:e.tab??"projectInfo",liveType:e.liveType??"calendar"}},o=e.newWindow??!1;t.jump(a,o)},jumpLiveDisplayDetail:e=>{const a={name:i.FB.display.detail,params:{id:`${e.project_id}`,liveId:`${e.live_id}`,tab:"live",liveType:e.liveType??"calendar"}},o=e.newWindow??!1;t.jump(a,o)},jump:(t,a=!1)=>{if(a){const{href:a}=e.root.$router.resolve(t);window.open(a,"_blank")}else e.root.$router.push(t)}};return{...t}}},43773:function(e,t,a){a.d(t,{R:function(){return d},y:function(){return v}});var i=a(36568),o=a.n(i),s=a(97434),l=a(64923),n=a(77944);let r=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+r++,document.body.appendChild(e),e},u=new Function,p=(e,t)=>{let a=e;return void 0===a&&(a={}),Object.keys(t).forEach((e=>{const i=a[e]||u,o=t[e];a[e]=(...e)=>{if(!1!==o(...e))return i(...e)}})),a},d=(e={})=>{const t=(0,s.ref)(),a=(0,s.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),i=(0,s.ref)(!0),r=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};r(e);const u=(0,s.ref)(p(e.on,{close(){a.visible=!1},updateDialog(e={}){r(e)}})),d=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,s.provide)(t,e.provide[t])}))},render(t){if(i.value&&a.visible)return t("el-dialog",o()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value}),a.footer&&t("fragments",{slot:"footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const v=(...e)=>{a.visible||(a.visible=!0,(0,s.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},_=e=>(r(e),g),m=()=>{a.visible=!1},f=(e,t,a=!1)=>(!0===a?u.value[e]=t:p(u.value,{[e]:t}),g);(0,s.onUnmounted)((()=>{i.value=!1,a.visible=!1}));const g=(0,s.reactive)({show:v,update:_,on:f,close:m,config:e,data:e.data});return g},v=(e={})=>{const t=(0,s.ref)(),a=(0,s.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),i=(0,s.ref)(!0),r=e=>{Object.keys(e).forEach((t=>{a.hasOwnProperty.call(a,t)&&(a[t]=e[t])}))};r(e);const u=(0,s.ref)(p(e.on,{close(){a.visible=!1},updateDialog(e={}){r(e)}})),d=()=>{const e=t.value.$refs&&t.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};t.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((t=>{(0,s.provide)(t,e.provide[t])}))},render(t){if(!i.value)return;if(!a.visible)return;const{width:s,...l}=a;return t("el-drawer",o()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...l,size:s}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[t("div",{class:"tg-drawer-content"},[a.visible&&t(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:u.value})]),a.footer&&t("div",{class:"tg-drawer-footer"},[t("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&t("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const v=(...e)=>{a.visible||(a.visible=!0,(0,s.nextTick)((()=>{const a=t.value.$refs&&t.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...e):a.show&&a.show(...e):console.log("未找到子组件请检查代码")})))},_=e=>(r(e),g),m=()=>{a.visible=!1},f=(e,t,a=!1)=>(!0===a?u.value[e]=t:p(u.value,{[e]:t}),g);(0,s.onUnmounted)((()=>{i.value=!1,a.visible=!1}));const g=(0,s.reactive)({show:v,update:_,on:f,close:m,config:e});return g}}}]);