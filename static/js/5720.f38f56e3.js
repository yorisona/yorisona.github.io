"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[5720],{15720:function(e,t,a){a.r(t),a.d(t,{default:function(){return B}});var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tg-page-container tg-public-studio-page"},[a("tg-card",{attrs:{padding:[18,18,6,18]},on:{"rect:update":e.onTopCardRectUpdate}},[a("el-form",{attrs:{size:"small","show-message":!1},nativeOn:{submit:function(e){e.preventDefault()}}},[a("div",{staticClass:"filter-form-div"},[a("div",{staticClass:"filter-form-item"},[a("el-form-item",{staticClass:"flex-form-item",staticStyle:{"margin-bottom":"14px"},attrs:{label:"业务类型：","label-width":"70px"}},[a("el-select",{staticClass:"select",staticStyle:{width:"100%"},attrs:{placeholder:""},model:{value:e.queryForm.select_business_type,callback:function(t){e.$set(e.queryForm,"select_business_type",t)},expression:"queryForm.select_business_type"}},[a("el-option",{attrs:{label:"全部",value:-1}}),a("el-option",{attrs:{label:"营销业务",value:1}}),a("el-option",{attrs:{label:"抖音店播",value:3}}),a("el-option",{attrs:{label:"淘宝店播",value:2}})],1)],1)],1),a("div",{staticClass:"filter-form-item"},[a("el-form-item",{attrs:{label:"直播间名称：","label-width":"85px"}},[a("el-input",{staticClass:"input",attrs:{placeholder:"请输入直播间名称"},model:{value:e.queryForm.studio_name,callback:function(t){e.$set(e.queryForm,"studio_name",t)},expression:"queryForm.studio_name"}})],1)],1),a("div",{staticClass:"filter-form-item"},[a("el-form-item",[a("div",{staticClass:"filter-form-item-btn"},[a("tg-button",{attrs:{type:"primary"},on:{click:e.onQuerySearchClick}},[e._v("查询")]),a("tg-button",{staticClass:"mgl-12",on:{click:e.onQueryResetClick}},[e._v("重置")])],1)])],1)])])],1),a("tg-card",e._b({directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mgt-12 flex-auto",attrs:{padding:[0,18,0,18]},on:{"rect:update":e.onRectUpdate}},"tg-card",e.cardProps,!1),[e.Permission.canEdit?a("div",{staticStyle:{"margin-top":"12px"}},[a("tg-button",{attrs:{type:"primary",icon:"ico-btn-add"},on:{click:function(t){return e.toggleAddStudioModalVisible(!0)}}},[e._v("新增直播间")])],1):e._e(),a("el-table",e._b({staticStyle:{"margin-top":"12px"},attrs:{stripe:"",data:e.list},scopedSlots:e._u([{key:"empty",fn:function(){return[a("empty-common",{attrs:{"detial-text":"暂无直播间"}})]},proxy:!0}])},"el-table",e.tableProps,!1),e._l(e.columns,(function(t,o){return a("el-table-column",e._b({key:o},"el-table-column",t,!1))})),1),e.total>0&&e.Permission.canViewList?a("el-pagination",{staticStyle:{margin:"8px 0"},attrs:{"current-page":e.queryForm.page_num,"page-sizes":[10,20,50,100],"page-size":e.queryForm.num,layout:"total, prev, pager, next, sizes, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.queryForm,"page_num",t)},"update:current-page":function(t){return e.$set(e.queryForm,"page_num",t)},"current-change":e.handleCurrentChange,"size-change":e.handlePageSizeChange}}):e._e()],1),a("AddStudio",{attrs:{visible:e.AddStudioVisible,studio:e.currentStudio},on:{"dialog:close":e.onAddStudioModalClose}})],1)},s=[],n=a(97434);const i=()=>({});var r=a(64236),u=a(3422),l=a(29625),d=a(78902),c=a(21757),m=a(61282),p=a(67910);const v=e=>{const t=(0,n.computed)((()=>{const e=(0,c.kG)(d.HN.studio_save);return{canEdit:e}})),a=(0,n.ref)(!1),o=(0,n.ref)(!1),s=(0,n.ref)(void 0),i=(e=!1)=>{a.value=e},v=(0,n.ref)([]),f=(0,n.ref)(0),g=async t=>{o.value=!0;const[a,{data:s}]=await Promise.all([await(0,r._v)(500),await(0,u.Q)(t)]);o.value=!1,s.success?(v.value=s.data.data,f.value=s.data.total):e.root.$message({type:"warning",message:s.message??"查询失败，稍后重试",duration:2e3,showClose:!0})},b=e=>{s.value=e,i(!0)},_=(e,t,a)=>{const o=e[t]||"--",{is_folded:s,folded_text:i}=(0,m.zb)(o,12);return a?i:s?(0,n.h)("el-popover",{props:{placement:"right",trigger:"hover",content:o}},[(0,n.h)("span",{slot:"reference"},[i])]):i},h=(e,t)=>_(e,"studio_name",t),y=(0,p.zY)(v,"直播间名称",h),x=e=>e.business_type.map((e=>l.Zb.get(e)??"")).join("、"),k=(0,n.computed)((()=>[{label:"直播间名称",property:"studio_name",minWidth:y.value,formatter:e=>h(e,!1)},{label:"业务类型",property:"business_type",minWidth:300,formatter:x},{label:"直播间地址",minWidth:200,property:"studio_address",formatter:e=>e.studio_address&&""!==e.studio_address&&e.studio_address.length>12?(0,n.h)("el-popover",{props:{palcement:"top",trigger:"hover"}},[(0,n.h)("div",{class:"line-clamp-2",slot:"reference"},[e.studio_address]),(0,n.h)("div",{style:{minWidth:"20px",maxWidth:"400px"}},[e.studio_address])]):(0,n.h)("DefText",{props:{content:e.studio_address}})},{label:"操作",width:86,formatter:e=>t.value.canEdit?(0,n.h)("a",{on:{click:()=>b(e)}},["编辑"]):""}]));return{currentStudio:s,list:v,total:f,columns:k,toggleAddStudioModalVisible:i,AddStudioVisible:a,loading:o,loadData:g}};var f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"customer-dialog studio-form-modal tg-dialog-vcenter",attrs:{visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"493px",top:"20vh"},on:{close:e.onCancelBtnClick},scopedSlots:e._u([{key:"title",fn:function(){return[a("span",[e._v(e._s(e.formTitle))])]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{on:{click:e.onCancelBtnClick}},[e._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:e.onSaveBtnClick}},[e._v("保存")])]},proxy:!0}])},[a("div",{staticClass:"dialog-content"},[a("el-form",{ref:"formRef",attrs:{rules:e.studioFormRules,model:e.studioForm,"label-width":"112px"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",{attrs:{label:"直播间名称：",prop:"studio_name"}},[a("el-input",{ref:"autoFocuseRef",staticStyle:{width:"360px"},attrs:{size:"medium",maxlength:10,placeholder:"请输入直播间名称"},model:{value:e.studioForm.studio_name,callback:function(t){e.$set(e.studioForm,"studio_name","string"===typeof t?t.trim():t)},expression:"studioForm.studio_name"}})],1),a("el-form-item",{staticClass:"checkboxRow",attrs:{label:"业务类型：",prop:"business_type"}},[a("el-checkbox-group",{staticClass:"studio-checkbox-group",model:{value:e.studioForm.business_type,callback:function(t){e.$set(e.studioForm,"business_type",t)},expression:"studioForm.business_type"}},[a("el-checkbox",{staticClass:"studio-checkbox",attrs:{label:1}},[e._v("营销业务")]),a("el-checkbox",{staticClass:"studio-checkbox",attrs:{label:3}},[e._v("抖音店播")]),a("el-checkbox",{staticClass:"studio-checkbox",attrs:{label:2}},[e._v("淘宝店播")])],1)],1),a("el-form-item",{attrs:{label:"直播间地址：",prop:"studio_address"}},[a("el-input",{staticStyle:{width:"360px"},attrs:{type:"textarea",rows:5,maxlength:100,"show-word-limit":"",placeholder:"请输入文本"},model:{value:e.studioForm.studio_address,callback:function(t){e.$set(e.studioForm,"studio_address","string"===typeof t?t.trim():t)},expression:"studioForm.studio_address"}})],1)],1)],1)])},g=[],b=a(53451),_=a.n(b);const{debounce:h}=_();var y=(0,n.defineComponent)({name:"AddStudio",props:{visible:{type:Boolean,required:!0},studio:{type:Object,required:!1}},setup(e,t){const a=(0,n.ref)(null),o=(0,n.ref)(void 0),s=(0,n.ref)("新增直播间"),i=()=>{t.emit("dialog:close"),l()},r=(0,n.ref)({id:-1,business_type:[],studio_address:"",studio_name:""}),l=()=>{r.value.studio_name="",r.value.id=-1,r.value.studio_address="",r.value.business_type=[]};(0,n.watch)((()=>e.visible),(t=>{a.value?.clearValidate(),t&&(s.value=void 0===e.studio?"新增直播间":"编辑直播间",void 0!==e.studio?(r.value.studio_name=e.studio.studio_name,r.value.id=e.studio.id,r.value.studio_address=e.studio.studio_address,r.value.business_type=e.studio.business_type):(0,n.nextTick)((()=>{o.value?.focus()})))}));const d=(0,n.ref)({studio_name:[{required:!0,message:"请输入直播间名称",trigger:"blur"}],business_type:[{required:!0,message:"请选择业务类型",trigger:"change"}]}),c=async()=>{if(void 0===r?.value)return;const e=await new Promise((e=>a.value?.validate((t=>e(t)))));if(!e)return;const o={studio_name:r.value.studio_name,business_type:r.value.business_type};r?.value.studio_address&&(o.studio_address=r.value.studio_address),-1!==r?.value.id&&(o.id=r.value.id);const{data:s}=await(0,u.V)(o);s.success?(t.root.$message.success(s.message),t.emit("dialog:close",!0),l()):t.root.$message.error(s.message??"直播间保存失败")},m=h(c,200);return{autoFocuseRef:o,formTitle:s,formRef:a,studioFormRules:d,studioForm:r,onSaveBtnClick:m,onCancelBtnClick:i}}}),x=y,k=a(1001),C=(0,k.Z)(x,f,g,!1,null,null,null),w=C.exports,S=a(20809),F=(0,n.defineComponent)({name:"TgPublicStudio",components:{AddStudio:w},setup(e,t){const{tableHeightLogic:a,onTopCardRectUpdate:o}=(0,S.Z)(),s=(0,n.ref)({studio_name:"",page_num:1,business_type:"",select_business_type:-1,num:20}),r=v(t),u=async e=>{r.currentStudio.value=void 0,r.toggleAddStudioModalVisible(),e&&await l()},l=async(e=!0)=>{e&&(s.value.page_num=1);const t={page_num:s.value.page_num,num:s.value.num,business_type:""};if(s.value.studio_name&&(t.studio_name=s.value.studio_name),-1!==s.value.select_business_type){const e=s.value.select_business_type??"";t.business_type=e.toString()}await r.loadData(t)},m=e=>{s.value.page_num=e,l(!1)},p=e=>{s.value.num=e,l()},f=()=>{l()},g=()=>{s.value.studio_name="",s.value.select_business_type=-1,l()},b=(0,n.computed)((()=>{const e=(0,c.kG)(d.HN.studio_list),t=(0,c.kG)(d.HN.studio_save);return{canEdit:t,canViewList:e}}));return{Permission:b,queryForm:s,handleCurrentChange:m,handlePageSizeChange:p,onQuerySearchClick:f,onQueryResetClick:g,...i(),onAddStudioModalClose:u,...r,reload:l,onTopCardRectUpdate:o,...a}},async mounted(){this.queryBrandList()},methods:{async queryBrandList(){await this.reload()}}}),q=F,R=(0,k.Z)(q,o,s,!1,null,null,null),B=R.exports},3422:function(e,t,a){a.d(t,{Q:function(){return r},V:function(){return u}});var o=a(76012),s=a(64236);const n="/api/studio/query_studio",i="/api/studio/save_studio",r=async e=>(0,o.dX)(n,{params:{...(0,s.jG)(e)}}),u=async e=>(0,o.SO)(i,{...(0,s.jG)(e)})},29625:function(e,t,a){var o,s;a.d(t,{Bs:function(){return p},C_:function(){return r},RB:function(){return v},UN:function(){return d},WD:function(){return o},Wj:function(){return u},Y$:function(){return s},Yh:function(){return i},Zb:function(){return n},i8:function(){return m},kA:function(){return f},x3:function(){return l}}),function(e){e[e["marketing"]=1]="marketing",e[e["taobao"]=2]="taobao",e[e["douyin"]=3]="douyin",e[e["base"]=4]="base",e[e["mcn"]=5]="mcn",e[e["douyinsh"]=7]="douyinsh"}(o||(o={})),function(e){e[e["common"]=1]="common",e[e["system"]=2]="system"}(s||(s={}));const n=new Map([[o.marketing,"营销业务"],[o.douyin,"抖音店播"],[o.taobao,"淘宝店播"],[o.base,"基地业务"],[o.mcn,"S2B2C"],[o.douyinsh,"抖音店播(上海)"]]),i=[{value:o.marketing,label:"整合营销"},{value:o.douyin,label:"抖音店播"},{value:o.taobao,label:"淘宝店播"},{value:o.mcn,label:"S2B2C"},{value:o.douyinsh,label:"抖音店播(上海)"}];var r;(function(e){e[e["creation"]=1]="creation",e[e["tryLive"]=2]="tryLive",e[e["execution"]=3]="execution",e[e["regionExecution"]=4]="regionExecution",e[e["finish"]=5]="finish",e[e["executionEnd"]=6]="executionEnd"})(r||(r={}));const u=new Map([[r.creation,"项目创建"],[r.tryLive,"试播中"],[r.execution,"项目执行中"],[r.regionExecution,"区域执行中"],[r.executionEnd,"执行结束"],[r.finish,"已完结"]]);var l;(function(e){e[e["region"]=2]="region",e[e["selfSupport"]=1]="selfSupport"})(l||(l={}));const d=new Map([[l.region,"区域"],[l.selfSupport,"自营"]]);var c;(function(e){e[e["month"]=1]="month",e[e["quarter"]=2]="quarter",e[e["halfAyear"]=3]="halfAyear"})(c||(c={}));const m=new Map([[c.month,"月结"],[c.quarter,"季结"],[c.halfAyear,"半年"]]),p=new Map([[1,"美妆"],[2,"生活"],[3,"服饰"],[4,"美食"],[5,"母婴"],[6,"数码"],[7,"家装"],[8,"健康"],[9,"宠物"],[10,"时尚"],[11,"配饰"],[12,"家电"],[13,"测评"],[14,"旅行"],[15,"运动"],[16,"摄影"],[17,"情感"],[18,"汽车"],[19,"搞笑"],[20,"教育"],[21,"财经"],[22,"萌娃"],[23,"文化"],[24,"影视"],[25,"娱乐"],[26,"游戏"],[27,"海外"],[28,"才艺"],[29,"三农"],[30,"二次元"],[31,"高颜值"]]);function v(e){return 0===e?"无":p.get(e)??"无"}var f;(function(e){e[e["live"]=1]="live",e[e["marketing"]=2]="marketing",e[e["common_business"]=3]="common_business"})(f||(f={}))},58302:function(e,t,a){var o=a(97434),s=a(77944),n=a(52140);const i=e=>{const t=(0,o.computed)((()=>s.Z.getters["global/scrollbarSetting"])),a=(0,o.computed)((()=>void 0!==e.pagename?!0!==t.value.find((t=>t.key===e.pagename))?.value:e.disable??!1)),i=(0,o.computed)((()=>{const t=(e.fixedBlockHeightRefs??[]).map((e=>(0,o.unref)(e))).reduce(((e,t)=>(0,o.unref)(e)+(0,o.unref)(t)),0);return a.value?"max-content":`calc(100vh - ${(0,o.unref)(t)+56+36}px)`})),r=(0,o.computed)((()=>(a.value,"flex-auto"))),u=(0,o.computed)((()=>({height:i.value,overflowInBody:!a.value}))),l=(0,o.ref)(0),d=(0,o.computed)((()=>a.value?{}:{height:Math.max(l.value-(0,o.unref)((0,o.unref)(e.compensation)),e.tableMinHeight??0)})),c=a.value?()=>{}:e=>{l.value!==e&&(l.value=e,(0,n.S)())},m=a.value?()=>{}:t=>{0===l.value?setTimeout((()=>{c(t.height)}),e.delay??1200):c(t.height)};return{cardHeight:i,tableProps:d,onRectUpdate:m,rectHeight:l,cardFlexClass:r,cardProps:u}};t["Z"]=i},20809:function(e,t,a){var o=a(97434),s=a(58302);t["Z"]=()=>{const e=32,t=34,a=36,n=31,i=(0,o.ref)(0),r=e=>{i.value=e.height},u=(0,s.Z)({compensation:(0,o.computed)((()=>e+t+a+n)),fixedBlockHeightRefs:[i,25],tableMinHeight:100});return{tableHeightLogic:u,onTopCardRectUpdate:r}}},52140:function(e,t,a){a.d(t,{S:function(){return o},n:function(){return s}});const o=()=>{const e=document.createEvent("Event");e.initEvent("resize",!0,!0),window.dispatchEvent(e)},s=()=>{const{width:e,height:t}=document.body.getBoundingClientRect();return{width:e,height:t}}},67910:function(e,t,a){a.d(t,{P6:function(){return u},zY:function(){return r}});var o=a(97434),s=a(61282),n=a(85937),i=a.n(n);const r=(e,t,a,n=20)=>(0,o.computed)((()=>Math.ceil(Math.max(...e.value.map((e=>(0,s.QN)(a(e,!0)))),(0,s.QN)(t)))+n+6)),u=(e,t=!0)=>{let a;return a=""===e||void 0===e?"--":(0,s.SJ)(new(i())(e??0)),t?(0,o.h)("span",[`￥${a}`]):(0,o.h)("span",[`${a}`])}}}]);