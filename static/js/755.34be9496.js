(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[755],{23983:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"customer-dialog brand-form-modal tg-dialog-vcenter",attrs:{visible:e.visible,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":!0,width:"478px",top:"20vh"},on:{close:e.onCancelBtnClick},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",[e._v(e._s(e.formTitle))])]},proxy:!0},{key:"footer",fn:function(){return[n("tg-button",{on:{click:e.onCancelBtnClick}},[e._v("取消")]),n("tg-button",{attrs:{type:"primary"},on:{click:e.onSaveBtnClick}},[e._v("保存")])]},proxy:!0}])},[n("div",{staticClass:"dialog-content"},[n("el-form",{ref:"formRef",attrs:{rules:e.brandFormRules,model:e.brandForm,"label-width":"98px","label-height":"18px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("el-form-item",{attrs:{label:"品牌名称：",prop:"brand_name"}},[n("el-input",{ref:"autoFocuseRef",staticStyle:{width:"360px"},attrs:{maxlength:20,size:"medium",placeholder:"请输入品牌名称"},model:{value:e.brandForm.brand_name,callback:function(t){e.$set(e.brandForm,"brand_name","string"===typeof t?t.trim():t)},expression:"brandForm.brand_name"}})],1)],1)],1)])},r=[],s=n(97434),i=n(53451),o=n.n(i),u=n(40629);const{debounce:l}=o();var c=(0,s.defineComponent)({name:"AddBrand",props:{brand:{type:Object,required:!1},visible:{type:Boolean,required:!0}},setup(e,t){const n=(0,s.ref)(null),a=(0,s.ref)(void 0),r=()=>{t.emit("dialog:close"),t.root.$nextTick(c)},i=(0,s.ref)("新增品牌"),o=(0,s.ref)({id:-1,brand_name:""});(0,s.watch)((()=>e.visible),(t=>{n.value?.clearValidate(),t&&(i.value=void 0===e.brand?"新增品牌":"编辑品牌",void 0!==e.brand?(o.value.brand_name=e.brand.brand_name,o.value.id=e.brand.id):(0,s.nextTick)((()=>{a.value?.focus()})))}));const c=()=>{o.value.brand_name="",o.value.id=-1},d=(0,s.ref)({brand_name:[{required:!0,message:"请输入品牌名称",trigger:"blur"}]}),p=async()=>{if(void 0===o?.value)return;const e=await new Promise((e=>n.value?.validate((t=>e(t)))));if(!e)return;const a={brand_name:o.value.brand_name};-1!==o?.value.id&&(a.id=o.value.id);const{data:r}=await(0,u.cE)(a);r.success?(t.root.$message.success(r.message),t.emit("dialog:close",!0),c()):t.root.$message.error(r.message??"品牌保存失败")},m=l(p,200);return{autoFocuseRef:a,formTitle:i,formRef:n,onCancelBtnClick:r,onSaveBtnClick:m,brandForm:o,brandFormRules:d}}}),d=c,p=n(1001),m=(0,p.Z)(d,a,r,!1,null,null,null),v=m.exports},90755:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tg-page-container tg-customer-brand-page"},[n("tg-card",{attrs:{padding:[18,18,6,18]}},[n("el-form",{attrs:{size:"small","show-message":!1,"label-width":"70px"},nativeOn:{submit:function(e){e.preventDefault()}}},[n("div",{staticClass:"filter-form-div"},[n("div",{staticClass:"filter-form-item single"},[n("el-form-item",{attrs:{label:"品牌名称："}},[n("el-input",{staticClass:"input",attrs:{size:"small",placeholder:"请输入品牌名称"},model:{value:e.queryForm.brand_name,callback:function(t){e.$set(e.queryForm,"brand_name",t)},expression:"queryForm.brand_name"}})],1)],1),n("div",{staticClass:"filter-form-item single"},[n("el-form-item",{attrs:{"label-width":"0"}},[n("div",{staticClass:"filter-form-item-btn"},[n("tg-button",{attrs:{type:"primary"},on:{click:e.onQuerySearchClick}},[e._v("查询")]),n("tg-button",{staticClass:"mgl-12",on:{click:e.onQueryResetClick}},[e._v("重置")])],1)])],1)])])],1),n("tg-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"mgt-12 flex-auto",attrs:{padding:[12,0,0,18]}},[e.Permission.canEdit?n("div",{staticClass:"brand-operation-area"},[n("tg-button",{attrs:{type:"primary",icon:"ico-btn-add"},on:{click:function(t){return e.toggleAddBrandModalVisible(!0)}}},[e._v("新增品牌")])],1):e._e(),n("div",{staticClass:"brand-item-card-container"},[e._l(e.list,(function(t){return[n("brand-item-card",{key:t.id,attrs:{"brand-item":t}},[e.Permission.canDelete?n("tg-icon",{staticClass:"ico-btn",attrs:{name:"ico-delete"},on:{click:function(n){return e.handleBrandDelete(t)}}}):e._e(),e.Permission.canEdit?n("tg-icon",{staticClass:"ico-btn",attrs:{name:"ico-edit-lite"},on:{click:function(n){return e.handleBrandEdit(t)}}}):e._e()],1)]})),e.list.length<=0?n("div",{staticClass:"empty-data"},[n("empty-common",{attrs:{"detial-text":"暂无品牌"}})],1):e._e()],2)]),n("AddBrand",{attrs:{visible:e.AddBrandVisible,brand:e.currentBrand},on:{"dialog:close":e.onAddBrandModalClose}})],1)},r=[],s=n(97434),i=n(40629),o=n(82741),u=n(78902),l=n(21757);const c=e=>{const t=(0,s.computed)((()=>{const e=(0,l.kG)(u.HN.brand_delete),t=(0,l.kG)(u.HN.brand_save);return{canEdit:t,canDelete:e}})),n=(0,s.ref)(!1),a=(0,s.ref)(void 0),r=(0,s.ref)(!1),c=(e=!1)=>{n.value=e},d=(0,s.ref)([]),p=(0,s.ref)(0),m=async t=>{r.value=!0;const[{data:n}]=await Promise.all([await(0,i.wh)(t)]);r.value=!1,n.success?(d.value=n.data.data,p.value=n.data.total):e.root.$message({type:"warning",message:n.message??"查询失败，稍后重试",duration:2e3,showClose:!0})},v=e=>{a.value=e,c(!0)},f=async(e,t)=>{const n=await(0,o.I)(e,"确认删除该品牌？");if(n){const{data:n}=await(0,i.$W)(t.id);n.success?(e.root.$message.success("删除成功"),await m({page_num:1,num:1e3})):e.root.$message({type:"warning",message:n.message??"删除失败，稍后重试",duration:2e3,showClose:!0})}},g=(0,s.ref)([{label:"品牌名称",property:"brand_name",align:"left",headerAlign:"left"},{label:"操作",width:92,align:"left",headerAlign:"left",formatter:n=>{const a=[];return t.value.canEdit&&a.push((0,s.h)("a",{on:{click:()=>v(n)}},["编辑"])),t.value.canDelete&&a.push((0,s.h)("a",{on:{click:()=>f(e,n)}},["删除"])),(0,s.h)("div",{class:"operation"},a)}}]);return{columns:g,list:d,total:p,currentBrand:a,loadData:m,loading:r,toggleAddBrandModalVisible:c,AddBrandVisible:n,delBrandData:f,editBrandData:v}};var d=n(23983),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"brand-item-card"},[n("div",{staticClass:"item-avatar"},[e._v(e._s(e.getFirstAvatarName(e.brandItem.brand_name)))]),n("div",{staticClass:"item-content"},[n("div",{staticClass:"item-brand-name"},[e._v(e._s(e.brandItem.brand_name))]),n("el-popover",{attrs:{placement:"right",trigger:"hover","popper-class":"platform-areas-grid-popover"}},[n("div",{staticClass:"platform-areas-grid"},[e.brandItem.associated_shops.length>0?e._l(e.brandItem.associated_shops,(function(t,a){return n("span",{key:a},[e._v(" "+e._s(t.shop_name)+" ")])})):[n("span",[e._v("无关联店铺")])]],2),n("template",{slot:"reference"},[n("div",[n("span",{staticClass:"item-relation-shop",staticStyle:{cursor:"pointer"}},[e._v("关联店铺：")]),n("span",{staticClass:"shop-count"},[e._v(e._s(e.brandItem.associated_shops.length))])])])],2)],1),n("div",{staticClass:"operation-area"},[e._t("default")],2)])},m=[],v=n(8136),f=(0,s.defineComponent)({name:"BrandItemCard",props:{brandItem:{type:Object,required:!0}},filters:{},setup(e,t){return{getFirstAvatarName:v.Ps}}}),g=f,b=n(1001),y=(0,b.Z)(g,p,m,!1,null,"77a3b044",null),h=y.exports,C=n(58302),F=(0,s.defineComponent)({name:"TgCustomerBrand",components:{AddBrand:d.Z,BrandItemCard:h},setup(e,t){const n=(0,s.ref)({brand_name:"",page_num:1,num:1e3}),a=c(t),r=async e=>{a.toggleAddBrandModalVisible(),a.currentBrand.value=void 0,e&&await i()},i=async(e=!0)=>{e&&(n.value.page_num=1);const t={page_num:n.value.page_num,num:n.value.num};n.value.brand_name&&(t.brand_name=n.value.brand_name),await a.loadData(t)},o=e=>{n.value.page_num=e,i(!1)},d=e=>{n.value.num=e,i()},p=()=>{i()},m=()=>{n.value.brand_name="",i()},v=(0,s.computed)((()=>{const e=(0,l.kG)(u.HN.brand_list),t=(0,l.kG)(u.HN.brand_save),n=(0,l.kG)(u.HN.brand_delete);return{canEdit:t,canViewList:e,canDelete:n}})),f=e=>{a.delBrandData(t,e)},g=e=>{a.editBrandData(e)},b=32,y=34,h=36,F=31,_=(0,s.ref)(0),B=e=>{_.value=e.height},D=(0,C.Z)({compensation:(0,s.computed)((()=>b+y+h+F)),fixedBlockHeightRefs:[_],tableMinHeight:100});return{Permission:v,reload:i,handleCurrentChange:o,handlePageSizeChange:d,onQuerySearchClick:p,onQueryResetClick:m,queryForm:n,onAddBrandModalClose:r,...a,handleBrandDelete:f,handleBrandEdit:g,onTopCardRectUpdate:B,...D}},async mounted(){this.queryBrandList()},methods:{async queryBrandList(){await this.reload()}}}),_=F,B=(0,b.Z)(_,a,r,!1,null,null,null),D=B.exports},40629:function(e,t,n){"use strict";n.d(t,{$W:function(){return c},wh:function(){return u},cE:function(){return l}});var a=n(76012),r=n(64236);const s="/api/brand/query_brand",i="/api/brand/save_brand",o="/api/brand/del_brand/:id/",u=async e=>(0,a.dX)(s,{params:{...(0,r.jG)(e)}}),l=async e=>(0,a.SO)(i,{...(0,r.jG)(e)}),c=async e=>(0,a.SO)(o.replace(":id",`${e}`))},82741:function(e,t,n){"use strict";n.d(t,{I:function(){return r},u:function(){return s}});var a=n(71340);const r=(e,t)=>{const n="string"===typeof t?{title:t}:t;return new Promise((t=>{e.root.$TDialog({...n,onConfirm:()=>t(!0),onCancel:()=>t(!1)})}))},s=e=>{const t="string"===typeof e?{title:e}:e;return new Promise(((e,n)=>{(0,a.t)({...t,onConfirm:()=>e(!0),onCancel:()=>n()})}))}},58302:function(e,t,n){"use strict";var a=n(97434),r=n(77944),s=n(52140);const i=e=>{const t=(0,a.computed)((()=>r.Z.getters["global/scrollbarSetting"])),n=(0,a.computed)((()=>void 0!==e.pagename?!0!==t.value.find((t=>t.key===e.pagename))?.value:e.disable??!1)),i=(0,a.computed)((()=>{const t=(e.fixedBlockHeightRefs??[]).map((e=>(0,a.unref)(e))).reduce(((e,t)=>(0,a.unref)(e)+(0,a.unref)(t)),0);return n.value?"max-content":`calc(100vh - ${(0,a.unref)(t)+56+36}px)`})),o=(0,a.computed)((()=>(n.value,"flex-auto"))),u=(0,a.computed)((()=>({height:i.value,overflowInBody:!n.value}))),l=(0,a.ref)(0),c=(0,a.computed)((()=>n.value?{}:{height:Math.max(l.value-(0,a.unref)((0,a.unref)(e.compensation)),e.tableMinHeight??0)})),d=n.value?()=>{}:e=>{l.value!==e&&(l.value=e,(0,s.S)())},p=n.value?()=>{}:t=>{0===l.value?setTimeout((()=>{d(t.height)}),e.delay??1200):d(t.height)};return{cardHeight:i,tableProps:c,onRectUpdate:p,rectHeight:l,cardFlexClass:o,cardProps:u}};t["Z"]=i},52140:function(e,t,n){"use strict";n.d(t,{S:function(){return a},n:function(){return r}});const a=()=>{const e=document.createEvent("Event");e.initEvent("resize",!0,!0),window.dispatchEvent(e)},r=()=>{const{width:e,height:t}=document.body.getBoundingClientRect();return{width:e,height:t}}},8136:function(e,t,n){"use strict";n.d(t,{AR:function(){return k},BG:function(){return B},Cl:function(){return F},D$:function(){return o},EI:function(){return d},Hx:function(){return s},LY:function(){return l},Nv:function(){return u},Ps:function(){return I},Rd:function(){return w},ZC:function(){return m},_t:function(){return b},bI:function(){return C},g9:function(){return g},hy:function(){return p},jh:function(){return A},mB:function(){return y},mx:function(){return E},nA:function(){return x},q0:function(){return D},sc:function(){return _},ug:function(){return h},us:function(){return f},vJ:function(){return v},wA:function(){return i},xF:function(){return c}});var a=n(20713),r=n.n(a);function s(e,t){const n=e.display_type;switch(n){case 0:return"混播";case 1:return"专场"}}const i=["综合","美妆","生活","服饰","美食","母婴","数码","家装","健康","宠物","时尚","配饰","家电","测评","旅行","运动","摄影","情感","汽车","搞笑","教育","财经","萌娃","文化","影视","娱乐","游戏","海外","才艺","二次元","高颜值"],o=["美妆","生活","服饰","美食","母婴","数码","家装","健康","宠物","时尚","配饰","家电","测评","旅行","运动","摄影","情感","汽车","搞笑","教育","财经","萌娃","文化","影视","娱乐","游戏","海外","才艺","二次元","高颜值","行政采购"];function u({category:e}){return 0===e?"无":i[e]}function l(e,t){const n=e.sales_price_period;switch(n){case 0:return"0 ~ 100";case 1:return"100 ~ 200";case 2:return"200以上"}}function c(e,t="YYYY-MM-DD"){return r()(e).format(t)}function d(e,t="YYYY-MM-DD hh:mm:ss"){return r()(e+"+0800").format(t)}function p(e,t){return r()(e+"+0800").format(t||"YYYY-MM-DD")}function m(e){let t=parseInt(e,10),n=0,a=0;t>=60&&(n=parseInt(t/60,10),t=parseInt(t%60,10),n>=60&&(a=parseInt(n/60,10),n=parseInt(n%60,10)));let r=""+(parseInt(t,10)<10?"0"+parseInt(t,10):parseInt(t,10));return r=(parseInt(n,10)<10?"0"+parseInt(n,10):parseInt(n,10))+":"+r,r=(parseInt(a,10)<10?"0"+parseInt(a,10):parseInt(a,10))+":"+r,r}function v(e){const t=e.is_presell;switch(t){case-1:return"未录入";case 1:return"预售";case 0:return"非预售";case 2:return"预热"}}function f(e){const t=e.is_display;switch(t){case-1:return"未录入";case 2:return"已出单";case 1:return"未出单"}}function g(e){const t=e.duration;switch(t){case-1:return"未录入";case 0:return"5 ~ 10分钟";case 1:return"10 ~ 15分钟";case 2:return"15 ~ 20分钟";case 3:return"0 ~ 5分钟";case 4:return"20分钟以上"}}function b(e){const t=e.display_period;switch(t){case-1:return"未录入";case 0:return"白天";case 1:return"晚上"}}function y(e){const t=e.shop_type;switch(t){case 0:return"无";case 1:return"淘宝店";case 2:return"天猫店";case 3:return"抖音店";default:return"--"}}function h(e){const t=e.company_type;switch(t){case 0:return"无";case 1:return"同行机构";case 2:return"广告公司";case 3:return"品牌TP";case 4:return"直客"}}function C(e,t){const n=/[^\x00-\xff]/g;let a;if(e.replace(n,"**").length>t){a=Math.floor(t/2);for(let r=a,s=e.length;r<s;r++)if(e.substr(0,r).replace(n,"**").length>=t)return e.substr(0,r)}return e}const F=[{type:0,value:"全部"},{type:1,value:"普通客户"},{type:2,value:"重点客户"},{type:3,value:"战略客户"},{type:4,value:"KA客户"}],_=[{value:"全部",type:0},{value:"淘宝图文",type:9},{value:"小红书",type:1},{value:"微信公众号",type:2},{value:"新浪微博",type:3},{value:"淘宝短视频",type:10},{value:"抖音",type:4},{value:"快手",type:5},{value:"哔哩哔哩",type:6},{value:"淘宝直播",type:7},{value:"一直播",type:8},{value:"线下场地搭建",type:11},{value:"线下视觉设计",type:12},{value:"活动策划执行",type:13}],B=[{value:"淘宝图文",type:9},{value:"小红书",type:1},{value:"微信公众号",type:2},{value:"新浪微博",type:3},{value:"淘宝短视频",type:10},{value:"抖音",type:4},{value:"快手",type:5},{value:"哔哩哔哩",type:6},{value:"淘宝直播",type:7},{value:"一直播",type:8},{value:"线下场地搭建",type:11},{value:"线下视觉设计",type:12},{value:"活动策划执行",type:13},{value:"行政采购",type:14}],D=[{value:3,text:"抖音店"},{value:1,text:"淘宝店"},{value:2,text:"天猫店"}],w=[{value:1,text:"同行机构"},{value:2,text:"广告公司"},{value:3,text:"品牌TP"},{value:4,text:"直客"}],k=[{type:0,value:"--"},{type:1,value:"同行机构"},{type:2,value:"广告公司"},{type:3,value:"品牌TP"},{type:4,value:"直客"}],x=["#D15CB4","#6090F0","#FF9C69","#59B6DF","#C673F0","#52CCC2","#F0737F","#6FCC66","#DBD26A","#9D73F0","#FAB36E","#A2D160","#D15CB4","#58B89F","#E06C9C","#8873F0","#FA9384","#C251A6","#486DB5","#C77A52","#4185A3","#9557B5","#3C968F","#B55760","#4F9149","#A19A4D","#7657B5","#BF8954","#759645","#964282","#3C7D6C","#A65073","#6556B3","#BF7065","#873874"],A=["#6090F0","#FF9C69","#52CCC2","#59B6DF","#C673F0","#D15CB4","#F0737F","#DBD26A","#FAB36E","#A2D160","#6FCC66","#58B89F","#8873F0","#FA9384","#9D73F0","#E06C9C","#C251A6"],E=["#1E8DFF","#FFBF00","#10C0D3","#9273F8","#FE9C25","#00B942","#FFCD39","#FF829D","#00A3FF","#3AD08E","#F1DC2F","#845EF7","#FF7F00","#B3DC12","#009999","#2877FF","#D977F2","#FFC073","#768FF3","#81E5B1","#BAC8FF","#E599F8","#E7E275","#FF7E7E","#F7A0B8","#49C6F1","#B197FC","#53D66F","#FF97AD","#FDD866"];function I(e){for(const t of e)if("一"<=t&&t<="龥")return t;return e[0]}},20713:function(e,t,n){e.exports=n(70680)(52703)}}]);