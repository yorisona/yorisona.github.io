"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[2642],{22642:function(e,s,t){t.r(s),t.d(s,{default:function(){return O}});t(21703);var a,r,o=t(36568),l=t.n(o),n=t(97434),i=t(1763),c=t(23624),d=t(99205),u=t(48606),m=t(44928),p=t(73497),v=t(15681),_=(0,n.defineComponent)({setup(e,s){const t=(0,n.ref)(0),a=(0,n.ref)({}),r=(0,n.ref)(),o=e=>{t.value=e.present_stage,a.value=e},l=(0,n.ref)({id:void 0}),i=async()=>{r.value?.validate((e=>{e&&s.emit("submit",l.value)}))};return{onSaveBtnClick:i,show:o,formData:l,formRef:r,current_state:t,currentData:a}},render(){const e=arguments[0],{formData:s,currentData:t}=this;return e("div",{class:"dialog-container"},[e("el-form",l()([{attrs:{size:"small","hide-required-asterisk":!0},ref:"formRef"},{attrs:{model:s}}]),[e("el-form-item",{attrs:{label:"重置到：",prop:"id",rules:{required:!0,message:"请选择转交人",trigger:"change"}}},[e("el-select",{style:"width:100%",model:{value:s.id,callback:e=>{this.$set(s,"id",e)}}},[v.Tp.map((s=>{let a=!1;return!1===t.is_target_confirmed&&s.value===v.__.TARGET_CONFIRM&&(a=!0),!1===t.is_self_evaluation&&s.value===v.__.SELF&&(a=!0),!1===t.is_superior_rating&&s.value===v.__.SUPERIOR&&(a=!0),e("el-option",{attrs:{label:s.label,value:s.value,disabled:s.value>=this.current_state||s.value===v.__.IN_PROGRESS||a}})}))])]),e("el-form-item",{attrs:{label:"重置说明：",prop:"remark",rules:{required:!0,message:"请填写重置说明",trigger:"change"}}},[e("el-input",{attrs:{type:"textarea",maxlength:200,"show-word-limit":!0,resize:"none"},model:{value:s.remark,callback:e=>{this.$set(s,"remark",e)}}})])])])}}),g=_,f=t(1001),b=(0,f.Z)(g,a,r,!1,null,"23fb3b69",null),h=b.exports,k=t(43773),w=t(70437),R=t(21757);let T=c.g,S=c.o_;var $,x,y=(0,n.defineComponent)({components:{Steps:p.Z},setup:()=>{const e=(0,m.t)(),s=(0,R.gI)(),t=(0,d.b$)(),a=(0,n.ref)(),r=e=>((0,d.h4)(e),t.updateDimension(e),a.value?.updateData(e),e);let o={};const l=(0,n.reactive)({examiner:"",assessment:"",examinerList:[],assessmentList:[]}),p=()=>T({page_num:1,num:20},o).then((e=>{if(!e.data.success)throw new Error(e.data.message);const s=e.data.data.data;if(s.length>0)return s[0];if(0===s.length)throw new Error("找不到数据");return s})).then(r).catch((e=>{u.Message.error(e.message)})),v=(0,n.ref)([{title:"考核管理"},{name:i.Gr.assessment.manage.detailList,title:"考核详情"},{title:"员工绩效详情"}]),{userid:_}=e.currentRoute.params;e.currentRoute.name===i.Gr.report.result_analysis_detail?(v.value=[{title:"绩效报表"},{name:i.Gr.report.result_analysis,title:"考核结果分析"},{title:"员工绩效详情"}],T=c.O5,S=c.L5):e.currentRoute.name===i.Gr.report.detailDetail&&(v.value=[{name:i.Gr.report.record,title:"员工绩效档案"},{title:"员工考核详情",name:i.Gr.report.detail,params:{id:e.currentRoute.query.id}},{title:"员工绩效详情"}],T=c.$R,S=c.y3);const g=()=>(o={assessment_detail_id:_},p()),f=e=>S({assessment_management_id:e}).then((e=>{e.data.success&&(l.examinerList=e.data.data.map((e=>({label:e.name,value:e.user_id}))))})),b=e=>S({user_id:e}).then((e=>{e.data.success&&(l.assessmentList=e.data.data.map((e=>({label:e.name,value:e.id}))))})),w=()=>{o={user_id:l.examiner,assessment_management_id:l.assessment},p()};(0,n.onMounted)((()=>{g().then((e=>{l.examiner=e.user_id,l.assessment=e.assessment_management_id,f(e.assessment_management_id),b(e.user_id)}))}));const $=(0,k.R)({component:h,title:"重置流程",width:"300px",on:{submit(e){(0,c.dP)({stage:e.id,remark:e.remark,assessment_detail_id:t.data.id}).then((e=>{e.data.success?(u.Message.success("重置成功"),$.close(),p()):u.Message.error(e.data.message)}))}}});return{routes:v,assTable:t,loadData:p,stepsRef:a,dialogResetProcess:$,searchForm:l,LoadAssesToUser:f,LoadUserToAssess:b,lastParams:o,onFilterChange:w,permission:s}},render(){const e=arguments[0],{routes:s,assTable:t,searchForm:a,permission:r}=this;return e("div",{class:"tg-page-container"},[e("tg-breadcrumbs",{attrs:{routes:s}}),e("div",{class:"page-content"},[e("div",{class:"form-box"},[e("el-form",{attrs:{size:"small",inline:!0}},[e("el-form-item",{attrs:{label:"被考核人："}},[e(w.Z,{attrs:{filterable:!0,clearable:!1,options:a.examinerList},on:{change:e=>{this.LoadUserToAssess(e),this.onFilterChange()}},model:{value:a.examiner,callback:e=>{this.$set(a,"examiner",e)}}})]),e("el-form-item",{attrs:{"label-width":"70px",label:"考核表："}},[e(w.Z,{attrs:{filterable:!0,clearable:!1,options:a.assessmentList},on:{change:e=>{this.LoadAssesToUser(e),this.onFilterChange()}},model:{value:a.assessment,callback:e=>{this.$set(a,"assessment",e)}}})])]),r.assessment_management_process&&t.data.present_stage>v.__.TARGET_SETTING&&e("tg-button",{on:{click:()=>this.dialogResetProcess.show(t.data)}},["重置流程"])]),e("steps",{ref:"stepsRef"}),e("tg-table",l()([{class:"table"},t.tableProps,{attrs:{border:!0}}]),[e("div",{class:"tg-page-empty",slot:"empty"},[e("empty-common")])])])])}}),E=y,C=(0,f.Z)(E,$,x,!1,null,"bd266704",null),O=C.exports},73497:function(e,s,t){t.d(s,{Z:function(){return u}});var a,r,o=t(97434),l=t(15681),n=(0,o.defineComponent)({props:{showRealName:{type:Boolean,default:()=>!0}},setup:()=>{const e=(0,o.ref)({}),s=(0,o.ref)(l.Tp.map((e=>({...e})))),t=s=>{e.value=s,!0!==s.is_target_confirmed&&a(l.__.TARGET_CONFIRM),!0!==s.is_superior_rating&&a(l.__.SUPERIOR),!0!==s.is_self_evaluation&&a(l.__.SELF)},a=e=>{s.value=s.value.filter((s=>s.value!==e))};return{steps:s,data:e,updateData:t,disabledStep:a}},render(){const e=arguments[0],{data:s}=this;return e("div",{class:"steps-box"},[this.steps.map((t=>{let a="step";s.present_stage>t.value&&(a=`${a} success`),s.present_stage===t.value&&(a=`${a} active`);let r="";switch(t.value){case l.__.TARGET_SETTING:r=`${s.operator_person?.username??"--"}（${s.operator_person?.real_name??"--"}）`;break;case l.__.SELF:case l.__.SIGNATURE:case l.__.IN_PROGRESS:r=`${s.username??"--"} ${s.real_name?` (${s.real_name})`:""}`;break;case l.__.TARGET_CONFIRM:r=`${s.confirmer_person?.username??"--"} ${s.confirmer_person?.real_name?`(${s.confirmer_person?.real_name})`:""}\n              `;break;case l.__.SUPERIOR:s.superior_assessment_person&&s.superior_assessment_person.length>0&&(r=s.superior_assessment_person.map((t=>{let a="";return s.present_stage===l.__.SUPERIOR&&s.present_person&&s.present_person.username===t.username&&(a="present"),e("span",{class:a},[`${t.username??"--"} ${t.real_name?` (${t.real_name})`:""}`])})));break}return e("div",{class:a},[e("div",{class:"step-target"},[e("span",[t.label])]),e("div",{class:"step-names"},[r])])}))])}}),i=n,c=t(1001),d=(0,c.Z)(i,a,r,!1,null,"625c60b5",null),u=d.exports},70437:function(e,s,t){var a=t(36568),r=t.n(a);const o={functional:!0,render:(e,s)=>{const{props:t}=s,{showAll:a=!1,showAllText:o="全部",clearable:l=!0}=t,n={props:{...s.value,clearable:l},on:s.listeners,attrs:s.data.attrs};return e("el-select",r()([{},n]),[a&&e("el-option",{attrs:{label:o,value:void 0}}),t.options?.map(((s,t)=>e("el-option",{attrs:{disabled:s.disabled,label:s.label,value:s.value},key:t})))])}};s["Z"]=o},43773:function(e,s,t){t.d(s,{R:function(){return m},y:function(){return p}});var a=t(36568),r=t.n(a),o=t(97434),l=t(64923),n=t(77944);let i=1;const c=()=>{const e=document.createElement("div");return e.id="dialog_"+i++,document.body.appendChild(e),e},d=new Function,u=(e,s)=>{let t=e;return void 0===t&&(t={}),Object.keys(s).forEach((e=>{const a=t[e]||d,r=s[e];t[e]=(...e)=>{if(!1!==r(...e))return a(...e)}})),t},m=(e={})=>{const s=(0,o.ref)(),t=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),a=(0,o.ref)(!0),i=e=>{Object.keys(e).forEach((s=>{t.hasOwnProperty.call(t,s)&&(t[s]=e[s])}))};i(e);const d=(0,o.ref)(u(e.on,{close(){t.visible=!1},updateDialog(e={}){i(e)}})),m=()=>{const e=s.value.$refs&&s.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};s.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((s=>{(0,o.provide)(s,e.provide[s])}))},render(s){if(a.value&&t.visible)return s("el-dialog",r()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${e.class}`},{props:t},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:d.value},{attrs:{isDialog:!0}}]),[t.visible&&s(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:d.value}),t.footer&&s("fragments",{slot:"footer"},[s("tg-button",{on:{click:()=>t.visible=!1}},[t.cancelText]),t.disabledOK&&s("tg-button",{attrs:{type:"primary"},on:{click:m}},[t.okText])])])}});const p=(...e)=>{t.visible||(t.visible=!0,(0,o.nextTick)((()=>{const t=s.value.$refs&&s.value.$refs.dialogRef;t?t.dialogShow?t.dialogShow(...e):t.show&&t.show(...e):console.log("未找到子组件请检查代码")})))},v=e=>(i(e),f),_=()=>{t.visible=!1},g=(e,s,t=!1)=>(!0===t?d.value[e]=s:u(d.value,{[e]:s}),f);(0,o.onUnmounted)((()=>{a.value=!1,t.visible=!1}));const f=(0,o.reactive)({show:p,update:v,on:g,close:_,config:e,data:e.data});return f},p=(e={})=>{const s=(0,o.ref)(),t=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),a=(0,o.ref)(!0),i=e=>{Object.keys(e).forEach((s=>{t.hasOwnProperty.call(t,s)&&(t[s]=e[s])}))};i(e);const d=(0,o.ref)(u(e.on,{close(){t.visible=!1},updateDialog(e={}){i(e)}})),m=()=>{const e=s.value.$refs&&s.value.$refs.dialogRef||{};e.dialogSubmit?e.dialogSubmit():e.onSaveBtnClick?e.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};s.value=new l["default"]({el:c(),store:n.Z,setup(){void 0!==e.provide&&Object.keys(e.provide).forEach((s=>{(0,o.provide)(s,e.provide[s])}))},render(s){if(!a.value)return;if(!t.visible)return;const{width:o,...l}=t;return s("el-drawer",r()([{class:`tg-drawer-rewrite ${e.class}`},{props:{...l,size:o}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:d.value},{attrs:{isDialog:!0}}]),[s("div",{class:"tg-drawer-content"},[t.visible&&s(e.component,{ref:"dialogRef",props:{...e.props,isDialog:!0},on:d.value})]),t.footer&&s("div",{class:"tg-drawer-footer"},[s("tg-button",{on:{click:()=>t.visible=!1}},[t.cancelText]),t.disabledOK&&s("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:m}},[t.okText])])])}});const p=(...e)=>{t.visible||(t.visible=!0,(0,o.nextTick)((()=>{const t=s.value.$refs&&s.value.$refs.dialogRef;t?t.dialogShow?t.dialogShow(...e):t.show&&t.show(...e):console.log("未找到子组件请检查代码")})))},v=e=>(i(e),f),_=()=>{t.visible=!1},g=(e,s,t=!1)=>(!0===t?d.value[e]=s:u(d.value,{[e]:s}),f);(0,o.onUnmounted)((()=>{a.value=!1,t.visible=!1}));const f=(0,o.reactive)({show:p,update:v,on:g,close:_,config:e});return f}}}]);