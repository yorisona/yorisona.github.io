"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[5851],{22721:function(e,n,a){a.r(n),a.d(n,{default:function(){return G}});var t,r,i,s,o=a(97434),l=a(36568),m=a.n(l),c=a(23624),u=a(59563),_=a(15681),d=(0,o.defineComponent)({setup(e,n){const a=(0,o.ref)(),t=(0,o.ref)(!1),r=e=>{e&&(m.value=e,t.value=!0)},i=(0,o.ref)(),s=(0,u.Q)(c.vv,{manual:!0}),l=()=>{i.value?.validate((e=>{e&&(void 0===m.value.id&&(m.value.id=Date.now()),n.emit("submit",m.value))}))},m=(0,o.ref)({dimension_type_list:[],indicator_list:[]});return{name:a,onSaveBtnClick:l,show:r,reqSaveTag:s,formData:m,formRef:i,hasEdit:t}},render(){const e=arguments[0];return e("div",{class:"DialogContainer"},[e("el-form",m()([{attrs:{size:"small","hide-required-asterisk":!0,labelPosition:"top"},ref:"formRef"},{attrs:{model:this.formData}}]),[e("el-form-item",{attrs:{label:"维度名称",prop:"name",rules:[{required:!0,message:"请输入维度名称",trigger:"change"}]}},[e("el-input",{attrs:{placeholder:"请输入维度名称"},style:"width:100%",model:{value:this.formData.name,callback:e=>{this.$set(this.formData,"name",e)}}})]),e("el-form-item",{attrs:{label:"维度类型",prop:"dimension_type_list",rules:[{required:!0,message:"请选择维度类型",trigger:"change"}]},class:"radio-form-item"},[e("el-checkbox-group",{attrs:{disabled:this.hasEdit},model:{value:this.formData.dimension_type_list,callback:e=>{this.$set(this.formData,"dimension_type_list",e)}}},[_.ts.map(((n,a)=>e("el-checkbox",{key:a,attrs:{label:n.value,disabled:this.hasEdit}},[n.label])))])]),e("el-form-item",{class:"radio-form-item",attrs:{label:"员工编辑和删除指标",prop:"is_modify_delete",rules:[{required:!0,message:"请选择员工编辑和删除指标",trigger:"change"}]}},[e("el-radio-group",{model:{value:this.formData.is_modify_delete,callback:e=>{this.$set(this.formData,"is_modify_delete",e)}}},[e("el-radio",{attrs:{name:"is_modify_delete",label:!0}},["支持"]),e("el-radio",{attrs:{name:"is_modify_delete",label:!1}},["不支持"])])])])])}}),p=d,f=a(1001),g=(0,f.Z)(p,t,r,!1,null,"c9b42202",null),y=g.exports,v=a(67663),b=a(43773),E=a(48606),I=a(24206),T=a(82741),A=a(64236),N=(0,o.defineComponent)({setup:()=>{const e=(0,o.inject)("formData"),n=e=>[{label:"指标名称",minWidth:100,prop:"name",align:"left"},{align:"center",label:"指标类型",minWidth:100,prop:"indicator_type",formatter:e=>_.rD.get(e.indicator_type)},{label:"指标定义",minWidth:140,prop:"remark",align:"left","show-overflow-tooltip":!0},{label:"考核标准",minWidth:200,prop:"check_standard","show-overflow-tooltip":!0},{label:"目标值",minWidth:100,prop:"is_target",align:"center"},{label:"结果值",minWidth:100,prop:"is_result",align:"center"},{label:"权重",minWidth:80,prop:"weight",align:"right",dataType:{suffix:"%"},formatter:e=>{switch(e.indicator_type){case _.F2.DEDUCT:case _.F2.BONUS:return"--";case _.F2.QUALITATIVE:case _.F2.RATION:return(0,A.xb)(e.weight)?"":`${e.weight}%`}}},{label:"指定评分人",minWidth:90,prop:"is_assign_scorer",align:"center"},{label:"评分方式",minWidth:100,prop:"scoring_method",align:"center",formatter:()=>"直接输入分数"},{label:"操作",minWidth:100,align:"center",formatter:(n,a,r,i)=>h("el-button-group",[h("tg-button",{attrs:{type:"link"},class:"mgr-12",on:{click:()=>{l.value=i,s.value=e,t.show({...n},e.dimension_type_list)}}},["编辑"]),h("tg-button",{attrs:{type:"link"},on:{click:async()=>{await(0,T.u)("确定删除该指标"),e.indicator_list.splice(i,1)}}},["删除"])])}],a=n=>{const a=n instanceof Array?n:[n],t=[],r=a.filter((n=>{for(let a=0;a<e.value.assessment_dimension_list.length;a++){const r=e.value.assessment_dimension_list[a];for(let e=0;e<r.indicator_list.length;e++){const a=r.indicator_list[e];if(a.name===n.name)return t.push(n),!1}}return!0}));return{indcators:r,repeatValue:t}},t=(0,b.y)({component:I["default"],width:"523px",title:"新增指标",props:{disabledSubmit:!0},on:{submit(e){if(void 0===e.id&&(e.id=Date.now()),null!==l.value)(0,o.set)(s.value.indicator_list,l.value,e);else{const n=a(e);if(0===n.indcators.length)return void E.Message.error(`${e.name} 名称重复`);s.value.indicator_list.push(e)}t.close()}}}),r=(0,b.R)({title:"添加考核维度",width:"421px",component:y,on:{submit(n){const a=e.value.assessment_dimension_list,t=a.findIndex((e=>e.name===n.name));-1===t||t===l.value?(null!==l.value?(0,o.set)(e.value.assessment_dimension_list,l.value,n):e.value.assessment_dimension_list.push(n),r.close()):E.Message.error("维度名称已存在")}}}),i=(0,b.R)({component:v.Z,title:"指标库导入",width:"800px",props:{autoClose:!1},on:{submit(e){const n=a(e);n.repeatValue.length>0?E.Message.error(`${n.repeatValue[0].name} 名称重复`):(s.value.indicator_list.push(...e),i.close())}}}),s=(0,o.ref)(),l=(0,o.ref)(null),m=()=>new Promise((e=>{e(void 0)}));return{formData:e,columnsEvaluation:n,dialogEva:r,validate:m,dialogInd:i,currentImportEva:s,drawerCreateIndic:t,operation:l}},render(){const e=arguments[0],{formData:n}=this;return e("div",{class:"page-container"},[e("div",{class:"page-tips"},[e("div",["评分规则："]),e("div",{class:"tip"},["每项指标的评分按照百分制打分"]),e("div",{class:"tip"},["总分=累加所有单项指标权重*评分之和"])]),e("div",{class:"mgb-18"},[e("tg-button",{attrs:{type:"primary",icon:"ico-btn-add",size:"small"},on:{click:()=>{this.operation=null,this.dialogEva.show()}}},["添加考核维度"])]),e("div",[n.assessment_dimension_list.map(((a,t)=>e("div",{key:t,class:0===t?"dimension-box":"mgt-18 dimension-box"},[e("div",{class:"dimension-title"},[e("div",{class:"dimension-name"},[a.name,!a.is_modify_delete&&e("span",{class:"tips"},[e("tg-icon",{attrs:{name:"ico-icon_tongyong_jinggao_mianxingbeifen-01"}}),"不支持被考核人编辑、删除指标"])]),e("div",{class:"dimension-operate"},[e("tg-icon",{attrs:{name:"ico-icon_bianji"},on:{click:()=>{this.operation=t,this.dialogEva.show({...a})}}}),e("span",{class:"split"}),e("tg-icon",{attrs:{name:"ico-btn-delete"},on:{click:()=>{a.indicator_list&&a.indicator_list.length>0?(0,T.u)("确认删除该维度的所有内容，删除后无法恢复？").then((()=>{n.assessment_dimension_list.splice(t,1)})):n.assessment_dimension_list.splice(t,1)}}})])]),e("tg-table",{attrs:{border:!0,columns:this.columnsEvaluation(a),data:a.indicator_list}}),e("div",{class:"dimension-footer"},[e("tg-button",{on:{click:()=>{this.currentImportEva=a,this.dialogInd.show(a.indicator_list,a.dimension_type_list)}}},["指标库导入"]),e("tg-button",{class:"mgl-12",on:{click:()=>{this.operation=null,this.currentImportEva=a,this.drawerCreateIndic.show(null,a.dimension_type_list)}}},["增加指标"])])])))])])}}),R=N,S=(0,f.Z)(R,i,s,!1,null,"5d3965cc",null),G=S.exports},15681:function(e,n,a){var t;a.d(n,{F2:function(){return t},Kg:function(){return u},OF:function(){return l},Sr:function(){return s},Tp:function(){return _},__:function(){return c},fB:function(){return o},rD:function(){return r},ts:function(){return i}}),function(e){e[e["RATION"]=1]="RATION",e[e["QUALITATIVE"]=2]="QUALITATIVE",e[e["BONUS"]=3]="BONUS",e[e["DEDUCT"]=4]="DEDUCT"}(t||(t={}));const r=new Map([[t.RATION,"定量指标"],[t.QUALITATIVE,"定性指标"],[t.BONUS,"加分项"],[t.DEDUCT,"扣分项"]]),i=[{label:"定量指标",value:t.RATION},{label:"定性指标",value:t.QUALITATIVE},{label:"加分项",value:t.BONUS},{label:"扣分项",value:t.DEDUCT}];var s;(function(e){e[e["MONTHLY"]=1]="MONTHLY",e[e["QUARTERLY"]=2]="QUARTERLY",e[e["SEMIANNUA"]=3]="SEMIANNUA",e[e["ANNUAL"]=4]="ANNUAL"})(s||(s={}));const o=new Map([[s.MONTHLY,"月度"],[s.QUARTERLY,"季度"],[s.SEMIANNUA,"半年度"],[s.ANNUAL,"年度"]]),l=[{label:"月度",value:s.MONTHLY},{label:"季度",value:s.QUARTERLY},{label:"半年度",value:s.SEMIANNUA},{label:"年度",value:s.ANNUAL}];var m,c;(function(e){e[e["BY_EVALUATION_PERSON"]=1]="BY_EVALUATION_PERSON",e[e["DIRECT_MANAGER"]=2]="DIRECT_MANAGER"})(m||(m={})),function(e){e[e["TARGET_SETTING"]=1]="TARGET_SETTING",e[e["TARGET_CONFIRM"]=2]="TARGET_CONFIRM",e[e["IN_PROGRESS"]=3]="IN_PROGRESS",e[e["SELF"]=4]="SELF",e[e["SUPERIOR"]=5]="SUPERIOR",e[e["SIGNATURE"]=6]="SIGNATURE",e[e["FINISH"]=7]="FINISH"}(c||(c={}));const u=new Map([[c.TARGET_SETTING,"目标制定"],[c.TARGET_CONFIRM,"目标确认"],[c.IN_PROGRESS,"执行中"],[c.SELF,"自评"],[c.SUPERIOR,"上级评分"],[c.SIGNATURE,"签字确认"],[c.FINISH,"考核完成"]]),_=[{label:"目标制定",value:c.TARGET_SETTING},{label:"目标确认",value:c.TARGET_CONFIRM},{label:"执行中",value:c.IN_PROGRESS},{label:"自评",value:c.SELF},{label:"上级评分",value:c.SUPERIOR},{label:"签字确认",value:c.SIGNATURE},{label:"考核完成",value:c.FINISH}]},23624:function(e,n,a){a.d(n,{$K:function(){return S},$R:function(){return A},$b:function(){return P},Cl:function(){return k},Dr:function(){return s},EB:function(){return h},Ev:function(){return f},JP:function(){return R},L5:function(){return M},Mz:function(){return C},O5:function(){return T},UX:function(){return p},Y4:function(){return o},ZM:function(){return v},Z_:function(){return w},ao:function(){return x},bV:function(){return $},bl:function(){return l},dP:function(){return X},g:function(){return E},gb:function(){return U},iC:function(){return I},iL:function(){return d},kT:function(){return y},lI:function(){return g},mS:function(){return m},n5:function(){return b},nQ:function(){return i},oY:function(){return q},o_:function(){return j},q0:function(){return L},s9:function(){return G},vL:function(){return u},vv:function(){return c},wF:function(){return N},wH:function(){return O},y3:function(){return F},yI:function(){return D},zr:function(){return _}});var t=a(76012),r=a(64236);const i=async(e,n)=>(0,t.dX)("/api/performance_management/query_indicators_library",{params:{...e,...(0,r.jG)(n)}}),s=async e=>(0,t.SO)("/api/performance_management/save_or_modify_indicator",(0,r.jG)(e)),o=async e=>(0,t.HG)("/api/performance_management/delete_indicators",{data:{id_list:e}}),l=async e=>(0,t.dX)("/api/performance_management/query_indicator_tag",{params:{...(0,r.jG)(e)}}),m=async e=>(0,t.SO)("/api/performance_management/modify_move_indicator_tag",{indicator_tag_list:e}),c=async e=>(0,t.SO)("/api/performance_management/save_or_modify_indicator_tag",e),u=async e=>(0,t.HG)(`/api/performance_management/delete_indicators_tag/${e}`),_=async()=>(0,t.dX)("/api/feishu/feishu_department_and_user_list"),d=async e=>(0,t.SO)("/api/performance_management/save_or_modify_evaluation_group",e),p=async(e,n)=>(0,t.dX)("/api/performance_management/query_evaluation_group",{params:(0,r.jG)({...e,...n})}),f=async(e,n)=>(0,t.dX)("/api/performance_management/query_evaluation_group_name",{params:(0,r.jG)({...e,...n})}),g=async e=>(0,t.HG)(`/api/performance_management/delete_evaluation_group/${e}`),y=async(e,n)=>(0,t.dX)("/api/performance_management/query_assessment",{params:(0,r.jG)({...e,...n})}),v=async e=>(0,t.SO)("/api/performance_management/save_assessment",e),h=async e=>(0,t.SO)("/api/performance_management/save_assessment_level_config",e),b=async()=>(0,t.dX)("/api/performance_management/query_assessment_level_config"),E=async(e,n)=>(0,t.dX)("/api/performance_management/query_assessment_detail",{params:(0,r.jG)({...e,...n})}),I=async e=>(0,t.dX)("/api/performance_management/get_assessment_detail_by_my_performance",{params:(0,r.jG)(e)}),T=async(e,n)=>(0,t.dX)("/api/performance_management/query_assessment_detail_by_analysis",{params:(0,r.jG)({...e,...n})}),A=async(e,n)=>(0,t.dX)("/api/performance_management/query_assessment_detail_by_performance_record",{params:(0,r.jG)({...e,...n})}),N=async e=>(0,t.SO)("/api/performance_management/modify_start_score",e),R=async e=>(0,t.SO)("/api/performance_management/modify_assessment_result",e),S=async(e,n)=>(0,t.dX)("/api/performance_management/query_my_performance",{params:(0,r.jG)({...e,...n})}),G=async e=>(0,t.dX)("/api/performance_management/query_assessment_by_id",{params:{assessment_management_id:e}}),O=async e=>{const{assessment_dimension_list:n}=e;return n&&n.length>0&&n.forEach((e=>{e.indicator_list&&e.indicator_list?.forEach((e=>{["self_assessment_score","weight","superior_assessment_score"].forEach((n=>{(0,r.xb)(e[n])&&(e[n]=null)}))}))})),console.log("payload",e),(0,t.SO)("/api/performance_management/modify_performance_process",(0,r.jG)(e))},U=async(e,n)=>(0,t.dX)("/api/performance_management/query_user_performance_record",{params:(0,r.jG)({...n,...e})}),w=async(e,n)=>(0,t.dX)("/api/performance_management/query_user_performance_detail_record",{params:(0,r.jG)({...e,...n})}),D=async(e,n)=>(0,t.dX)("/api/performance_management/query_performance_analysis",{params:(0,r.jG)({...e,...n})}),q=async()=>(0,t.dX)("/api/performance_management/query_finish_assessment"),k=async(e,n)=>(0,t.dX)("/api/performance_management/query_with_me_performance",{params:(0,r.jG)({...e,...n})}),C=async(e,n)=>(0,t.dX)("/api/performance_management/query_subordinate_performance",{params:(0,r.jG)({...e,...n})}),L=async e=>(0,t.SO)("/api/performance_management/check_evaluation_group_user_ids",e),X=async e=>(0,t.SO)("/api/performance_management/modify_reset_process",(0,r.jG)(e)),j=async e=>(0,t.dX)("/api/performance_management/query_assessment_and_user",{params:e}),M=async e=>(0,t.dX)("/api/performance_management/query_assessment_and_user_by_analysis",{params:e}),F=async e=>(0,t.dX)("/api/performance_management/query_assessment_and_user_by_performance_record",{params:e}),$=async(e,n)=>(0,t.dX)("/api/performance_management/query_assessment_name",{params:(0,r.jG)({...e,...n})}),x=async e=>(0,t.dX)("/api/auth/getuser_leader_by_subordinate_id",{params:{user_id:e}}),P=async e=>(0,t.dX)("/api/performance_management/query_assessment_and_user_by_my_performance",{params:(0,r.jG)(e)})},82741:function(e,n,a){a.d(n,{I:function(){return r},u:function(){return i}});var t=a(71340);const r=(e,n)=>{const a="string"===typeof n?{title:n}:n;return new Promise((n=>{e.root.$TDialog({...a,onConfirm:()=>n(!0),onCancel:()=>n(!1)})}))},i=e=>{const n="string"===typeof e?{title:e}:e;return new Promise(((e,a)=>{(0,t.t)({...n,onConfirm:()=>e(!0),onCancel:()=>a()})}))}},88721:function(e,n,a){var t=a(41572);a(97434);const r={IntergerAndDecimals(e){const n=/(\d+)$|\d+\.?\d{0,2}/.exec(e);return n?n[0]:""},Interger(e){return e.replace(/[^\d]/g,"")},NumberRange(e,n){return a=>{const t=this.IntergerAndDecimals(a);if(""===t)return t;const r=Number(t);return r<e?e+"":r>n?n+"":t}},Thousands(e){if(null===e||void 0===e||""===e)return e;e+="";const n=/^(\d+)(\.\d+$)?$/.exec(e+"");if(!n)return e;const a=n[1],t=n[2];let r=a.replace(/(\d{1,3})(?=(\d{3})+$)/g,(e=>`${e},`));return void 0!==t&&(r=`${r}${t}`),r},NineIntergerAndDecimals(e){const n=(/(?:0|[1-9]\d{0,8})(?:\.\d{0,2})?/u.exec(e.replace(/[^.\d]+/gu,"").replace(t.Pj,""))??[""])[0];return n}};n["Z"]=r}}]);