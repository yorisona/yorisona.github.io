"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[3217],{8755:function(e,t,s){s.r(t),s.d(t,{default:function(){return q}});var l,r,a,n,o=s(97434),i=s(21495),c=s(59563),m=s(70437),u=s(15681),d=s(1763),g=s(23624),p=s(44928),f=s(43773),_=s(2906),v=s(36568),b=s.n(v),k=s(88721),y=s(48606),x=s(64236),w=(0,o.defineComponent)({setup(e,t){const s=e=>{console.log("value",e)};(0,g.n5)().then((e=>{e.data.success&&e.data.data.length>0&&(r.value=e.data.data[0])}));const l=(0,c.Q)(g.EB,{manual:!0}),r=(0,o.ref)({entry_method:1,config_list:[{gt_score:0}]}),a=()=>{const e=r.value.config_list[r.value.config_list.length-1],t={name:"",lte_score:"",gt_score:""};(0,x.xb)(e.lte_score)||(t.gt_score=Number(e.lte_score)),r.value.config_list.push(t)},n=async()=>{i.value?.validate(((e,s)=>{if(!e){const e=s[Object.keys(s)[0]];return y.Message.error(e[0].message),void console.log(s)}const a=r.value;a.config_list=a.config_list.map(((e,t)=>(e.order=t,e.lte_score=Number(e.lte_score),e.gt_score=Number(e.gt_score),e))),l.runAsync(a).then((()=>{y.Message.success("设置成功"),t.emit("close")}))}))},i=(0,o.ref)();return{onSaveBtnClick:n,show:s,formData:r,formRef:i,addConfigList:a}},render(){const e=arguments[0],{formData:t}=this;return e("div",{class:"dialog-container"},[e("el-form",b()([{attrs:{size:"small","show-message":!1},ref:"formRef"},{attrs:{model:t}}]),[e("el-form-item",{attrs:{label:"录入方式：","label-width":"70px"},class:"level-way"},[e("el-select",{attrs:{placeholder:"请输入标签名称",value:1,disabled:!0},style:"width:100%"},[e("el-option",{attrs:{label:"分数区间对应",value:1}})])]),e("div",{class:"level-box-header"},[e("div",{class:"level-name"},["等级名称"]),e("div",{class:"level-range"},["分数区间范围"])]),e("div",{class:"levels-box"},[t.config_list.map(((s,l)=>e("fragments",[e("el-form-item",{class:"mgr-16",attrs:{prop:`config_list.${l}.name`,rules:{required:!0,message:"请输入等级名称",trigger:["change"]}}},[e("el-input",{attrs:{placeholder:"请输入",size:"small"},model:{value:s.name,callback:e=>{this.$set(s,"name",e)}}})]),e("el-form-item",[e("el-input",{attrs:{disabled:!0,placeholder:"请输入",value:s.gt_score,size:"small"},on:{input:e=>{s.gt_score=k.Z.Interger(e)}}})]),e("div",{class:"score mgl-6 mgr-6"},["< 分数 ≤"]),e("el-form-item",{class:"mgr-12",attrs:{prop:`config_list.${l}.lte_score`,rules:[{required:!0,message:"请输入分数区间范围",trigger:["blur"]},{validator:(e,s,r)=>{const a=Number(s);if(0===l&&a>0)return r();const n=Number(t.config_list[l-1].lte_score);if(isNaN(n))return r("");a<=n&&r("必须大于前一项分数"),r()},trigger:"blur"}]}},[e("el-input",{attrs:{placeholder:"请输入",size:"small"},on:{input:e=>{s.lte_score=k.Z.Interger(e)},blur:()=>{const e=t.config_list[l+1];e&&((0,x.xb)(s.lte_score)?e.gt_score="":e.gt_score=Number(s.lte_score))}},model:{value:s.lte_score,callback:e=>{this.$set(s,"lte_score",e)}}})]),e("div",{class:"score"},[l>0&&e("tg-icon",{attrs:{name:"ico-delete"},on:{click:()=>{t.config_list.splice(l,1)}}})])])))]),e("div",{class:"add"},[e("div",{class:"icon-add",on:{click:this.addConfigList}},[e("tg-icon",{attrs:{name:"ico-btn-add"}})]),e("tg-button",{attrs:{type:"link"},on:{click:this.addConfigList}},["添加等级"])])])])}}),L=w,$=s(1001),N=(0,$.Z)(L,l,r,!1,null,"f291fe86",null),C=N.exports,D=s(31165),Z=s(21757),I=(0,o.defineComponent)({setup:()=>{const e=(0,p.t)(),t=(0,Z.gI)(),s=[{label:"考核名称",prop:"name"},{label:"考核周期",prop:"assessment_cycle"},{label:"参与人数",formatter:e=>e.user_count},{label:"操作",minWidth:60,formatter:s=>h("div",[h("tg-button",{attrs:{type:"link"},on:{click:()=>{e.push({name:d.Gr.assessment.manage.detailList,params:{id:s.id}})}}},["查看"]),t.assessment_management_score&&h("tg-button",{attrs:{type:"link"},class:"mgl-12",on:{click:async()=>{n.show(s.id)}}},["发起评分"])])}],l=(0,c.h)(g.kT),r=(0,f.R)({title:"发起考核",component:_.Z,width:"380px",on:{submit:()=>{l.reload()}}}),a=(0,f.R)({component:C,title:"考核等级设置",width:"430px"}),n=(0,f.R)({component:D.Z,title:"发起评分",width:"600px",okText:"确定"}),i=(0,o.ref)({}),m={reset(){i.value={}}};return{columns:s,reqList:l,dialogLauch:r,dialogSetLevel:a,dialogLaunchScore:n,formData:i,config:m,permission:t}},render(){const e=arguments[0],{formData:t,permission:s}=this;return e(i.L,{attrs:{columns:this.columns,service:this.reqList,value:this.formData,config:this.config}},[e("el-form-item",{attrs:{label:"考核周期："}},[e(m.Z,{attrs:{options:u.OF},model:{value:t.cycle_type,callback:e=>{this.$set(t,"cycle_type",e)}}})]),e("el-form-item",{attrs:{label:"绩效名称："}},[e("el-input",{attrs:{placeholder:"请输入绩效名称"},model:{value:t.name,callback:e=>{this.$set(t,"name",e)}}})]),e("div",{slot:"btnLine",class:"btns-line"},[s.assessment_management_start&&e("tg-button",{attrs:{type:"primary",size:"small"},on:{click:()=>{this.dialogLauch.show()}}},["发起考核"]),s.assessment_management_level&&e("tg-button",{attrs:{size:"small"},style:"margin-left: 12px;",on:{click:()=>{this.dialogSetLevel.show()}}},["考核等级设置"])])])}}),z=I,R=(0,$.Z)(z,a,n,!1,null,"e8e29e0c",null),q=R.exports},88721:function(e,t,s){var l=s(41572);s(97434);const r={IntergerAndDecimals(e){const t=/(\d+)$|\d+\.?\d{0,2}/.exec(e);return t?t[0]:""},Interger(e){return e.replace(/[^\d]/g,"")},NumberRange(e,t){return s=>{const l=this.IntergerAndDecimals(s);if(""===l)return l;const r=Number(l);return r<e?e+"":r>t?t+"":l}},Thousands(e){if(null===e||void 0===e||""===e)return e;e+="";const t=/^(\d+)(\.\d+$)?$/.exec(e+"");if(!t)return e;const s=t[1],l=t[2];let r=s.replace(/(\d{1,3})(?=(\d{3})+$)/g,(e=>`${e},`));return void 0!==l&&(r=`${r}${l}`),r},NineIntergerAndDecimals(e){const t=(/(?:0|[1-9]\d{0,8})(?:\.\d{0,2})?/u.exec(e.replace(/[^.\d]+/gu,"").replace(l.Pj,""))??[""])[0];return t}};t["Z"]=r}}]);