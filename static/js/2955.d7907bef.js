"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[2955],{72955:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var o,r,l=a(36568),n=a.n(l),s=a(97434),i=a(29625),c=a(3293),d=a(7039),m=a(1763),p=a(49998),u=a(26895),h=(0,s.defineComponent)({name:"",setup(e,t){const{saleData:a,loading:o,AbnormalTableColumn:r,getData:l,total:n,onAnnexDialogClose:p}=(0,d.mO)(t),h=(0,s.ref)(),_=()=>({page_num:1,num:20,department_name:t.root.$route.query.department_name??void 0,business_type:Number(t.root.$route.query.business_type??0)||void 0,department_id:t.root.$route.query.department_id??void 0,department_level:t.root.$route.query.department_level??void 0,start_date:t.root.$route.query.start_date??void 0,end_date:t.root.$route.query.end_date??void 0,project_name:"",company_name:"",no_normal:!0}),v=(0,s.ref)(_()),y=(0,s.computed)((()=>[{label:"全部",value:void 0},{label:"抖音店播",value:i.WD.douyin},{label:"淘宝店播",value:i.WD.taobao},{label:"S2B2C",value:i.WD.mcn},{label:"营销业务",value:i.WD.marketing}])),g=(0,s.ref)([]),f=(0,s.ref)(void 0),b={async getFeishuDepartmentList(e=!1){const a=await(0,c.o1)({});if(a.data.success){const e=a.data.data.data;(0,u.$S)(e,!0,3),g.value=e}else t.root.$message.error(a.data.message??"请求失败，请重试")},handleCheckChange:e=>{f.value?.setCheckedKeys([]),v.value.department_id===e.id?(v.value.department_id=void 0,v.value.department_name=void 0):(v.value.department_id=e.id,v.value.department_name=e.name,v.value.department_level=e.level,f.value?.setCheckedKeys([e.id]))},ondepartmentCleaar(e){f.value?.setCheckedKeys([]),v.value.department_id=void 0,v.value.department_name=void 0,v.value.department_level=void 0,e&&e.stopPropagation()}};(0,s.onMounted)((async()=>{b.getFeishuDepartmentList(!1),l(v.value),v.value.department_id&&f.value?.setCheckedKeys([v.value.department_id])}));const k=async()=>{v.value={page_num:1,num:20,department_name:void 0,business_type:void 0,department_id:void 0,department_level:void 0,start_date:void 0,end_date:void 0,project_name:"",company_name:"",no_normal:!0},b.ondepartmentCleaar(),l(v.value)},x=async()=>{l(v.value)},C=e=>{v.value.page_num=e,l(v.value)},w=e=>{v.value.num=e,l(v.value)},q=(e,a)=>{if(a){if("操作"===a.label)return;if("项目信息"===a.label&&e.project_infos.length>0)return}if(1===e.contract_info.contract_type||2===e.contract_info.contract_type||5===e.contract_info.contract_type){const a=t.root.$router.resolve({name:e.template_info?m.l6.contracts.customer.detailTemplate:m.l6.contracts.customer.detail,params:{id:`${e.contract_info.id}`}});window.open(a.href,"_blank")}else if(3===e.contract_info.contract_type||4===e.contract_info.contract_type||6===e.contract_info.contract_type){const a=t.root.$router.resolve({name:e.template_info?m.l6.contracts.supplier.detailTemplate:m.l6.contracts.supplier.detail,params:{id:`${e.contract_info.id}`},query:{contract_type:`${e.contract_info.contract_type}`}});window.open(a.href,"_blank")}else{const a=t.root.$router.resolve({name:m.l6.contracts.anchor.detailTemplate,params:{id:`${e.contract_info.id}`},query:{contract_type:`${e.contract_info.contract_type}`}});window.open(a.href,"_blank")}};return{data:h,reset:k,reload:x,queryForm:v,businessList:y,feishuDepartmentList:g,department_tree:f,tableLoading:o,infoTotal:n,tableColumn:r,saleData:a,handleRowClick:q,onCurrentChange:C,handlePageSizeChange:w,onAnnexDialogClose:p,...b}},render(){const e=arguments[0],t={label:"name",children:"sons"},a={on:{"dialog:close":()=>{this.onAnnexDialogClose()}}};return e("div",{class:"tg-contract-page flex-auto"},[e("tg-card",{attrs:{padding:18}},[e("el-form",{class:"filter-form flex-form",attrs:{size:"medium","label-width":"70px","show-message":!1,"label-position":"left",inline:!0}},[e("el-form-item",{attrs:{label:"业务类型："}},[e("el-select",{style:"width: 204px;height: 36px",attrs:{clearable:!0},on:{focus:this.selectControlPopoverHide},model:{value:this.queryForm.business_type,callback:e=>{this.$set(this.queryForm,"business_type",e)}}},[this.businessList.map((t=>e("el-option",{attrs:{label:t.label,value:t.value},key:t.value})))])]),e("el-form-item",{attrs:{label:"归属部门："}},[e("el-popover",{attrs:{placement:"bottom-start",trigger:"click",width:"370","popper-class":"project-fund-statement-tree-popper"}},[e("div",{slot:"reference",class:"department-tree-select",style:"display: block; cursor: pointer;"},[this.queryForm.department_name&&e("div",{class:"depart-select-box"},[e("span",{style:"height: 36px; line-height: 36px;"},[this.queryForm.department_name]),e("i",{style:"margin-top: 10px; color: white",class:"el-icon-circle-close",on:{click:this.ondepartmentCleaar}})]),!this.queryForm.department_name&&e("div",{class:"depart-select-box"},[e("span",{style:"color:rgba(164, 178, 194, 1); height: 36px; line-height: 36px; font-size: 14px;"},["请选择所属部门"]),e("i",{style:"margin-top: 10px; color: #c0c4cc",class:"el-icon-arrow-down"})])]),e("div",{class:"department-tree"},[e("el-tree",n()([{ref:"department_tree"},{props:{props:t}},{attrs:{"check-strictly":!0,"node-key":"id",data:this.feishuDepartmentList,"show-checkbox":!0,"check-on-click-node":!0,"default-expanded-keys":this.queryForm.department_id?[this.queryForm.department_id]:[]},on:{check:this.handleCheckChange}}]))])]),e("li",{style:"display: none",class:"controlPopoverHide"})]),e("el-form-item",{attrs:{label:"项目名称："}},[e("el-input",{style:"width: 192px",attrs:{clearable:!0,placeholder:"请输入项目名称"},model:{value:this.queryForm.project_name,callback:e=>{this.$set(this.queryForm,"project_name",e)}}})]),e("el-form-item",{attrs:{label:"公司名称："},class:"flex-form-item form-item-group",style:"margin-bottom: 12px"},[e("el-input",{style:"width: 192px",attrs:{clearable:!0,placeholder:"请输入公司名称"},model:{value:this.queryForm.company_name,callback:e=>{this.$set(this.queryForm,"company_name",e)}}})]),e("el-form-item",{class:"flex-form-item order-100",style:"margin-bottom: 14px"},[e("tg-button",{attrs:{type:"primary"},on:{click:this.reload}},["查询"]),e("tg-button",{class:"mgl-12",on:{click:this.reset}},["重置"])])])]),e("section",{class:"table-field"},[e("div",{style:"height: 100%;"},[e("tg-table",{attrs:{stripe:!0,"tooltip-effect":"light",height:"100%",border:!0,data:this.saleData,"row-style":{cursor:"pointer"}},directives:[{name:"loading",value:this.tableLoading}],class:"precharge-table",on:{"row-click":this.handleRowClick}},[e("template",{slot:"empty"},[e("empty-common",{style:"margin-top:20px",attrs:{imgHeight:"100",imgWidth:"200","detial-text":"暂无数据"}})]),this.tableColumn.map((t=>e("el-table-column",{attrs:{"show-overflow-tooltip":!0,label:t.label,prop:t.property,align:t.align,headerAlign:t.headerAlign,minWidth:t.minWidth,formatter:t.formatter}})))])])]),this.saleData.length>0&&e("div",{class:"pagination"},[e("el-pagination",{style:"margin: 8px 0;",class:"flex-none",attrs:{"current-page":this.queryForm.page_num,"page-sizes":[10,20,30,50,100],"page-size":this.queryForm.num,total:this.infoTotal,layout:"total, prev, pager, next, sizes, jumper"},on:{"current-change":this.onCurrentChange,"size-change":this.handlePageSizeChange}})]),e(p.Z,n()([{},a]))])}}),_=h,v=a(1001),y=(0,v.Z)(_,o,r,!1,null,"1d672e40",null),g=y.exports}}]);