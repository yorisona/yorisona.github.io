"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[3748],{66626:function(t,e,a){a.d(e,{Z:function(){return C}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"customer-dialog statement-dialog tg-dialog-vcenter",attrs:{visible:t.visible,width:"822px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{close:t.onCancelBtnClick},scopedSlots:t._u([{key:"title",fn:function(){return[a("span",[t._v("新增客户结算单")])]},proxy:!0},{key:"footer",fn:function(){return[a("tg-button",{attrs:{type:"default"},on:{click:t.onCancelBtnClick}},[t._v("取消")]),a("tg-button",{attrs:{type:"primary"},on:{click:t.onConfirmBtnClick}},[t._v("提交")])]},proxy:!0}])},[a("div",{staticClass:"form-block"},[a("el-form",{ref:"formRef",attrs:{model:t.form,rules:t.formRules,"label-width":"92px",size:"small",inline:""}},[a("div",{staticClass:"subject mgb-10"},[t._v("结算单基本信息")]),a("el-form-item",{attrs:{label:"合同编号：",prop:"contract_id"}},[a("el-select",{staticClass:"contract-attachment-input",attrs:{filterable:"",remote:"","reserve-keyword":"",clearable:"",placeholder:"请搜索并选择合同编号","popper-class":"contract-select-empty","remote-method":t.getCustmerByContractUid_extend,loading:t.contract_uid_loading},on:{change:t.onContractUidChange},model:{value:t.contract_uid,callback:function(e){t.contract_uid=e},expression:"contract_uid"}},t._l(t.contractInfoRecords,(function(t){return a("el-option",{key:t.contract_uid,attrs:{label:t.contract_uid,value:t.contract_uid}})})),1)],1),a("el-form-item",{attrs:{label:"客户：",prop:"partner_name"}},[a("el-input",{staticClass:"contract-attachment-input",attrs:{placeholder:"请搜索并选择关联合同编号",disabled:""},model:{value:t.form.partner_name,callback:function(e){t.$set(t.form,"partner_name","string"===typeof e?e.trim():e)},expression:"form.partner_name"}})],1),t.project?a("el-form-item",{attrs:{label:"项目：",rules:[{required:!0}]}},[t.project.project_name?a("el-input",{staticClass:"contract-attachment-input",attrs:{placeholder:"请先关联合同编号",disabled:""},model:{value:t.project.project_name,callback:function(e){t.$set(t.project,"project_name",e)},expression:"project.project_name"}}):a("el-input",{staticClass:"contract-attachment-input",attrs:{placeholder:"请先关联合同编号",disabled:""},model:{value:t.project.cooperation_name,callback:function(e){t.$set(t.project,"cooperation_name",e)},expression:"project.cooperation_name"}})],1):t._e(),t.project&&5!==t.project.business_type?a("el-form-item",{attrs:{label:"品牌："}},[a("el-input",{staticClass:"contract-attachment-input",attrs:{placeholder:"请先关联合同编号",disabled:""},model:{value:t.project.brand_name,callback:function(e){t.$set(t.project,"brand_name",e)},expression:"project.brand_name"}})],1):t._e(),a("el-form-item",{attrs:{label:"审批金额：",prop:"approval_amount"}},[a("el-input",{staticClass:"contract-attachment-input",attrs:{placeholder:"请输入审批金额"},on:{input:t.inputApprovalAmount},model:{value:t.form.approval_amount,callback:function(e){t.$set(t.form,"approval_amount",e)},expression:"form.approval_amount"}})],1),a("el-form-item",{attrs:{label:"用章情况：",prop:"seal_type"}},[a("el-select",{staticClass:"contract-attachment-input",model:{value:t.form.seal_type,callback:function(e){t.$set(t.form,"seal_type",e)},expression:"form.seal_type"}},t._l(t.SealTypeOptions,(function(t){return a("el-option",{key:t.value,staticStyle:{width:"158px"},attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",{attrs:{label:"申请内容：",prop:"comment"}},[a("el-input",{staticStyle:{width:"426px"},attrs:{type:"textarea",maxlength:100,placeholder:"请输入文本","show-word-limit":""},model:{value:t.form.comment,callback:function(e){t.$set(t.form,"comment","string"===typeof e?e.trim():e)},expression:"form.comment"}})],1),a("el-form-item",{attrs:{label:"附件单：",prop:"attachment_url"}},[a("div",{staticClass:"upload-btn-wrap"},[a("el-upload",{staticClass:"upload-attachment",attrs:{action:"/",multiple:!1,"show-file-list":!1,accept:".jpeg,.jpg,.png,.pdf,.docx,.xlsx","http-request":t.uploadAttachmentFile,disabled:t.uploadedAttachmentList.length>=5}},[a("tg-button",{attrs:{icon:"ico-btn-upload",disabled:t.uploadedAttachmentList.length>=5}},[t._v("上传文件 ")])],1)],1),a("span",{staticClass:"upload-tips mgl-12"},[t._v("支持扩展名：.docx .pdf .jpg .png .xlsx；最多上传5个文件夹 (单个文件大小不超过30M) ")]),t.uploadedAttachmentList.length?a("div",{staticClass:"uploaded-list"},[a("upload-file-list",{attrs:{inline:""},model:{value:t.uploadedAttachmentList,callback:function(e){t.uploadedAttachmentList=e},expression:"uploadedAttachmentList"}})],1):t._e()]),a("div",{staticClass:"subject mgb-16",staticStyle:{"margin-top":"8px"}},[t._v("结算情况")]),t._l(t.form.settlement_detail,(function(e,n){return a("div",{key:n,staticClass:"settlement-detail-item"},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{"label-width":t.labelWidth,label:"结算方式：",prop:"settlement_detail["+n+"].settle_way",rules:t.settlementDetailRules.settle_way}},[a("el-radio-group",{staticStyle:{display:"inline-flex"},model:{value:e.settle_way,callback:function(a){t.$set(e,"settle_way",a)},expression:"settlement.settle_way"}},t._l(t.SettleWayOptions,(function(e){return a("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label)+" ")])})),1)],1),a("div",{staticClass:"settlement-detail-item-grid"},[t.isVTask(e)?a("el-form-item",{attrs:{"label-width":t.labelWidth,label:"店铺名称：",prop:"settlement_detail["+n+"].shop_name",rules:t.settlementDetailRules.shop_name}},[a("el-input",{staticStyle:{width:"158px"},attrs:{maxlength:20,placeholder:"店铺名称"},model:{value:e.shop_name,callback:function(a){t.$set(e,"shop_name","string"===typeof a?a.trim():a)},expression:"settlement.shop_name"}})],1):t._e(),t.isVTask(e)?a("el-form-item",{staticStyle:{margin:"0"},attrs:{"label-width":t.labelWidth,label:"旺旺名：",prop:"settlement_detail["+n+"].wangwang_num",rules:t.settlementDetailRules.wangwang_num}},[a("el-input",{staticStyle:{width:"158px"},attrs:{maxlength:20,placeholder:"下单旺旺名"},model:{value:e.wangwang_num,callback:function(a){t.$set(e,"wangwang_num","string"===typeof a?a.trim():a)},expression:"settlement.wangwang_num"}})],1):t._e(),a("el-form-item",{staticStyle:{margin:"0"},attrs:{"label-width":t.labelWidth,label:"结算金额：",prop:"settlement_detail["+n+"].settle_amount",rules:t.settlementDetailRules.settle_amount}},[a("el-input",{staticStyle:{width:"158px"},attrs:{placeholder:"0.00"},on:{input:function(e){return t.inputAmount(n,"settle_amount",e)}},model:{value:e.settle_amount,callback:function(a){t.$set(e,"settle_amount",a)},expression:"settlement.settle_amount"}})],1),a("el-form-item",{staticStyle:{margin:"0"},attrs:{"label-width":t.labelWidth,label:"开始日期：",prop:"settlement_detail["+n+"].start_date",rules:t.settlementDetailRules.start_date}},[a("el-date-picker",{staticStyle:{width:"158px"},attrs:{clearable:"",placeholder:"开始日期","value-format":"yyyy-MM-dd"},on:{change:function(e){return t.onStartDateChange(n,e)}},model:{value:e.start_date,callback:function(a){t.$set(e,"start_date",a)},expression:"settlement.start_date"}})],1),a("el-form-item",{staticStyle:{margin:"0"},attrs:{"label-width":t.labelWidth,label:"结束日期：",prop:"settlement_detail["+n+"].end_date",rules:t.settlementDetailRules.end_date}},[a("el-date-picker",{staticStyle:{width:"158px"},attrs:{clearable:"",placeholder:"结束日期","value-format":"yyyy-MM-dd"},on:{change:function(e){return t.onEndDateChange(n,e)}},model:{value:e.end_date,callback:function(a){t.$set(e,"end_date",a)},expression:"settlement.end_date"}})],1)],1),a("el-form-item",{staticStyle:{width:"512px"},attrs:{"label-width":t.labelWidth,label:"备注：",prop:"settlement_detail["+n+"].remark",rules:t.settlementDetailRules.remark}},[a("el-input",{staticStyle:{width:"416px"},attrs:{maxlength:20,placeholder:"备注（不超过20个字）","show-word-limit":""},model:{value:e.remark,callback:function(a){t.$set(e,"remark","string"===typeof a?a.trim():a)},expression:"settlement.remark"}})],1),t.isOnlyEmpty?t._e():a("div",{staticClass:"close-btn",on:{click:function(e){return t.removeSettlement(n)}}},[a("tg-icon",{attrs:{name:"ico-cross-lite"}})],1)],1)})),t.isFullSettlementDetail?t._e():a("div",{staticClass:"statement-add-btn",on:{click:t.addSettment}},[a("tg-icon",{attrs:{name:"ico-btn-add"}}),a("span",[t._v("点击添加")])],1)],2)],1)]),a("tg-mask-loading",{attrs:{visible:t.saveLoading,content:"  正在提交数据，请稍候..."}})],1)},r=[],o=(a(21703),a(26699),a(97434)),i=a(93889),l=a(12205),s=a(41572);const c=t=>{const e=(t,e,a)=>{s.WV.test(e)?a(new Error("请输入正数")):a()},a=(t,e,a)=>{s.Ll.test(e)?a():a(new Error("请输入金额"))},n=(0,o.ref)({contract_type:[{required:!0,message:"请选择合同类型",trigger:"change"}],contract_id:[{required:!0,message:"请搜索并选择关联合同编号",trigger:"blur"}],partner_name:[{required:!0,message:"请搜索并选择关联合同编号",trigger:"blur"}],approval_amount:[{required:!0,message:"请输入审批金额",trigger:"blur"},{validator:e,trigger:"blur"}],seal_type:[{required:!0,message:"请选择用章情况",trigger:"blur"}],attachment_url:[{required:!0,message:"请上传附件",trigger:"blur"}]}),r=(0,o.ref)({settle_way:[{required:!0,message:"请选择结算方式",trigger:"change"}],shop_name:[{required:!0,message:"请输入店铺名称",trigger:"blur"}],wangwang_num:[{required:!0,message:"请输入下单旺旺名",trigger:"blur"}],settle_amount:[{required:!0,message:"请输入结算金额",trigger:"blur"},{validator:e,trigger:"blur"}],start_date:[{required:!0,message:"请选择开始日期",trigger:"blur"}],end_date:[{required:!0,message:"请选择结束日期",trigger:"blur"}],done_amount:[{required:!0,message:"请输入已收金额",trigger:"blur"},{validator:a,trigger:"blur"}],wait_amount:[{required:!0,message:"请输入待收金额",trigger:"blur"},{validator:a,trigger:"blur"}],invoice_amount:[{required:!0,message:"请输入已开票金额",trigger:"blur"},{validator:a,trigger:"blur"}],remark:[{message:"请输入备注",trigger:"blur"},{validator:(t,e,a)=>{e.trim().length>20?a(new Error("备注最多20个字")):a()},trigger:"blur"}]}),i=(0,o.computed)((()=>({...n.value,...r.value})));return{formRules:i,settlementDetailRules:r}};var u=a(61282),p=a(86863),d=a(83005),m=a(84731),_=a(29625),v=a(64236),f=a(48606);const g=12;var h=(0,o.defineComponent)({name:"StatementFormDialog",components:{},props:{visible:{type:Boolean,required:!0},isfromworkbench:{type:Boolean,required:!1},editData:{type:Object,required:!1},isMerchant:{type:Boolean,default:!1}},setup(t,e){const a=(0,o.ref)(!1),n=(0,o.ref)(null),r=(0,o.inject)("contract"),s=(0,o.computed)((()=>void 0!==r?.value)),p=(0,o.ref)(""),v=(0,o.ref)(""),h=(0,o.inject)("project_add_id"),y=(0,o.inject)("project"),b=(0,m.f)(t.isMerchant);let w=1;t.editData&&t.editData.isEdit?w=t.editData.business_type===_.WD.marketing?2:1:b.isLiveDetail||b.isCommonBusinessDetail?w=1:b.isCoopDetail&&(w=2);const C=(0,o.ref)({contract_id:"",approval_amount:"",comment:"",attachment_url:[],partner_id:"",partner_name:"",contract_type:void 0,seal_type:i.N5.Type2,settlement_detail:[],current_project_id:h,project_type:w}),k=()=>{if(void 0===r?.value)return;const{contract_info:{id:t,partner_id:e,contract_uid:a},partner_info:{partner_name:n}}=r.value;C.value.contract_id=t,p.value=a,C.value.partner_id=e,C.value.partner_name=n,v.value=n};(0,o.watch)((()=>t.visible),((t,e)=>{t&&t!==e&&k()}));const{clearContractInfoRecords:j,...x}=(0,l.b)(C,n,1,i.RJ.Framework),{formRules:D,settlementDetailRules:S}=c(C),T=JSON.stringify({settle_way:i.GD.Bank,shop_name:"",wangwang_num:"",settle_amount:"",start_date:"",end_date:"",done_amount:"",wait_amount:"",invoice_amount:"",remark:""}),B=()=>{C.value.settlement_detail.push({settle_way:i.GD.Bank,shop_name:"",wangwang_num:"",settle_amount:"",start_date:"",end_date:"",done_amount:"",wait_amount:"",invoice_amount:"",remark:""})},O=t=>JSON.stringify(t)===T,Z=t=>{C.value.settlement_detail.splice(t,1),0===C.value.settlement_detail.length&&B()},P=(0,o.computed)((()=>1===C.value.settlement_detail.length&&O(C.value.settlement_detail[0]))),$=({settle_way:t})=>t===i.GD.VTask;B();const q=(0,o.computed)((()=>C.value.settlement_detail.length>=g)),R=(t,a)=>{null===a&&e.root.$nextTick((()=>{C.value.settlement_detail[t].start_date=""}))},L=(t,a)=>{null===a&&e.root.$nextTick((()=>{C.value.settlement_detail[t].end_date=""}))},A=t=>{const e=(0,u.nA)(t);C.value.approval_amount=e},E=(t,e,a)=>{C.value.settlement_detail[t][e]=(0,u.nA)(a)},F=()=>{n.value?.clearValidate(),n.value?.resetFields(),t.editData&&t.editData.isEdit?(C.value=Object.assign({},C.value,{contract_uid:t.editData.contract_no,partner_name:t.editData.partner_name,contract_id:t.editData.contract_id,partner_id:t.editData.partner_id,approval_amount:t.editData.approval_amount,comment:t.editData.comment,attachment_url:t.editData.attachment_url?.split(",")||[],current_project_id:t.editData.project_id,settlement_detail:t.editData.settlement_detail.map((t=>({settle_amount:t.settle_amount,settle_way:t.settle_way,start_date:t.start_date,end_date:t.end_date,done_amount:t.done_amount,wait_amount:t.wait_amount,invoice_amount:t.invoice_amount,remark:t.remark,shop_name:t.shop_name,wangwang_num:t.wangwang_num})))}),x.contract_uid.value=t.editData.contract_no,K.value=t.editData.attachment_url?.split(",")||[],w=t.editData.business_type===_.WD.marketing?2:1,C.value.project_type=w):(C.value.contract_id="",C.value.approval_amount="",C.value.comment="",C.value.attachment_url=[],C.value.partner_id="",C.value.partner_name="",C.value.contract_type=i.RJ.Framework,C.value.seal_type=i.N5.Type2,C.value.settlement_detail=[],x.contract_uid.value="",K.value=[],j(),B())},G=()=>{e.emit("dialog:close"),F()},W=async()=>{const{contract_id:t,attachment_url:e,partner_id:a,settlement_detail:n,...r}=C.value;if(""===t||""===a)return Promise.reject(new Error("请关联客户合同"));if(0===e.length)return Promise.reject(new Error("请上传附件"));const o=n.filter((t=>!O(t))),i={contract_id:t,attachment_url:e.join(","),partner_id:a,settlement_detail:o,...r};return Promise.resolve(i)},U=async()=>{t.isfromworkbench||k();const r=await new Promise((t=>{n.value?.validate((e=>{t(e)}))}));if(!r)return;const o=await W();function i(){return Promise.resolve().then((()=>t.editData&&t.editData.isEdit?t.editData.business_type===_.WD.marketing?(0,d.Zx)(o):t.editData.business_type===_.WD.mcn?(0,d.BJ)(o):(0,d._C)(o):b.isLiveDetail?(0,d._C)(o):b.isCommonBusinessDetail?(0,d.BJ)(o):b.isCoopDetail?(0,d.Zx)(o):(0,d.Te)(o)))}a.value=!0;const{data:l}=await i();a.value=!1,l.success?e.emit("dialog:close",!0):e.root.$message.error(l.message??"新增结算单失败")},X=(0,o.computed)((()=>C.value.settlement_detail)),K=(0,o.ref)([]);let M;(0,o.watch)((()=>t.editData),(t=>{t&&(C.value=Object.assign({},C.value,{contract_uid:t.contract_no,partner_name:t.partner_name,contract_id:t.contract_id,partner_id:t.partner_id,contract_type:t.contract_type,approval_amount:t.approval_amount,comment:t.comment,attachment_url:t.attachment_url?.split(",")||[],current_project_id:t.project_id,settlement_detail:t.settlement_detail.map((t=>({settle_amount:t.settle_amount,settle_way:t.settle_way,start_date:t.start_date,end_date:t.end_date,done_amount:t.done_amount,wait_amount:t.wait_amount,invoice_amount:t.invoice_amount,remark:t.remark,shop_name:t.shop_name,wangwang_num:t.wangwang_num})))}),x.contract_uid.value=t.contract_no,K.value=t.attachment_url?.split(",")||[],w=t.business_type===_.WD.marketing?2:1,C.value.project_type=w)}),{deep:!0});const V=()=>{M=f.Loading.service({lock:!0,text:"加载中……",background:"rgba(0, 0, 0, 0.7)"})},J=()=>{M.close()},N=t=>x.getCustmerByContractUid(t);return{saveLoading:a,startLoading:V,closeLoading:J,loadnewing:M,project:y,project_add_id:h,ContractType:i.RJ,formRef:n,form:C,formRules:D,lockContract:s,locked_contract_uid:p,locked_partner_name:v,settlementDetailRules:S,SettleWayOptions:i.kD,...x,getCustmerByContractUid_extend:N,SealTypeOptions:i.Vx,addSettment:B,removeSettlement:Z,isVTask:$,isFullSettlementDetail:q,isOnlyEmpty:P,onStartDateChange:R,onEndDateChange:L,inputApprovalAmount:A,inputAmount:E,onCancelBtnClick:G,onConfirmBtnClick:U,labelWidth:"78px",settlement_detail:X,uploadedAttachmentList:K}},methods:{beforeUpload(t){return this.loading=!0,t.size>31457280?(this.$message.error(`${t.name} ${(t.size/1024/1024).toFixed(2)}MB 请限制在30MB以内`),this.loading=!1,!1):!(!["image/jpeg","image/jpg","image/png","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type)&&![".jpg",".jpeg",".png",".docx",".doc",".xls",".xlsx"].includes((0,v.mD)(t.name)))||(this.$message.warning("文件格式不正确，请使用 jpg / png / pdf / docx / xlsx"),this.loading=!1,!1)},async uploadAttachmentFile(t){if(!this.beforeUpload(t.file))return;this.isAddingEditing=!1;const e=new FormData;e.append("file",t.file,t.file.name),e.append("attachment_type","contract_annex"),this.uploadAttachmentUploading=!0,this.startLoading();const a=await(0,p.w_)(e);this.uploadAttachmentUploading=!1,this.closeLoading(),a.data.success?(this.uploadedAttachmentList.push(a.data.data.source),this.form.attachment_url=this.uploadedAttachmentList,this.formRef?.validateField("attachment_url")):this.$message({type:"warning",message:a.data.message??"上传失败，稍后重试",showClose:!0,duration:3e3})},handleAttachmentClick(t){this.uploadedAttachmentList.splice(t,1),this.form.attachment_url=this.uploadedAttachmentList}}}),y=h,b=a(1001),w=(0,b.Z)(y,n,r,!1,null,null,null),C=w.exports},86863:function(t,e,a){a.d(e,{B9:function(){return k},C7:function(){return h},E2:function(){return p},Fn:function(){return u},Jv:function(){return w},LK:function(){return m},Ou:function(){return g},TG:function(){return i},Uw:function(){return r},XZ:function(){return d},_6:function(){return b},aw:function(){return B},cQ:function(){return C},dh:function(){return T},em:function(){return o},g9:function(){return x},iI:function(){return c},it:function(){return y},jy:function(){return v},kT:function(){return j},pc:function(){return l},qJ:function(){return _},qq:function(){return f},ve:function(){return D},vf:function(){return S},w_:function(){return s}});var n=a(76012);a(42963);function r(t){return(0,n.ZP)({url:"/api/cust/del_customer",method:"get",params:t})}function o(t){return(0,n.ZP)({url:"/api/auth/query_user_names",method:"get",params:t})}function i(){return(0,n.ZP)({url:"/api/auth/query_user_names",method:"get"})}function l(t){return(0,n.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:t})}function s(t){return(0,n.ZP)({url:"/api/cont/upload_attachment",method:"post",data:t})}function c(){return(0,n.ZP)({url:"/api/auth/get_department",method:"get"})}function u(){return(0,n.ZP)({url:"/api/cont/get_approver",method:"get"})}function p(t,e=1){const a=1===e?"/api/cont/query_contract":2===e?"/api/cont/query_law_contract":4===e?"/api/cont/query_cooperation_contract":5===e?"/api/cont/query_common_contract":"/api/cont/query_shop_live_contract";return(0,n.ZP)({url:a,method:"get",params:t})}function d(){return(0,n.ZP)({url:"/api/cont/get_contract_uid",method:"get"})}function m(t={}){return(0,n.ZP)({url:"/api/shop_live/get_shop_live_contract_uid",method:"get",params:t})}function _(t){return(0,n.ZP)({url:"/api/cont/del_contract",method:"post",data:t})}function v(t){return(0,n.ZP)({url:"/api/cont/approve_contract",method:"post",data:t})}function f(t){return(0,n.ZP)({url:"/api/cont/del_contract",method:"post",data:t})}function g(t){return(0,n.ZP)({url:`/api/cont/delete_contract_annex/${t}/`,method:"post"})}function h(t){return(0,n.ZP)({url:`/api/cont/delete_contract_statements/${t}/`,method:"post"})}function y(t){return(0,n.ZP)({url:"/api/cont/invalid_contract",method:"post",data:t})}function b(t){return(0,n.ZP)({url:"/api/cont/recycle_contract",method:"post",data:t})}function w(t){return(0,n.ZP)({url:"/api/auth/get_user_by_role",method:"get",params:t})}function C(t){return(0,n.ZP)({url:"/api/cont/get_partner_by_name",method:"get",params:t})}function k(t){return(0,n.ZP)({url:"/api/cont/save_contract_annex",method:"post",data:t})}function j(t){return(0,n.ZP)({url:"/api/cont/del_contract_annex",method:"post",data:t})}function x(t){return(0,n.ZP)({url:"/api/cont/query_contract_annex",method:"get",params:t})}function D(t){return(0,n.ZP)({url:"/api/cont/query_contract_statements",method:"get",params:t})}function S(t){return(0,n.ZP)({url:`/api/cont/get_contract_approval_flow/${t}/`,method:"get"})}function T(t){return(0,n.ZP)({url:`/api/cont/get_contract_annex_approval_flow/${t}/`,method:"get"})}function B(t){return(0,n.ZP)({url:`/api/cont/get_contract_statements_approval_flow/${t}/`,method:"get"})}},12205:function(t,e,a){a.d(e,{b:function(){return i},j:function(){return l}});var n=a(79433),r=a(97434),o=a(83005);const i=(t,e,a=1,n)=>{const i=(0,r.ref)(""),l=(0,r.ref)(!1),s=(0,r.ref)([]),c=()=>{s.value=[]},u=async(e,n)=>{if(""===e)return void(s.value=[]);const r=n;l.value=!0;const{data:i}=await(0,o.z0)({partner_type:a,contract_status:2,only_main:0,search:e,contract_type:r,project_type:t.value.project_type});l.value=!1,i.success?s.value=i.data.data.filter((t=>2===t.contract_status)):s.value=[]},p=a=>{const n=s.value.find((t=>t.contract_uid===a));t.value.partner_name=n?.partner_name??"",t.value.contract_id=n?.contract_id??"",t.value.partner_id=n?.partner_id??"",t.value.contract_type=n?.contract_type??"",e.value?.clearValidate()},d=t=>{i.value=t,u(t)},m=()=>{c(),i.value="",l.value=!1,t.value.partner_name="",t.value.contract_id="",t.value.partner_id=""},_=()=>{c(),i.value="",l.value=!1};return{contract_uid:i,contract_uid_loading:l,contractInfoRecords:s,clearContractInfoRecords:c,getCustmerByContractUid:u,onContractUidChange:p,resetContractUid:m,refillContractUid:d,resetFrameContractUid:_}},l=(t,e)=>{const a=(0,r.ref)("");(0,r.watch)((()=>a.value),(t=>{""===t&&(o.value=[])}));const o=(0,r.ref)([]),i=async(t,e=!1)=>{let a=[],r=!0;if(e){const e=(await(0,n.iY)({shop_name:t,num:1e3,page_num:1})).data;a=e.data.data,r=e.success}else{const e=(await(0,n.G7)({shop_name:t})).data;a=e.data,r=e.success}o.value=r?a:[]},l=(0,r.computed)((()=>o.value.find((e=>e.id===t.value.partner_id)))),s=(0,r.computed)((()=>l.value?.company_name??"")),c=(0,r.computed)((()=>l.value?.shop_name??"")),u=a=>{t.value.partner_id=a,e.value?.clearValidate()},p=(t,e=!1)=>{a.value=t,i(t,e)},d=()=>{t.value.partner_id="",a.value=""};return{allStoreName:o,shopNameSearchKey:a,getAllStoreName:i,shop_name:c,company_name:s,onPartnerIdChange:u,refillShopNameSearchKey:p,resetShopName:d}}},84731:function(t,e,a){a.d(e,{f:function(){return o}});var n=a(44928),r=a(1763);const o=(t=!1)=>{const e=(0,n.t)(),a=e.currentRoute.name,o=r.u3.project.detail===a||t,i=r.u3.contract.supplier.detail===a||r.u3.contract.supplier.detailTemplate===a||r.u3.contract.anchor.detailTemplate===a,l=r.u3.contract.customer.detail===a||r.u3.contract.customer.detailTemplate===a,s=r.FB.contract.supplier.detail===a||r.FB.contract.supplier.detailTemplate===a||r.FB.contract.anchor.detailTemplate===a,c=r.FB.contract.customer.detail===a||r.FB.contract.customer.detailTemplate===a,u=r.u3.contract.customer.detailTemplate===a,p=r.Z8.contract.supplier.detail===a||r.Z8.contract.supplier.detailTemplate===a||r.Z8.contract.anchor.detailTemplate===a,d=r.Z8.contract.customer.detail===a||r.Z8.contract.customer.detailTemplate===a,m=r.l6.contracts.supplier.detail===a||r.l6.contracts.supplier.detailTemplate===a||r.l6.contracts.anchor.detailTemplate===a,_=r.l6.contracts.customer.detail===a||r.l6.contracts.customer.detailTemplate===a,v=r.l6.statistics.supplier.detail===a||r.l6.statistics.supplier.detailTemplate===a||r.l6.statistics.anchor.detailTemplate===a,f=r.l6.statistics.customer.detail===a||r.l6.statistics.customer.detailTemplate===a,g=r.Z8.project.detail===a,h=r.FB.project.detail===a,y=r.u3.contract.customer.detailTemplate===a||r.l6.contracts.customer.detailTemplate===a||r.Z8.contract.customer.detailTemplate===a||r.FB.contract.customer.detailTemplate===a,b=r.bv.player_contract===a;return{isCustomerDetail:y,isCommonBusinessDetail:o,isCommonBusinessSupplierContractDetail:i,isCommonBusinessCustomerContractDetail:l,isLiveSupplierContractDetail:s,isLiveCustomerContractDetail:c,isLegalCustomerContractDetail:_,isLegalSupplierContractDetail:m,isLegalStatisticsSupplierContractDetail:v,isLegalStatisticsCustomerContractDetail:f,isCoopSupplierContractDetail:p,isCoopCustomerContractDetail:d,isCoopDetail:g,isLiveDetail:h,isisCommonBusinessCustomerContractDetailTemplate:u,isSupplierDetail:b}}},78066:function(t,e,a){a.d(e,{A8:function(){return x},Ed:function(){return g},Eo:function(){return c},FT:function(){return B},HB:function(){return O},HR:function(){return S},I8:function(){return C},KH:function(){return b},Kn:function(){return y},LY:function(){return P},MB:function(){return d},Mv:function(){return l},R_:function(){return w},S2:function(){return L},WH:function(){return q},Wk:function(){return m},dF:function(){return T},fz:function(){return Z},gO:function(){return R},hQ:function(){return j},l7:function(){return p},mP:function(){return $},oP:function(){return v},pB:function(){return s},qG:function(){return f},sB:function(){return k},sV:function(){return u},tF:function(){return i},w3:function(){return D},xR:function(){return h},yC:function(){return _}});var n=a(64236),r=a(76012),o=a(70753);const i=async t=>(0,r.dX)(o.EA,{params:{...(0,n.jG)(t)}}),l=async t=>(0,r.SO)(o.j0,{...(0,n.jG)(t)}),s=async t=>(0,r.SO)("/api/shop_live/shop_live_project_approval",{...(0,n.jG)(t)}),c=async t=>(0,r.dX)("/api/shop_live/query_shop_live_cost",{params:{...(0,n.jG)(t)}}),u=async t=>(0,r.dX)("/api/payable/query_shop_live_payables",{params:{...(0,n.jG)(t)}}),p=async t=>(0,r.dX)(o.L.replace(":id",t)),d=async t=>(0,r.dX)(o.a0,{params:{project_id:t}}),m=async(t,e,a)=>(0,r.dX)(o.gV,{params:{project_id:t,page_num:e,num:a}}),_=async(t,e,a)=>(0,r.dX)(o.qe,{params:{project_id:t,page_num:e,num:a}}),v=async t=>(0,r.SO)(o.OW.replace("{achievement_id}",t)),f=async t=>(0,r.SO)(o.a9.replace("{achievement_id}",t)),g=async t=>(0,r.SO)("/api/shop_live/del_shop_live_cost/{cost_id}/".replace("{cost_id}",t)),h=async t=>(0,r.SO)(o.xR,(0,n.jG)(t)),y=async t=>(0,r.SO)(o.Kn,(0,n.jG)(t)),b=async t=>(0,r.SO)(o.KH,(0,n.jG)(t)),w=async t=>(0,r.SO)("/api/coop/save_achievement",(0,n.jG)(t)),C=async t=>(0,r.SO)("/api/shop_live/save_shop_live_cost",t),k=(t,e,a)=>(0,r.dX)("/api/shop_live/daily_report",{params:{begin_time:t,end_time:e,project_id:a}}),j=t=>(0,r.SO)("/api/shop_live/daily_report",(0,n.jG)(t)),x=(t,e,a)=>(0,r.dX)("/api/coop/daily_report",{params:{begin_time:t,end_time:e,project_id:a}}),D=t=>(0,r.SO)("/api/coop/daily_report",(0,n.jG)(t)),S=t=>(0,r.SO)("/api/shop_live/save_net_sales_rate",(0,n.jG)(t)),T=(t,e)=>(0,r.dX)("/api/shop_live/query_project_goal_settings",{params:{year:t,project_id:e}}),B=t=>(0,r.SO)("/api/shop_live/save_project_shop_goal_settings",t),O=t=>(0,r.SO)("/api/shop_live/save_project_anchor_goal_settings",t),Z=t=>(0,r.dX)("/api/shop_live/get_project_settlement_setting",{params:{project_id:t}}),P=t=>(0,r.SO)("/api/shop_live/save_project_settlement_setting",(0,n.jG)(t)),$=t=>(0,r.dX)("/api/shop_live/get_project_auth_status/"+t+"/"),q=t=>(0,r.dX)("/api/shop_live/search_expense_type",{params:{keyword:t}}),R=t=>(0,r.SO)("/api/shop_live/save_s2b2c_settlement_setting",(0,n.jG)(t)),L=t=>(0,r.dX)("/api/shop_live/get_s2b2c_settlement_setting",{params:{project_id:t}})},82741:function(t,e,a){a.d(e,{I:function(){return r},u:function(){return o}});var n=a(71340);const r=(t,e)=>{const a="string"===typeof e?{title:e}:e;return new Promise((e=>{t.root.$TDialog({...a,onConfirm:()=>e(!0),onCancel:()=>e(!1)})}))},o=t=>{const e="string"===typeof t?{title:t}:t;return new Promise(((t,a)=>{(0,n.t)({...e,onConfirm:()=>t(!0),onCancel:()=>a()})}))}},44928:function(t,e,a){a.d(e,{t:function(){return r}});var n=a(86834);const r=()=>{const t=new Proxy({},{get(t,e){return Reflect.get(n.Z,e)}});return t}},43773:function(t,e,a){a.d(e,{R:function(){return d},y:function(){return m}});var n=a(36568),r=a.n(n),o=a(97434),i=a(64923),l=a(77944);let s=1;const c=()=>{const t=document.createElement("div");return t.id="dialog_"+s++,document.body.appendChild(t),t},u=new Function,p=(t,e)=>{let a=t;return void 0===a&&(a={}),Object.keys(e).forEach((t=>{const n=a[t]||u,r=e[t];a[t]=(...t)=>{if(!1!==r(...t))return n(...t)}})),a},d=(t={})=>{const e=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,o.ref)(!0),s=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};s(t);const u=(0,o.ref)(p(t.on,{close(){a.visible=!1},updateDialog(t={}){s(t)}})),d=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new i["default"]({el:c(),store:l.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,o.provide)(e,t.provide[e])}))},render(e){if(n.value&&a.visible)return e("el-dialog",r()([{class:`customer-dialog el-dialog-center-rewrite tg-body-container  ${t.class}`},{props:a},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value}),a.footer&&e("fragments",{slot:"footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},_=t=>(s(t),g),v=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?u.value[t]=e:p(u.value,{[t]:e}),g);(0,o.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const g=(0,o.reactive)({show:m,update:_,on:f,close:v,config:t,data:t.data});return g},m=(t={})=>{const e=(0,o.ref)(),a=(0,o.reactive)({visible:!1,title:void 0,width:void 0,footer:!0,okText:"提交",cancelText:"取消",disabledOK:!0}),n=(0,o.ref)(!0),s=t=>{Object.keys(t).forEach((e=>{a.hasOwnProperty.call(a,e)&&(a[e]=t[e])}))};s(t);const u=(0,o.ref)(p(t.on,{close(){a.visible=!1},updateDialog(t={}){s(t)}})),d=()=>{const t=e.value.$refs&&e.value.$refs.dialogRef||{};t.dialogSubmit?t.dialogSubmit():t.onSaveBtnClick?t.onSaveBtnClick():console.log("子组件没有dialogSubmit或onSaveBtnClick")};e.value=new i["default"]({el:c(),store:l.Z,setup(){void 0!==t.provide&&Object.keys(t.provide).forEach((e=>{(0,o.provide)(e,t.provide[e])}))},render(e){if(!n.value)return;if(!a.visible)return;const{width:o,...i}=a;return e("el-drawer",r()([{class:`tg-drawer-rewrite ${t.class}`},{props:{...i,size:o}},{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,wrapperClosable:!1}},{on:u.value},{attrs:{isDialog:!0}}]),[e("div",{class:"tg-drawer-content"},[a.visible&&e(t.component,{ref:"dialogRef",props:{...t.props,isDialog:!0},on:u.value})]),a.footer&&e("div",{class:"tg-drawer-footer"},[e("tg-button",{on:{click:()=>a.visible=!1}},[a.cancelText]),a.disabledOK&&e("tg-button",{class:"mgl-12",attrs:{type:"primary"},on:{click:d}},[a.okText])])])}});const m=(...t)=>{a.visible||(a.visible=!0,(0,o.nextTick)((()=>{const a=e.value.$refs&&e.value.$refs.dialogRef;a?a.dialogShow?a.dialogShow(...t):a.show&&a.show(...t):console.log("未找到子组件请检查代码")})))},_=t=>(s(t),g),v=()=>{a.visible=!1},f=(t,e,a=!1)=>(!0===a?u.value[t]=e:p(u.value,{[t]:e}),g);(0,o.onUnmounted)((()=>{n.value=!1,a.visible=!1}));const g=(0,o.reactive)({show:m,update:_,on:f,close:v,config:t});return g}}}]);