"use strict";(self["webpackChunkgoumee_star_temp"]=self["webpackChunkgoumee_star_temp"]||[]).push([[1352],{22770:function(e,t,n){n.d(t,{Z:function(){return c}});var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{staticClass:"tg-dialog-classic tg-dialog-vcenter-new tg-reverse-audit-dialog",attrs:{visible:e.visible,"close-on-click-modal":!1,width:"440px"},on:{close:e.close},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("单据冲销")]},proxy:!0},{key:"footer",fn:function(){return[n("tg-button",{on:{click:e.onRefuse}},[e._v("取消")]),n("tg-button",{attrs:{type:"primary",disabled:e.isConfirmBtnDisabled},on:{click:e.onConfirm}},[e._v("提交")])]},proxy:!0}])},[n("div",{staticClass:"tg-reverse-audit-dialog-content",style:{paddingBottom:0===e.is_pass?"24px":"8px"}},[n("el-form",{staticClass:"el-form-vertical",attrs:{"label-position":"top","show-message":!1}},[n("div",{staticClass:"reverse-reason-label"},[e._v("冲销原因")]),n("div",{staticClass:"reverse-reason-content"},[e._v(" "+e._s(e.reverse_reason)+" ")]),n("el-form-item",{staticClass:"sp-form-item",staticStyle:{"margin-top":"18px"},attrs:{label:"是否通过",prop:"is_pass",required:""}},[n("div",{staticStyle:{width:"100%"}},[n("el-radio-group",{model:{value:e.is_pass,callback:function(t){e.is_pass=t},expression:"is_pass"}},[n("el-radio",{attrs:{label:1}},[e._v("通过")]),n("el-radio",{attrs:{label:0}},[e._v("不通过")])],1)],1)]),n("el-input",{directives:[{name:"show",rawName:"v-show",value:0===e.is_pass,expression:"is_pass === 0"}],attrs:{type:"textarea",placeholder:"请输入不通过原因",clearable:"",maxlength:100,"show-word-limit":""},model:{value:e.reverse_back_reason,callback:function(t){e.reverse_back_reason="string"===typeof t?t.trim():t},expression:"reverse_back_reason"}})],1)],1)])},r=[],o=n(97434),l=n(58861),i=n(22895),s=(0,o.defineComponent)({setup(e,t){const n=(0,o.ref)(""),a=(0,o.ref)(""),r=(0,o.ref)(i.w.YES),s=(0,o.ref)(null),u=(0,o.computed)((()=>r.value===i.w.NO&&""===a.value.trim())),{visible:m,setVisible:d}=(0,l.Z)();(0,o.watch)((()=>m.value),(e=>{console.log({next:e})}));const c=()=>{n.value="",d()},_=async()=>{if(u.value)return void t.root.$message.warning("请填写不通过原因");const e=await(s.value?.(r.value,a.value));e&&(n.value="",d())},p=(e,t)=>{n.value=e,a.value="",r.value=i.w.YES,s.value=t,d(!0)},f=()=>{n.value="",a.value="",s.value=null,d(!1)};return{visible:m,open:p,close:f,is_pass:r,reverse_reason:n,reverse_back_reason:a,onRefuse:c,onConfirm:_,isConfirmBtnDisabled:u}}}),u=s,m=n(1001),d=(0,m.Z)(u,a,r,!1,null,null,null),c=d.exports},67957:function(e,t,n){n.d(t,{QN:function(){return o},RD:function(){return s},e2:function(){return i},uE:function(){return u}});var a=n(74750),r=n(97434);const o="杭州煜丰电子商务有限公司",l=(0,r.computed)((()=>{let e;try{e=new URL("https://data.goumee.com")}catch{console.log(`current url = ${e}`)}const t=e?.protocol,n=e?.hostname;return`${t}//${n}`})),i=(e,t,n=1)=>t&&1===n?`${l.value}/api/shop_live/download_live_goods_detail?settlement_id=${e}&company_id=${t}&fee_type=${n}&Authorization=${(0,a.LP)()}`:`${l.value}/api/shop_live/download_live_goods_detail?settlement_id=${e}&fee_type=${n}&Authorization=${(0,a.LP)()}`,s=(e,t,n)=>`${l.value}/api/oceanengine/ad_plan/download_ad_cost?kol_ids=${e}&start_date=${t}&end_date=${n}&Authorization=${(0,a.LP)()}`,u=(e,t,n)=>`${l.value}/api/oceanengine/ad_plan/download_ad_cost/yufeng?project_id=${e}&start_date=${t}&end_date=${n}&Authorization=${(0,a.LP)()}`},99166:function(e,t,n){n.d(t,{S:function(){return f}});n(26699);var a=n(97434),r=n(28348),o=n(85937),l=n.n(o),i=n(61282),s=n(6933),u=n.n(s),m=n(10079),d=n(67578),c=n(67910);const _=e=>{const{settlement_type:t}=e;return t===r.kX.live_taobao||t===r.kX.live_douyin||[r.kX.common_mcn_taobao_cps,r.kX.common_mcn_douyin_cps,r.kX.common_mcn_vtask,r.kX.s2b2c_douyin_cps].includes(t)?e.company_name||"--":[r.kX.marketing_marketing,r.kX.marketing_vtask].includes(t)&&e.company_name||"--"},p=e=>0===e?"--":u()(1e3*e).format("YYYY.MM.DD"),f=e=>{const t=(e,t)=>(0,a.h)("div",{class:"number-div"},[(0,a.h)("span",{class:"number-span "+(!t&&null!==e.reversed_id||null!==e.refunded_id?"reverse-red":"")},e.settlement_uid)]),n=e=>(0,a.h)("div",{class:"number-div"},[(0,a.h)("span",{class:"number-span"},e.related_income_settlement_uid||"--")]),o=(e,t)=>{const n=e.company_name||"--",{is_folded:r,folded_text:o}=(0,i.zb)(n,15);return t?o:r?(0,a.h)("el-popover",{props:{placement:"bottom",trigger:"hover",content:n}},[(0,a.h)("span",{slot:"reference"},[o])]):o},s=(e,t)=>{const n=(0,i.SJ)(new(l())(e.tax_included_amount??0));return t?n:(0,a.h)("span",(0,m.a2)(e),[n])},f=(0,c.zY)(e,"含税结算金额 (元)",s),v=(e,t)=>{let n="--";return void 0===e.tax_amount||isNaN(Number(`${e.tax_amount}`))?n:(n=(0,i.SJ)(new(l())(e.tax_amount)),t?n:(0,a.h)("span",(0,m.a2)(e),[n]))},g=(0,c.zY)(e,"税额 (元)",v),h=(e,t)=>{let n="--";return void 0===e.tax_excluded_amount||isNaN(Number(`${e.tax_excluded_amount}`))?n:(n=(0,i.SJ)(new(l())(e.tax_excluded_amount)),t?n:(0,a.h)("span",(0,m.a2)(e),[n]))},b=(0,c.zY)(e,"不含税金额 (元)",h),y=(e,t)=>{let n="--";return void 0===e.paid_amount||isNaN(Number(`${e.paid_amount}`))?n:(n=(0,i.SJ)(new(l())(e.paid_amount)),t?n:(0,a.h)("span",(0,m.a2)(e),[n]))},x=(0,c.zY)(e,"已付金额 (元)",y),w=(e,t)=>{let n="--";return void 0===e.pending_amount||isNaN(Number(`${e.pending_amount}`))?n:(n=(0,i.SJ)(new(l())(e.pending_amount)),t?n:(0,a.h)("span",(0,m.a2)(e),[n]))},k=(0,c.zY)(e,"未付金额 (元)",w),$=(e,t)=>{const n=e.project_name||"--",{is_folded:r,folded_text:o}=(0,i.zb)(n);return t?o:r?(0,a.h)("el-popover",{props:{placement:"bottom",trigger:"hover",content:n}},[(0,a.h)("span",{slot:"reference"},[o])]):o},Y=(e,t)=>{const n=e.feishu_department_name||"--",{is_folded:r,folded_text:o}=(0,i.zb)(n);return t?o:r?(0,a.h)("el-popover",{props:{placement:"bottom",trigger:"hover",content:n}},[(0,a.h)("span",{slot:"reference"},[o])]):o},N=(0,c.zY)(e,"项目名称",$),z=(0,c.zY)(e,"所属部门",Y),W=(e,t)=>r.v$.get(e.settlement_type)??"--",C=(0,c.zY)(e,"结算类型",W),A=(0,c.zY)(e,"结算供应商",_),S=(0,a.computed)((()=>({label:"结算编号",property:"settlement_uid",fixed:"left",minWidth:160,formatter:e=>t(e,!1)}))),D=(0,a.computed)((()=>({label:"结算客户",property:"company_name",align:"left",minWidth:(0,c.zY)(e,"结算公司",o).value,formatter:e=>o(e,!1)}))),j=(0,a.ref)({label:"结算周期",property:"start_date",width:170,align:"center",formatter:e=>[e.start_date,e.end_date].map((e=>u()(1e3*e).format("YYYY.MM.DD"))).join(" ~ ")}),B=(0,a.computed)((()=>({label:"含税结算金额 (元)",property:"tax_included_amount",align:"right",headerAlign:"right",minWidth:f.value,formatter:e=>s(e,!1)}))),F=(0,a.computed)((()=>({label:"税率",property:"tax_rate",align:"right",headerAlign:"right",minWidth:80,formatter:e=>isNaN(Number(`${e.tax_rate}`))?"--":`${e.tax_rate}%`}))),X=(0,a.computed)((()=>({label:"税额 (元)",property:"total_settle_amount",align:"right",headerAlign:"right",minWidth:g.value,formatter:e=>v(e,!1)}))),E=(0,a.computed)((()=>({label:"不含税金额 (元)",property:"tax_excluded_amount",align:"right",headerAlign:"right",minWidth:b.value,formatter:e=>h(e,!1)}))),L=(0,a.computed)((()=>({label:"已付金额 (元)",property:"tax_excluded_amount",align:"right",headerAlign:"right",minWidth:x.value,formatter:e=>y(e,!1)}))),J=(0,a.computed)((()=>({label:"待付金额 (元)",property:"tax_excluded_amount",align:"right",headerAlign:"right",minWidth:k.value,formatter:e=>w(e,!1)}))),M=(0,a.ref)({label:"结算状态",property:"status",width:130,align:"center",formatter:e=>{const t=new Map([[0,"rgba(60,82,105,0.60);"],[1,"#FF955F"],[2,"#33BA5D"],[3,"#F04B4B"],[4,"#FF955F"],[5,"#F04B4B"]]);if((0,m.vs)(e))return(0,a.h)("div",{style:"display: flex;justify-content: center"},"--");if((0,m.Ep)(e)){const{refund_status:n=0}=e,o=t.get(n),l=`display: inline-block; border-radius: 50%; width: 6px;height: 6px;margin-top:7px;background: ${o};`,i=r.D_.get(n)??"--";return(0,a.h)("div",{style:"display: flex;justify-content: center;padding-left:30px"},[(0,a.h)("div",{style:l}),(0,a.h)("div",{style:"padding: 0 0 0 5px; width:70px;  display: inline-block;text-align:left"},[i])])}{const{status:n}=e,o=t.get(e.status),l=`display: inline-block; border-radius: 50%; width: 6px;margin-top:7px;height: 6px;background: ${o};`,i=r.D_.get(n)??"--";return(0,a.h)("div",{style:"display: flex;justify-content: center;padding-left:30px"},[(0,a.h)("div",{style:l}),(0,a.h)("div",{style:"padding:0 0 0 5px;width:70px; display: inline-block;text-align:left"},[i])])}}}),V=(0,a.ref)({label:"冲销状态",property:"status",align:"center",formatter:e=>{if((0,m.vs)(e)){const{reverse_status:t}=e,n=d.h0.wait_confirm===t?"fg-waiting":t===d.h0.refused?"fg-failure":"fg-success";return(0,a.h)("span",{class:n},d.LQ.get(t)??"--")}return"--"}}),P=(0,a.ref)({label:"结算人",property:"submit_username",minWidth:100,align:"center",formatter:e=>(0,i.Vw)(e.submit_username)}),R=(0,a.ref)({label:"提交日期",property:"submit_time",minWidth:100,align:"center",formatter:e=>p(e.submit_time)}),Z=(0,a.ref)({label:"确认人",minWidth:100,align:"center",property:"confirmed_username",formatter:e=>e.status===r.ne.confirmed?(0,i.Vw)(e.confirmed_username):"--"}),Q=(0,a.ref)({label:"确认日期",align:"center",property:"confirmed_time",minWidth:100,formatter:e=>e.status===r.ne.confirmed?p(e.confirmed_time):"--"}),q=(0,a.ref)({label:"对应收入结算",fixed:"left",minWidth:150,formatter:e=>n(e)}),O=(0,a.computed)((()=>({label:"项目名称",property:"project_name",minWidth:N.value,fixed:"left",formatter:e=>$(e,!1)}))),U=(0,a.computed)((()=>({label:"所属部门",property:"feishu_department_name",align:"center",minWidth:z.value+10,formatter:e=>Y(e,!1)}))),G=(0,a.computed)((()=>({label:"结算类型",property:"settlement_type",align:"center",minWidth:C.value,formatter:e=>W(e,!1)}))),H=(0,a.computed)((()=>({label:"结算供应商",minWidth:A.value,formatter:_}))),I=(0,a.ref)({label:"结算单",align:"center",formatter:e=>e.settlement_files.length?"已上传":"--"});return{settlement_number_column:S,settlement_company_column:D,settlement_cycle_column:j,settlement_money_column:B,settlement_tax_rate_column:F,settlement_tax_amount_column:X,settlement_no_tax_amount_column:E,paid_amount_column:L,not_paid_amount_column:J,settlement_status_column:M,write_off_status_column:V,settlement_person_column:P,submit_date_column:R,confirm_person_column:Z,confirm_date_column:Q,income_settlement_column:q,project_name_colume:O,department_name_colume:U,settlement_type_column:G,settlement_supplier_column:H,settlement_bill_column:I}}},10079:function(e,t,n){n.d(t,{Ep:function(){return o},a2:function(){return r},vs:function(){return a}});const a=e=>null!==e.reversed_id,r=e=>a(e)||o(e)?{class:"reverse-red"}:{},o=e=>null!==e.refunded_id},58861:function(e,t,n){var a=n(97434);const r=(e=!1)=>{const t=(0,a.ref)(e),n=(e=!1)=>t.value=e,r=()=>t.value=!t.value;return{visible:(0,a.computed)((()=>t.value)),setVisible:n,toggleVisible:r}};t["Z"]=r}}]);